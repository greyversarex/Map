function u6(r,n){for(var s=0;s<n.length;s++){const u=n[s];if(typeof u!="string"&&!Array.isArray(u)){for(const m in u)if(m!=="default"&&!(m in r)){const x=Object.getOwnPropertyDescriptor(u,m);x&&Object.defineProperty(r,m,x.get?x:{enumerable:!0,get:()=>u[m]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))u(m);new MutationObserver(m=>{for(const x of m)if(x.type==="childList")for(const v of x.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&u(v)}).observe(document,{childList:!0,subtree:!0});function s(m){const x={};return m.integrity&&(x.integrity=m.integrity),m.referrerPolicy&&(x.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?x.credentials="include":m.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function u(m){if(m.ep)return;m.ep=!0;const x=s(m);fetch(m.href,x)}})();function lx(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var bv={exports:{}},cg={},wv={exports:{}},Gr={};var _b;function TC(){if(_b)return Gr;_b=1;var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),v=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),R=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),B=Symbol.iterator;function W(Re){return Re===null||typeof Re!="object"?null:(Re=B&&Re[B]||Re["@@iterator"],typeof Re=="function"?Re:null)}var re={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ce=Object.assign,Q={};function X(Re,at,nr){this.props=Re,this.context=at,this.refs=Q,this.updater=nr||re}X.prototype.isReactComponent={},X.prototype.setState=function(Re,at){if(typeof Re!="object"&&typeof Re!="function"&&Re!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Re,at,"setState")},X.prototype.forceUpdate=function(Re){this.updater.enqueueForceUpdate(this,Re,"forceUpdate")};function le(){}le.prototype=X.prototype;function he(Re,at,nr){this.props=Re,this.context=at,this.refs=Q,this.updater=nr||re}var _e=he.prototype=new le;_e.constructor=he,ce(_e,X.prototype),_e.isPureReactComponent=!0;var Ie=Array.isArray,ke=Object.prototype.hasOwnProperty,Je={current:null},He={key:!0,ref:!0,__self:!0,__source:!0};function nt(Re,at,nr){var er,ir={},sr=null,St=null;if(at!=null)for(er in at.ref!==void 0&&(St=at.ref),at.key!==void 0&&(sr=""+at.key),at)ke.call(at,er)&&!He.hasOwnProperty(er)&&(ir[er]=at[er]);var Gt=arguments.length-2;if(Gt===1)ir.children=nr;else if(1<Gt){for(var yr=Array(Gt),cr=0;cr<Gt;cr++)yr[cr]=arguments[cr+2];ir.children=yr}if(Re&&Re.defaultProps)for(er in Gt=Re.defaultProps,Gt)ir[er]===void 0&&(ir[er]=Gt[er]);return{$$typeof:r,type:Re,key:sr,ref:St,props:ir,_owner:Je.current}}function Pt(Re,at){return{$$typeof:r,type:Re.type,key:at,ref:Re.ref,props:Re.props,_owner:Re._owner}}function Ct(Re){return typeof Re=="object"&&Re!==null&&Re.$$typeof===r}function Zt(Re){var at={"=":"=0",":":"=2"};return"$"+Re.replace(/[=:]/g,function(nr){return at[nr]})}var lt=/\/+/g;function Et(Re,at){return typeof Re=="object"&&Re!==null&&Re.key!=null?Zt(""+Re.key):at.toString(36)}function ft(Re,at,nr,er,ir){var sr=typeof Re;(sr==="undefined"||sr==="boolean")&&(Re=null);var St=!1;if(Re===null)St=!0;else switch(sr){case"string":case"number":St=!0;break;case"object":switch(Re.$$typeof){case r:case n:St=!0}}if(St)return St=Re,ir=ir(St),Re=er===""?"."+Et(St,0):er,Ie(ir)?(nr="",Re!=null&&(nr=Re.replace(lt,"$&/")+"/"),ft(ir,at,nr,"",function(cr){return cr})):ir!=null&&(Ct(ir)&&(ir=Pt(ir,nr+(!ir.key||St&&St.key===ir.key?"":(""+ir.key).replace(lt,"$&/")+"/")+Re)),at.push(ir)),1;if(St=0,er=er===""?".":er+":",Ie(Re))for(var Gt=0;Gt<Re.length;Gt++){sr=Re[Gt];var yr=er+Et(sr,Gt);St+=ft(sr,at,nr,yr,ir)}else if(yr=W(Re),typeof yr=="function")for(Re=yr.call(Re),Gt=0;!(sr=Re.next()).done;)sr=sr.value,yr=er+Et(sr,Gt++),St+=ft(sr,at,nr,yr,ir);else if(sr==="object")throw at=String(Re),Error("Objects are not valid as a React child (found: "+(at==="[object Object]"?"object with keys {"+Object.keys(Re).join(", ")+"}":at)+"). If you meant to render a collection of children, use an array instead.");return St}function gt(Re,at,nr){if(Re==null)return Re;var er=[],ir=0;return ft(Re,er,"","",function(sr){return at.call(nr,sr,ir++)}),er}function dt(Re){if(Re._status===-1){var at=Re._result;at=at(),at.then(function(nr){(Re._status===0||Re._status===-1)&&(Re._status=1,Re._result=nr)},function(nr){(Re._status===0||Re._status===-1)&&(Re._status=2,Re._result=nr)}),Re._status===-1&&(Re._status=0,Re._result=at)}if(Re._status===1)return Re._result.default;throw Re._result}var mt={current:null},Xe={transition:null},Be={ReactCurrentDispatcher:mt,ReactCurrentBatchConfig:Xe,ReactCurrentOwner:Je};function _t(){throw Error("act(...) is not supported in production builds of React.")}return Gr.Children={map:gt,forEach:function(Re,at,nr){gt(Re,function(){at.apply(this,arguments)},nr)},count:function(Re){var at=0;return gt(Re,function(){at++}),at},toArray:function(Re){return gt(Re,function(at){return at})||[]},only:function(Re){if(!Ct(Re))throw Error("React.Children.only expected to receive a single React element child.");return Re}},Gr.Component=X,Gr.Fragment=s,Gr.Profiler=m,Gr.PureComponent=he,Gr.StrictMode=u,Gr.Suspense=A,Gr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Be,Gr.act=_t,Gr.cloneElement=function(Re,at,nr){if(Re==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Re+".");var er=ce({},Re.props),ir=Re.key,sr=Re.ref,St=Re._owner;if(at!=null){if(at.ref!==void 0&&(sr=at.ref,St=Je.current),at.key!==void 0&&(ir=""+at.key),Re.type&&Re.type.defaultProps)var Gt=Re.type.defaultProps;for(yr in at)ke.call(at,yr)&&!He.hasOwnProperty(yr)&&(er[yr]=at[yr]===void 0&&Gt!==void 0?Gt[yr]:at[yr])}var yr=arguments.length-2;if(yr===1)er.children=nr;else if(1<yr){Gt=Array(yr);for(var cr=0;cr<yr;cr++)Gt[cr]=arguments[cr+2];er.children=Gt}return{$$typeof:r,type:Re.type,key:ir,ref:sr,props:er,_owner:St}},Gr.createContext=function(Re){return Re={$$typeof:v,_currentValue:Re,_currentValue2:Re,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Re.Provider={$$typeof:x,_context:Re},Re.Consumer=Re},Gr.createElement=nt,Gr.createFactory=function(Re){var at=nt.bind(null,Re);return at.type=Re,at},Gr.createRef=function(){return{current:null}},Gr.forwardRef=function(Re){return{$$typeof:l,render:Re}},Gr.isValidElement=Ct,Gr.lazy=function(Re){return{$$typeof:L,_payload:{_status:-1,_result:Re},_init:dt}},Gr.memo=function(Re,at){return{$$typeof:R,type:Re,compare:at===void 0?null:at}},Gr.startTransition=function(Re){var at=Xe.transition;Xe.transition={};try{Re()}finally{Xe.transition=at}},Gr.unstable_act=_t,Gr.useCallback=function(Re,at){return mt.current.useCallback(Re,at)},Gr.useContext=function(Re){return mt.current.useContext(Re)},Gr.useDebugValue=function(){},Gr.useDeferredValue=function(Re){return mt.current.useDeferredValue(Re)},Gr.useEffect=function(Re,at){return mt.current.useEffect(Re,at)},Gr.useId=function(){return mt.current.useId()},Gr.useImperativeHandle=function(Re,at,nr){return mt.current.useImperativeHandle(Re,at,nr)},Gr.useInsertionEffect=function(Re,at){return mt.current.useInsertionEffect(Re,at)},Gr.useLayoutEffect=function(Re,at){return mt.current.useLayoutEffect(Re,at)},Gr.useMemo=function(Re,at){return mt.current.useMemo(Re,at)},Gr.useReducer=function(Re,at,nr){return mt.current.useReducer(Re,at,nr)},Gr.useRef=function(Re){return mt.current.useRef(Re)},Gr.useState=function(Re){return mt.current.useState(Re)},Gr.useSyncExternalStore=function(Re,at,nr){return mt.current.useSyncExternalStore(Re,at,nr)},Gr.useTransition=function(){return mt.current.useTransition()},Gr.version="18.3.1",Gr}var vb;function t_(){return vb||(vb=1,wv.exports=TC()),wv.exports}var xb;function SC(){if(xb)return cg;xb=1;var r=t_(),n=Symbol.for("react.element"),s=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,m=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x={key:!0,ref:!0,__self:!0,__source:!0};function v(l,A,R){var L,B={},W=null,re=null;R!==void 0&&(W=""+R),A.key!==void 0&&(W=""+A.key),A.ref!==void 0&&(re=A.ref);for(L in A)u.call(A,L)&&!x.hasOwnProperty(L)&&(B[L]=A[L]);if(l&&l.defaultProps)for(L in A=l.defaultProps,A)B[L]===void 0&&(B[L]=A[L]);return{$$typeof:n,type:l,key:W,ref:re,props:B,_owner:m.current}}return cg.Fragment=s,cg.jsx=v,cg.jsxs=v,cg}var bb;function PC(){return bb||(bb=1,bv.exports=SC()),bv.exports}var V=PC(),Jy={},Tv={exports:{}},Xo={},Sv={exports:{}},Pv={};var wb;function CC(){return wb||(wb=1,(function(r){function n(Xe,Be){var _t=Xe.length;Xe.push(Be);e:for(;0<_t;){var Re=_t-1>>>1,at=Xe[Re];if(0<m(at,Be))Xe[Re]=Be,Xe[_t]=at,_t=Re;else break e}}function s(Xe){return Xe.length===0?null:Xe[0]}function u(Xe){if(Xe.length===0)return null;var Be=Xe[0],_t=Xe.pop();if(_t!==Be){Xe[0]=_t;e:for(var Re=0,at=Xe.length,nr=at>>>1;Re<nr;){var er=2*(Re+1)-1,ir=Xe[er],sr=er+1,St=Xe[sr];if(0>m(ir,_t))sr<at&&0>m(St,ir)?(Xe[Re]=St,Xe[sr]=_t,Re=sr):(Xe[Re]=ir,Xe[er]=_t,Re=er);else if(sr<at&&0>m(St,_t))Xe[Re]=St,Xe[sr]=_t,Re=sr;else break e}}return Be}function m(Xe,Be){var _t=Xe.sortIndex-Be.sortIndex;return _t!==0?_t:Xe.id-Be.id}if(typeof performance=="object"&&typeof performance.now=="function"){var x=performance;r.unstable_now=function(){return x.now()}}else{var v=Date,l=v.now();r.unstable_now=function(){return v.now()-l}}var A=[],R=[],L=1,B=null,W=3,re=!1,ce=!1,Q=!1,X=typeof setTimeout=="function"?setTimeout:null,le=typeof clearTimeout=="function"?clearTimeout:null,he=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _e(Xe){for(var Be=s(R);Be!==null;){if(Be.callback===null)u(R);else if(Be.startTime<=Xe)u(R),Be.sortIndex=Be.expirationTime,n(A,Be);else break;Be=s(R)}}function Ie(Xe){if(Q=!1,_e(Xe),!ce)if(s(A)!==null)ce=!0,dt(ke);else{var Be=s(R);Be!==null&&mt(Ie,Be.startTime-Xe)}}function ke(Xe,Be){ce=!1,Q&&(Q=!1,le(nt),nt=-1),re=!0;var _t=W;try{for(_e(Be),B=s(A);B!==null&&(!(B.expirationTime>Be)||Xe&&!Zt());){var Re=B.callback;if(typeof Re=="function"){B.callback=null,W=B.priorityLevel;var at=Re(B.expirationTime<=Be);Be=r.unstable_now(),typeof at=="function"?B.callback=at:B===s(A)&&u(A),_e(Be)}else u(A);B=s(A)}if(B!==null)var nr=!0;else{var er=s(R);er!==null&&mt(Ie,er.startTime-Be),nr=!1}return nr}finally{B=null,W=_t,re=!1}}var Je=!1,He=null,nt=-1,Pt=5,Ct=-1;function Zt(){return!(r.unstable_now()-Ct<Pt)}function lt(){if(He!==null){var Xe=r.unstable_now();Ct=Xe;var Be=!0;try{Be=He(!0,Xe)}finally{Be?Et():(Je=!1,He=null)}}else Je=!1}var Et;if(typeof he=="function")Et=function(){he(lt)};else if(typeof MessageChannel<"u"){var ft=new MessageChannel,gt=ft.port2;ft.port1.onmessage=lt,Et=function(){gt.postMessage(null)}}else Et=function(){X(lt,0)};function dt(Xe){He=Xe,Je||(Je=!0,Et())}function mt(Xe,Be){nt=X(function(){Xe(r.unstable_now())},Be)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Xe){Xe.callback=null},r.unstable_continueExecution=function(){ce||re||(ce=!0,dt(ke))},r.unstable_forceFrameRate=function(Xe){0>Xe||125<Xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Pt=0<Xe?Math.floor(1e3/Xe):5},r.unstable_getCurrentPriorityLevel=function(){return W},r.unstable_getFirstCallbackNode=function(){return s(A)},r.unstable_next=function(Xe){switch(W){case 1:case 2:case 3:var Be=3;break;default:Be=W}var _t=W;W=Be;try{return Xe()}finally{W=_t}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(Xe,Be){switch(Xe){case 1:case 2:case 3:case 4:case 5:break;default:Xe=3}var _t=W;W=Xe;try{return Be()}finally{W=_t}},r.unstable_scheduleCallback=function(Xe,Be,_t){var Re=r.unstable_now();switch(typeof _t=="object"&&_t!==null?(_t=_t.delay,_t=typeof _t=="number"&&0<_t?Re+_t:Re):_t=Re,Xe){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=_t+at,Xe={id:L++,callback:Be,priorityLevel:Xe,startTime:_t,expirationTime:at,sortIndex:-1},_t>Re?(Xe.sortIndex=_t,n(R,Xe),s(A)===null&&Xe===s(R)&&(Q?(le(nt),nt=-1):Q=!0,mt(Ie,_t-Re))):(Xe.sortIndex=at,n(A,Xe),ce||re||(ce=!0,dt(ke))),Xe},r.unstable_shouldYield=Zt,r.unstable_wrapCallback=function(Xe){var Be=W;return function(){var _t=W;W=Be;try{return Xe.apply(this,arguments)}finally{W=_t}}}})(Pv)),Pv}var Tb;function EC(){return Tb||(Tb=1,Sv.exports=CC()),Sv.exports}var Sb;function MC(){if(Sb)return Xo;Sb=1;var r=t_(),n=EC();function s(h){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+h,S=1;S<arguments.length;S++)p+="&args[]="+encodeURIComponent(arguments[S]);return"Minified React error #"+h+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=new Set,m={};function x(h,p){v(h,p),v(h+"Capture",p)}function v(h,p){for(m[h]=p,h=0;h<p.length;h++)u.add(p[h])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),A=Object.prototype.hasOwnProperty,R=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,L={},B={};function W(h){return A.call(B,h)?!0:A.call(L,h)?!1:R.test(h)?B[h]=!0:(L[h]=!0,!1)}function re(h,p,S,M){if(S!==null&&S.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return M?!1:S!==null?!S.acceptsBooleans:(h=h.toLowerCase().slice(0,5),h!=="data-"&&h!=="aria-");default:return!1}}function ce(h,p,S,M){if(p===null||typeof p>"u"||re(h,p,S,M))return!0;if(M)return!1;if(S!==null)switch(S.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function Q(h,p,S,M,F,$,ie){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=M,this.attributeNamespace=F,this.mustUseProperty=S,this.propertyName=h,this.type=p,this.sanitizeURL=$,this.removeEmptyString=ie}var X={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(h){X[h]=new Q(h,0,!1,h,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(h){var p=h[0];X[p]=new Q(p,1,!1,h[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(h){X[h]=new Q(h,2,!1,h.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(h){X[h]=new Q(h,2,!1,h,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(h){X[h]=new Q(h,3,!1,h.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(h){X[h]=new Q(h,3,!0,h,null,!1,!1)}),["capture","download"].forEach(function(h){X[h]=new Q(h,4,!1,h,null,!1,!1)}),["cols","rows","size","span"].forEach(function(h){X[h]=new Q(h,6,!1,h,null,!1,!1)}),["rowSpan","start"].forEach(function(h){X[h]=new Q(h,5,!1,h.toLowerCase(),null,!1,!1)});var le=/[\-:]([a-z])/g;function he(h){return h[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(h){var p=h.replace(le,he);X[p]=new Q(p,1,!1,h,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(h){var p=h.replace(le,he);X[p]=new Q(p,1,!1,h,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(h){var p=h.replace(le,he);X[p]=new Q(p,1,!1,h,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(h){X[h]=new Q(h,1,!1,h.toLowerCase(),null,!1,!1)}),X.xlinkHref=new Q("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(h){X[h]=new Q(h,1,!1,h.toLowerCase(),null,!0,!0)});function _e(h,p,S,M){var F=X.hasOwnProperty(p)?X[p]:null;(F!==null?F.type!==0:M||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(ce(p,S,F,M)&&(S=null),M||F===null?W(p)&&(S===null?h.removeAttribute(p):h.setAttribute(p,""+S)):F.mustUseProperty?h[F.propertyName]=S===null?F.type===3?!1:"":S:(p=F.attributeName,M=F.attributeNamespace,S===null?h.removeAttribute(p):(F=F.type,S=F===3||F===4&&S===!0?"":""+S,M?h.setAttributeNS(M,p,S):h.setAttribute(p,S))))}var Ie=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ke=Symbol.for("react.element"),Je=Symbol.for("react.portal"),He=Symbol.for("react.fragment"),nt=Symbol.for("react.strict_mode"),Pt=Symbol.for("react.profiler"),Ct=Symbol.for("react.provider"),Zt=Symbol.for("react.context"),lt=Symbol.for("react.forward_ref"),Et=Symbol.for("react.suspense"),ft=Symbol.for("react.suspense_list"),gt=Symbol.for("react.memo"),dt=Symbol.for("react.lazy"),mt=Symbol.for("react.offscreen"),Xe=Symbol.iterator;function Be(h){return h===null||typeof h!="object"?null:(h=Xe&&h[Xe]||h["@@iterator"],typeof h=="function"?h:null)}var _t=Object.assign,Re;function at(h){if(Re===void 0)try{throw Error()}catch(S){var p=S.stack.trim().match(/\n( *(at )?)/);Re=p&&p[1]||""}return`
`+Re+h}var nr=!1;function er(h,p){if(!h||nr)return"";nr=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(et){var M=et}Reflect.construct(h,[],p)}else{try{p.call()}catch(et){M=et}h.call(p.prototype)}else{try{throw Error()}catch(et){M=et}h()}}catch(et){if(et&&M&&typeof et.stack=="string"){for(var F=et.stack.split(`
`),$=M.stack.split(`
`),ie=F.length-1,Pe=$.length-1;1<=ie&&0<=Pe&&F[ie]!==$[Pe];)Pe--;for(;1<=ie&&0<=Pe;ie--,Pe--)if(F[ie]!==$[Pe]){if(ie!==1||Pe!==1)do if(ie--,Pe--,0>Pe||F[ie]!==$[Pe]){var Le=`
`+F[ie].replace(" at new "," at ");return h.displayName&&Le.includes("<anonymous>")&&(Le=Le.replace("<anonymous>",h.displayName)),Le}while(1<=ie&&0<=Pe);break}}}finally{nr=!1,Error.prepareStackTrace=S}return(h=h?h.displayName||h.name:"")?at(h):""}function ir(h){switch(h.tag){case 5:return at(h.type);case 16:return at("Lazy");case 13:return at("Suspense");case 19:return at("SuspenseList");case 0:case 2:case 15:return h=er(h.type,!1),h;case 11:return h=er(h.type.render,!1),h;case 1:return h=er(h.type,!0),h;default:return""}}function sr(h){if(h==null)return null;if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case He:return"Fragment";case Je:return"Portal";case Pt:return"Profiler";case nt:return"StrictMode";case Et:return"Suspense";case ft:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case Zt:return(h.displayName||"Context")+".Consumer";case Ct:return(h._context.displayName||"Context")+".Provider";case lt:var p=h.render;return h=h.displayName,h||(h=p.displayName||p.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case gt:return p=h.displayName||null,p!==null?p:sr(h.type)||"Memo";case dt:p=h._payload,h=h._init;try{return sr(h(p))}catch{}}return null}function St(h){var p=h.type;switch(h.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return h=p.render,h=h.displayName||h.name||"",p.displayName||(h!==""?"ForwardRef("+h+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sr(p);case 8:return p===nt?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function Gt(h){switch(typeof h){case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function yr(h){var p=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function cr(h){var p=yr(h)?"checked":"value",S=Object.getOwnPropertyDescriptor(h.constructor.prototype,p),M=""+h[p];if(!h.hasOwnProperty(p)&&typeof S<"u"&&typeof S.get=="function"&&typeof S.set=="function"){var F=S.get,$=S.set;return Object.defineProperty(h,p,{configurable:!0,get:function(){return F.call(this)},set:function(ie){M=""+ie,$.call(this,ie)}}),Object.defineProperty(h,p,{enumerable:S.enumerable}),{getValue:function(){return M},setValue:function(ie){M=""+ie},stopTracking:function(){h._valueTracker=null,delete h[p]}}}}function Lr(h){h._valueTracker||(h._valueTracker=cr(h))}function jr(h){if(!h)return!1;var p=h._valueTracker;if(!p)return!0;var S=p.getValue(),M="";return h&&(M=yr(h)?h.checked?"true":"false":h.value),h=M,h!==S?(p.setValue(h),!0):!1}function Fn(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}function en(h,p){var S=p.checked;return _t({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:S??h._wrapperState.initialChecked})}function ni(h,p){var S=p.defaultValue==null?"":p.defaultValue,M=p.checked!=null?p.checked:p.defaultChecked;S=Gt(p.value!=null?p.value:S),h._wrapperState={initialChecked:M,initialValue:S,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function vi(h,p){p=p.checked,p!=null&&_e(h,"checked",p,!1)}function Xr(h,p){vi(h,p);var S=Gt(p.value),M=p.type;if(S!=null)M==="number"?(S===0&&h.value===""||h.value!=S)&&(h.value=""+S):h.value!==""+S&&(h.value=""+S);else if(M==="submit"||M==="reset"){h.removeAttribute("value");return}p.hasOwnProperty("value")?Mo(h,p.type,S):p.hasOwnProperty("defaultValue")&&Mo(h,p.type,Gt(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(h.defaultChecked=!!p.defaultChecked)}function io(h,p,S){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var M=p.type;if(!(M!=="submit"&&M!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+h._wrapperState.initialValue,S||p===h.value||(h.value=p),h.defaultValue=p}S=h.name,S!==""&&(h.name=""),h.defaultChecked=!!h._wrapperState.initialChecked,S!==""&&(h.name=S)}function Mo(h,p,S){(p!=="number"||Fn(h.ownerDocument)!==h)&&(S==null?h.defaultValue=""+h._wrapperState.initialValue:h.defaultValue!==""+S&&(h.defaultValue=""+S))}var Ms=Array.isArray;function Ae(h,p,S,M){if(h=h.options,p){p={};for(var F=0;F<S.length;F++)p["$"+S[F]]=!0;for(S=0;S<h.length;S++)F=p.hasOwnProperty("$"+h[S].value),h[S].selected!==F&&(h[S].selected=F),F&&M&&(h[S].defaultSelected=!0)}else{for(S=""+Gt(S),p=null,F=0;F<h.length;F++){if(h[F].value===S){h[F].selected=!0,M&&(h[F].defaultSelected=!0);return}p!==null||h[F].disabled||(p=h[F])}p!==null&&(p.selected=!0)}}function Ue(h,p){if(p.dangerouslySetInnerHTML!=null)throw Error(s(91));return _t({},p,{value:void 0,defaultValue:void 0,children:""+h._wrapperState.initialValue})}function it(h,p){var S=p.value;if(S==null){if(S=p.children,p=p.defaultValue,S!=null){if(p!=null)throw Error(s(92));if(Ms(S)){if(1<S.length)throw Error(s(93));S=S[0]}p=S}p==null&&(p=""),S=p}h._wrapperState={initialValue:Gt(S)}}function Vt(h,p){var S=Gt(p.value),M=Gt(p.defaultValue);S!=null&&(S=""+S,S!==h.value&&(h.value=S),p.defaultValue==null&&h.defaultValue!==S&&(h.defaultValue=S)),M!=null&&(h.defaultValue=""+M)}function Mt(h){var p=h.textContent;p===h._wrapperState.initialValue&&p!==""&&p!==null&&(h.value=p)}function xe(h){switch(h){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ee(h,p){return h==null||h==="http://www.w3.org/1999/xhtml"?xe(p):h==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":h}var te,oe=(function(h){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,S,M,F){MSApp.execUnsafeLocalFunction(function(){return h(p,S,M,F)})}:h})(function(h,p){if(h.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in h)h.innerHTML=p;else{for(te=te||document.createElement("div"),te.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=te.firstChild;h.firstChild;)h.removeChild(h.firstChild);for(;p.firstChild;)h.appendChild(p.firstChild)}});function we(h,p){if(p){var S=h.firstChild;if(S&&S===h.lastChild&&S.nodeType===3){S.nodeValue=p;return}}h.textContent=p}var Ee={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ne=["Webkit","ms","Moz","O"];Object.keys(Ee).forEach(function(h){Ne.forEach(function(p){p=p+h.charAt(0).toUpperCase()+h.substring(1),Ee[p]=Ee[h]})});function Oe(h,p,S){return p==null||typeof p=="boolean"||p===""?"":S||typeof p!="number"||p===0||Ee.hasOwnProperty(h)&&Ee[h]?(""+p).trim():p+"px"}function De(h,p){h=h.style;for(var S in p)if(p.hasOwnProperty(S)){var M=S.indexOf("--")===0,F=Oe(S,p[S],M);S==="float"&&(S="cssFloat"),M?h.setProperty(S,F):h[S]=F}}var Ze=_t({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ut(h,p){if(p){if(Ze[h]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(s(137,h));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(s(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(s(61))}if(p.style!=null&&typeof p.style!="object")throw Error(s(62))}}function st(h,p){if(h.indexOf("-")===-1)return typeof p.is=="string";switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ot=null;function $t(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var hr=null,Ur=null,kr=null;function $e(h){if(h=po(h)){if(typeof hr!="function")throw Error(s(280));var p=h.stateNode;p&&(p=Au(p),hr(h.stateNode,h.type,p))}}function an(h){Ur?kr?kr.push(h):kr=[h]:Ur=h}function xi(){if(Ur){var h=Ur,p=kr;if(kr=Ur=null,$e(h),p)for(h=0;h<p.length;h++)$e(p[h])}}function fr(h,p){return h(p)}function Kr(){}var hi=!1;function mn(h,p,S){if(hi)return h(p,S);hi=!0;try{return fr(h,p,S)}finally{hi=!1,(Ur!==null||kr!==null)&&(Kr(),xi())}}function gn(h,p){var S=h.stateNode;if(S===null)return null;var M=Au(S);if(M===null)return null;S=M[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(M=!M.disabled)||(h=h.type,M=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!M;break e;default:h=!1}if(h)return null;if(S&&typeof S!="function")throw Error(s(231,p,typeof S));return S}var tn=!1;if(l)try{var On={};Object.defineProperty(On,"passive",{get:function(){tn=!0}}),window.addEventListener("test",On,On),window.removeEventListener("test",On,On)}catch{tn=!1}function ou(h,p,S,M,F,$,ie,Pe,Le){var et=Array.prototype.slice.call(arguments,3);try{p.apply(S,et)}catch(Tt){this.onError(Tt)}}var Jo=!1,yt=null,bi=!1,Ri=null,hh={onError:function(h){Jo=!0,yt=h}};function Ls(h,p,S,M,F,$,ie,Pe,Le){Jo=!1,yt=null,ou.apply(hh,arguments)}function Lt(h,p,S,M,F,$,ie,Pe,Le){if(Ls.apply(this,arguments),Jo){if(Jo){var et=yt;Jo=!1,yt=null}else throw Error(s(198));bi||(bi=!0,Ri=et)}}function _r(h){var p=h,S=h;if(h.alternate)for(;p.return;)p=p.return;else{h=p;do p=h,(p.flags&4098)!==0&&(S=p.return),h=p.return;while(h)}return p.tag===3?S:null}function Pr(h){if(h.tag===13){var p=h.memoizedState;if(p===null&&(h=h.alternate,h!==null&&(p=h.memoizedState)),p!==null)return p.dehydrated}return null}function ds(h){if(_r(h)!==h)throw Error(s(188))}function dh(h){var p=h.alternate;if(!p){if(p=_r(h),p===null)throw Error(s(188));return p!==h?null:h}for(var S=h,M=p;;){var F=S.return;if(F===null)break;var $=F.alternate;if($===null){if(M=F.return,M!==null){S=M;continue}break}if(F.child===$.child){for($=F.child;$;){if($===S)return ds(F),h;if($===M)return ds(F),p;$=$.sibling}throw Error(s(188))}if(S.return!==M.return)S=F,M=$;else{for(var ie=!1,Pe=F.child;Pe;){if(Pe===S){ie=!0,S=F,M=$;break}if(Pe===M){ie=!0,M=F,S=$;break}Pe=Pe.sibling}if(!ie){for(Pe=$.child;Pe;){if(Pe===S){ie=!0,S=$,M=F;break}if(Pe===M){ie=!0,M=$,S=F;break}Pe=Pe.sibling}if(!ie)throw Error(s(189))}}if(S.alternate!==M)throw Error(s(190))}if(S.tag!==3)throw Error(s(188));return S.stateNode.current===S?h:p}function Io(h){return h=dh(h),h!==null?vr(h):null}function vr(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){var p=vr(h);if(p!==null)return p;h=h.sibling}return null}var hc=n.unstable_scheduleCallback,dc=n.unstable_cancelCallback,fh=n.unstable_shouldYield,fc=n.unstable_requestPaint,Mn=n.unstable_now,pc=n.unstable_getCurrentPriorityLevel,ll=n.unstable_ImmediatePriority,Bi=n.unstable_UserBlockingPriority,qr=n.unstable_NormalPriority,ph=n.unstable_LowPriority,cl=n.unstable_IdlePriority,Aa=null,Vi=null;function so(h){if(Vi&&typeof Vi.onCommitFiberRoot=="function")try{Vi.onCommitFiberRoot(Aa,h,void 0,(h.current.flags&128)===128)}catch{}}var zs=Math.clz32?Math.clz32:Vn,ul=Math.log,mh=Math.LN2;function Vn(h){return h>>>=0,h===0?32:31-(ul(h)/mh|0)|0}var au=64,lu=4194304;function ea(h){switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return h&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return h}}function cu(h,p){var S=h.pendingLanes;if(S===0)return 0;var M=0,F=h.suspendedLanes,$=h.pingedLanes,ie=S&268435455;if(ie!==0){var Pe=ie&~F;Pe!==0?M=ea(Pe):($&=ie,$!==0&&(M=ea($)))}else ie=S&~F,ie!==0?M=ea(ie):$!==0&&(M=ea($));if(M===0)return 0;if(p!==0&&p!==M&&(p&F)===0&&(F=M&-M,$=p&-p,F>=$||F===16&&($&4194240)!==0))return p;if((M&4)!==0&&(M|=S&16),p=h.entangledLanes,p!==0)for(h=h.entanglements,p&=M;0<p;)S=31-zs(p),F=1<<S,M|=h[S],p&=~F;return M}function tp(h,p){switch(h){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rp(h,p){for(var S=h.suspendedLanes,M=h.pingedLanes,F=h.expirationTimes,$=h.pendingLanes;0<$;){var ie=31-zs($),Pe=1<<ie,Le=F[ie];Le===-1?((Pe&S)===0||(Pe&M)!==0)&&(F[ie]=tp(Pe,p)):Le<=p&&(h.expiredLanes|=Pe),$&=~Pe}}function mc(h){return h=h.pendingLanes&-1073741825,h!==0?h:h&1073741824?1073741824:0}function gh(){var h=au;return au<<=1,(au&4194240)===0&&(au=64),h}function uu(h){for(var p=[],S=0;31>S;S++)p.push(h);return p}function hl(h,p,S){h.pendingLanes|=p,p!==536870912&&(h.suspendedLanes=0,h.pingedLanes=0),h=h.eventTimes,p=31-zs(p),h[p]=S}function Nd(h,p){var S=h.pendingLanes&~p;h.pendingLanes=p,h.suspendedLanes=0,h.pingedLanes=0,h.expiredLanes&=p,h.mutableReadLanes&=p,h.entangledLanes&=p,p=h.entanglements;var M=h.eventTimes;for(h=h.expirationTimes;0<S;){var F=31-zs(S),$=1<<F;p[F]=0,M[F]=-1,h[F]=-1,S&=~$}}function jd(h,p){var S=h.entangledLanes|=p;for(h=h.entanglements;S;){var M=31-zs(S),F=1<<M;F&p|h[M]&p&&(h[M]|=p),S&=~F}}var Zr=0;function hu(h){return h&=-h,1<h?4<h?(h&268435455)!==0?16:536870912:4:1}var Bd,ka,yh,gc,ta,Da=!1,xr=[],Ao=null,Ra=null,ko=null,wi=new Map,ii=new Map,Yr=[],ur="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ln(h,p){switch(h){case"focusin":case"focusout":Ao=null;break;case"dragenter":case"dragleave":Ra=null;break;case"mouseover":case"mouseout":ko=null;break;case"pointerover":case"pointerout":wi.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":ii.delete(p.pointerId)}}function Fs(h,p,S,M,F,$){return h===null||h.nativeEvent!==$?(h={blockedOn:p,domEventName:S,eventSystemFlags:M,nativeEvent:$,targetContainers:[F]},p!==null&&(p=po(p),p!==null&&ka(p)),h):(h.eventSystemFlags|=M,p=h.targetContainers,F!==null&&p.indexOf(F)===-1&&p.push(F),h)}function rs(h,p,S,M,F){switch(p){case"focusin":return Ao=Fs(Ao,h,p,S,M,F),!0;case"dragenter":return Ra=Fs(Ra,h,p,S,M,F),!0;case"mouseover":return ko=Fs(ko,h,p,S,M,F),!0;case"pointerover":var $=F.pointerId;return wi.set($,Fs(wi.get($)||null,h,p,S,M,F)),!0;case"gotpointercapture":return $=F.pointerId,ii.set($,Fs(ii.get($)||null,h,p,S,M,F)),!0}return!1}function fs(h){var p=fo(h.target);if(p!==null){var S=_r(p);if(S!==null){if(p=S.tag,p===13){if(p=Pr(S),p!==null){h.blockedOn=p,ta(h.priority,function(){yh(S)});return}}else if(p===3&&S.stateNode.current.memoizedState.isDehydrated){h.blockedOn=S.tag===3?S.stateNode.containerInfo:null;return}}}h.blockedOn=null}function Ti(h){if(h.blockedOn!==null)return!1;for(var p=h.targetContainers;0<p.length;){var S=fu(h.domEventName,h.eventSystemFlags,p[0],h.nativeEvent);if(S===null){S=h.nativeEvent;var M=new S.constructor(S.type,S);Ot=M,S.target.dispatchEvent(M),Ot=null}else return p=po(S),p!==null&&ka(p),h.blockedOn=S,!1;p.shift()}return!0}function dl(h,p,S){Ti(h)&&S.delete(p)}function La(){Da=!1,Ao!==null&&Ti(Ao)&&(Ao=null),Ra!==null&&Ti(Ra)&&(Ra=null),ko!==null&&Ti(ko)&&(ko=null),wi.forEach(dl),ii.forEach(dl)}function bn(h,p){h.blockedOn===p&&(h.blockedOn=null,Da||(Da=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,La)))}function oo(h){function p(F){return bn(F,h)}if(0<xr.length){bn(xr[0],h);for(var S=1;S<xr.length;S++){var M=xr[S];M.blockedOn===h&&(M.blockedOn=null)}}for(Ao!==null&&bn(Ao,h),Ra!==null&&bn(Ra,h),ko!==null&&bn(ko,h),wi.forEach(p),ii.forEach(p),S=0;S<Yr.length;S++)M=Yr[S],M.blockedOn===h&&(M.blockedOn=null);for(;0<Yr.length&&(S=Yr[0],S.blockedOn===null);)fs(S),S.blockedOn===null&&Yr.shift()}var ns=Ie.ReactCurrentBatchConfig,fl=!0;function ps(h,p,S,M){var F=Zr,$=ns.transition;ns.transition=null;try{Zr=1,ao(h,p,S,M)}finally{Zr=F,ns.transition=$}}function pl(h,p,S,M){var F=Zr,$=ns.transition;ns.transition=null;try{Zr=4,ao(h,p,S,M)}finally{Zr=F,ns.transition=$}}function ao(h,p,S,M){if(fl){var F=fu(h,p,S,M);if(F===null)El(h,p,M,du,S),ln(h,M);else if(rs(F,h,p,S,M))M.stopPropagation();else if(ln(h,M),p&4&&-1<ur.indexOf(h)){for(;F!==null;){var $=po(F);if($!==null&&Bd($),$=fu(h,p,S,M),$===null&&El(h,p,M,du,S),$===F)break;F=$}F!==null&&M.stopPropagation()}else El(h,p,M,null,S)}}var du=null;function fu(h,p,S,M){if(du=null,h=$t(M),h=fo(h),h!==null)if(p=_r(h),p===null)h=null;else if(S=p.tag,S===13){if(h=Pr(p),h!==null)return h;h=null}else if(S===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;h=null}else p!==h&&(h=null);return du=h,null}function za(h){switch(h){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pc()){case ll:return 1;case Bi:return 4;case qr:case ph:return 16;case cl:return 536870912;default:return 16}default:return 16}}var Br=null,Fa=null,Mr=null;function br(){if(Mr)return Mr;var h,p=Fa,S=p.length,M,F="value"in Br?Br.value:Br.textContent,$=F.length;for(h=0;h<S&&p[h]===F[h];h++);var ie=S-h;for(M=1;M<=ie&&p[S-M]===F[$-M];M++);return Mr=F.slice(h,1<M?1-M:void 0)}function ra(h){var p=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&p===13&&(h=13)):h=p,h===10&&(h=13),32<=h||h===13?h:0}function Ir(){return!0}function yc(){return!1}function Nn(h){function p(S,M,F,$,ie){this._reactName=S,this._targetInst=F,this.type=M,this.nativeEvent=$,this.target=ie,this.currentTarget=null;for(var Pe in h)h.hasOwnProperty(Pe)&&(S=h[Pe],this[Pe]=S?S($):$[Pe]);return this.isDefaultPrevented=($.defaultPrevented!=null?$.defaultPrevented:$.returnValue===!1)?Ir:yc,this.isPropagationStopped=yc,this}return _t(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var S=this.nativeEvent;S&&(S.preventDefault?S.preventDefault():typeof S.returnValue!="unknown"&&(S.returnValue=!1),this.isDefaultPrevented=Ir)},stopPropagation:function(){var S=this.nativeEvent;S&&(S.stopPropagation?S.stopPropagation():typeof S.cancelBubble!="unknown"&&(S.cancelBubble=!0),this.isPropagationStopped=Ir)},persist:function(){},isPersistent:Ir}),p}var lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Do=Nn(lo),_c=_t({},lo,{view:0,detail:0}),pu=Nn(_c),mu,Vd,vc,Si=_t({},_c,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Oa,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==vc&&(vc&&h.type==="mousemove"?(mu=h.screenX-vc.screenX,Vd=h.screenY-vc.screenY):Vd=mu=0,vc=h),mu)},movementY:function(h){return"movementY"in h?h.movementY:Vd}}),co=Nn(Si),In=_t({},Si,{dataTransfer:0}),ml=Nn(In),Ud=_t({},_c,{relatedTarget:0}),gl=Nn(Ud),Un=_t({},lo,{animationName:0,elapsedTime:0,pseudoElement:0}),np=Nn(Un),$d=_t({},lo,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),ip=Nn($d),Dm=_t({},lo,{data:0}),yl=Nn(Dm),_h={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gu(h){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(h):(h=Gd[h])?!!p[h]:!1}function Oa(){return gu}var bc=_t({},_c,{key:function(h){if(h.key){var p=_h[h.key]||h.key;if(p!=="Unidentified")return p}return h.type==="keypress"?(h=ra(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?xc[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Oa,charCode:function(h){return h.type==="keypress"?ra(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?ra(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),si=Nn(bc),sp=_t({},Si,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_l=Nn(sp),yu=_t({},_c,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Oa}),vl=Nn(yu),Rm=_t({},lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),vh=Nn(Rm),Lm=_t({},Si,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),wc=Nn(Lm),xh=[9,13,27,32],bh=l&&"CompositionEvent"in window,Tc=null;l&&"documentMode"in document&&(Tc=document.documentMode);var qd=l&&"TextEvent"in window&&!Tc,wh=l&&(!bh||Tc&&8<Tc&&11>=Tc),Th=" ",Zd=!1;function Wd(h,p){switch(h){case"keyup":return xh.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hd(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var Os=!1;function op(h,p){switch(h){case"compositionend":return Hd(p);case"keypress":return p.which!==32?null:(Zd=!0,Th);case"textInput":return h=p.data,h===Th&&Zd?null:h;default:return null}}function Xd(h,p){if(Os)return h==="compositionend"||!bh&&Wd(h,p)?(h=br(),Mr=Fa=Br=null,Os=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return wh&&p.locale!=="ko"?null:p.data;default:return null}}var Sc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kd(h){var p=h&&h.nodeName&&h.nodeName.toLowerCase();return p==="input"?!!Sc[h.type]:p==="textarea"}function _u(h,p,S,M){an(M),p=Ic(p,"onChange"),0<p.length&&(S=new Do("onChange","change",null,S,M),h.push({event:S,listeners:p}))}var vu=null,xu=null;function ap(h){fp(h,0)}function Na(h){var p=mo(h);if(jr(p))return h}function lp(h,p){if(h==="change")return p}var Sh=!1;if(l){var Ph;if(l){var Pc="oninput"in document;if(!Pc){var Ns=document.createElement("div");Ns.setAttribute("oninput","return;"),Pc=typeof Ns.oninput=="function"}Ph=Pc}else Ph=!1;Sh=Ph&&(!document.documentMode||9<document.documentMode)}function bu(){vu&&(vu.detachEvent("onpropertychange",Ch),xu=vu=null)}function Ch(h){if(h.propertyName==="value"&&Na(xu)){var p=[];_u(p,xu,h,$t(h)),mn(ap,p)}}function Yd(h,p,S){h==="focusin"?(bu(),vu=p,xu=S,vu.attachEvent("onpropertychange",Ch)):h==="focusout"&&bu()}function Qd(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return Na(xu)}function Eh(h,p){if(h==="click")return Na(p)}function xl(h,p){if(h==="input"||h==="change")return Na(p)}function Jd(h,p){return h===p&&(h!==0||1/h===1/p)||h!==h&&p!==p}var uo=typeof Object.is=="function"?Object.is:Jd;function Cc(h,p){if(uo(h,p))return!0;if(typeof h!="object"||h===null||typeof p!="object"||p===null)return!1;var S=Object.keys(h),M=Object.keys(p);if(S.length!==M.length)return!1;for(M=0;M<S.length;M++){var F=S[M];if(!A.call(p,F)||!uo(h[F],p[F]))return!1}return!0}function cp(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function up(h,p){var S=cp(h);h=0;for(var M;S;){if(S.nodeType===3){if(M=h+S.textContent.length,h<=p&&M>=p)return{node:S,offset:p-h};h=M}e:{for(;S;){if(S.nextSibling){S=S.nextSibling;break e}S=S.parentNode}S=void 0}S=cp(S)}}function ef(h,p){return h&&p?h===p?!0:h&&h.nodeType===3?!1:p&&p.nodeType===3?ef(h,p.parentNode):"contains"in h?h.contains(p):h.compareDocumentPosition?!!(h.compareDocumentPosition(p)&16):!1:!1}function hp(){for(var h=window,p=Fn();p instanceof h.HTMLIFrameElement;){try{var S=typeof p.contentWindow.location.href=="string"}catch{S=!1}if(S)h=p.contentWindow;else break;p=Fn(h.document)}return p}function Vr(h){var p=h&&h.nodeName&&h.nodeName.toLowerCase();return p&&(p==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||p==="textarea"||h.contentEditable==="true")}function Mh(h){var p=hp(),S=h.focusedElem,M=h.selectionRange;if(p!==S&&S&&S.ownerDocument&&ef(S.ownerDocument.documentElement,S)){if(M!==null&&Vr(S)){if(p=M.start,h=M.end,h===void 0&&(h=p),"selectionStart"in S)S.selectionStart=p,S.selectionEnd=Math.min(h,S.value.length);else if(h=(p=S.ownerDocument||document)&&p.defaultView||window,h.getSelection){h=h.getSelection();var F=S.textContent.length,$=Math.min(M.start,F);M=M.end===void 0?$:Math.min(M.end,F),!h.extend&&$>M&&(F=M,M=$,$=F),F=up(S,$);var ie=up(S,M);F&&ie&&(h.rangeCount!==1||h.anchorNode!==F.node||h.anchorOffset!==F.offset||h.focusNode!==ie.node||h.focusOffset!==ie.offset)&&(p=p.createRange(),p.setStart(F.node,F.offset),h.removeAllRanges(),$>M?(h.addRange(p),h.extend(ie.node,ie.offset)):(p.setEnd(ie.node,ie.offset),h.addRange(p)))}}for(p=[],h=S;h=h.parentNode;)h.nodeType===1&&p.push({element:h,left:h.scrollLeft,top:h.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<p.length;S++)h=p[S],h.element.scrollLeft=h.left,h.element.scrollTop=h.top}}var Ih=l&&"documentMode"in document&&11>=document.documentMode,na=null,wu=null,ho=null,bl=!1;function wl(h,p,S){var M=S.window===S?S.document:S.nodeType===9?S:S.ownerDocument;bl||na==null||na!==Fn(M)||(M=na,"selectionStart"in M&&Vr(M)?M={start:M.selectionStart,end:M.selectionEnd}:(M=(M.ownerDocument&&M.ownerDocument.defaultView||window).getSelection(),M={anchorNode:M.anchorNode,anchorOffset:M.anchorOffset,focusNode:M.focusNode,focusOffset:M.focusOffset}),ho&&Cc(ho,M)||(ho=M,M=Ic(wu,"onSelect"),0<M.length&&(p=new Do("onSelect","select",null,p,S),h.push({event:p,listeners:M}),p.target=na)))}function is(h,p){var S={};return S[h.toLowerCase()]=p.toLowerCase(),S["Webkit"+h]="webkit"+p,S["Moz"+h]="moz"+p,S}var Tl={animationend:is("Animation","AnimationEnd"),animationiteration:is("Animation","AnimationIteration"),animationstart:is("Animation","AnimationStart"),transitionend:is("Transition","TransitionEnd")},Ah={},kh={};l&&(kh=document.createElement("div").style,"AnimationEvent"in window||(delete Tl.animationend.animation,delete Tl.animationiteration.animation,delete Tl.animationstart.animation),"TransitionEvent"in window||delete Tl.transitionend.transition);function Ro(h){if(Ah[h])return Ah[h];if(!Tl[h])return h;var p=Tl[h],S;for(S in p)if(p.hasOwnProperty(S)&&S in kh)return Ah[h]=p[S];return h}var Tu=Ro("animationend"),Su=Ro("animationiteration"),Ec=Ro("animationstart"),Pu=Ro("transitionend"),tf=new Map,Sl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Is(h,p){tf.set(h,p),x(p,[h])}for(var Dh=0;Dh<Sl.length;Dh++){var Cu=Sl[Dh],Er=Cu.toLowerCase(),Rh=Cu[0].toUpperCase()+Cu.slice(1);Is(Er,"on"+Rh)}Is(Tu,"onAnimationEnd"),Is(Su,"onAnimationIteration"),Is(Ec,"onAnimationStart"),Is("dblclick","onDoubleClick"),Is("focusin","onFocus"),Is("focusout","onBlur"),Is(Pu,"onTransitionEnd"),v("onMouseEnter",["mouseout","mouseover"]),v("onMouseLeave",["mouseout","mouseover"]),v("onPointerEnter",["pointerout","pointerover"]),v("onPointerLeave",["pointerout","pointerover"]),x("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),x("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),x("onBeforeInput",["compositionend","keypress","textInput","paste"]),x("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),x("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),x("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Eu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dp=new Set("cancel close invalid load scroll toggle".split(" ").concat(Eu));function Mc(h,p,S){var M=h.type||"unknown-event";h.currentTarget=S,Lt(M,p,void 0,h),h.currentTarget=null}function fp(h,p){p=(p&4)!==0;for(var S=0;S<h.length;S++){var M=h[S],F=M.event;M=M.listeners;e:{var $=void 0;if(p)for(var ie=M.length-1;0<=ie;ie--){var Pe=M[ie],Le=Pe.instance,et=Pe.currentTarget;if(Pe=Pe.listener,Le!==$&&F.isPropagationStopped())break e;Mc(F,Pe,et),$=Le}else for(ie=0;ie<M.length;ie++){if(Pe=M[ie],Le=Pe.instance,et=Pe.currentTarget,Pe=Pe.listener,Le!==$&&F.isPropagationStopped())break e;Mc(F,Pe,et),$=Le}}}if(bi)throw h=Ri,bi=!1,Ri=null,h}function An(h,p){var S=p[Al];S===void 0&&(S=p[Al]=new Set);var M=h+"__bubble";S.has(M)||(Cl(p,h,2,!1),S.add(M))}function Lh(h,p,S){var M=0;p&&(M|=4),Cl(S,h,M,p)}var zh="_reactListening"+Math.random().toString(36).slice(2);function Pl(h){if(!h[zh]){h[zh]=!0,u.forEach(function(S){S!=="selectionchange"&&(dp.has(S)||Lh(S,!1,h),Lh(S,!0,h))});var p=h.nodeType===9?h:h.ownerDocument;p===null||p[zh]||(p[zh]=!0,Lh("selectionchange",!1,p))}}function Cl(h,p,S,M){switch(za(p)){case 1:var F=ps;break;case 4:F=pl;break;default:F=ao}S=F.bind(null,p,S,h),F=void 0,!tn||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(F=!0),M?F!==void 0?h.addEventListener(p,S,{capture:!0,passive:F}):h.addEventListener(p,S,!0):F!==void 0?h.addEventListener(p,S,{passive:F}):h.addEventListener(p,S,!1)}function El(h,p,S,M,F){var $=M;if((p&1)===0&&(p&2)===0&&M!==null)e:for(;;){if(M===null)return;var ie=M.tag;if(ie===3||ie===4){var Pe=M.stateNode.containerInfo;if(Pe===F||Pe.nodeType===8&&Pe.parentNode===F)break;if(ie===4)for(ie=M.return;ie!==null;){var Le=ie.tag;if((Le===3||Le===4)&&(Le=ie.stateNode.containerInfo,Le===F||Le.nodeType===8&&Le.parentNode===F))return;ie=ie.return}for(;Pe!==null;){if(ie=fo(Pe),ie===null)return;if(Le=ie.tag,Le===5||Le===6){M=$=ie;continue e}Pe=Pe.parentNode}}M=M.return}mn(function(){var et=$,Tt=$t(S),It=[];e:{var wt=tf.get(h);if(wt!==void 0){var Xt=Do,tr=h;switch(h){case"keypress":if(ra(S)===0)break e;case"keydown":case"keyup":Xt=si;break;case"focusin":tr="focus",Xt=gl;break;case"focusout":tr="blur",Xt=gl;break;case"beforeblur":case"afterblur":Xt=gl;break;case"click":if(S.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Xt=co;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Xt=ml;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Xt=vl;break;case Tu:case Su:case Ec:Xt=np;break;case Pu:Xt=vh;break;case"scroll":Xt=pu;break;case"wheel":Xt=wc;break;case"copy":case"cut":case"paste":Xt=ip;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Xt=_l}var rr=(p&4)!==0,Qn=!rr&&h==="scroll",We=rr?wt!==null?wt+"Capture":null:wt;rr=[];for(var Fe=et,Qe;Fe!==null;){Qe=Fe;var Rt=Qe.stateNode;if(Qe.tag===5&&Rt!==null&&(Qe=Rt,We!==null&&(Rt=gn(Fe,We),Rt!=null&&rr.push(ja(Fe,Rt,Qe)))),Qn)break;Fe=Fe.return}0<rr.length&&(wt=new Xt(wt,tr,null,S,Tt),It.push({event:wt,listeners:rr}))}}if((p&7)===0){e:{if(wt=h==="mouseover"||h==="pointerover",Xt=h==="mouseout"||h==="pointerout",wt&&S!==Ot&&(tr=S.relatedTarget||S.fromElement)&&(fo(tr)||tr[js]))break e;if((Xt||wt)&&(wt=Tt.window===Tt?Tt:(wt=Tt.ownerDocument)?wt.defaultView||wt.parentWindow:window,Xt?(tr=S.relatedTarget||S.toElement,Xt=et,tr=tr?fo(tr):null,tr!==null&&(Qn=_r(tr),tr!==Qn||tr.tag!==5&&tr.tag!==6)&&(tr=null)):(Xt=null,tr=et),Xt!==tr)){if(rr=co,Rt="onMouseLeave",We="onMouseEnter",Fe="mouse",(h==="pointerout"||h==="pointerover")&&(rr=_l,Rt="onPointerLeave",We="onPointerEnter",Fe="pointer"),Qn=Xt==null?wt:mo(Xt),Qe=tr==null?wt:mo(tr),wt=new rr(Rt,Fe+"leave",Xt,S,Tt),wt.target=Qn,wt.relatedTarget=Qe,Rt=null,fo(Tt)===et&&(rr=new rr(We,Fe+"enter",tr,S,Tt),rr.target=Qe,rr.relatedTarget=Qn,Rt=rr),Qn=Rt,Xt&&tr)t:{for(rr=Xt,We=tr,Fe=0,Qe=rr;Qe;Qe=Ba(Qe))Fe++;for(Qe=0,Rt=We;Rt;Rt=Ba(Rt))Qe++;for(;0<Fe-Qe;)rr=Ba(rr),Fe--;for(;0<Qe-Fe;)We=Ba(We),Qe--;for(;Fe--;){if(rr===We||We!==null&&rr===We.alternate)break t;rr=Ba(rr),We=Ba(We)}rr=null}else rr=null;Xt!==null&&Mu(It,wt,Xt,rr,!1),tr!==null&&Qn!==null&&Mu(It,Qn,tr,rr,!0)}}e:{if(wt=et?mo(et):window,Xt=wt.nodeName&&wt.nodeName.toLowerCase(),Xt==="select"||Xt==="input"&&wt.type==="file")var or=lp;else if(Kd(wt))if(Sh)or=xl;else{or=Qd;var dr=Yd}else(Xt=wt.nodeName)&&Xt.toLowerCase()==="input"&&(wt.type==="checkbox"||wt.type==="radio")&&(or=Eh);if(or&&(or=or(h,et))){_u(It,or,S,Tt);break e}dr&&dr(h,wt,et),h==="focusout"&&(dr=wt._wrapperState)&&dr.controlled&&wt.type==="number"&&Mo(wt,"number",wt.value)}switch(dr=et?mo(et):window,h){case"focusin":(Kd(dr)||dr.contentEditable==="true")&&(na=dr,wu=et,ho=null);break;case"focusout":ho=wu=na=null;break;case"mousedown":bl=!0;break;case"contextmenu":case"mouseup":case"dragend":bl=!1,wl(It,S,Tt);break;case"selectionchange":if(Ih)break;case"keydown":case"keyup":wl(It,S,Tt)}var mr;if(bh)e:{switch(h){case"compositionstart":var Tr="onCompositionStart";break e;case"compositionend":Tr="onCompositionEnd";break e;case"compositionupdate":Tr="onCompositionUpdate";break e}Tr=void 0}else Os?Wd(h,S)&&(Tr="onCompositionEnd"):h==="keydown"&&S.keyCode===229&&(Tr="onCompositionStart");Tr&&(wh&&S.locale!=="ko"&&(Os||Tr!=="onCompositionStart"?Tr==="onCompositionEnd"&&Os&&(mr=br()):(Br=Tt,Fa="value"in Br?Br.value:Br.textContent,Os=!0)),dr=Ic(et,Tr),0<dr.length&&(Tr=new yl(Tr,h,null,S,Tt),It.push({event:Tr,listeners:dr}),mr?Tr.data=mr:(mr=Hd(S),mr!==null&&(Tr.data=mr)))),(mr=qd?op(h,S):Xd(h,S))&&(et=Ic(et,"onBeforeInput"),0<et.length&&(Tt=new yl("onBeforeInput","beforeinput",null,S,Tt),It.push({event:Tt,listeners:et}),Tt.data=mr))}fp(It,p)})}function ja(h,p,S){return{instance:h,listener:p,currentTarget:S}}function Ic(h,p){for(var S=p+"Capture",M=[];h!==null;){var F=h,$=F.stateNode;F.tag===5&&$!==null&&(F=$,$=gn(h,S),$!=null&&M.unshift(ja(h,$,F)),$=gn(h,p),$!=null&&M.push(ja(h,$,F))),h=h.return}return M}function Ba(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5);return h||null}function Mu(h,p,S,M,F){for(var $=p._reactName,ie=[];S!==null&&S!==M;){var Pe=S,Le=Pe.alternate,et=Pe.stateNode;if(Le!==null&&Le===M)break;Pe.tag===5&&et!==null&&(Pe=et,F?(Le=gn(S,$),Le!=null&&ie.unshift(ja(S,Le,Pe))):F||(Le=gn(S,$),Le!=null&&ie.push(ja(S,Le,Pe)))),S=S.return}ie.length!==0&&h.push({event:p,listeners:ie})}var Fh=/\r\n?/g,Va=/\u0000|\uFFFD/g;function Ua(h){return(typeof h=="string"?h:""+h).replace(Fh,`
`).replace(Va,"")}function Ac(h,p,S){if(p=Ua(p),Ua(h)!==p&&S)throw Error(s(425))}function Oh(){}var Ml=null,rf=null;function Nh(h,p){return h==="textarea"||h==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var Il=typeof setTimeout=="function"?setTimeout:void 0,jh=typeof clearTimeout=="function"?clearTimeout:void 0,nf=typeof Promise=="function"?Promise:void 0,pp=typeof queueMicrotask=="function"?queueMicrotask:typeof nf<"u"?function(h){return nf.resolve(null).then(h).catch(Iu)}:Il;function Iu(h){setTimeout(function(){throw h})}function kc(h,p){var S=p,M=0;do{var F=S.nextSibling;if(h.removeChild(S),F&&F.nodeType===8)if(S=F.data,S==="/$"){if(M===0){h.removeChild(F),oo(p);return}M--}else S!=="$"&&S!=="$?"&&S!=="$!"||M++;S=F}while(S);oo(p)}function ia(h){for(;h!=null;h=h.nextSibling){var p=h.nodeType;if(p===1||p===3)break;if(p===8){if(p=h.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return h}function sf(h){h=h.previousSibling;for(var p=0;h;){if(h.nodeType===8){var S=h.data;if(S==="$"||S==="$!"||S==="$?"){if(p===0)return h;p--}else S==="/$"&&p++}h=h.previousSibling}return null}var yn=Math.random().toString(36).slice(2),Ui="__reactFiber$"+yn,Li="__reactProps$"+yn,js="__reactContainer$"+yn,Al="__reactEvents$"+yn,Bh="__reactListeners$"+yn,$a="__reactHandles$"+yn;function fo(h){var p=h[Ui];if(p)return p;for(var S=h.parentNode;S;){if(p=S[js]||S[Ui]){if(S=p.alternate,p.child!==null||S!==null&&S.child!==null)for(h=sf(h);h!==null;){if(S=h[Ui])return S;h=sf(h)}return p}h=S,S=h.parentNode}return null}function po(h){return h=h[Ui]||h[js],!h||h.tag!==5&&h.tag!==6&&h.tag!==13&&h.tag!==3?null:h}function mo(h){if(h.tag===5||h.tag===6)return h.stateNode;throw Error(s(33))}function Au(h){return h[Li]||null}var Vh=[],kl=-1;function sa(h){return{current:h}}function wn(h){0>kl||(h.current=Vh[kl],Vh[kl]=null,kl--)}function Wr(h,p){kl++,Vh[kl]=h.current,h.current=p}var Lo={},Pi=sa(Lo),Ci=sa(!1),Ga=Lo;function qa(h,p){var S=h.type.contextTypes;if(!S)return Lo;var M=h.stateNode;if(M&&M.__reactInternalMemoizedUnmaskedChildContext===p)return M.__reactInternalMemoizedMaskedChildContext;var F={},$;for($ in S)F[$]=p[$];return M&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=p,h.__reactInternalMemoizedMaskedChildContext=F),F}function $i(h){return h=h.childContextTypes,h!=null}function ku(){wn(Ci),wn(Pi)}function Uh(h,p,S){if(Pi.current!==Lo)throw Error(s(168));Wr(Pi,p),Wr(Ci,S)}function $h(h,p,S){var M=h.stateNode;if(p=p.childContextTypes,typeof M.getChildContext!="function")return S;M=M.getChildContext();for(var F in M)if(!(F in p))throw Error(s(108,St(h)||"Unknown",F));return _t({},S,M)}function go(h){return h=(h=h.stateNode)&&h.__reactInternalMemoizedMergedChildContext||Lo,Ga=Pi.current,Wr(Pi,h),Wr(Ci,Ci.current),!0}function of(h,p,S){var M=h.stateNode;if(!M)throw Error(s(169));S?(h=$h(h,p,Ga),M.__reactInternalMemoizedMergedChildContext=h,wn(Ci),wn(Pi),Wr(Pi,h)):wn(Ci),Wr(Ci,S)}var oi=null,ms=!1,Gh=!1;function Bs(h){oi===null?oi=[h]:oi.push(h)}function zm(h){ms=!0,Bs(h)}function Vs(){if(!Gh&&oi!==null){Gh=!0;var h=0,p=Zr;try{var S=oi;for(Zr=1;h<S.length;h++){var M=S[h];do M=M(!0);while(M!==null)}oi=null,ms=!1}catch(F){throw oi!==null&&(oi=oi.slice(h+1)),hc(ll,Vs),F}finally{Zr=p,Gh=!1}}return null}var zo=[],$n=0,Za=null,Du=0,Us=[],$s=0,Gs=null,gs=1,di="";function zt(h,p){zo[$n++]=Du,zo[$n++]=Za,Za=h,Du=p}function Ru(h,p,S){Us[$s++]=gs,Us[$s++]=di,Us[$s++]=Gs,Gs=h;var M=gs;h=di;var F=32-zs(M)-1;M&=~(1<<F),S+=1;var $=32-zs(p)+F;if(30<$){var ie=F-F%5;$=(M&(1<<ie)-1).toString(32),M>>=ie,F-=ie,gs=1<<32-zs(p)+F|S<<F|M,di=$+h}else gs=1<<$|S<<F|M,di=h}function Lu(h){h.return!==null&&(zt(h,1),Ru(h,1,0))}function Wa(h){for(;h===Za;)Za=zo[--$n],zo[$n]=null,Du=zo[--$n],zo[$n]=null;for(;h===Gs;)Gs=Us[--$s],Us[$s]=null,di=Us[--$s],Us[$s]=null,gs=Us[--$s],Us[$s]=null}var zi=null,Fi=null,Tn=!1,ss=null;function qh(h,p){var S=Wo(5,null,null,0);S.elementType="DELETED",S.stateNode=p,S.return=h,p=h.deletions,p===null?(h.deletions=[S],h.flags|=16):p.push(S)}function af(h,p){switch(h.tag){case 5:var S=h.type;return p=p.nodeType!==1||S.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(h.stateNode=p,zi=h,Fi=ia(p.firstChild),!0):!1;case 6:return p=h.pendingProps===""||p.nodeType!==3?null:p,p!==null?(h.stateNode=p,zi=h,Fi=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(S=Gs!==null?{id:gs,overflow:di}:null,h.memoizedState={dehydrated:p,treeContext:S,retryLane:1073741824},S=Wo(18,null,null,0),S.stateNode=p,S.return=h,h.child=S,zi=h,Fi=null,!0):!1;default:return!1}}function Ha(h){return(h.mode&1)!==0&&(h.flags&128)===0}function lf(h){if(Tn){var p=Fi;if(p){var S=p;if(!af(h,p)){if(Ha(h))throw Error(s(418));p=ia(S.nextSibling);var M=zi;p&&af(h,p)?qh(M,S):(h.flags=h.flags&-4097|2,Tn=!1,zi=h)}}else{if(Ha(h))throw Error(s(418));h.flags=h.flags&-4097|2,Tn=!1,zi=h}}}function zu(h){for(h=h.return;h!==null&&h.tag!==5&&h.tag!==3&&h.tag!==13;)h=h.return;zi=h}function Dl(h){if(h!==zi)return!1;if(!Tn)return zu(h),Tn=!0,!1;var p;if((p=h.tag!==3)&&!(p=h.tag!==5)&&(p=h.type,p=p!=="head"&&p!=="body"&&!Nh(h.type,h.memoizedProps)),p&&(p=Fi)){if(Ha(h))throw cf(),Error(s(418));for(;p;)qh(h,p),p=ia(p.nextSibling)}if(zu(h),h.tag===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));e:{for(h=h.nextSibling,p=0;h;){if(h.nodeType===8){var S=h.data;if(S==="/$"){if(p===0){Fi=ia(h.nextSibling);break e}p--}else S!=="$"&&S!=="$!"&&S!=="$?"||p++}h=h.nextSibling}Fi=null}}else Fi=zi?ia(h.stateNode.nextSibling):null;return!0}function cf(){for(var h=Fi;h;)h=ia(h.nextSibling)}function Xa(){Fi=zi=null,Tn=!1}function Zh(h){ss===null?ss=[h]:ss.push(h)}var uf=Ie.ReactCurrentBatchConfig;function Rl(h,p,S){if(h=S.ref,h!==null&&typeof h!="function"&&typeof h!="object"){if(S._owner){if(S=S._owner,S){if(S.tag!==1)throw Error(s(309));var M=S.stateNode}if(!M)throw Error(s(147,h));var F=M,$=""+h;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===$?p.ref:(p=function(ie){var Pe=F.refs;ie===null?delete Pe[$]:Pe[$]=ie},p._stringRef=$,p)}if(typeof h!="string")throw Error(s(284));if(!S._owner)throw Error(s(290,h))}return h}function Fu(h,p){throw h=Object.prototype.toString.call(p),Error(s(31,h==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":h))}function oa(h){var p=h._init;return p(h._payload)}function rn(h){function p(We,Fe){if(h){var Qe=We.deletions;Qe===null?(We.deletions=[Fe],We.flags|=16):Qe.push(Fe)}}function S(We,Fe){if(!h)return null;for(;Fe!==null;)p(We,Fe),Fe=Fe.sibling;return null}function M(We,Fe){for(We=new Map;Fe!==null;)Fe.key!==null?We.set(Fe.key,Fe):We.set(Fe.index,Fe),Fe=Fe.sibling;return We}function F(We,Fe){return We=Wl(We,Fe),We.index=0,We.sibling=null,We}function $(We,Fe,Qe){return We.index=Qe,h?(Qe=We.alternate,Qe!==null?(Qe=Qe.index,Qe<Fe?(We.flags|=2,Fe):Qe):(We.flags|=2,Fe)):(We.flags|=1048576,Fe)}function ie(We){return h&&We.alternate===null&&(We.flags|=2),We}function Pe(We,Fe,Qe,Rt){return Fe===null||Fe.tag!==6?(Fe=Cp(Qe,We.mode,Rt),Fe.return=We,Fe):(Fe=F(Fe,Qe),Fe.return=We,Fe)}function Le(We,Fe,Qe,Rt){var or=Qe.type;return or===He?Tt(We,Fe,Qe.props.children,Rt,Qe.key):Fe!==null&&(Fe.elementType===or||typeof or=="object"&&or!==null&&or.$$typeof===dt&&oa(or)===Fe.type)?(Rt=F(Fe,Qe.props),Rt.ref=Rl(We,Fe,Qe),Rt.return=We,Rt):(Rt=ud(Qe.type,Qe.key,Qe.props,null,We.mode,Rt),Rt.ref=Rl(We,Fe,Qe),Rt.return=We,Rt)}function et(We,Fe,Qe,Rt){return Fe===null||Fe.tag!==4||Fe.stateNode.containerInfo!==Qe.containerInfo||Fe.stateNode.implementation!==Qe.implementation?(Fe=Qm(Qe,We.mode,Rt),Fe.return=We,Fe):(Fe=F(Fe,Qe.children||[]),Fe.return=We,Fe)}function Tt(We,Fe,Qe,Rt,or){return Fe===null||Fe.tag!==7?(Fe=Zc(Qe,We.mode,Rt,or),Fe.return=We,Fe):(Fe=F(Fe,Qe),Fe.return=We,Fe)}function It(We,Fe,Qe){if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number")return Fe=Cp(""+Fe,We.mode,Qe),Fe.return=We,Fe;if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case ke:return Qe=ud(Fe.type,Fe.key,Fe.props,null,We.mode,Qe),Qe.ref=Rl(We,null,Fe),Qe.return=We,Qe;case Je:return Fe=Qm(Fe,We.mode,Qe),Fe.return=We,Fe;case dt:var Rt=Fe._init;return It(We,Rt(Fe._payload),Qe)}if(Ms(Fe)||Be(Fe))return Fe=Zc(Fe,We.mode,Qe,null),Fe.return=We,Fe;Fu(We,Fe)}return null}function wt(We,Fe,Qe,Rt){var or=Fe!==null?Fe.key:null;if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number")return or!==null?null:Pe(We,Fe,""+Qe,Rt);if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case ke:return Qe.key===or?Le(We,Fe,Qe,Rt):null;case Je:return Qe.key===or?et(We,Fe,Qe,Rt):null;case dt:return or=Qe._init,wt(We,Fe,or(Qe._payload),Rt)}if(Ms(Qe)||Be(Qe))return or!==null?null:Tt(We,Fe,Qe,Rt,null);Fu(We,Qe)}return null}function Xt(We,Fe,Qe,Rt,or){if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number")return We=We.get(Qe)||null,Pe(Fe,We,""+Rt,or);if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case ke:return We=We.get(Rt.key===null?Qe:Rt.key)||null,Le(Fe,We,Rt,or);case Je:return We=We.get(Rt.key===null?Qe:Rt.key)||null,et(Fe,We,Rt,or);case dt:var dr=Rt._init;return Xt(We,Fe,Qe,dr(Rt._payload),or)}if(Ms(Rt)||Be(Rt))return We=We.get(Qe)||null,Tt(Fe,We,Rt,or,null);Fu(Fe,Rt)}return null}function tr(We,Fe,Qe,Rt){for(var or=null,dr=null,mr=Fe,Tr=Fe=0,Wi=null;mr!==null&&Tr<Qe.length;Tr++){mr.index>Tr?(Wi=mr,mr=null):Wi=mr.sibling;var nn=wt(We,mr,Qe[Tr],Rt);if(nn===null){mr===null&&(mr=Wi);break}h&&mr&&nn.alternate===null&&p(We,mr),Fe=$(nn,Fe,Tr),dr===null?or=nn:dr.sibling=nn,dr=nn,mr=Wi}if(Tr===Qe.length)return S(We,mr),Tn&&zt(We,Tr),or;if(mr===null){for(;Tr<Qe.length;Tr++)mr=It(We,Qe[Tr],Rt),mr!==null&&(Fe=$(mr,Fe,Tr),dr===null?or=mr:dr.sibling=mr,dr=mr);return Tn&&zt(We,Tr),or}for(mr=M(We,mr);Tr<Qe.length;Tr++)Wi=Xt(mr,We,Tr,Qe[Tr],Rt),Wi!==null&&(h&&Wi.alternate!==null&&mr.delete(Wi.key===null?Tr:Wi.key),Fe=$(Wi,Fe,Tr),dr===null?or=Wi:dr.sibling=Wi,dr=Wi);return h&&mr.forEach(function(Wc){return p(We,Wc)}),Tn&&zt(We,Tr),or}function rr(We,Fe,Qe,Rt){var or=Be(Qe);if(typeof or!="function")throw Error(s(150));if(Qe=or.call(Qe),Qe==null)throw Error(s(151));for(var dr=or=null,mr=Fe,Tr=Fe=0,Wi=null,nn=Qe.next();mr!==null&&!nn.done;Tr++,nn=Qe.next()){mr.index>Tr?(Wi=mr,mr=null):Wi=mr.sibling;var Wc=wt(We,mr,nn.value,Rt);if(Wc===null){mr===null&&(mr=Wi);break}h&&mr&&Wc.alternate===null&&p(We,mr),Fe=$(Wc,Fe,Tr),dr===null?or=Wc:dr.sibling=Wc,dr=Wc,mr=Wi}if(nn.done)return S(We,mr),Tn&&zt(We,Tr),or;if(mr===null){for(;!nn.done;Tr++,nn=Qe.next())nn=It(We,nn.value,Rt),nn!==null&&(Fe=$(nn,Fe,Tr),dr===null?or=nn:dr.sibling=nn,dr=nn);return Tn&&zt(We,Tr),or}for(mr=M(We,mr);!nn.done;Tr++,nn=Qe.next())nn=Xt(mr,We,Tr,nn.value,Rt),nn!==null&&(h&&nn.alternate!==null&&mr.delete(nn.key===null?Tr:nn.key),Fe=$(nn,Fe,Tr),dr===null?or=nn:dr.sibling=nn,dr=nn);return h&&mr.forEach(function(Fy){return p(We,Fy)}),Tn&&zt(We,Tr),or}function Qn(We,Fe,Qe,Rt){if(typeof Qe=="object"&&Qe!==null&&Qe.type===He&&Qe.key===null&&(Qe=Qe.props.children),typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case ke:e:{for(var or=Qe.key,dr=Fe;dr!==null;){if(dr.key===or){if(or=Qe.type,or===He){if(dr.tag===7){S(We,dr.sibling),Fe=F(dr,Qe.props.children),Fe.return=We,We=Fe;break e}}else if(dr.elementType===or||typeof or=="object"&&or!==null&&or.$$typeof===dt&&oa(or)===dr.type){S(We,dr.sibling),Fe=F(dr,Qe.props),Fe.ref=Rl(We,dr,Qe),Fe.return=We,We=Fe;break e}S(We,dr);break}else p(We,dr);dr=dr.sibling}Qe.type===He?(Fe=Zc(Qe.props.children,We.mode,Rt,Qe.key),Fe.return=We,We=Fe):(Rt=ud(Qe.type,Qe.key,Qe.props,null,We.mode,Rt),Rt.ref=Rl(We,Fe,Qe),Rt.return=We,We=Rt)}return ie(We);case Je:e:{for(dr=Qe.key;Fe!==null;){if(Fe.key===dr)if(Fe.tag===4&&Fe.stateNode.containerInfo===Qe.containerInfo&&Fe.stateNode.implementation===Qe.implementation){S(We,Fe.sibling),Fe=F(Fe,Qe.children||[]),Fe.return=We,We=Fe;break e}else{S(We,Fe);break}else p(We,Fe);Fe=Fe.sibling}Fe=Qm(Qe,We.mode,Rt),Fe.return=We,We=Fe}return ie(We);case dt:return dr=Qe._init,Qn(We,Fe,dr(Qe._payload),Rt)}if(Ms(Qe))return tr(We,Fe,Qe,Rt);if(Be(Qe))return rr(We,Fe,Qe,Rt);Fu(We,Qe)}return typeof Qe=="string"&&Qe!==""||typeof Qe=="number"?(Qe=""+Qe,Fe!==null&&Fe.tag===6?(S(We,Fe.sibling),Fe=F(Fe,Qe),Fe.return=We,We=Fe):(S(We,Fe),Fe=Cp(Qe,We.mode,Rt),Fe.return=We,We=Fe),ie(We)):S(We,Fe)}return Qn}var Dc=rn(!0),Rc=rn(!1),Ll=sa(null),zl=null,Ka=null,Wh=null;function Hh(){Wh=Ka=zl=null}function Xh(h){var p=Ll.current;wn(Ll),h._currentValue=p}function As(h,p,S){for(;h!==null;){var M=h.alternate;if((h.childLanes&p)!==p?(h.childLanes|=p,M!==null&&(M.childLanes|=p)):M!==null&&(M.childLanes&p)!==p&&(M.childLanes|=p),h===S)break;h=h.return}}function Fo(h,p){zl=h,Wh=Ka=null,h=h.dependencies,h!==null&&h.firstContext!==null&&((h.lanes&p)!==0&&(as=!0),h.firstContext=null)}function jt(h){var p=h._currentValue;if(Wh!==h)if(h={context:h,memoizedValue:p,next:null},Ka===null){if(zl===null)throw Error(s(308));Ka=h,zl.dependencies={lanes:0,firstContext:h}}else Ka=Ka.next=h;return p}var Kt=null;function Fl(h){Kt===null?Kt=[h]:Kt.push(h)}function Ou(h,p,S,M){var F=p.interleaved;return F===null?(S.next=S,Fl(p)):(S.next=F.next,F.next=S),p.interleaved=S,qs(h,M)}function qs(h,p){h.lanes|=p;var S=h.alternate;for(S!==null&&(S.lanes|=p),S=h,h=h.return;h!==null;)h.childLanes|=p,S=h.alternate,S!==null&&(S.childLanes|=p),S=h,h=h.return;return S.tag===3?S.stateNode:null}var Hn=!1;function ys(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kh(h,p){h=h.updateQueue,p.updateQueue===h&&(p.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,effects:h.effects})}function Oo(h,p){return{eventTime:h,lane:p,tag:0,payload:null,callback:null,next:null}}function Ya(h,p,S){var M=h.updateQueue;if(M===null)return null;if(M=M.shared,(Jr&2)!==0){var F=M.pending;return F===null?p.next=p:(p.next=F.next,F.next=p),M.pending=p,qs(h,S)}return F=M.interleaved,F===null?(p.next=p,Fl(M)):(p.next=F.next,F.next=p),M.interleaved=p,qs(h,S)}function Yh(h,p,S){if(p=p.updateQueue,p!==null&&(p=p.shared,(S&4194240)!==0)){var M=p.lanes;M&=h.pendingLanes,S|=M,p.lanes=S,jd(h,S)}}function Lc(h,p){var S=h.updateQueue,M=h.alternate;if(M!==null&&(M=M.updateQueue,S===M)){var F=null,$=null;if(S=S.firstBaseUpdate,S!==null){do{var ie={eventTime:S.eventTime,lane:S.lane,tag:S.tag,payload:S.payload,callback:S.callback,next:null};$===null?F=$=ie:$=$.next=ie,S=S.next}while(S!==null);$===null?F=$=p:$=$.next=p}else F=$=p;S={baseState:M.baseState,firstBaseUpdate:F,lastBaseUpdate:$,shared:M.shared,effects:M.effects},h.updateQueue=S;return}h=S.lastBaseUpdate,h===null?S.firstBaseUpdate=p:h.next=p,S.lastBaseUpdate=p}function _n(h,p,S,M){var F=h.updateQueue;Hn=!1;var $=F.firstBaseUpdate,ie=F.lastBaseUpdate,Pe=F.shared.pending;if(Pe!==null){F.shared.pending=null;var Le=Pe,et=Le.next;Le.next=null,ie===null?$=et:ie.next=et,ie=Le;var Tt=h.alternate;Tt!==null&&(Tt=Tt.updateQueue,Pe=Tt.lastBaseUpdate,Pe!==ie&&(Pe===null?Tt.firstBaseUpdate=et:Pe.next=et,Tt.lastBaseUpdate=Le))}if($!==null){var It=F.baseState;ie=0,Tt=et=Le=null,Pe=$;do{var wt=Pe.lane,Xt=Pe.eventTime;if((M&wt)===wt){Tt!==null&&(Tt=Tt.next={eventTime:Xt,lane:0,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null});e:{var tr=h,rr=Pe;switch(wt=p,Xt=S,rr.tag){case 1:if(tr=rr.payload,typeof tr=="function"){It=tr.call(Xt,It,wt);break e}It=tr;break e;case 3:tr.flags=tr.flags&-65537|128;case 0:if(tr=rr.payload,wt=typeof tr=="function"?tr.call(Xt,It,wt):tr,wt==null)break e;It=_t({},It,wt);break e;case 2:Hn=!0}}Pe.callback!==null&&Pe.lane!==0&&(h.flags|=64,wt=F.effects,wt===null?F.effects=[Pe]:wt.push(Pe))}else Xt={eventTime:Xt,lane:wt,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null},Tt===null?(et=Tt=Xt,Le=It):Tt=Tt.next=Xt,ie|=wt;if(Pe=Pe.next,Pe===null){if(Pe=F.shared.pending,Pe===null)break;wt=Pe,Pe=wt.next,wt.next=null,F.lastBaseUpdate=wt,F.shared.pending=null}}while(!0);if(Tt===null&&(Le=It),F.baseState=Le,F.firstBaseUpdate=et,F.lastBaseUpdate=Tt,p=F.shared.interleaved,p!==null){F=p;do ie|=F.lane,F=F.next;while(F!==p)}else $===null&&(F.shared.lanes=0);Nc|=ie,h.lanes=ie,h.memoizedState=It}}function Gn(h,p,S){if(h=p.effects,p.effects=null,h!==null)for(p=0;p<h.length;p++){var M=h[p],F=M.callback;if(F!==null){if(M.callback=null,M=S,typeof F!="function")throw Error(s(191,F));F.call(M)}}}var yo={},_s=sa(yo),Qa=sa(yo),Ol=sa(yo);function No(h){if(h===yo)throw Error(s(174));return h}function Nu(h,p){switch(Wr(Ol,p),Wr(Qa,h),Wr(_s,yo),h=p.nodeType,h){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:ee(null,"");break;default:h=h===8?p.parentNode:p,p=h.namespaceURI||null,h=h.tagName,p=ee(p,h)}wn(_s),Wr(_s,p)}function jo(){wn(_s),wn(Qa),wn(Ol)}function Bo(h){No(Ol.current);var p=No(_s.current),S=ee(p,h.type);p!==S&&(Wr(Qa,h),Wr(_s,S))}function zc(h){Qa.current===h&&(wn(_s),wn(Qa))}var vn=sa(0);function Nl(h){for(var p=h;p!==null;){if(p.tag===13){var S=p.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||S.data==="$?"||S.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===h)break;for(;p.sibling===null;){if(p.return===null||p.return===h)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var jl=[];function ju(){for(var h=0;h<jl.length;h++)jl[h]._workInProgressVersionPrimary=null;jl.length=0}var aa=Ie.ReactCurrentDispatcher,la=Ie.ReactCurrentBatchConfig,ca=0,xn=null,kn=null,ai=null,Bl=!1,Ja=!1,Vl=0,b=0;function t(){throw Error(s(321))}function a(h,p){if(p===null)return!1;for(var S=0;S<p.length&&S<h.length;S++)if(!uo(h[S],p[S]))return!1;return!0}function d(h,p,S,M,F,$){if(ca=$,xn=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,aa.current=h===null||h.memoizedState===null?Dn:Ei,h=S(M,F),Ja){$=0;do{if(Ja=!1,Vl=0,25<=$)throw Error(s(301));$+=1,ai=kn=null,p.updateQueue=null,aa.current=Kn,h=S(M,F)}while(Ja)}if(aa.current=Cn,p=kn!==null&&kn.next!==null,ca=0,ai=kn=xn=null,Bl=!1,p)throw Error(s(300));return h}function g(){var h=Vl!==0;return Vl=0,h}function w(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ai===null?xn.memoizedState=ai=h:ai=ai.next=h,ai}function P(){if(kn===null){var h=xn.alternate;h=h!==null?h.memoizedState:null}else h=kn.next;var p=ai===null?xn.memoizedState:ai.next;if(p!==null)ai=p,kn=h;else{if(h===null)throw Error(s(310));kn=h,h={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},ai===null?xn.memoizedState=ai=h:ai=ai.next=h}return ai}function E(h,p){return typeof p=="function"?p(h):p}function k(h){var p=P(),S=p.queue;if(S===null)throw Error(s(311));S.lastRenderedReducer=h;var M=kn,F=M.baseQueue,$=S.pending;if($!==null){if(F!==null){var ie=F.next;F.next=$.next,$.next=ie}M.baseQueue=F=$,S.pending=null}if(F!==null){$=F.next,M=M.baseState;var Pe=ie=null,Le=null,et=$;do{var Tt=et.lane;if((ca&Tt)===Tt)Le!==null&&(Le=Le.next={lane:0,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null}),M=et.hasEagerState?et.eagerState:h(M,et.action);else{var It={lane:Tt,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null};Le===null?(Pe=Le=It,ie=M):Le=Le.next=It,xn.lanes|=Tt,Nc|=Tt}et=et.next}while(et!==null&&et!==$);Le===null?ie=M:Le.next=Pe,uo(M,p.memoizedState)||(as=!0),p.memoizedState=M,p.baseState=ie,p.baseQueue=Le,S.lastRenderedState=M}if(h=S.interleaved,h!==null){F=h;do $=F.lane,xn.lanes|=$,Nc|=$,F=F.next;while(F!==h)}else F===null&&(S.lanes=0);return[p.memoizedState,S.dispatch]}function z(h){var p=P(),S=p.queue;if(S===null)throw Error(s(311));S.lastRenderedReducer=h;var M=S.dispatch,F=S.pending,$=p.memoizedState;if(F!==null){S.pending=null;var ie=F=F.next;do $=h($,ie.action),ie=ie.next;while(ie!==F);uo($,p.memoizedState)||(as=!0),p.memoizedState=$,p.baseQueue===null&&(p.baseState=$),S.lastRenderedState=$}return[$,M]}function N(){}function Z(h,p){var S=xn,M=P(),F=p(),$=!uo(M.memoizedState,F);if($&&(M.memoizedState=F,as=!0),M=M.queue,be(ne.bind(null,S,M,h),[h]),M.getSnapshot!==p||$||ai!==null&&ai.memoizedState.tag&1){if(S.flags|=2048,me(9,Y.bind(null,S,M,F,p),void 0,null),Zi===null)throw Error(s(349));(ca&30)!==0||q(S,p,F)}return F}function q(h,p,S){h.flags|=16384,h={getSnapshot:p,value:S},p=xn.updateQueue,p===null?(p={lastEffect:null,stores:null},xn.updateQueue=p,p.stores=[h]):(S=p.stores,S===null?p.stores=[h]:S.push(h))}function Y(h,p,S,M){p.value=S,p.getSnapshot=M,de(p)&&pe(h)}function ne(h,p,S){return S(function(){de(p)&&pe(h)})}function de(h){var p=h.getSnapshot;h=h.value;try{var S=p();return!uo(h,S)}catch{return!0}}function pe(h){var p=qs(h,1);p!==null&&ga(p,h,1,-1)}function fe(h){var p=w();return typeof h=="function"&&(h=h()),p.memoizedState=p.baseState=h,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:E,lastRenderedState:h},p.queue=h,h=h.dispatch=Sn.bind(null,xn,h),[p.memoizedState,h]}function me(h,p,S,M){return h={tag:h,create:p,destroy:S,deps:M,next:null},p=xn.updateQueue,p===null?(p={lastEffect:null,stores:null},xn.updateQueue=p,p.lastEffect=h.next=h):(S=p.lastEffect,S===null?p.lastEffect=h.next=h:(M=S.next,S.next=h,h.next=M,p.lastEffect=h)),h}function Se(){return P().memoizedState}function ge(h,p,S,M){var F=w();xn.flags|=h,F.memoizedState=me(1|p,S,void 0,M===void 0?null:M)}function Te(h,p,S,M){var F=P();M=M===void 0?null:M;var $=void 0;if(kn!==null){var ie=kn.memoizedState;if($=ie.destroy,M!==null&&a(M,ie.deps)){F.memoizedState=me(p,S,$,M);return}}xn.flags|=h,F.memoizedState=me(1|p,S,$,M)}function Me(h,p){return ge(8390656,8,h,p)}function be(h,p){return Te(2048,8,h,p)}function ze(h,p){return Te(4,2,h,p)}function Ke(h,p){return Te(4,4,h,p)}function Ve(h,p){if(typeof p=="function")return h=h(),p(h),function(){p(null)};if(p!=null)return h=h(),p.current=h,function(){p.current=null}}function Ge(h,p,S){return S=S!=null?S.concat([h]):null,Te(4,4,Ve.bind(null,p,h),S)}function qe(){}function vt(h,p){var S=P();p=p===void 0?null:p;var M=S.memoizedState;return M!==null&&p!==null&&a(p,M[1])?M[0]:(S.memoizedState=[h,p],h)}function bt(h,p){var S=P();p=p===void 0?null:p;var M=S.memoizedState;return M!==null&&p!==null&&a(p,M[1])?M[0]:(h=h(),S.memoizedState=[h,p],h)}function ct(h,p,S){return(ca&21)===0?(h.baseState&&(h.baseState=!1,as=!0),h.memoizedState=S):(uo(S,p)||(S=gh(),xn.lanes|=S,Nc|=S,h.baseState=!0),p)}function kt(h,p){var S=Zr;Zr=S!==0&&4>S?S:4,h(!0);var M=la.transition;la.transition={};try{h(!1),p()}finally{Zr=S,la.transition=M}}function pr(){return P().memoizedState}function Qr(h,p,S){var M=Hs(h);if(S={lane:M,action:S,hasEagerState:!1,eagerState:null,next:null},cn(h))Pn(p,S);else if(S=Ou(h,p,S,M),S!==null){var F=ws();ga(S,h,M,F),un(S,p,M)}}function Sn(h,p,S){var M=Hs(h),F={lane:M,action:S,hasEagerState:!1,eagerState:null,next:null};if(cn(h))Pn(p,F);else{var $=h.alternate;if(h.lanes===0&&($===null||$.lanes===0)&&($=p.lastRenderedReducer,$!==null))try{var ie=p.lastRenderedState,Pe=$(ie,S);if(F.hasEagerState=!0,F.eagerState=Pe,uo(Pe,ie)){var Le=p.interleaved;Le===null?(F.next=F,Fl(p)):(F.next=Le.next,Le.next=F),p.interleaved=F;return}}catch{}S=Ou(h,p,F,M),S!==null&&(F=ws(),ga(S,h,M,F),un(S,p,M))}}function cn(h){var p=h.alternate;return h===xn||p!==null&&p===xn}function Pn(h,p){Ja=Bl=!0;var S=h.pending;S===null?p.next=p:(p.next=S.next,S.next=p),h.pending=p}function un(h,p,S){if((S&4194240)!==0){var M=p.lanes;M&=h.pendingLanes,S|=M,p.lanes=S,jd(h,S)}}var Cn={readContext:jt,useCallback:t,useContext:t,useEffect:t,useImperativeHandle:t,useInsertionEffect:t,useLayoutEffect:t,useMemo:t,useReducer:t,useRef:t,useState:t,useDebugValue:t,useDeferredValue:t,useTransition:t,useMutableSource:t,useSyncExternalStore:t,useId:t,unstable_isNewReconciler:!1},Dn={readContext:jt,useCallback:function(h,p){return w().memoizedState=[h,p===void 0?null:p],h},useContext:jt,useEffect:Me,useImperativeHandle:function(h,p,S){return S=S!=null?S.concat([h]):null,ge(4194308,4,Ve.bind(null,p,h),S)},useLayoutEffect:function(h,p){return ge(4194308,4,h,p)},useInsertionEffect:function(h,p){return ge(4,2,h,p)},useMemo:function(h,p){var S=w();return p=p===void 0?null:p,h=h(),S.memoizedState=[h,p],h},useReducer:function(h,p,S){var M=w();return p=S!==void 0?S(p):p,M.memoizedState=M.baseState=p,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:p},M.queue=h,h=h.dispatch=Qr.bind(null,xn,h),[M.memoizedState,h]},useRef:function(h){var p=w();return h={current:h},p.memoizedState=h},useState:fe,useDebugValue:qe,useDeferredValue:function(h){return w().memoizedState=h},useTransition:function(){var h=fe(!1),p=h[0];return h=kt.bind(null,h[1]),w().memoizedState=h,[p,h]},useMutableSource:function(){},useSyncExternalStore:function(h,p,S){var M=xn,F=w();if(Tn){if(S===void 0)throw Error(s(407));S=S()}else{if(S=p(),Zi===null)throw Error(s(349));(ca&30)!==0||q(M,p,S)}F.memoizedState=S;var $={value:S,getSnapshot:p};return F.queue=$,Me(ne.bind(null,M,$,h),[h]),M.flags|=2048,me(9,Y.bind(null,M,$,S,p),void 0,null),S},useId:function(){var h=w(),p=Zi.identifierPrefix;if(Tn){var S=di,M=gs;S=(M&~(1<<32-zs(M)-1)).toString(32)+S,p=":"+p+"R"+S,S=Vl++,0<S&&(p+="H"+S.toString(32)),p+=":"}else S=b++,p=":"+p+"r"+S.toString(32)+":";return h.memoizedState=p},unstable_isNewReconciler:!1},Ei={readContext:jt,useCallback:vt,useContext:jt,useEffect:be,useImperativeHandle:Ge,useInsertionEffect:ze,useLayoutEffect:Ke,useMemo:bt,useReducer:k,useRef:Se,useState:function(){return k(E)},useDebugValue:qe,useDeferredValue:function(h){var p=P();return ct(p,kn.memoizedState,h)},useTransition:function(){var h=k(E)[0],p=P().memoizedState;return[h,p]},useMutableSource:N,useSyncExternalStore:Z,useId:pr,unstable_isNewReconciler:!1},Kn={readContext:jt,useCallback:vt,useContext:jt,useEffect:be,useImperativeHandle:Ge,useInsertionEffect:ze,useLayoutEffect:Ke,useMemo:bt,useReducer:z,useRef:Se,useState:function(){return z(E)},useDebugValue:qe,useDeferredValue:function(h){var p=P();return kn===null?p.memoizedState=h:ct(p,kn.memoizedState,h)},useTransition:function(){var h=z(E)[0],p=P().memoizedState;return[h,p]},useMutableSource:N,useSyncExternalStore:Z,useId:pr,unstable_isNewReconciler:!1};function Hr(h,p){if(h&&h.defaultProps){p=_t({},p),h=h.defaultProps;for(var S in h)p[S]===void 0&&(p[S]=h[S]);return p}return p}function fi(h,p,S,M){p=h.memoizedState,S=S(M,p),S=S==null?p:_t({},p,S),h.memoizedState=S,h.lanes===0&&(h.updateQueue.baseState=S)}var _o={isMounted:function(h){return(h=h._reactInternals)?_r(h)===h:!1},enqueueSetState:function(h,p,S){h=h._reactInternals;var M=ws(),F=Hs(h),$=Oo(M,F);$.payload=p,S!=null&&($.callback=S),p=Ya(h,$,F),p!==null&&(ga(p,h,F,M),Yh(p,h,F))},enqueueReplaceState:function(h,p,S){h=h._reactInternals;var M=ws(),F=Hs(h),$=Oo(M,F);$.tag=1,$.payload=p,S!=null&&($.callback=S),p=Ya(h,$,F),p!==null&&(ga(p,h,F,M),Yh(p,h,F))},enqueueForceUpdate:function(h,p){h=h._reactInternals;var S=ws(),M=Hs(h),F=Oo(S,M);F.tag=2,p!=null&&(F.callback=p),p=Ya(h,F,M),p!==null&&(ga(p,h,M,S),Yh(p,h,M))}};function Vo(h,p,S,M,F,$,ie){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(M,$,ie):p.prototype&&p.prototype.isPureReactComponent?!Cc(S,M)||!Cc(F,$):!0}function vo(h,p,S){var M=!1,F=Lo,$=p.contextType;return typeof $=="object"&&$!==null?$=jt($):(F=$i(p)?Ga:Pi.current,M=p.contextTypes,$=(M=M!=null)?qa(h,F):Lo),p=new p(S,$),h.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=_o,h.stateNode=p,p._reactInternals=h,M&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=F,h.__reactInternalMemoizedMaskedChildContext=$),p}function os(h,p,S,M){h=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(S,M),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(S,M),p.state!==h&&_o.enqueueReplaceState(p,p.state,null)}function ua(h,p,S,M){var F=h.stateNode;F.props=S,F.state=h.memoizedState,F.refs={},ys(h);var $=p.contextType;typeof $=="object"&&$!==null?F.context=jt($):($=$i(p)?Ga:Pi.current,F.context=qa(h,$)),F.state=h.memoizedState,$=p.getDerivedStateFromProps,typeof $=="function"&&(fi(h,p,$,S),F.state=h.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof F.getSnapshotBeforeUpdate=="function"||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(p=F.state,typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount(),p!==F.state&&_o.enqueueReplaceState(F,F.state,null),_n(h,S,F,M),F.state=h.memoizedState),typeof F.componentDidMount=="function"&&(h.flags|=4194308)}function Uo(h,p){try{var S="",M=p;do S+=ir(M),M=M.return;while(M);var F=S}catch($){F=`
Error generating stack: `+$.message+`
`+$.stack}return{value:h,source:p,stack:F,digest:null}}function ha(h,p,S){return{value:h,source:null,stack:S??null,digest:p??null}}function vs(h,p){try{console.error(p.value)}catch(S){setTimeout(function(){throw S})}}var $o=typeof WeakMap=="function"?WeakMap:Map;function Zs(h,p,S){S=Oo(-1,S),S.tag=3,S.payload={element:null};var M=p.value;return S.callback=function(){Bc||(Bc=!0,bp=M),vs(h,p)},S}function Ws(h,p,S){S=Oo(-1,S),S.tag=3;var M=h.type.getDerivedStateFromError;if(typeof M=="function"){var F=p.value;S.payload=function(){return M(F)},S.callback=function(){vs(h,p)}}var $=h.stateNode;return $!==null&&typeof $.componentDidCatch=="function"&&(S.callback=function(){vs(h,p),typeof M!="function"&&(ql===null?ql=new Set([this]):ql.add(this));var ie=p.stack;this.componentDidCatch(p.value,{componentStack:ie!==null?ie:""})}),S}function pn(h,p,S){var M=h.pingCache;if(M===null){M=h.pingCache=new $o;var F=new Set;M.set(p,F)}else F=M.get(p),F===void 0&&(F=new Set,M.set(p,F));F.has(S)||(F.add(S),h=Cy.bind(null,h,p,S),p.then(h,h))}function hn(h){do{var p;if((p=h.tag===13)&&(p=h.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return h;h=h.return}while(h!==null);return null}function li(h,p,S,M,F){return(h.mode&1)===0?(h===p?h.flags|=65536:(h.flags|=128,S.flags|=131072,S.flags&=-52805,S.tag===1&&(S.alternate===null?S.tag=17:(p=Oo(-1,1),p.tag=2,Ya(S,p,1))),S.lanes|=1),h):(h.flags|=65536,h.lanes=F,h)}var pi=Ie.ReactCurrentOwner,as=!1;function Gi(h,p,S,M){p.child=h===null?Rc(p,null,S,M):Dc(p,h.child,S,M)}function el(h,p,S,M,F){S=S.render;var $=p.ref;return Fo(p,F),M=d(h,p,S,M,$,F),S=g(),h!==null&&!as?(p.updateQueue=h.updateQueue,p.flags&=-2053,h.lanes&=~F,$l(h,p,F)):(Tn&&S&&Lu(p),p.flags|=1,Gi(h,p,M,F),p.child)}function mp(h,p,S,M,F){if(h===null){var $=S.type;return typeof $=="function"&&!Ym($)&&$.defaultProps===void 0&&S.compare===null&&S.defaultProps===void 0?(p.tag=15,p.type=$,hf(h,p,$,M,F)):(h=ud(S.type,null,M,p,p.mode,F),h.ref=p.ref,h.return=p,p.child=h)}if($=h.child,(h.lanes&F)===0){var ie=$.memoizedProps;if(S=S.compare,S=S!==null?S:Cc,S(ie,M)&&h.ref===p.ref)return $l(h,p,F)}return p.flags|=1,h=Wl($,M),h.ref=p.ref,h.return=p,p.child=h}function hf(h,p,S,M,F){if(h!==null){var $=h.memoizedProps;if(Cc($,M)&&h.ref===p.ref)if(as=!1,p.pendingProps=M=$,(h.lanes&F)!==0)(h.flags&131072)!==0&&(as=!0);else return p.lanes=h.lanes,$l(h,p,F)}return Go(h,p,S,M,F)}function Qh(h,p,S){var M=p.pendingProps,F=M.children,$=h!==null?h.memoizedState:null;if(M.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wr(ad,bo),bo|=S;else{if((S&1073741824)===0)return h=$!==null?$.baseLanes|S:S,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:h,cachePool:null,transitions:null},p.updateQueue=null,Wr(ad,bo),bo|=h,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},M=$!==null?$.baseLanes:S,Wr(ad,bo),bo|=M}else $!==null?(M=$.baseLanes|S,p.memoizedState=null):M=S,Wr(ad,bo),bo|=M;return Gi(h,p,F,S),p.child}function da(h,p){var S=p.ref;(h===null&&S!==null||h!==null&&h.ref!==S)&&(p.flags|=512,p.flags|=2097152)}function Go(h,p,S,M,F){var $=$i(S)?Ga:Pi.current;return $=qa(p,$),Fo(p,F),S=d(h,p,S,M,$,F),M=g(),h!==null&&!as?(p.updateQueue=h.updateQueue,p.flags&=-2053,h.lanes&=~F,$l(h,p,F)):(Tn&&M&&Lu(p),p.flags|=1,Gi(h,p,S,F),p.child)}function fa(h,p,S,M,F){if($i(S)){var $=!0;go(p)}else $=!1;if(Fo(p,F),p.stateNode===null)Ul(h,p),vo(p,S,M),ua(p,S,M,F),M=!0;else if(h===null){var ie=p.stateNode,Pe=p.memoizedProps;ie.props=Pe;var Le=ie.context,et=S.contextType;typeof et=="object"&&et!==null?et=jt(et):(et=$i(S)?Ga:Pi.current,et=qa(p,et));var Tt=S.getDerivedStateFromProps,It=typeof Tt=="function"||typeof ie.getSnapshotBeforeUpdate=="function";It||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(Pe!==M||Le!==et)&&os(p,ie,M,et),Hn=!1;var wt=p.memoizedState;ie.state=wt,_n(p,M,ie,F),Le=p.memoizedState,Pe!==M||wt!==Le||Ci.current||Hn?(typeof Tt=="function"&&(fi(p,S,Tt,M),Le=p.memoizedState),(Pe=Hn||Vo(p,S,Pe,M,wt,Le,et))?(It||typeof ie.UNSAFE_componentWillMount!="function"&&typeof ie.componentWillMount!="function"||(typeof ie.componentWillMount=="function"&&ie.componentWillMount(),typeof ie.UNSAFE_componentWillMount=="function"&&ie.UNSAFE_componentWillMount()),typeof ie.componentDidMount=="function"&&(p.flags|=4194308)):(typeof ie.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=M,p.memoizedState=Le),ie.props=M,ie.state=Le,ie.context=et,M=Pe):(typeof ie.componentDidMount=="function"&&(p.flags|=4194308),M=!1)}else{ie=p.stateNode,Kh(h,p),Pe=p.memoizedProps,et=p.type===p.elementType?Pe:Hr(p.type,Pe),ie.props=et,It=p.pendingProps,wt=ie.context,Le=S.contextType,typeof Le=="object"&&Le!==null?Le=jt(Le):(Le=$i(S)?Ga:Pi.current,Le=qa(p,Le));var Xt=S.getDerivedStateFromProps;(Tt=typeof Xt=="function"||typeof ie.getSnapshotBeforeUpdate=="function")||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(Pe!==It||wt!==Le)&&os(p,ie,M,Le),Hn=!1,wt=p.memoizedState,ie.state=wt,_n(p,M,ie,F);var tr=p.memoizedState;Pe!==It||wt!==tr||Ci.current||Hn?(typeof Xt=="function"&&(fi(p,S,Xt,M),tr=p.memoizedState),(et=Hn||Vo(p,S,et,M,wt,tr,Le)||!1)?(Tt||typeof ie.UNSAFE_componentWillUpdate!="function"&&typeof ie.componentWillUpdate!="function"||(typeof ie.componentWillUpdate=="function"&&ie.componentWillUpdate(M,tr,Le),typeof ie.UNSAFE_componentWillUpdate=="function"&&ie.UNSAFE_componentWillUpdate(M,tr,Le)),typeof ie.componentDidUpdate=="function"&&(p.flags|=4),typeof ie.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof ie.componentDidUpdate!="function"||Pe===h.memoizedProps&&wt===h.memoizedState||(p.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||Pe===h.memoizedProps&&wt===h.memoizedState||(p.flags|=1024),p.memoizedProps=M,p.memoizedState=tr),ie.props=M,ie.state=tr,ie.context=Le,M=et):(typeof ie.componentDidUpdate!="function"||Pe===h.memoizedProps&&wt===h.memoizedState||(p.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||Pe===h.memoizedProps&&wt===h.memoizedState||(p.flags|=1024),M=!1)}return Bu(h,p,S,M,$,F)}function Bu(h,p,S,M,F,$){da(h,p);var ie=(p.flags&128)!==0;if(!M&&!ie)return F&&of(p,S,!1),$l(h,p,$);M=p.stateNode,pi.current=p;var Pe=ie&&typeof S.getDerivedStateFromError!="function"?null:M.render();return p.flags|=1,h!==null&&ie?(p.child=Dc(p,h.child,null,$),p.child=Dc(p,null,Pe,$)):Gi(h,p,Pe,$),p.memoizedState=M.state,F&&of(p,S,!0),p.child}function Jh(h){var p=h.stateNode;p.pendingContext?Uh(h,p.pendingContext,p.pendingContext!==p.context):p.context&&Uh(h,p.context,!1),Nu(h,p.containerInfo)}function Vu(h,p,S,M,F){return Xa(),Zh(F),p.flags|=256,Gi(h,p,S,M),p.child}var Fc={dehydrated:null,treeContext:null,retryLane:0};function ed(h){return{baseLanes:h,cachePool:null,transitions:null}}function Fm(h,p,S){var M=p.pendingProps,F=vn.current,$=!1,ie=(p.flags&128)!==0,Pe;if((Pe=ie)||(Pe=h!==null&&h.memoizedState===null?!1:(F&2)!==0),Pe?($=!0,p.flags&=-129):(h===null||h.memoizedState!==null)&&(F|=1),Wr(vn,F&1),h===null)return lf(p),h=p.memoizedState,h!==null&&(h=h.dehydrated,h!==null)?((p.mode&1)===0?p.lanes=1:h.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(ie=M.children,h=M.fallback,$?(M=p.mode,$=p.child,ie={mode:"hidden",children:ie},(M&1)===0&&$!==null?($.childLanes=0,$.pendingProps=ie):$=bf(ie,M,0,null),h=Zc(h,M,S,null),$.return=p,h.return=p,$.sibling=h,p.child=$,p.child.memoizedState=ed(S),p.memoizedState=Fc,h):Om(p,ie));if(F=h.memoizedState,F!==null&&(Pe=F.dehydrated,Pe!==null))return D_(h,p,ie,M,Pe,F,S);if($){$=M.fallback,ie=p.mode,F=h.child,Pe=F.sibling;var Le={mode:"hidden",children:M.children};return(ie&1)===0&&p.child!==F?(M=p.child,M.childLanes=0,M.pendingProps=Le,p.deletions=null):(M=Wl(F,Le),M.subtreeFlags=F.subtreeFlags&14680064),Pe!==null?$=Wl(Pe,$):($=Zc($,ie,S,null),$.flags|=2),$.return=p,M.return=p,M.sibling=$,p.child=M,M=$,$=p.child,ie=h.child.memoizedState,ie=ie===null?ed(S):{baseLanes:ie.baseLanes|S,cachePool:null,transitions:ie.transitions},$.memoizedState=ie,$.childLanes=h.childLanes&~S,p.memoizedState=Fc,M}return $=h.child,h=$.sibling,M=Wl($,{mode:"visible",children:M.children}),(p.mode&1)===0&&(M.lanes=S),M.return=p,M.sibling=null,h!==null&&(S=p.deletions,S===null?(p.deletions=[h],p.flags|=16):S.push(h)),p.child=M,p.memoizedState=null,M}function Om(h,p){return p=bf({mode:"visible",children:p},h.mode,0,null),p.return=h,h.child=p}function td(h,p,S,M){return M!==null&&Zh(M),Dc(p,h.child,null,S),h=Om(p,p.pendingProps.children),h.flags|=2,p.memoizedState=null,h}function D_(h,p,S,M,F,$,ie){if(S)return p.flags&256?(p.flags&=-257,M=ha(Error(s(422))),td(h,p,ie,M)):p.memoizedState!==null?(p.child=h.child,p.flags|=128,null):($=M.fallback,F=p.mode,M=bf({mode:"visible",children:M.children},F,0,null),$=Zc($,F,ie,null),$.flags|=2,M.return=p,$.return=p,M.sibling=$,p.child=M,(p.mode&1)!==0&&Dc(p,h.child,null,ie),p.child.memoizedState=ed(ie),p.memoizedState=Fc,$);if((p.mode&1)===0)return td(h,p,ie,null);if(F.data==="$!"){if(M=F.nextSibling&&F.nextSibling.dataset,M)var Pe=M.dgst;return M=Pe,$=Error(s(419)),M=ha($,M,void 0),td(h,p,ie,M)}if(Pe=(ie&h.childLanes)!==0,as||Pe){if(M=Zi,M!==null){switch(ie&-ie){case 4:F=2;break;case 16:F=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:F=32;break;case 536870912:F=268435456;break;default:F=0}F=(F&(M.suspendedLanes|ie))!==0?0:F,F!==0&&F!==$.retryLane&&($.retryLane=F,qs(h,F),ga(M,h,F,-1))}return Hm(),M=ha(Error(s(421))),td(h,p,ie,M)}return F.data==="$?"?(p.flags|=128,p.child=h.child,p=O_.bind(null,h),F._reactRetry=p,null):(h=$.treeContext,Fi=ia(F.nextSibling),zi=p,Tn=!0,ss=null,h!==null&&(Us[$s++]=gs,Us[$s++]=di,Us[$s++]=Gs,gs=h.id,di=h.overflow,Gs=p),p=Om(p,M.children),p.flags|=4096,p)}function gp(h,p,S){h.lanes|=p;var M=h.alternate;M!==null&&(M.lanes|=p),As(h.return,p,S)}function yp(h,p,S,M,F){var $=h.memoizedState;$===null?h.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:M,tail:S,tailMode:F}:($.isBackwards=p,$.rendering=null,$.renderingStartTime=0,$.last=M,$.tail=S,$.tailMode=F)}function Nm(h,p,S){var M=p.pendingProps,F=M.revealOrder,$=M.tail;if(Gi(h,p,M.children,S),M=vn.current,(M&2)!==0)M=M&1|2,p.flags|=128;else{if(h!==null&&(h.flags&128)!==0)e:for(h=p.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&gp(h,S,p);else if(h.tag===19)gp(h,S,p);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===p)break e;for(;h.sibling===null;){if(h.return===null||h.return===p)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}M&=1}if(Wr(vn,M),(p.mode&1)===0)p.memoizedState=null;else switch(F){case"forwards":for(S=p.child,F=null;S!==null;)h=S.alternate,h!==null&&Nl(h)===null&&(F=S),S=S.sibling;S=F,S===null?(F=p.child,p.child=null):(F=S.sibling,S.sibling=null),yp(p,!1,F,S,$);break;case"backwards":for(S=null,F=p.child,p.child=null;F!==null;){if(h=F.alternate,h!==null&&Nl(h)===null){p.child=F;break}h=F.sibling,F.sibling=S,S=F,F=h}yp(p,!0,S,null,$);break;case"together":yp(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function Ul(h,p){(p.mode&1)===0&&h!==null&&(h.alternate=null,p.alternate=null,p.flags|=2)}function $l(h,p,S){if(h!==null&&(p.dependencies=h.dependencies),Nc|=p.lanes,(S&p.childLanes)===0)return null;if(h!==null&&p.child!==h.child)throw Error(s(153));if(p.child!==null){for(h=p.child,S=Wl(h,h.pendingProps),p.child=S,S.return=p;h.sibling!==null;)h=h.sibling,S=S.sibling=Wl(h,h.pendingProps),S.return=p;S.sibling=null}return p.child}function rd(h,p,S){switch(p.tag){case 3:Jh(p),Xa();break;case 5:Bo(p);break;case 1:$i(p.type)&&go(p);break;case 4:Nu(p,p.stateNode.containerInfo);break;case 10:var M=p.type._context,F=p.memoizedProps.value;Wr(Ll,M._currentValue),M._currentValue=F;break;case 13:if(M=p.memoizedState,M!==null)return M.dehydrated!==null?(Wr(vn,vn.current&1),p.flags|=128,null):(S&p.child.childLanes)!==0?Fm(h,p,S):(Wr(vn,vn.current&1),h=$l(h,p,S),h!==null?h.sibling:null);Wr(vn,vn.current&1);break;case 19:if(M=(S&p.childLanes)!==0,(h.flags&128)!==0){if(M)return Nm(h,p,S);p.flags|=128}if(F=p.memoizedState,F!==null&&(F.rendering=null,F.tail=null,F.lastEffect=null),Wr(vn,vn.current),M)break;return null;case 22:case 23:return p.lanes=0,Qh(h,p,S)}return $l(h,p,S)}var df,nd,dy,fy;df=function(h,p){for(var S=p.child;S!==null;){if(S.tag===5||S.tag===6)h.appendChild(S.stateNode);else if(S.tag!==4&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===p)break;for(;S.sibling===null;){if(S.return===null||S.return===p)return;S=S.return}S.sibling.return=S.return,S=S.sibling}},nd=function(){},dy=function(h,p,S,M){var F=h.memoizedProps;if(F!==M){h=p.stateNode,No(_s.current);var $=null;switch(S){case"input":F=en(h,F),M=en(h,M),$=[];break;case"select":F=_t({},F,{value:void 0}),M=_t({},M,{value:void 0}),$=[];break;case"textarea":F=Ue(h,F),M=Ue(h,M),$=[];break;default:typeof F.onClick!="function"&&typeof M.onClick=="function"&&(h.onclick=Oh)}ut(S,M);var ie;S=null;for(et in F)if(!M.hasOwnProperty(et)&&F.hasOwnProperty(et)&&F[et]!=null)if(et==="style"){var Pe=F[et];for(ie in Pe)Pe.hasOwnProperty(ie)&&(S||(S={}),S[ie]="")}else et!=="dangerouslySetInnerHTML"&&et!=="children"&&et!=="suppressContentEditableWarning"&&et!=="suppressHydrationWarning"&&et!=="autoFocus"&&(m.hasOwnProperty(et)?$||($=[]):($=$||[]).push(et,null));for(et in M){var Le=M[et];if(Pe=F?.[et],M.hasOwnProperty(et)&&Le!==Pe&&(Le!=null||Pe!=null))if(et==="style")if(Pe){for(ie in Pe)!Pe.hasOwnProperty(ie)||Le&&Le.hasOwnProperty(ie)||(S||(S={}),S[ie]="");for(ie in Le)Le.hasOwnProperty(ie)&&Pe[ie]!==Le[ie]&&(S||(S={}),S[ie]=Le[ie])}else S||($||($=[]),$.push(et,S)),S=Le;else et==="dangerouslySetInnerHTML"?(Le=Le?Le.__html:void 0,Pe=Pe?Pe.__html:void 0,Le!=null&&Pe!==Le&&($=$||[]).push(et,Le)):et==="children"?typeof Le!="string"&&typeof Le!="number"||($=$||[]).push(et,""+Le):et!=="suppressContentEditableWarning"&&et!=="suppressHydrationWarning"&&(m.hasOwnProperty(et)?(Le!=null&&et==="onScroll"&&An("scroll",h),$||Pe===Le||($=[])):($=$||[]).push(et,Le))}S&&($=$||[]).push("style",S);var et=$;(p.updateQueue=et)&&(p.flags|=4)}},fy=function(h,p,S,M){S!==M&&(p.flags|=4)};function ff(h,p){if(!Tn)switch(h.tailMode){case"hidden":p=h.tail;for(var S=null;p!==null;)p.alternate!==null&&(S=p),p=p.sibling;S===null?h.tail=null:S.sibling=null;break;case"collapsed":S=h.tail;for(var M=null;S!==null;)S.alternate!==null&&(M=S),S=S.sibling;M===null?p||h.tail===null?h.tail=null:h.tail.sibling=null:M.sibling=null}}function xs(h){var p=h.alternate!==null&&h.alternate.child===h.child,S=0,M=0;if(p)for(var F=h.child;F!==null;)S|=F.lanes|F.childLanes,M|=F.subtreeFlags&14680064,M|=F.flags&14680064,F.return=h,F=F.sibling;else for(F=h.child;F!==null;)S|=F.lanes|F.childLanes,M|=F.subtreeFlags,M|=F.flags,F.return=h,F=F.sibling;return h.subtreeFlags|=M,h.childLanes=S,p}function R_(h,p,S){var M=p.pendingProps;switch(Wa(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xs(p),null;case 1:return $i(p.type)&&ku(),xs(p),null;case 3:return M=p.stateNode,jo(),wn(Ci),wn(Pi),ju(),M.pendingContext&&(M.context=M.pendingContext,M.pendingContext=null),(h===null||h.child===null)&&(Dl(p)?p.flags|=4:h===null||h.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,ss!==null&&(Tp(ss),ss=null))),nd(h,p),xs(p),null;case 5:zc(p);var F=No(Ol.current);if(S=p.type,h!==null&&p.stateNode!=null)dy(h,p,S,M,F),h.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!M){if(p.stateNode===null)throw Error(s(166));return xs(p),null}if(h=No(_s.current),Dl(p)){M=p.stateNode,S=p.type;var $=p.memoizedProps;switch(M[Ui]=p,M[Li]=$,h=(p.mode&1)!==0,S){case"dialog":An("cancel",M),An("close",M);break;case"iframe":case"object":case"embed":An("load",M);break;case"video":case"audio":for(F=0;F<Eu.length;F++)An(Eu[F],M);break;case"source":An("error",M);break;case"img":case"image":case"link":An("error",M),An("load",M);break;case"details":An("toggle",M);break;case"input":ni(M,$),An("invalid",M);break;case"select":M._wrapperState={wasMultiple:!!$.multiple},An("invalid",M);break;case"textarea":it(M,$),An("invalid",M)}ut(S,$),F=null;for(var ie in $)if($.hasOwnProperty(ie)){var Pe=$[ie];ie==="children"?typeof Pe=="string"?M.textContent!==Pe&&($.suppressHydrationWarning!==!0&&Ac(M.textContent,Pe,h),F=["children",Pe]):typeof Pe=="number"&&M.textContent!==""+Pe&&($.suppressHydrationWarning!==!0&&Ac(M.textContent,Pe,h),F=["children",""+Pe]):m.hasOwnProperty(ie)&&Pe!=null&&ie==="onScroll"&&An("scroll",M)}switch(S){case"input":Lr(M),io(M,$,!0);break;case"textarea":Lr(M),Mt(M);break;case"select":case"option":break;default:typeof $.onClick=="function"&&(M.onclick=Oh)}M=F,p.updateQueue=M,M!==null&&(p.flags|=4)}else{ie=F.nodeType===9?F:F.ownerDocument,h==="http://www.w3.org/1999/xhtml"&&(h=xe(S)),h==="http://www.w3.org/1999/xhtml"?S==="script"?(h=ie.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild)):typeof M.is=="string"?h=ie.createElement(S,{is:M.is}):(h=ie.createElement(S),S==="select"&&(ie=h,M.multiple?ie.multiple=!0:M.size&&(ie.size=M.size))):h=ie.createElementNS(h,S),h[Ui]=p,h[Li]=M,df(h,p,!1,!1),p.stateNode=h;e:{switch(ie=st(S,M),S){case"dialog":An("cancel",h),An("close",h),F=M;break;case"iframe":case"object":case"embed":An("load",h),F=M;break;case"video":case"audio":for(F=0;F<Eu.length;F++)An(Eu[F],h);F=M;break;case"source":An("error",h),F=M;break;case"img":case"image":case"link":An("error",h),An("load",h),F=M;break;case"details":An("toggle",h),F=M;break;case"input":ni(h,M),F=en(h,M),An("invalid",h);break;case"option":F=M;break;case"select":h._wrapperState={wasMultiple:!!M.multiple},F=_t({},M,{value:void 0}),An("invalid",h);break;case"textarea":it(h,M),F=Ue(h,M),An("invalid",h);break;default:F=M}ut(S,F),Pe=F;for($ in Pe)if(Pe.hasOwnProperty($)){var Le=Pe[$];$==="style"?De(h,Le):$==="dangerouslySetInnerHTML"?(Le=Le?Le.__html:void 0,Le!=null&&oe(h,Le)):$==="children"?typeof Le=="string"?(S!=="textarea"||Le!=="")&&we(h,Le):typeof Le=="number"&&we(h,""+Le):$!=="suppressContentEditableWarning"&&$!=="suppressHydrationWarning"&&$!=="autoFocus"&&(m.hasOwnProperty($)?Le!=null&&$==="onScroll"&&An("scroll",h):Le!=null&&_e(h,$,Le,ie))}switch(S){case"input":Lr(h),io(h,M,!1);break;case"textarea":Lr(h),Mt(h);break;case"option":M.value!=null&&h.setAttribute("value",""+Gt(M.value));break;case"select":h.multiple=!!M.multiple,$=M.value,$!=null?Ae(h,!!M.multiple,$,!1):M.defaultValue!=null&&Ae(h,!!M.multiple,M.defaultValue,!0);break;default:typeof F.onClick=="function"&&(h.onclick=Oh)}switch(S){case"button":case"input":case"select":case"textarea":M=!!M.autoFocus;break e;case"img":M=!0;break e;default:M=!1}}M&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return xs(p),null;case 6:if(h&&p.stateNode!=null)fy(h,p,h.memoizedProps,M);else{if(typeof M!="string"&&p.stateNode===null)throw Error(s(166));if(S=No(Ol.current),No(_s.current),Dl(p)){if(M=p.stateNode,S=p.memoizedProps,M[Ui]=p,($=M.nodeValue!==S)&&(h=zi,h!==null))switch(h.tag){case 3:Ac(M.nodeValue,S,(h.mode&1)!==0);break;case 5:h.memoizedProps.suppressHydrationWarning!==!0&&Ac(M.nodeValue,S,(h.mode&1)!==0)}$&&(p.flags|=4)}else M=(S.nodeType===9?S:S.ownerDocument).createTextNode(M),M[Ui]=p,p.stateNode=M}return xs(p),null;case 13:if(wn(vn),M=p.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(Tn&&Fi!==null&&(p.mode&1)!==0&&(p.flags&128)===0)cf(),Xa(),p.flags|=98560,$=!1;else if($=Dl(p),M!==null&&M.dehydrated!==null){if(h===null){if(!$)throw Error(s(318));if($=p.memoizedState,$=$!==null?$.dehydrated:null,!$)throw Error(s(317));$[Ui]=p}else Xa(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;xs(p),$=!1}else ss!==null&&(Tp(ss),ss=null),$=!0;if(!$)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=S,p):(M=M!==null,M!==(h!==null&&h.memoizedState!==null)&&M&&(p.child.flags|=8192,(p.mode&1)!==0&&(h===null||(vn.current&1)!==0?mi===0&&(mi=3):Hm())),p.updateQueue!==null&&(p.flags|=4),xs(p),null);case 4:return jo(),nd(h,p),h===null&&Pl(p.stateNode.containerInfo),xs(p),null;case 10:return Xh(p.type._context),xs(p),null;case 17:return $i(p.type)&&ku(),xs(p),null;case 19:if(wn(vn),$=p.memoizedState,$===null)return xs(p),null;if(M=(p.flags&128)!==0,ie=$.rendering,ie===null)if(M)ff($,!1);else{if(mi!==0||h!==null&&(h.flags&128)!==0)for(h=p.child;h!==null;){if(ie=Nl(h),ie!==null){for(p.flags|=128,ff($,!1),M=ie.updateQueue,M!==null&&(p.updateQueue=M,p.flags|=4),p.subtreeFlags=0,M=S,S=p.child;S!==null;)$=S,h=M,$.flags&=14680066,ie=$.alternate,ie===null?($.childLanes=0,$.lanes=h,$.child=null,$.subtreeFlags=0,$.memoizedProps=null,$.memoizedState=null,$.updateQueue=null,$.dependencies=null,$.stateNode=null):($.childLanes=ie.childLanes,$.lanes=ie.lanes,$.child=ie.child,$.subtreeFlags=0,$.deletions=null,$.memoizedProps=ie.memoizedProps,$.memoizedState=ie.memoizedState,$.updateQueue=ie.updateQueue,$.type=ie.type,h=ie.dependencies,$.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),S=S.sibling;return Wr(vn,vn.current&1|2),p.child}h=h.sibling}$.tail!==null&&Mn()>Gl&&(p.flags|=128,M=!0,ff($,!1),p.lanes=4194304)}else{if(!M)if(h=Nl(ie),h!==null){if(p.flags|=128,M=!0,S=h.updateQueue,S!==null&&(p.updateQueue=S,p.flags|=4),ff($,!0),$.tail===null&&$.tailMode==="hidden"&&!ie.alternate&&!Tn)return xs(p),null}else 2*Mn()-$.renderingStartTime>Gl&&S!==1073741824&&(p.flags|=128,M=!0,ff($,!1),p.lanes=4194304);$.isBackwards?(ie.sibling=p.child,p.child=ie):(S=$.last,S!==null?S.sibling=ie:p.child=ie,$.last=ie)}return $.tail!==null?(p=$.tail,$.rendering=p,$.tail=p.sibling,$.renderingStartTime=Mn(),p.sibling=null,S=vn.current,Wr(vn,M?S&1|2:S&1),p):(xs(p),null);case 22:case 23:return Zm(),M=p.memoizedState!==null,h!==null&&h.memoizedState!==null!==M&&(p.flags|=8192),M&&(p.mode&1)!==0?(bo&1073741824)!==0&&(xs(p),p.subtreeFlags&6&&(p.flags|=8192)):xs(p),null;case 24:return null;case 25:return null}throw Error(s(156,p.tag))}function py(h,p){switch(Wa(p),p.tag){case 1:return $i(p.type)&&ku(),h=p.flags,h&65536?(p.flags=h&-65537|128,p):null;case 3:return jo(),wn(Ci),wn(Pi),ju(),h=p.flags,(h&65536)!==0&&(h&128)===0?(p.flags=h&-65537|128,p):null;case 5:return zc(p),null;case 13:if(wn(vn),h=p.memoizedState,h!==null&&h.dehydrated!==null){if(p.alternate===null)throw Error(s(340));Xa()}return h=p.flags,h&65536?(p.flags=h&-65537|128,p):null;case 19:return wn(vn),null;case 4:return jo(),null;case 10:return Xh(p.type._context),null;case 22:case 23:return Zm(),null;case 24:return null;default:return null}}var id=!1,ls=!1,my=typeof WeakSet=="function"?WeakSet:Set,Qt=null;function sd(h,p){var S=h.ref;if(S!==null)if(typeof S=="function")try{S(null)}catch(M){Yn(h,p,M)}else S.current=null}function _p(h,p,S){try{S()}catch(M){Yn(h,p,M)}}var jm=!1;function L_(h,p){if(Ml=fl,h=hp(),Vr(h)){if("selectionStart"in h)var S={start:h.selectionStart,end:h.selectionEnd};else e:{S=(S=h.ownerDocument)&&S.defaultView||window;var M=S.getSelection&&S.getSelection();if(M&&M.rangeCount!==0){S=M.anchorNode;var F=M.anchorOffset,$=M.focusNode;M=M.focusOffset;try{S.nodeType,$.nodeType}catch{S=null;break e}var ie=0,Pe=-1,Le=-1,et=0,Tt=0,It=h,wt=null;t:for(;;){for(var Xt;It!==S||F!==0&&It.nodeType!==3||(Pe=ie+F),It!==$||M!==0&&It.nodeType!==3||(Le=ie+M),It.nodeType===3&&(ie+=It.nodeValue.length),(Xt=It.firstChild)!==null;)wt=It,It=Xt;for(;;){if(It===h)break t;if(wt===S&&++et===F&&(Pe=ie),wt===$&&++Tt===M&&(Le=ie),(Xt=It.nextSibling)!==null)break;It=wt,wt=It.parentNode}It=Xt}S=Pe===-1||Le===-1?null:{start:Pe,end:Le}}else S=null}S=S||{start:0,end:0}}else S=null;for(rf={focusedElem:h,selectionRange:S},fl=!1,Qt=p;Qt!==null;)if(p=Qt,h=p.child,(p.subtreeFlags&1028)!==0&&h!==null)h.return=p,Qt=h;else for(;Qt!==null;){p=Qt;try{var tr=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(tr!==null){var rr=tr.memoizedProps,Qn=tr.memoizedState,We=p.stateNode,Fe=We.getSnapshotBeforeUpdate(p.elementType===p.type?rr:Hr(p.type,rr),Qn);We.__reactInternalSnapshotBeforeUpdate=Fe}break;case 3:var Qe=p.stateNode.containerInfo;Qe.nodeType===1?Qe.textContent="":Qe.nodeType===9&&Qe.documentElement&&Qe.removeChild(Qe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(Rt){Yn(p,p.return,Rt)}if(h=p.sibling,h!==null){h.return=p.return,Qt=h;break}Qt=p.return}return tr=jm,jm=!1,tr}function Uu(h,p,S){var M=p.updateQueue;if(M=M!==null?M.lastEffect:null,M!==null){var F=M=M.next;do{if((F.tag&h)===h){var $=F.destroy;F.destroy=void 0,$!==void 0&&_p(p,S,$)}F=F.next}while(F!==M)}}function pf(h,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var S=p=p.next;do{if((S.tag&h)===h){var M=S.create;S.destroy=M()}S=S.next}while(S!==p)}}function mf(h){var p=h.ref;if(p!==null){var S=h.stateNode;h.tag,h=S,typeof p=="function"?p(h):p.current=h}}function od(h){var p=h.alternate;p!==null&&(h.alternate=null,od(p)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(p=h.stateNode,p!==null&&(delete p[Ui],delete p[Li],delete p[Al],delete p[Bh],delete p[$a])),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function bs(h){return h.tag===5||h.tag===3||h.tag===4}function Bm(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||bs(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function gf(h,p,S){var M=h.tag;if(M===5||M===6)h=h.stateNode,p?S.nodeType===8?S.parentNode.insertBefore(h,p):S.insertBefore(h,p):(S.nodeType===8?(p=S.parentNode,p.insertBefore(h,S)):(p=S,p.appendChild(h)),S=S._reactRootContainer,S!=null||p.onclick!==null||(p.onclick=Oh));else if(M!==4&&(h=h.child,h!==null))for(gf(h,p,S),h=h.sibling;h!==null;)gf(h,p,S),h=h.sibling}function Vm(h,p,S){var M=h.tag;if(M===5||M===6)h=h.stateNode,p?S.insertBefore(h,p):S.appendChild(h);else if(M!==4&&(h=h.child,h!==null))for(Vm(h,p,S),h=h.sibling;h!==null;)Vm(h,p,S),h=h.sibling}var qi=null,pa=!1;function Oc(h,p,S){for(S=S.child;S!==null;)Um(h,p,S),S=S.sibling}function Um(h,p,S){if(Vi&&typeof Vi.onCommitFiberUnmount=="function")try{Vi.onCommitFiberUnmount(Aa,S)}catch{}switch(S.tag){case 5:ls||sd(S,p);case 6:var M=qi,F=pa;qi=null,Oc(h,p,S),qi=M,pa=F,qi!==null&&(pa?(h=qi,S=S.stateNode,h.nodeType===8?h.parentNode.removeChild(S):h.removeChild(S)):qi.removeChild(S.stateNode));break;case 18:qi!==null&&(pa?(h=qi,S=S.stateNode,h.nodeType===8?kc(h.parentNode,S):h.nodeType===1&&kc(h,S),oo(h)):kc(qi,S.stateNode));break;case 4:M=qi,F=pa,qi=S.stateNode.containerInfo,pa=!0,Oc(h,p,S),qi=M,pa=F;break;case 0:case 11:case 14:case 15:if(!ls&&(M=S.updateQueue,M!==null&&(M=M.lastEffect,M!==null))){F=M=M.next;do{var $=F,ie=$.destroy;$=$.tag,ie!==void 0&&(($&2)!==0||($&4)!==0)&&_p(S,p,ie),F=F.next}while(F!==M)}Oc(h,p,S);break;case 1:if(!ls&&(sd(S,p),M=S.stateNode,typeof M.componentWillUnmount=="function"))try{M.props=S.memoizedProps,M.state=S.memoizedState,M.componentWillUnmount()}catch(Pe){Yn(S,p,Pe)}Oc(h,p,S);break;case 21:Oc(h,p,S);break;case 22:S.mode&1?(ls=(M=ls)||S.memoizedState!==null,Oc(h,p,S),ls=M):Oc(h,p,S);break;default:Oc(h,p,S)}}function gy(h){var p=h.updateQueue;if(p!==null){h.updateQueue=null;var S=h.stateNode;S===null&&(S=h.stateNode=new my),p.forEach(function(M){var F=xf.bind(null,h,M);S.has(M)||(S.add(M),M.then(F,F))})}}function xo(h,p){var S=p.deletions;if(S!==null)for(var M=0;M<S.length;M++){var F=S[M];try{var $=h,ie=p,Pe=ie;e:for(;Pe!==null;){switch(Pe.tag){case 5:qi=Pe.stateNode,pa=!1;break e;case 3:qi=Pe.stateNode.containerInfo,pa=!0;break e;case 4:qi=Pe.stateNode.containerInfo,pa=!0;break e}Pe=Pe.return}if(qi===null)throw Error(s(160));Um($,ie,F),qi=null,pa=!1;var Le=F.alternate;Le!==null&&(Le.return=null),F.return=null}catch(et){Yn(F,p,et)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)$m(p,h),p=p.sibling}function $m(h,p){var S=h.alternate,M=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:if(xo(p,h),ma(h),M&4){try{Uu(3,h,h.return),pf(3,h)}catch(rr){Yn(h,h.return,rr)}try{Uu(5,h,h.return)}catch(rr){Yn(h,h.return,rr)}}break;case 1:xo(p,h),ma(h),M&512&&S!==null&&sd(S,S.return);break;case 5:if(xo(p,h),ma(h),M&512&&S!==null&&sd(S,S.return),h.flags&32){var F=h.stateNode;try{we(F,"")}catch(rr){Yn(h,h.return,rr)}}if(M&4&&(F=h.stateNode,F!=null)){var $=h.memoizedProps,ie=S!==null?S.memoizedProps:$,Pe=h.type,Le=h.updateQueue;if(h.updateQueue=null,Le!==null)try{Pe==="input"&&$.type==="radio"&&$.name!=null&&vi(F,$),st(Pe,ie);var et=st(Pe,$);for(ie=0;ie<Le.length;ie+=2){var Tt=Le[ie],It=Le[ie+1];Tt==="style"?De(F,It):Tt==="dangerouslySetInnerHTML"?oe(F,It):Tt==="children"?we(F,It):_e(F,Tt,It,et)}switch(Pe){case"input":Xr(F,$);break;case"textarea":Vt(F,$);break;case"select":var wt=F._wrapperState.wasMultiple;F._wrapperState.wasMultiple=!!$.multiple;var Xt=$.value;Xt!=null?Ae(F,!!$.multiple,Xt,!1):wt!==!!$.multiple&&($.defaultValue!=null?Ae(F,!!$.multiple,$.defaultValue,!0):Ae(F,!!$.multiple,$.multiple?[]:"",!1))}F[Li]=$}catch(rr){Yn(h,h.return,rr)}}break;case 6:if(xo(p,h),ma(h),M&4){if(h.stateNode===null)throw Error(s(162));F=h.stateNode,$=h.memoizedProps;try{F.nodeValue=$}catch(rr){Yn(h,h.return,rr)}}break;case 3:if(xo(p,h),ma(h),M&4&&S!==null&&S.memoizedState.isDehydrated)try{oo(p.containerInfo)}catch(rr){Yn(h,h.return,rr)}break;case 4:xo(p,h),ma(h);break;case 13:xo(p,h),ma(h),F=h.child,F.flags&8192&&($=F.memoizedState!==null,F.stateNode.isHidden=$,!$||F.alternate!==null&&F.alternate.memoizedState!==null||(xp=Mn())),M&4&&gy(h);break;case 22:if(Tt=S!==null&&S.memoizedState!==null,h.mode&1?(ls=(et=ls)||Tt,xo(p,h),ls=et):xo(p,h),ma(h),M&8192){if(et=h.memoizedState!==null,(h.stateNode.isHidden=et)&&!Tt&&(h.mode&1)!==0)for(Qt=h,Tt=h.child;Tt!==null;){for(It=Qt=Tt;Qt!==null;){switch(wt=Qt,Xt=wt.child,wt.tag){case 0:case 11:case 14:case 15:Uu(4,wt,wt.return);break;case 1:sd(wt,wt.return);var tr=wt.stateNode;if(typeof tr.componentWillUnmount=="function"){M=wt,S=wt.return;try{p=M,tr.props=p.memoizedProps,tr.state=p.memoizedState,tr.componentWillUnmount()}catch(rr){Yn(M,S,rr)}}break;case 5:sd(wt,wt.return);break;case 22:if(wt.memoizedState!==null){yf(It);continue}}Xt!==null?(Xt.return=wt,Qt=Xt):yf(It)}Tt=Tt.sibling}e:for(Tt=null,It=h;;){if(It.tag===5){if(Tt===null){Tt=It;try{F=It.stateNode,et?($=F.style,typeof $.setProperty=="function"?$.setProperty("display","none","important"):$.display="none"):(Pe=It.stateNode,Le=It.memoizedProps.style,ie=Le!=null&&Le.hasOwnProperty("display")?Le.display:null,Pe.style.display=Oe("display",ie))}catch(rr){Yn(h,h.return,rr)}}}else if(It.tag===6){if(Tt===null)try{It.stateNode.nodeValue=et?"":It.memoizedProps}catch(rr){Yn(h,h.return,rr)}}else if((It.tag!==22&&It.tag!==23||It.memoizedState===null||It===h)&&It.child!==null){It.child.return=It,It=It.child;continue}if(It===h)break e;for(;It.sibling===null;){if(It.return===null||It.return===h)break e;Tt===It&&(Tt=null),It=It.return}Tt===It&&(Tt=null),It.sibling.return=It.return,It=It.sibling}}break;case 19:xo(p,h),ma(h),M&4&&gy(h);break;case 21:break;default:xo(p,h),ma(h)}}function ma(h){var p=h.flags;if(p&2){try{e:{for(var S=h.return;S!==null;){if(bs(S)){var M=S;break e}S=S.return}throw Error(s(160))}switch(M.tag){case 5:var F=M.stateNode;M.flags&32&&(we(F,""),M.flags&=-33);var $=Bm(h);Vm(h,$,F);break;case 3:case 4:var ie=M.stateNode.containerInfo,Pe=Bm(h);gf(h,Pe,ie);break;default:throw Error(s(161))}}catch(Le){Yn(h,h.return,Le)}h.flags&=-3}p&4096&&(h.flags&=-4097)}function z_(h,p,S){Qt=h,yy(h)}function yy(h,p,S){for(var M=(h.mode&1)!==0;Qt!==null;){var F=Qt,$=F.child;if(F.tag===22&&M){var ie=F.memoizedState!==null||id;if(!ie){var Pe=F.alternate,Le=Pe!==null&&Pe.memoizedState!==null||ls;Pe=id;var et=ls;if(id=ie,(ls=Le)&&!et)for(Qt=F;Qt!==null;)ie=Qt,Le=ie.child,ie.tag===22&&ie.memoizedState!==null?vp(F):Le!==null?(Le.return=ie,Qt=Le):vp(F);for(;$!==null;)Qt=$,yy($),$=$.sibling;Qt=F,id=Pe,ls=et}_y(h)}else(F.subtreeFlags&8772)!==0&&$!==null?($.return=F,Qt=$):_y(h)}}function _y(h){for(;Qt!==null;){var p=Qt;if((p.flags&8772)!==0){var S=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:ls||pf(5,p);break;case 1:var M=p.stateNode;if(p.flags&4&&!ls)if(S===null)M.componentDidMount();else{var F=p.elementType===p.type?S.memoizedProps:Hr(p.type,S.memoizedProps);M.componentDidUpdate(F,S.memoizedState,M.__reactInternalSnapshotBeforeUpdate)}var $=p.updateQueue;$!==null&&Gn(p,$,M);break;case 3:var ie=p.updateQueue;if(ie!==null){if(S=null,p.child!==null)switch(p.child.tag){case 5:S=p.child.stateNode;break;case 1:S=p.child.stateNode}Gn(p,ie,S)}break;case 5:var Pe=p.stateNode;if(S===null&&p.flags&4){S=Pe;var Le=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":Le.autoFocus&&S.focus();break;case"img":Le.src&&(S.src=Le.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var et=p.alternate;if(et!==null){var Tt=et.memoizedState;if(Tt!==null){var It=Tt.dehydrated;It!==null&&oo(It)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}ls||p.flags&512&&mf(p)}catch(wt){Yn(p,p.return,wt)}}if(p===h){Qt=null;break}if(S=p.sibling,S!==null){S.return=p.return,Qt=S;break}Qt=p.return}}function yf(h){for(;Qt!==null;){var p=Qt;if(p===h){Qt=null;break}var S=p.sibling;if(S!==null){S.return=p.return,Qt=S;break}Qt=p.return}}function vp(h){for(;Qt!==null;){var p=Qt;try{switch(p.tag){case 0:case 11:case 15:var S=p.return;try{pf(4,p)}catch(Le){Yn(p,S,Le)}break;case 1:var M=p.stateNode;if(typeof M.componentDidMount=="function"){var F=p.return;try{M.componentDidMount()}catch(Le){Yn(p,F,Le)}}var $=p.return;try{mf(p)}catch(Le){Yn(p,$,Le)}break;case 5:var ie=p.return;try{mf(p)}catch(Le){Yn(p,ie,Le)}}}catch(Le){Yn(p,p.return,Le)}if(p===h){Qt=null;break}var Pe=p.sibling;if(Pe!==null){Pe.return=p.return,Qt=Pe;break}Qt=p.return}}var vy=Math.ceil,tl=Ie.ReactCurrentDispatcher,$u=Ie.ReactCurrentOwner,qo=Ie.ReactCurrentBatchConfig,Jr=0,Zi=null,Mi=null,cs=0,bo=0,ad=sa(0),mi=0,_f=null,Nc=0,jc=0,Gm=0,Rn=null,Oi=null,xp=0,Gl=1/0,Zo=null,Bc=!1,bp=null,ql=null,Vc=!1,rl=null,Zl=0,Uc=0,$c=null,Gc=-1,wp=0;function ws(){return(Jr&6)!==0?Mn():Gc!==-1?Gc:Gc=Mn()}function Hs(h){return(h.mode&1)===0?1:(Jr&2)!==0&&cs!==0?cs&-cs:uf.transition!==null?(wp===0&&(wp=gh()),wp):(h=Zr,h!==0||(h=window.event,h=h===void 0?16:za(h.type)),h)}function ga(h,p,S,M){if(50<Uc)throw Uc=0,$c=null,Error(s(185));hl(h,S,M),((Jr&2)===0||h!==Zi)&&(h===Zi&&((Jr&2)===0&&(jc|=S),mi===4&&qc(h,cs)),ks(h,M),S===1&&Jr===0&&(p.mode&1)===0&&(Gl=Mn()+500,ms&&Vs()))}function ks(h,p){var S=h.callbackNode;rp(h,p);var M=cu(h,h===Zi?cs:0);if(M===0)S!==null&&dc(S),h.callbackNode=null,h.callbackPriority=0;else if(p=M&-M,h.callbackPriority!==p){if(S!=null&&dc(S),p===1)h.tag===0?zm(by.bind(null,h)):Bs(by.bind(null,h)),pp(function(){(Jr&6)===0&&Vs()}),S=null;else{switch(hu(M)){case 1:S=ll;break;case 4:S=Bi;break;case 16:S=qr;break;case 536870912:S=cl;break;default:S=qr}S=My(S,ld.bind(null,h))}h.callbackPriority=p,h.callbackNode=S}}function ld(h,p){if(Gc=-1,wp=0,(Jr&6)!==0)throw Error(s(327));var S=h.callbackNode;if(cd()&&h.callbackNode!==S)return null;var M=cu(h,h===Zi?cs:0);if(M===0)return null;if((M&30)!==0||(M&h.expiredLanes)!==0||p)p=Sp(h,M);else{p=M;var F=Jr;Jr|=2;var $=Wm();(Zi!==h||cs!==p)&&(Zo=null,Gl=Mn()+500,ya(h,p));do try{Ty();break}catch(Pe){wy(h,Pe)}while(!0);Hh(),tl.current=$,Jr=F,Mi!==null?p=0:(Zi=null,cs=0,p=mi)}if(p!==0){if(p===2&&(F=mc(h),F!==0&&(M=F,p=vf(h,F))),p===1)throw S=_f,ya(h,0),qc(h,M),ks(h,Mn()),S;if(p===6)qc(h,M);else{if(F=h.current.alternate,(M&30)===0&&!xy(F)&&(p=Sp(h,M),p===2&&($=mc(h),$!==0&&(M=$,p=vf(h,$))),p===1))throw S=_f,ya(h,0),qc(h,M),ks(h,Mn()),S;switch(h.finishedWork=F,h.finishedLanes=M,p){case 0:case 1:throw Error(s(345));case 2:_a(h,Oi,Zo);break;case 3:if(qc(h,M),(M&130023424)===M&&(p=xp+500-Mn(),10<p)){if(cu(h,0)!==0)break;if(F=h.suspendedLanes,(F&M)!==M){ws(),h.pingedLanes|=h.suspendedLanes&F;break}h.timeoutHandle=Il(_a.bind(null,h,Oi,Zo),p);break}_a(h,Oi,Zo);break;case 4:if(qc(h,M),(M&4194240)===M)break;for(p=h.eventTimes,F=-1;0<M;){var ie=31-zs(M);$=1<<ie,ie=p[ie],ie>F&&(F=ie),M&=~$}if(M=F,M=Mn()-M,M=(120>M?120:480>M?480:1080>M?1080:1920>M?1920:3e3>M?3e3:4320>M?4320:1960*vy(M/1960))-M,10<M){h.timeoutHandle=Il(_a.bind(null,h,Oi,Zo),M);break}_a(h,Oi,Zo);break;case 5:_a(h,Oi,Zo);break;default:throw Error(s(329))}}}return ks(h,Mn()),h.callbackNode===S?ld.bind(null,h):null}function vf(h,p){var S=Rn;return h.current.memoizedState.isDehydrated&&(ya(h,p).flags|=256),h=Sp(h,p),h!==2&&(p=Oi,Oi=S,p!==null&&Tp(p)),h}function Tp(h){Oi===null?Oi=h:Oi.push.apply(Oi,h)}function xy(h){for(var p=h;;){if(p.flags&16384){var S=p.updateQueue;if(S!==null&&(S=S.stores,S!==null))for(var M=0;M<S.length;M++){var F=S[M],$=F.getSnapshot;F=F.value;try{if(!uo($(),F))return!1}catch{return!1}}}if(S=p.child,p.subtreeFlags&16384&&S!==null)S.return=p,p=S;else{if(p===h)break;for(;p.sibling===null;){if(p.return===null||p.return===h)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function qc(h,p){for(p&=~Gm,p&=~jc,h.suspendedLanes|=p,h.pingedLanes&=~p,h=h.expirationTimes;0<p;){var S=31-zs(p),M=1<<S;h[S]=-1,p&=~M}}function by(h){if((Jr&6)!==0)throw Error(s(327));cd();var p=cu(h,0);if((p&1)===0)return ks(h,Mn()),null;var S=Sp(h,p);if(h.tag!==0&&S===2){var M=mc(h);M!==0&&(p=M,S=vf(h,M))}if(S===1)throw S=_f,ya(h,0),qc(h,p),ks(h,Mn()),S;if(S===6)throw Error(s(345));return h.finishedWork=h.current.alternate,h.finishedLanes=p,_a(h,Oi,Zo),ks(h,Mn()),null}function qm(h,p){var S=Jr;Jr|=1;try{return h(p)}finally{Jr=S,Jr===0&&(Gl=Mn()+500,ms&&Vs())}}function Gu(h){rl!==null&&rl.tag===0&&(Jr&6)===0&&cd();var p=Jr;Jr|=1;var S=qo.transition,M=Zr;try{if(qo.transition=null,Zr=1,h)return h()}finally{Zr=M,qo.transition=S,Jr=p,(Jr&6)===0&&Vs()}}function Zm(){bo=ad.current,wn(ad)}function ya(h,p){h.finishedWork=null,h.finishedLanes=0;var S=h.timeoutHandle;if(S!==-1&&(h.timeoutHandle=-1,jh(S)),Mi!==null)for(S=Mi.return;S!==null;){var M=S;switch(Wa(M),M.tag){case 1:M=M.type.childContextTypes,M!=null&&ku();break;case 3:jo(),wn(Ci),wn(Pi),ju();break;case 5:zc(M);break;case 4:jo();break;case 13:wn(vn);break;case 19:wn(vn);break;case 10:Xh(M.type._context);break;case 22:case 23:Zm()}S=S.return}if(Zi=h,Mi=h=Wl(h.current,null),cs=bo=p,mi=0,_f=null,Gm=jc=Nc=0,Oi=Rn=null,Kt!==null){for(p=0;p<Kt.length;p++)if(S=Kt[p],M=S.interleaved,M!==null){S.interleaved=null;var F=M.next,$=S.pending;if($!==null){var ie=$.next;$.next=F,M.next=ie}S.pending=M}Kt=null}return h}function wy(h,p){do{var S=Mi;try{if(Hh(),aa.current=Cn,Bl){for(var M=xn.memoizedState;M!==null;){var F=M.queue;F!==null&&(F.pending=null),M=M.next}Bl=!1}if(ca=0,ai=kn=xn=null,Ja=!1,Vl=0,$u.current=null,S===null||S.return===null){mi=1,_f=p,Mi=null;break}e:{var $=h,ie=S.return,Pe=S,Le=p;if(p=cs,Pe.flags|=32768,Le!==null&&typeof Le=="object"&&typeof Le.then=="function"){var et=Le,Tt=Pe,It=Tt.tag;if((Tt.mode&1)===0&&(It===0||It===11||It===15)){var wt=Tt.alternate;wt?(Tt.updateQueue=wt.updateQueue,Tt.memoizedState=wt.memoizedState,Tt.lanes=wt.lanes):(Tt.updateQueue=null,Tt.memoizedState=null)}var Xt=hn(ie);if(Xt!==null){Xt.flags&=-257,li(Xt,ie,Pe,$,p),Xt.mode&1&&pn($,et,p),p=Xt,Le=et;var tr=p.updateQueue;if(tr===null){var rr=new Set;rr.add(Le),p.updateQueue=rr}else tr.add(Le);break e}else{if((p&1)===0){pn($,et,p),Hm();break e}Le=Error(s(426))}}else if(Tn&&Pe.mode&1){var Qn=hn(ie);if(Qn!==null){(Qn.flags&65536)===0&&(Qn.flags|=256),li(Qn,ie,Pe,$,p),Zh(Uo(Le,Pe));break e}}$=Le=Uo(Le,Pe),mi!==4&&(mi=2),Rn===null?Rn=[$]:Rn.push($),$=ie;do{switch($.tag){case 3:$.flags|=65536,p&=-p,$.lanes|=p;var We=Zs($,Le,p);Lc($,We);break e;case 1:Pe=Le;var Fe=$.type,Qe=$.stateNode;if(($.flags&128)===0&&(typeof Fe.getDerivedStateFromError=="function"||Qe!==null&&typeof Qe.componentDidCatch=="function"&&(ql===null||!ql.has(Qe)))){$.flags|=65536,p&=-p,$.lanes|=p;var Rt=Ws($,Pe,p);Lc($,Rt);break e}}$=$.return}while($!==null)}Pp(S)}catch(or){p=or,Mi===S&&S!==null&&(Mi=S=S.return);continue}break}while(!0)}function Wm(){var h=tl.current;return tl.current=Cn,h===null?Cn:h}function Hm(){(mi===0||mi===3||mi===2)&&(mi=4),Zi===null||(Nc&268435455)===0&&(jc&268435455)===0||qc(Zi,cs)}function Sp(h,p){var S=Jr;Jr|=2;var M=Wm();(Zi!==h||cs!==p)&&(Zo=null,ya(h,p));do try{F_();break}catch(F){wy(h,F)}while(!0);if(Hh(),Jr=S,tl.current=M,Mi!==null)throw Error(s(261));return Zi=null,cs=0,mi}function F_(){for(;Mi!==null;)Sy(Mi)}function Ty(){for(;Mi!==null&&!fh();)Sy(Mi)}function Sy(h){var p=Km(h.alternate,h,bo);h.memoizedProps=h.pendingProps,p===null?Pp(h):Mi=p,$u.current=null}function Pp(h){var p=h;do{var S=p.alternate;if(h=p.return,(p.flags&32768)===0){if(S=R_(S,p,bo),S!==null){Mi=S;return}}else{if(S=py(S,p),S!==null){S.flags&=32767,Mi=S;return}if(h!==null)h.flags|=32768,h.subtreeFlags=0,h.deletions=null;else{mi=6,Mi=null;return}}if(p=p.sibling,p!==null){Mi=p;return}Mi=p=h}while(p!==null);mi===0&&(mi=5)}function _a(h,p,S){var M=Zr,F=qo.transition;try{qo.transition=null,Zr=1,Xm(h,p,S,M)}finally{qo.transition=F,Zr=M}return null}function Xm(h,p,S,M){do cd();while(rl!==null);if((Jr&6)!==0)throw Error(s(327));S=h.finishedWork;var F=h.finishedLanes;if(S===null)return null;if(h.finishedWork=null,h.finishedLanes=0,S===h.current)throw Error(s(177));h.callbackNode=null,h.callbackPriority=0;var $=S.lanes|S.childLanes;if(Nd(h,$),h===Zi&&(Mi=Zi=null,cs=0),(S.subtreeFlags&2064)===0&&(S.flags&2064)===0||Vc||(Vc=!0,My(qr,function(){return cd(),null})),$=(S.flags&15990)!==0,(S.subtreeFlags&15990)!==0||$){$=qo.transition,qo.transition=null;var ie=Zr;Zr=1;var Pe=Jr;Jr|=4,$u.current=null,L_(h,S),$m(S,h),Mh(rf),fl=!!Ml,rf=Ml=null,h.current=S,z_(S),fc(),Jr=Pe,Zr=ie,qo.transition=$}else h.current=S;if(Vc&&(Vc=!1,rl=h,Zl=F),$=h.pendingLanes,$===0&&(ql=null),so(S.stateNode),ks(h,Mn()),p!==null)for(M=h.onRecoverableError,S=0;S<p.length;S++)F=p[S],M(F.value,{componentStack:F.stack,digest:F.digest});if(Bc)throw Bc=!1,h=bp,bp=null,h;return(Zl&1)!==0&&h.tag!==0&&cd(),$=h.pendingLanes,($&1)!==0?h===$c?Uc++:(Uc=0,$c=h):Uc=0,Vs(),null}function cd(){if(rl!==null){var h=hu(Zl),p=qo.transition,S=Zr;try{if(qo.transition=null,Zr=16>h?16:h,rl===null)var M=!1;else{if(h=rl,rl=null,Zl=0,(Jr&6)!==0)throw Error(s(331));var F=Jr;for(Jr|=4,Qt=h.current;Qt!==null;){var $=Qt,ie=$.child;if((Qt.flags&16)!==0){var Pe=$.deletions;if(Pe!==null){for(var Le=0;Le<Pe.length;Le++){var et=Pe[Le];for(Qt=et;Qt!==null;){var Tt=Qt;switch(Tt.tag){case 0:case 11:case 15:Uu(8,Tt,$)}var It=Tt.child;if(It!==null)It.return=Tt,Qt=It;else for(;Qt!==null;){Tt=Qt;var wt=Tt.sibling,Xt=Tt.return;if(od(Tt),Tt===et){Qt=null;break}if(wt!==null){wt.return=Xt,Qt=wt;break}Qt=Xt}}}var tr=$.alternate;if(tr!==null){var rr=tr.child;if(rr!==null){tr.child=null;do{var Qn=rr.sibling;rr.sibling=null,rr=Qn}while(rr!==null)}}Qt=$}}if(($.subtreeFlags&2064)!==0&&ie!==null)ie.return=$,Qt=ie;else e:for(;Qt!==null;){if($=Qt,($.flags&2048)!==0)switch($.tag){case 0:case 11:case 15:Uu(9,$,$.return)}var We=$.sibling;if(We!==null){We.return=$.return,Qt=We;break e}Qt=$.return}}var Fe=h.current;for(Qt=Fe;Qt!==null;){ie=Qt;var Qe=ie.child;if((ie.subtreeFlags&2064)!==0&&Qe!==null)Qe.return=ie,Qt=Qe;else e:for(ie=Fe;Qt!==null;){if(Pe=Qt,(Pe.flags&2048)!==0)try{switch(Pe.tag){case 0:case 11:case 15:pf(9,Pe)}}catch(or){Yn(Pe,Pe.return,or)}if(Pe===ie){Qt=null;break e}var Rt=Pe.sibling;if(Rt!==null){Rt.return=Pe.return,Qt=Rt;break e}Qt=Pe.return}}if(Jr=F,Vs(),Vi&&typeof Vi.onPostCommitFiberRoot=="function")try{Vi.onPostCommitFiberRoot(Aa,h)}catch{}M=!0}return M}finally{Zr=S,qo.transition=p}}return!1}function Py(h,p,S){p=Uo(S,p),p=Zs(h,p,1),h=Ya(h,p,1),p=ws(),h!==null&&(hl(h,1,p),ks(h,p))}function Yn(h,p,S){if(h.tag===3)Py(h,h,S);else for(;p!==null;){if(p.tag===3){Py(p,h,S);break}else if(p.tag===1){var M=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(ql===null||!ql.has(M))){h=Uo(S,h),h=Ws(p,h,1),p=Ya(p,h,1),h=ws(),p!==null&&(hl(p,1,h),ks(p,h));break}}p=p.return}}function Cy(h,p,S){var M=h.pingCache;M!==null&&M.delete(p),p=ws(),h.pingedLanes|=h.suspendedLanes&S,Zi===h&&(cs&S)===S&&(mi===4||mi===3&&(cs&130023424)===cs&&500>Mn()-xp?ya(h,0):Gm|=S),ks(h,p)}function Ey(h,p){p===0&&((h.mode&1)===0?p=1:(p=lu,lu<<=1,(lu&130023424)===0&&(lu=4194304)));var S=ws();h=qs(h,p),h!==null&&(hl(h,p,S),ks(h,S))}function O_(h){var p=h.memoizedState,S=0;p!==null&&(S=p.retryLane),Ey(h,S)}function xf(h,p){var S=0;switch(h.tag){case 13:var M=h.stateNode,F=h.memoizedState;F!==null&&(S=F.retryLane);break;case 19:M=h.stateNode;break;default:throw Error(s(314))}M!==null&&M.delete(p),Ey(h,S)}var Km;Km=function(h,p,S){if(h!==null)if(h.memoizedProps!==p.pendingProps||Ci.current)as=!0;else{if((h.lanes&S)===0&&(p.flags&128)===0)return as=!1,rd(h,p,S);as=(h.flags&131072)!==0}else as=!1,Tn&&(p.flags&1048576)!==0&&Ru(p,Du,p.index);switch(p.lanes=0,p.tag){case 2:var M=p.type;Ul(h,p),h=p.pendingProps;var F=qa(p,Pi.current);Fo(p,S),F=d(null,p,M,h,F,S);var $=g();return p.flags|=1,typeof F=="object"&&F!==null&&typeof F.render=="function"&&F.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,$i(M)?($=!0,go(p)):$=!1,p.memoizedState=F.state!==null&&F.state!==void 0?F.state:null,ys(p),F.updater=_o,p.stateNode=F,F._reactInternals=p,ua(p,M,h,S),p=Bu(null,p,M,!0,$,S)):(p.tag=0,Tn&&$&&Lu(p),Gi(null,p,F,S),p=p.child),p;case 16:M=p.elementType;e:{switch(Ul(h,p),h=p.pendingProps,F=M._init,M=F(M._payload),p.type=M,F=p.tag=j_(M),h=Hr(M,h),F){case 0:p=Go(null,p,M,h,S);break e;case 1:p=fa(null,p,M,h,S);break e;case 11:p=el(null,p,M,h,S);break e;case 14:p=mp(null,p,M,Hr(M.type,h),S);break e}throw Error(s(306,M,""))}return p;case 0:return M=p.type,F=p.pendingProps,F=p.elementType===M?F:Hr(M,F),Go(h,p,M,F,S);case 1:return M=p.type,F=p.pendingProps,F=p.elementType===M?F:Hr(M,F),fa(h,p,M,F,S);case 3:e:{if(Jh(p),h===null)throw Error(s(387));M=p.pendingProps,$=p.memoizedState,F=$.element,Kh(h,p),_n(p,M,null,S);var ie=p.memoizedState;if(M=ie.element,$.isDehydrated)if($={element:M,isDehydrated:!1,cache:ie.cache,pendingSuspenseBoundaries:ie.pendingSuspenseBoundaries,transitions:ie.transitions},p.updateQueue.baseState=$,p.memoizedState=$,p.flags&256){F=Uo(Error(s(423)),p),p=Vu(h,p,M,S,F);break e}else if(M!==F){F=Uo(Error(s(424)),p),p=Vu(h,p,M,S,F);break e}else for(Fi=ia(p.stateNode.containerInfo.firstChild),zi=p,Tn=!0,ss=null,S=Rc(p,null,M,S),p.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling;else{if(Xa(),M===F){p=$l(h,p,S);break e}Gi(h,p,M,S)}p=p.child}return p;case 5:return Bo(p),h===null&&lf(p),M=p.type,F=p.pendingProps,$=h!==null?h.memoizedProps:null,ie=F.children,Nh(M,F)?ie=null:$!==null&&Nh(M,$)&&(p.flags|=32),da(h,p),Gi(h,p,ie,S),p.child;case 6:return h===null&&lf(p),null;case 13:return Fm(h,p,S);case 4:return Nu(p,p.stateNode.containerInfo),M=p.pendingProps,h===null?p.child=Dc(p,null,M,S):Gi(h,p,M,S),p.child;case 11:return M=p.type,F=p.pendingProps,F=p.elementType===M?F:Hr(M,F),el(h,p,M,F,S);case 7:return Gi(h,p,p.pendingProps,S),p.child;case 8:return Gi(h,p,p.pendingProps.children,S),p.child;case 12:return Gi(h,p,p.pendingProps.children,S),p.child;case 10:e:{if(M=p.type._context,F=p.pendingProps,$=p.memoizedProps,ie=F.value,Wr(Ll,M._currentValue),M._currentValue=ie,$!==null)if(uo($.value,ie)){if($.children===F.children&&!Ci.current){p=$l(h,p,S);break e}}else for($=p.child,$!==null&&($.return=p);$!==null;){var Pe=$.dependencies;if(Pe!==null){ie=$.child;for(var Le=Pe.firstContext;Le!==null;){if(Le.context===M){if($.tag===1){Le=Oo(-1,S&-S),Le.tag=2;var et=$.updateQueue;if(et!==null){et=et.shared;var Tt=et.pending;Tt===null?Le.next=Le:(Le.next=Tt.next,Tt.next=Le),et.pending=Le}}$.lanes|=S,Le=$.alternate,Le!==null&&(Le.lanes|=S),As($.return,S,p),Pe.lanes|=S;break}Le=Le.next}}else if($.tag===10)ie=$.type===p.type?null:$.child;else if($.tag===18){if(ie=$.return,ie===null)throw Error(s(341));ie.lanes|=S,Pe=ie.alternate,Pe!==null&&(Pe.lanes|=S),As(ie,S,p),ie=$.sibling}else ie=$.child;if(ie!==null)ie.return=$;else for(ie=$;ie!==null;){if(ie===p){ie=null;break}if($=ie.sibling,$!==null){$.return=ie.return,ie=$;break}ie=ie.return}$=ie}Gi(h,p,F.children,S),p=p.child}return p;case 9:return F=p.type,M=p.pendingProps.children,Fo(p,S),F=jt(F),M=M(F),p.flags|=1,Gi(h,p,M,S),p.child;case 14:return M=p.type,F=Hr(M,p.pendingProps),F=Hr(M.type,F),mp(h,p,M,F,S);case 15:return hf(h,p,p.type,p.pendingProps,S);case 17:return M=p.type,F=p.pendingProps,F=p.elementType===M?F:Hr(M,F),Ul(h,p),p.tag=1,$i(M)?(h=!0,go(p)):h=!1,Fo(p,S),vo(p,M,F),ua(p,M,F,S),Bu(null,p,M,!0,h,S);case 19:return Nm(h,p,S);case 22:return Qh(h,p,S)}throw Error(s(156,p.tag))};function My(h,p){return hc(h,p)}function N_(h,p,S,M){this.tag=h,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wo(h,p,S,M){return new N_(h,p,S,M)}function Ym(h){return h=h.prototype,!(!h||!h.isReactComponent)}function j_(h){if(typeof h=="function")return Ym(h)?1:0;if(h!=null){if(h=h.$$typeof,h===lt)return 11;if(h===gt)return 14}return 2}function Wl(h,p){var S=h.alternate;return S===null?(S=Wo(h.tag,p,h.key,h.mode),S.elementType=h.elementType,S.type=h.type,S.stateNode=h.stateNode,S.alternate=h,h.alternate=S):(S.pendingProps=p,S.type=h.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=h.flags&14680064,S.childLanes=h.childLanes,S.lanes=h.lanes,S.child=h.child,S.memoizedProps=h.memoizedProps,S.memoizedState=h.memoizedState,S.updateQueue=h.updateQueue,p=h.dependencies,S.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},S.sibling=h.sibling,S.index=h.index,S.ref=h.ref,S}function ud(h,p,S,M,F,$){var ie=2;if(M=h,typeof h=="function")Ym(h)&&(ie=1);else if(typeof h=="string")ie=5;else e:switch(h){case He:return Zc(S.children,F,$,p);case nt:ie=8,F|=8;break;case Pt:return h=Wo(12,S,p,F|2),h.elementType=Pt,h.lanes=$,h;case Et:return h=Wo(13,S,p,F),h.elementType=Et,h.lanes=$,h;case ft:return h=Wo(19,S,p,F),h.elementType=ft,h.lanes=$,h;case mt:return bf(S,F,$,p);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case Ct:ie=10;break e;case Zt:ie=9;break e;case lt:ie=11;break e;case gt:ie=14;break e;case dt:ie=16,M=null;break e}throw Error(s(130,h==null?h:typeof h,""))}return p=Wo(ie,S,p,F),p.elementType=h,p.type=M,p.lanes=$,p}function Zc(h,p,S,M){return h=Wo(7,h,M,p),h.lanes=S,h}function bf(h,p,S,M){return h=Wo(22,h,M,p),h.elementType=mt,h.lanes=S,h.stateNode={isHidden:!1},h}function Cp(h,p,S){return h=Wo(6,h,null,p),h.lanes=S,h}function Qm(h,p,S){return p=Wo(4,h.children!==null?h.children:[],h.key,p),p.lanes=S,p.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},p}function Ep(h,p,S,M,F){this.tag=p,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uu(0),this.expirationTimes=uu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uu(0),this.identifierPrefix=M,this.onRecoverableError=F,this.mutableSourceEagerHydrationData=null}function Jm(h,p,S,M,F,$,ie,Pe,Le){return h=new Ep(h,p,S,Pe,Le),p===1?(p=1,$===!0&&(p|=8)):p=0,$=Wo(3,null,null,p),h.current=$,$.stateNode=h,$.memoizedState={element:M,isDehydrated:S,cache:null,transitions:null,pendingSuspenseBoundaries:null},ys($),h}function Iy(h,p,S){var M=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Je,key:M==null?null:""+M,children:h,containerInfo:p,implementation:S}}function Ay(h){if(!h)return Lo;h=h._reactInternals;e:{if(_r(h)!==h||h.tag!==1)throw Error(s(170));var p=h;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if($i(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(s(171))}if(h.tag===1){var S=h.type;if($i(S))return $h(h,S,p)}return p}function ky(h,p,S,M,F,$,ie,Pe,Le){return h=Jm(S,M,!0,h,F,$,ie,Pe,Le),h.context=Ay(null),S=h.current,M=ws(),F=Hs(S),$=Oo(M,F),$.callback=p??null,Ya(S,$,F),h.current.lanes=F,hl(h,F,M),ks(h,M),h}function Mp(h,p,S,M){var F=p.current,$=ws(),ie=Hs(F);return S=Ay(S),p.context===null?p.context=S:p.pendingContext=S,p=Oo($,ie),p.payload={element:h},M=M===void 0?null:M,M!==null&&(p.callback=M),h=Ya(F,p,ie),h!==null&&(ga(h,F,ie,$),Yh(h,F,ie)),ie}function wf(h){return h=h.current,h.child?(h.child.tag===5,h.child.stateNode):null}function Dy(h,p){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var S=h.retryLane;h.retryLane=S!==0&&S<p?S:p}}function eg(h,p){Dy(h,p),(h=h.alternate)&&Dy(h,p)}function Ii(){return null}var hd=typeof reportError=="function"?reportError:function(h){console.error(h)};function tg(h){this._internalRoot=h}Ip.prototype.render=tg.prototype.render=function(h){var p=this._internalRoot;if(p===null)throw Error(s(409));Mp(h,p,null,null)},Ip.prototype.unmount=tg.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var p=h.containerInfo;Gu(function(){Mp(null,h,null,null)}),p[js]=null}};function Ip(h){this._internalRoot=h}Ip.prototype.unstable_scheduleHydration=function(h){if(h){var p=gc();h={blockedOn:null,target:h,priority:p};for(var S=0;S<Yr.length&&p!==0&&p<Yr[S].priority;S++);Yr.splice(S,0,h),S===0&&fs(h)}};function Ap(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}function Tf(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11&&(h.nodeType!==8||h.nodeValue!==" react-mount-point-unstable "))}function Ry(){}function Ly(h,p,S,M,F){if(F){if(typeof M=="function"){var $=M;M=function(){var et=wf(ie);$.call(et)}}var ie=ky(p,M,h,0,null,!1,!1,"",Ry);return h._reactRootContainer=ie,h[js]=ie.current,Pl(h.nodeType===8?h.parentNode:h),Gu(),ie}for(;F=h.lastChild;)h.removeChild(F);if(typeof M=="function"){var Pe=M;M=function(){var et=wf(Le);Pe.call(et)}}var Le=Jm(h,0,!1,null,null,!1,!1,"",Ry);return h._reactRootContainer=Le,h[js]=Le.current,Pl(h.nodeType===8?h.parentNode:h),Gu(function(){Mp(p,Le,S,M)}),Le}function Sf(h,p,S,M,F){var $=S._reactRootContainer;if($){var ie=$;if(typeof F=="function"){var Pe=F;F=function(){var Le=wf(ie);Pe.call(Le)}}Mp(p,ie,h,F)}else ie=Ly(S,p,h,F,M);return wf(ie)}Bd=function(h){switch(h.tag){case 3:var p=h.stateNode;if(p.current.memoizedState.isDehydrated){var S=ea(p.pendingLanes);S!==0&&(jd(p,S|1),ks(p,Mn()),(Jr&6)===0&&(Gl=Mn()+500,Vs()))}break;case 13:Gu(function(){var M=qs(h,1);if(M!==null){var F=ws();ga(M,h,1,F)}}),eg(h,1)}},ka=function(h){if(h.tag===13){var p=qs(h,134217728);if(p!==null){var S=ws();ga(p,h,134217728,S)}eg(h,134217728)}},yh=function(h){if(h.tag===13){var p=Hs(h),S=qs(h,p);if(S!==null){var M=ws();ga(S,h,p,M)}eg(h,p)}},gc=function(){return Zr},ta=function(h,p){var S=Zr;try{return Zr=h,p()}finally{Zr=S}},hr=function(h,p,S){switch(p){case"input":if(Xr(h,S),p=S.name,S.type==="radio"&&p!=null){for(S=h;S.parentNode;)S=S.parentNode;for(S=S.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<S.length;p++){var M=S[p];if(M!==h&&M.form===h.form){var F=Au(M);if(!F)throw Error(s(90));jr(M),Xr(M,F)}}}break;case"textarea":Vt(h,S);break;case"select":p=S.value,p!=null&&Ae(h,!!S.multiple,p,!1)}},fr=qm,Kr=Gu;var dd={usingClientEntryPoint:!1,Events:[po,mo,Au,an,xi,qm]},qu={findFiberByHostInstance:fo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zy={bundleType:qu.bundleType,version:qu.version,rendererPackageName:qu.rendererPackageName,rendererConfig:qu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ie.ReactCurrentDispatcher,findHostInstanceByFiber:function(h){return h=Io(h),h===null?null:h.stateNode},findFiberByHostInstance:qu.findFiberByHostInstance||Ii,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pf.isDisabled&&Pf.supportsFiber)try{Aa=Pf.inject(zy),Vi=Pf}catch{}}return Xo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dd,Xo.createPortal=function(h,p){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ap(p))throw Error(s(200));return Iy(h,p,null,S)},Xo.createRoot=function(h,p){if(!Ap(h))throw Error(s(299));var S=!1,M="",F=hd;return p!=null&&(p.unstable_strictMode===!0&&(S=!0),p.identifierPrefix!==void 0&&(M=p.identifierPrefix),p.onRecoverableError!==void 0&&(F=p.onRecoverableError)),p=Jm(h,1,!1,null,null,S,!1,M,F),h[js]=p.current,Pl(h.nodeType===8?h.parentNode:h),new tg(p)},Xo.findDOMNode=function(h){if(h==null)return null;if(h.nodeType===1)return h;var p=h._reactInternals;if(p===void 0)throw typeof h.render=="function"?Error(s(188)):(h=Object.keys(h).join(","),Error(s(268,h)));return h=Io(p),h=h===null?null:h.stateNode,h},Xo.flushSync=function(h){return Gu(h)},Xo.hydrate=function(h,p,S){if(!Tf(p))throw Error(s(200));return Sf(null,h,p,!0,S)},Xo.hydrateRoot=function(h,p,S){if(!Ap(h))throw Error(s(405));var M=S!=null&&S.hydratedSources||null,F=!1,$="",ie=hd;if(S!=null&&(S.unstable_strictMode===!0&&(F=!0),S.identifierPrefix!==void 0&&($=S.identifierPrefix),S.onRecoverableError!==void 0&&(ie=S.onRecoverableError)),p=ky(p,null,h,1,S??null,F,!1,$,ie),h[js]=p.current,Pl(h),M)for(h=0;h<M.length;h++)S=M[h],F=S._getVersion,F=F(S._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[S,F]:p.mutableSourceEagerHydrationData.push(S,F);return new Ip(p)},Xo.render=function(h,p,S){if(!Tf(p))throw Error(s(200));return Sf(null,h,p,!1,S)},Xo.unmountComponentAtNode=function(h){if(!Tf(h))throw Error(s(40));return h._reactRootContainer?(Gu(function(){Sf(null,null,h,!1,function(){h._reactRootContainer=null,h[js]=null})}),!0):!1},Xo.unstable_batchedUpdates=qm,Xo.unstable_renderSubtreeIntoContainer=function(h,p,S,M){if(!Tf(S))throw Error(s(200));if(h==null||h._reactInternals===void 0)throw Error(s(38));return Sf(h,p,S,!1,M)},Xo.version="18.3.1-next-f1338f8080-20240426",Xo}var Pb;function h6(){if(Pb)return Tv.exports;Pb=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(n){console.error(n)}}return r(),Tv.exports=MC(),Tv.exports}var Cb;function IC(){if(Cb)return Jy;Cb=1;var r=h6();return Jy.createRoot=r.createRoot,Jy.hydrateRoot=r.hydrateRoot,Jy}var AC=IC();function kC(r,n){if(r instanceof RegExp)return{keys:!1,pattern:r};var s,u,m,x,v=[],l="",A=r.split("/");for(A[0]||A.shift();m=A.shift();)s=m[0],s==="*"?(v.push(s),l+=m[1]==="?"?"(?:/(.*))?":"/(.*)"):s===":"?(u=m.indexOf("?",1),x=m.indexOf(".",1),v.push(m.substring(1,~u?u:~x?x:m.length)),l+=~u&&!~x?"(?:/([^/]+?))?":"/([^/]+?)",~x&&(l+=(~u?"?":"")+"\\"+m.substring(x))):l+="/"+m;return{keys:v,pattern:new RegExp("^"+l+(n?"(?=$|/)":"/?$"),"i")}}var j=t_();const gr=lx(j),d6=u6({__proto__:null,default:gr},[j]);var Cv={exports:{}},Ev={};var Eb;function DC(){if(Eb)return Ev;Eb=1;var r=t_();function n(B,W){return B===W&&(B!==0||1/B===1/W)||B!==B&&W!==W}var s=typeof Object.is=="function"?Object.is:n,u=r.useState,m=r.useEffect,x=r.useLayoutEffect,v=r.useDebugValue;function l(B,W){var re=W(),ce=u({inst:{value:re,getSnapshot:W}}),Q=ce[0].inst,X=ce[1];return x(function(){Q.value=re,Q.getSnapshot=W,A(Q)&&X({inst:Q})},[B,re,W]),m(function(){return A(Q)&&X({inst:Q}),B(function(){A(Q)&&X({inst:Q})})},[B]),v(re),re}function A(B){var W=B.getSnapshot;B=B.value;try{var re=W();return!s(B,re)}catch{return!0}}function R(B,W){return W()}var L=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?R:l;return Ev.useSyncExternalStore=r.useSyncExternalStore!==void 0?r.useSyncExternalStore:L,Ev}var Mb;function RC(){return Mb||(Mb=1,Cv.exports=DC()),Cv.exports}var LC=RC();const zC=d6.useInsertionEffect,FC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",OC=FC?j.useLayoutEffect:j.useEffect,NC=zC||OC,f6=r=>{const n=j.useRef([r,(...s)=>n[0](...s)]).current;return NC(()=>{n[0]=r}),n[1]},jC="popstate",cx="pushState",ux="replaceState",BC="hashchange",Ib=[jC,cx,ux,BC],VC=r=>{for(const n of Ib)addEventListener(n,r);return()=>{for(const n of Ib)removeEventListener(n,r)}},p6=(r,n)=>LC.useSyncExternalStore(VC,r,n),UC=()=>location.search,$C=({ssrSearch:r=""}={})=>p6(UC,()=>r),Ab=()=>location.pathname,GC=({ssrPath:r}={})=>p6(Ab,r?()=>r:Ab),qC=(r,{replace:n=!1,state:s=null}={})=>history[n?ux:cx](s,"",r),ZC=(r={})=>[GC(r),qC],kb=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[kb]>"u"){for(const r of[cx,ux]){const n=history[r];history[r]=function(){const s=n.apply(this,arguments),u=new Event(r);return u.arguments=arguments,dispatchEvent(u),s}}Object.defineProperty(window,kb,{value:!0})}const WC=(r,n)=>n.toLowerCase().indexOf(r.toLowerCase())?"~"+n:n.slice(r.length)||"/",m6=(r="")=>r==="/"?"":r,HC=(r,n)=>r[0]==="~"?r.slice(1):m6(n)+r,XC=(r="",n)=>WC(Db(m6(r)),Db(n)),Db=r=>{try{return decodeURI(r)}catch{return r}},g6={hook:ZC,searchHook:$C,parser:kC,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:r=>r},y6=j.createContext(g6),Qg=()=>j.useContext(y6),_6={},v6=j.createContext(_6),KC=()=>j.useContext(v6),r_=r=>{const[n,s]=r.hook(r);return[XC(r.base,n),f6((u,m)=>s(HC(u,r.base),m))]},x6=()=>r_(Qg()),b6=(r,n,s,u)=>{const{pattern:m,keys:x}=n instanceof RegExp?{keys:!1,pattern:n}:r(n||"*",u),v=m.exec(s)||[],[l,...A]=v;return l!==void 0?[!0,(()=>{const R=x!==!1?Object.fromEntries(x.map((B,W)=>[B,A[W]])):v.groups;let L={...A};return R&&Object.assign(L,R),L})(),...u?[l]:[]]:[!1,null]},YC=({children:r,...n})=>{const s=Qg(),u=n.hook?g6:s;let m=u;const[x,v]=n.ssrPath?.split("?")??[];v&&(n.ssrSearch=v,n.ssrPath=x),n.hrefs=n.hrefs??n.hook?.hrefs;let l=j.useRef({}),A=l.current,R=A;for(let L in u){const B=L==="base"?u[L]+(n[L]||""):n[L]||u[L];A===R&&B!==R[L]&&(l.current=R={...R}),R[L]=B,B!==u[L]&&(m=R)}return j.createElement(y6.Provider,{value:m,children:r})},Rb=({children:r,component:n},s)=>n?j.createElement(n,{params:s}):typeof r=="function"?r(s):r,QC=r=>{let n=j.useRef(_6),s=n.current;for(const u in r)r[u]!==s[u]&&(s=r);return Object.keys(r).length===0&&(s=r),n.current=s},e0=({path:r,nest:n,match:s,...u})=>{const m=Qg(),[x]=r_(m),[v,l,A]=s??b6(m.parser,r,x,n),R=QC({...KC(),...l});if(!v)return null;const L=A?j.createElement(YC,{base:A},Rb(u,R)):Rb(u,R);return j.createElement(v6.Provider,{value:R,children:L})},Lb=j.forwardRef((r,n)=>{const s=Qg(),[u,m]=r_(s),{to:x="",href:v=x,onClick:l,asChild:A,children:R,className:L,replace:B,state:W,...re}=r,ce=f6(X=>{X.ctrlKey||X.metaKey||X.altKey||X.shiftKey||X.button!==0||(l?.(X),X.defaultPrevented||(X.preventDefault(),m(v,r)))}),Q=s.hrefs(v[0]==="~"?v.slice(1):s.base+v,s);return A&&j.isValidElement(R)?j.cloneElement(R,{onClick:ce,href:Q}):j.createElement("a",{...re,onClick:ce,href:Q,className:L?.call?L(u===v):L,children:R,ref:n})}),w6=r=>Array.isArray(r)?r.flatMap(n=>w6(n&&n.type===j.Fragment?n.props.children:n)):[r],JC=({children:r,location:n})=>{const s=Qg(),[u]=r_(s);for(const m of w6(r)){let x=0;if(j.isValidElement(m)&&(x=b6(s.parser,m.props.path,n||u,m.props.nest))[0])return j.cloneElement(m,{match:x})}return null};var wm=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Uf=typeof window>"u"||"Deno"in globalThis;function ol(){}function eE(r,n){return typeof r=="function"?r(n):r}function h1(r){return typeof r=="number"&&r>=0&&r!==1/0}function T6(r,n){return Math.max(r+(n||0)-Date.now(),0)}function im(r,n){return typeof r=="function"?r(n):r}function rc(r,n){return typeof r=="function"?r(n):r}function zb(r,n){const{type:s="all",exact:u,fetchStatus:m,predicate:x,queryKey:v,stale:l}=r;if(v){if(u){if(n.queryHash!==hx(v,n.options))return!1}else if(!Eg(n.queryKey,v))return!1}if(s!=="all"){const A=n.isActive();if(s==="active"&&!A||s==="inactive"&&A)return!1}return!(typeof l=="boolean"&&n.isStale()!==l||m&&m!==n.state.fetchStatus||x&&!x(n))}function Fb(r,n){const{exact:s,status:u,predicate:m,mutationKey:x}=r;if(x){if(!n.options.mutationKey)return!1;if(s){if($f(n.options.mutationKey)!==$f(x))return!1}else if(!Eg(n.options.mutationKey,x))return!1}return!(u&&n.state.status!==u||m&&!m(n))}function hx(r,n){return(n?.queryKeyHashFn||$f)(r)}function $f(r){return JSON.stringify(r,(n,s)=>d1(s)?Object.keys(s).sort().reduce((u,m)=>(u[m]=s[m],u),{}):s)}function Eg(r,n){return r===n?!0:typeof r!=typeof n?!1:r&&n&&typeof r=="object"&&typeof n=="object"?!Object.keys(n).some(s=>!Eg(r[s],n[s])):!1}function S6(r,n){if(r===n)return r;const s=Ob(r)&&Ob(n);if(s||d1(r)&&d1(n)){const u=s?r:Object.keys(r),m=u.length,x=s?n:Object.keys(n),v=x.length,l=s?[]:{};let A=0;for(let R=0;R<v;R++){const L=s?R:x[R];(!s&&u.includes(L)||s)&&r[L]===void 0&&n[L]===void 0?(l[L]=void 0,A++):(l[L]=S6(r[L],n[L]),l[L]===r[L]&&r[L]!==void 0&&A++)}return m===v&&A===m?r:l}return n}function T0(r,n){if(!n||Object.keys(r).length!==Object.keys(n).length)return!1;for(const s in r)if(r[s]!==n[s])return!1;return!0}function Ob(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function d1(r){if(!Nb(r))return!1;const n=r.constructor;if(n===void 0)return!0;const s=n.prototype;return!(!Nb(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function Nb(r){return Object.prototype.toString.call(r)==="[object Object]"}function tE(r){return new Promise(n=>{setTimeout(n,r)})}function f1(r,n,s){return typeof s.structuralSharing=="function"?s.structuralSharing(r,n):s.structuralSharing!==!1?S6(r,n):n}function rE(r,n,s=0){const u=[...r,n];return s&&u.length>s?u.slice(1):u}function nE(r,n,s=0){const u=[n,...r];return s&&u.length>s?u.slice(0,-1):u}var dx=Symbol();function P6(r,n){return!r.queryFn&&n?.initialPromise?()=>n.initialPromise:!r.queryFn||r.queryFn===dx?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}var iE=class extends wm{#e;#t;#n;constructor(){super(),this.#n=r=>{if(!Uf&&window.addEventListener){const n=()=>r();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(r){this.#n=r,this.#t?.(),this.#t=r(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()})}setFocused(r){this.#e!==r&&(this.#e=r,this.onFocus())}onFocus(){const r=this.isFocused();this.listeners.forEach(n=>{n(r)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},fx=new iE,sE=class extends wm{#e=!0;#t;#n;constructor(){super(),this.#n=r=>{if(!Uf&&window.addEventListener){const n=()=>r(!0),s=()=>r(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(r){this.#n=r,this.#t?.(),this.#t=r(this.setOnline.bind(this))}setOnline(r){this.#e!==r&&(this.#e=r,this.listeners.forEach(s=>{s(r)}))}isOnline(){return this.#e}},S0=new sE;function p1(){let r,n;const s=new Promise((m,x)=>{r=m,n=x});s.status="pending",s.catch(()=>{});function u(m){Object.assign(s,m),delete s.resolve,delete s.reject}return s.resolve=m=>{u({status:"fulfilled",value:m}),r(m)},s.reject=m=>{u({status:"rejected",reason:m}),n(m)},s}function oE(r){return Math.min(1e3*2**r,3e4)}function C6(r){return(r??"online")==="online"?S0.isOnline():!0}var E6=class extends Error{constructor(r){super("CancelledError"),this.revert=r?.revert,this.silent=r?.silent}};function Mv(r){return r instanceof E6}function M6(r){let n=!1,s=0,u=!1,m;const x=p1(),v=Q=>{u||(W(new E6(Q)),r.abort?.())},l=()=>{n=!0},A=()=>{n=!1},R=()=>fx.isFocused()&&(r.networkMode==="always"||S0.isOnline())&&r.canRun(),L=()=>C6(r.networkMode)&&r.canRun(),B=Q=>{u||(u=!0,r.onSuccess?.(Q),m?.(),x.resolve(Q))},W=Q=>{u||(u=!0,r.onError?.(Q),m?.(),x.reject(Q))},re=()=>new Promise(Q=>{m=X=>{(u||R())&&Q(X)},r.onPause?.()}).then(()=>{m=void 0,u||r.onContinue?.()}),ce=()=>{if(u)return;let Q;const X=s===0?r.initialPromise:void 0;try{Q=X??r.fn()}catch(le){Q=Promise.reject(le)}Promise.resolve(Q).then(B).catch(le=>{if(u)return;const he=r.retry??(Uf?0:3),_e=r.retryDelay??oE,Ie=typeof _e=="function"?_e(s,le):_e,ke=he===!0||typeof he=="number"&&s<he||typeof he=="function"&&he(s,le);if(n||!ke){W(le);return}s++,r.onFail?.(s,le),tE(Ie).then(()=>R()?void 0:re()).then(()=>{n?W(le):ce()})})};return{promise:x,cancel:v,continue:()=>(m?.(),x),cancelRetry:l,continueRetry:A,canStart:L,start:()=>(L()?ce():re().then(ce),x)}}function aE(){let r=[],n=0,s=l=>{l()},u=l=>{l()},m=l=>setTimeout(l,0);const x=l=>{n?r.push(l):m(()=>{s(l)})},v=()=>{const l=r;r=[],l.length&&m(()=>{u(()=>{l.forEach(A=>{s(A)})})})};return{batch:l=>{let A;n++;try{A=l()}finally{n--,n||v()}return A},batchCalls:l=>(...A)=>{x(()=>{l(...A)})},schedule:x,setNotifyFunction:l=>{s=l},setBatchNotifyFunction:l=>{u=l},setScheduler:l=>{m=l}}}var hs=aE(),I6=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),h1(this.gcTime)&&(this.#e=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(Uf?1/0:300*1e3))}clearGcTimeout(){this.#e&&(clearTimeout(this.#e),this.#e=void 0)}},lE=class extends I6{#e;#t;#n;#r;#o;#s;constructor(r){super(),this.#s=!1,this.#o=r.defaultOptions,this.setOptions(r.options),this.observers=[],this.#n=r.cache,this.queryKey=r.queryKey,this.queryHash=r.queryHash,this.#e=cE(this.options),this.state=r.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(r){this.options={...this.#o,...r},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(r,n){const s=f1(this.state.data,r,this.options);return this.#i({data:s,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),s}setState(r,n){this.#i({type:"setState",state:r,setStateOptions:n})}cancel(r){const n=this.#r?.promise;return this.#r?.cancel(r),n?n.then(ol).catch(ol):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(r=>rc(r.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===dx||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(r=>r.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(r=0){return this.state.isInvalidated||this.state.data===void 0||!T6(this.state.dataUpdatedAt,r)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(r){this.observers.includes(r)||(this.observers.push(r),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:r}))}removeObserver(r){this.observers.includes(r)&&(this.observers=this.observers.filter(n=>n!==r),this.observers.length||(this.#r&&(this.#s?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:r}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}fetch(r,n){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(r&&this.setOptions(r),!this.options.queryFn){const l=this.observers.find(A=>A.options.queryFn);l&&this.setOptions(l.options)}const s=new AbortController,u=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(this.#s=!0,s.signal)})},m=()=>{const l=P6(this.options,n),A={queryKey:this.queryKey,meta:this.meta};return u(A),this.#s=!1,this.options.persister?this.options.persister(l,A,this):l(A)},x={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:m};u(x),this.options.behavior?.onFetch(x,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==x.fetchOptions?.meta)&&this.#i({type:"fetch",meta:x.fetchOptions?.meta});const v=l=>{Mv(l)&&l.silent||this.#i({type:"error",error:l}),Mv(l)||(this.#n.config.onError?.(l,this),this.#n.config.onSettled?.(this.state.data,l,this)),this.scheduleGc()};return this.#r=M6({initialPromise:n?.initialPromise,fn:x.fetchFn,abort:s.abort.bind(s),onSuccess:l=>{if(l===void 0){v(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(l)}catch(A){v(A);return}this.#n.config.onSuccess?.(l,this),this.#n.config.onSettled?.(l,this.state.error,this),this.scheduleGc()},onError:v,onFail:(l,A)=>{this.#i({type:"failed",failureCount:l,error:A})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:x.options.retry,retryDelay:x.options.retryDelay,networkMode:x.options.networkMode,canRun:()=>!0}),this.#r.start()}#i(r){const n=s=>{switch(r.type){case"failed":return{...s,fetchFailureCount:r.failureCount,fetchFailureReason:r.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...A6(s.data,this.options),fetchMeta:r.meta??null};case"success":return{...s,data:r.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:r.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!r.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const u=r.error;return Mv(u)&&u.revert&&this.#t?{...this.#t,fetchStatus:"idle"}:{...s,error:u,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:u,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...r.state}}};this.state=n(this.state),hs.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:r})})}};function A6(r,n){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:C6(n.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function cE(r){const n=typeof r.initialData=="function"?r.initialData():r.initialData,s=n!==void 0,u=s?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:n,dataUpdateCount:0,dataUpdatedAt:s?u??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var uE=class extends wm{constructor(r={}){super(),this.config=r,this.#e=new Map}#e;build(r,n,s){const u=n.queryKey,m=n.queryHash??hx(u,n);let x=this.get(m);return x||(x=new lE({cache:this,queryKey:u,queryHash:m,options:r.defaultQueryOptions(n),state:s,defaultOptions:r.getQueryDefaults(u)}),this.add(x)),x}add(r){this.#e.has(r.queryHash)||(this.#e.set(r.queryHash,r),this.notify({type:"added",query:r}))}remove(r){const n=this.#e.get(r.queryHash);n&&(r.destroy(),n===r&&this.#e.delete(r.queryHash),this.notify({type:"removed",query:r}))}clear(){hs.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}get(r){return this.#e.get(r)}getAll(){return[...this.#e.values()]}find(r){const n={exact:!0,...r};return this.getAll().find(s=>zb(n,s))}findAll(r={}){const n=this.getAll();return Object.keys(r).length>0?n.filter(s=>zb(r,s)):n}notify(r){hs.batch(()=>{this.listeners.forEach(n=>{n(r)})})}onFocus(){hs.batch(()=>{this.getAll().forEach(r=>{r.onFocus()})})}onOnline(){hs.batch(()=>{this.getAll().forEach(r=>{r.onOnline()})})}},hE=class extends I6{#e;#t;#n;constructor(r){super(),this.mutationId=r.mutationId,this.#t=r.mutationCache,this.#e=[],this.state=r.state||k6(),this.setOptions(r.options),this.scheduleGc()}setOptions(r){this.options=r,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(r){this.#e.includes(r)||(this.#e.push(r),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:r}))}removeObserver(r){this.#e=this.#e.filter(n=>n!==r),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:r})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(r){this.#n=M6({fn:()=>this.options.mutationFn?this.options.mutationFn(r):Promise.reject(new Error("No mutationFn found")),onFail:(u,m)=>{this.#r({type:"failed",failureCount:u,error:m})},onPause:()=>{this.#r({type:"pause"})},onContinue:()=>{this.#r({type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const n=this.state.status==="pending",s=!this.#n.canStart();try{if(!n){this.#r({type:"pending",variables:r,isPaused:s}),await this.#t.config.onMutate?.(r,this);const m=await this.options.onMutate?.(r);m!==this.state.context&&this.#r({type:"pending",context:m,variables:r,isPaused:s})}const u=await this.#n.start();return await this.#t.config.onSuccess?.(u,r,this.state.context,this),await this.options.onSuccess?.(u,r,this.state.context),await this.#t.config.onSettled?.(u,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(u,null,r,this.state.context),this.#r({type:"success",data:u}),u}catch(u){try{throw await this.#t.config.onError?.(u,r,this.state.context,this),await this.options.onError?.(u,r,this.state.context),await this.#t.config.onSettled?.(void 0,u,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,u,r,this.state.context),u}finally{this.#r({type:"error",error:u})}}finally{this.#t.runNext(this)}}#r(r){const n=s=>{switch(r.type){case"failed":return{...s,failureCount:r.failureCount,failureReason:r.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:r.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:r.isPaused,status:"pending",variables:r.variables,submittedAt:Date.now()};case"success":return{...s,data:r.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:r.error,failureCount:s.failureCount+1,failureReason:r.error,isPaused:!1,status:"error"}}};this.state=n(this.state),hs.batch(()=>{this.#e.forEach(s=>{s.onMutationUpdate(r)}),this.#t.notify({mutation:this,type:"updated",action:r})})}};function k6(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var dE=class extends wm{constructor(r={}){super(),this.config=r,this.#e=new Map,this.#t=Date.now()}#e;#t;build(r,n,s){const u=new hE({mutationCache:this,mutationId:++this.#t,options:r.defaultMutationOptions(n),state:s});return this.add(u),u}add(r){const n=t0(r),s=this.#e.get(n)??[];s.push(r),this.#e.set(n,s),this.notify({type:"added",mutation:r})}remove(r){const n=t0(r);if(this.#e.has(n)){const s=this.#e.get(n)?.filter(u=>u!==r);s&&(s.length===0?this.#e.delete(n):this.#e.set(n,s))}this.notify({type:"removed",mutation:r})}canRun(r){const n=this.#e.get(t0(r))?.find(s=>s.state.status==="pending");return!n||n===r}runNext(r){return this.#e.get(t0(r))?.find(s=>s!==r&&s.state.isPaused)?.continue()??Promise.resolve()}clear(){hs.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}getAll(){return[...this.#e.values()].flat()}find(r){const n={exact:!0,...r};return this.getAll().find(s=>Fb(n,s))}findAll(r={}){return this.getAll().filter(n=>Fb(r,n))}notify(r){hs.batch(()=>{this.listeners.forEach(n=>{n(r)})})}resumePausedMutations(){const r=this.getAll().filter(n=>n.state.isPaused);return hs.batch(()=>Promise.all(r.map(n=>n.continue().catch(ol))))}};function t0(r){return r.options.scope?.id??String(r.mutationId)}function jb(r){return{onFetch:(n,s)=>{const u=n.options,m=n.fetchOptions?.meta?.fetchMore?.direction,x=n.state.data?.pages||[],v=n.state.data?.pageParams||[];let l={pages:[],pageParams:[]},A=0;const R=async()=>{let L=!1;const B=ce=>{Object.defineProperty(ce,"signal",{enumerable:!0,get:()=>(n.signal.aborted?L=!0:n.signal.addEventListener("abort",()=>{L=!0}),n.signal)})},W=P6(n.options,n.fetchOptions),re=async(ce,Q,X)=>{if(L)return Promise.reject();if(Q==null&&ce.pages.length)return Promise.resolve(ce);const le={queryKey:n.queryKey,pageParam:Q,direction:X?"backward":"forward",meta:n.options.meta};B(le);const he=await W(le),{maxPages:_e}=n.options,Ie=X?nE:rE;return{pages:Ie(ce.pages,he,_e),pageParams:Ie(ce.pageParams,Q,_e)}};if(m&&x.length){const ce=m==="backward",Q=ce?fE:Bb,X={pages:x,pageParams:v},le=Q(u,X);l=await re(X,le,ce)}else{const ce=r??x.length;do{const Q=A===0?v[0]??u.initialPageParam:Bb(u,l);if(A>0&&Q==null)break;l=await re(l,Q),A++}while(A<ce)}return l};n.options.persister?n.fetchFn=()=>n.options.persister?.(R,{queryKey:n.queryKey,meta:n.options.meta,signal:n.signal},s):n.fetchFn=R}}}function Bb(r,{pages:n,pageParams:s}){const u=n.length-1;return n.length>0?r.getNextPageParam(n[u],n,s[u],s):void 0}function fE(r,{pages:n,pageParams:s}){return n.length>0?r.getPreviousPageParam?.(n[0],n,s[0],s):void 0}var pE=class{#e;#t;#n;#r;#o;#s;#i;#a;constructor(r={}){this.#e=r.queryCache||new uE,this.#t=r.mutationCache||new dE,this.#n=r.defaultOptions||{},this.#r=new Map,this.#o=new Map,this.#s=0}mount(){this.#s++,this.#s===1&&(this.#i=fx.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#a=S0.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#s--,this.#s===0&&(this.#i?.(),this.#i=void 0,this.#a?.(),this.#a=void 0)}isFetching(r){return this.#e.findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return this.#t.findAll({...r,status:"pending"}).length}getQueryData(r){const n=this.defaultQueryOptions({queryKey:r});return this.#e.get(n.queryHash)?.state.data}ensureQueryData(r){const n=this.getQueryData(r.queryKey);if(n===void 0)return this.fetchQuery(r);{const s=this.defaultQueryOptions(r),u=this.#e.build(this,s);return r.revalidateIfStale&&u.isStaleByTime(im(s.staleTime,u))&&this.prefetchQuery(s),Promise.resolve(n)}}getQueriesData(r){return this.#e.findAll(r).map(({queryKey:n,state:s})=>{const u=s.data;return[n,u]})}setQueryData(r,n,s){const u=this.defaultQueryOptions({queryKey:r}),x=this.#e.get(u.queryHash)?.state.data,v=eE(n,x);if(v!==void 0)return this.#e.build(this,u).setData(v,{...s,manual:!0})}setQueriesData(r,n,s){return hs.batch(()=>this.#e.findAll(r).map(({queryKey:u})=>[u,this.setQueryData(u,n,s)]))}getQueryState(r){const n=this.defaultQueryOptions({queryKey:r});return this.#e.get(n.queryHash)?.state}removeQueries(r){const n=this.#e;hs.batch(()=>{n.findAll(r).forEach(s=>{n.remove(s)})})}resetQueries(r,n){const s=this.#e,u={type:"active",...r};return hs.batch(()=>(s.findAll(r).forEach(m=>{m.reset()}),this.refetchQueries(u,n)))}cancelQueries(r={},n={}){const s={revert:!0,...n},u=hs.batch(()=>this.#e.findAll(r).map(m=>m.cancel(s)));return Promise.all(u).then(ol).catch(ol)}invalidateQueries(r={},n={}){return hs.batch(()=>{if(this.#e.findAll(r).forEach(u=>{u.invalidate()}),r.refetchType==="none")return Promise.resolve();const s={...r,type:r.refetchType??r.type??"active"};return this.refetchQueries(s,n)})}refetchQueries(r={},n){const s={...n,cancelRefetch:n?.cancelRefetch??!0},u=hs.batch(()=>this.#e.findAll(r).filter(m=>!m.isDisabled()).map(m=>{let x=m.fetch(void 0,s);return s.throwOnError||(x=x.catch(ol)),m.state.fetchStatus==="paused"?Promise.resolve():x}));return Promise.all(u).then(ol)}fetchQuery(r){const n=this.defaultQueryOptions(r);n.retry===void 0&&(n.retry=!1);const s=this.#e.build(this,n);return s.isStaleByTime(im(n.staleTime,s))?s.fetch(n):Promise.resolve(s.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(ol).catch(ol)}fetchInfiniteQuery(r){return r.behavior=jb(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(ol).catch(ol)}ensureInfiniteQueryData(r){return r.behavior=jb(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return S0.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(r){this.#n=r}setQueryDefaults(r,n){this.#r.set($f(r),{queryKey:r,defaultOptions:n})}getQueryDefaults(r){const n=[...this.#r.values()];let s={};return n.forEach(u=>{Eg(r,u.queryKey)&&(s={...s,...u.defaultOptions})}),s}setMutationDefaults(r,n){this.#o.set($f(r),{mutationKey:r,defaultOptions:n})}getMutationDefaults(r){const n=[...this.#o.values()];let s={};return n.forEach(u=>{Eg(r,u.mutationKey)&&(s={...s,...u.defaultOptions})}),s}defaultQueryOptions(r){if(r._defaulted)return r;const n={...this.#n.queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return n.queryHash||(n.queryHash=hx(n.queryKey,n)),n.refetchOnReconnect===void 0&&(n.refetchOnReconnect=n.networkMode!=="always"),n.throwOnError===void 0&&(n.throwOnError=!!n.suspense),!n.networkMode&&n.persister&&(n.networkMode="offlineFirst"),n.enabled!==!0&&n.queryFn===dx&&(n.enabled=!1),n}defaultMutationOptions(r){return r?._defaulted?r:{...this.#n.mutations,...r?.mutationKey&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},mE=class extends wm{constructor(r,n){super(),this.options=n,this.#e=r,this.#a=null,this.#i=p1(),this.options.experimental_prefetchInRender||this.#i.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}#e;#t=void 0;#n=void 0;#r=void 0;#o;#s;#i;#a;#m;#d;#f;#c;#u;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),Vb(this.#t,this.options)?this.#h():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return m1(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return m1(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#x(),this.#b(),this.#t.removeObserver(this)}setOptions(r,n){const s=this.options,u=this.#t;if(this.options=this.#e.defaultQueryOptions(r),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof rc(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#w(),this.#t.setOptions(this.options),s._defaulted&&!T0(this.options,s)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const m=this.hasListeners();m&&Ub(this.#t,u,this.options,s)&&this.#h(),this.updateResult(n),m&&(this.#t!==u||rc(this.options.enabled,this.#t)!==rc(s.enabled,this.#t)||im(this.options.staleTime,this.#t)!==im(s.staleTime,this.#t))&&this.#g();const x=this.#y();m&&(this.#t!==u||rc(this.options.enabled,this.#t)!==rc(s.enabled,this.#t)||x!==this.#l)&&this.#_(x)}getOptimisticResult(r){const n=this.#e.getQueryCache().build(this.#e,r),s=this.createResult(n,r);return yE(this,s)&&(this.#r=s,this.#s=this.options,this.#o=this.#t.state),s}getCurrentResult(){return this.#r}trackResult(r,n){const s={};return Object.keys(r).forEach(u=>{Object.defineProperty(s,u,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(u),n?.(u),r[u])})}),s}trackProp(r){this.#p.add(r)}getCurrentQuery(){return this.#t}refetch({...r}={}){return this.fetch({...r})}fetchOptimistic(r){const n=this.#e.defaultQueryOptions(r),s=this.#e.getQueryCache().build(this.#e,n);return s.fetch().then(()=>this.createResult(s,n))}fetch(r){return this.#h({...r,cancelRefetch:r.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#h(r){this.#w();let n=this.#t.fetch(this.options,r);return r?.throwOnError||(n=n.catch(ol)),n}#g(){this.#x();const r=im(this.options.staleTime,this.#t);if(Uf||this.#r.isStale||!h1(r))return;const s=T6(this.#r.dataUpdatedAt,r)+1;this.#c=setTimeout(()=>{this.#r.isStale||this.updateResult()},s)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(r){this.#b(),this.#l=r,!(Uf||rc(this.options.enabled,this.#t)===!1||!h1(this.#l)||this.#l===0)&&(this.#u=setInterval(()=>{(this.options.refetchIntervalInBackground||fx.isFocused())&&this.#h()},this.#l))}#v(){this.#g(),this.#_(this.#y())}#x(){this.#c&&(clearTimeout(this.#c),this.#c=void 0)}#b(){this.#u&&(clearInterval(this.#u),this.#u=void 0)}createResult(r,n){const s=this.#t,u=this.options,m=this.#r,x=this.#o,v=this.#s,A=r!==s?r.state:this.#n,{state:R}=r;let L={...R},B=!1,W;if(n._optimisticResults){const He=this.hasListeners(),nt=!He&&Vb(r,n),Pt=He&&Ub(r,s,n,u);(nt||Pt)&&(L={...L,...A6(R.data,r.options)}),n._optimisticResults==="isRestoring"&&(L.fetchStatus="idle")}let{error:re,errorUpdatedAt:ce,status:Q}=L;if(n.select&&L.data!==void 0)if(m&&L.data===x?.data&&n.select===this.#m)W=this.#d;else try{this.#m=n.select,W=n.select(L.data),W=f1(m?.data,W,n),this.#d=W,this.#a=null}catch(He){this.#a=He}else W=L.data;if(n.placeholderData!==void 0&&W===void 0&&Q==="pending"){let He;if(m?.isPlaceholderData&&n.placeholderData===v?.placeholderData)He=m.data;else if(He=typeof n.placeholderData=="function"?n.placeholderData(this.#f?.state.data,this.#f):n.placeholderData,n.select&&He!==void 0)try{He=n.select(He),this.#a=null}catch(nt){this.#a=nt}He!==void 0&&(Q="success",W=f1(m?.data,He,n),B=!0)}this.#a&&(re=this.#a,W=this.#d,ce=Date.now(),Q="error");const X=L.fetchStatus==="fetching",le=Q==="pending",he=Q==="error",_e=le&&X,Ie=W!==void 0,Je={status:Q,fetchStatus:L.fetchStatus,isPending:le,isSuccess:Q==="success",isError:he,isInitialLoading:_e,isLoading:_e,data:W,dataUpdatedAt:L.dataUpdatedAt,error:re,errorUpdatedAt:ce,failureCount:L.fetchFailureCount,failureReason:L.fetchFailureReason,errorUpdateCount:L.errorUpdateCount,isFetched:L.dataUpdateCount>0||L.errorUpdateCount>0,isFetchedAfterMount:L.dataUpdateCount>A.dataUpdateCount||L.errorUpdateCount>A.errorUpdateCount,isFetching:X,isRefetching:X&&!le,isLoadingError:he&&!Ie,isPaused:L.fetchStatus==="paused",isPlaceholderData:B,isRefetchError:he&&Ie,isStale:px(r,n),refetch:this.refetch,promise:this.#i};if(this.options.experimental_prefetchInRender){const He=Ct=>{Je.status==="error"?Ct.reject(Je.error):Je.data!==void 0&&Ct.resolve(Je.data)},nt=()=>{const Ct=this.#i=Je.promise=p1();He(Ct)},Pt=this.#i;switch(Pt.status){case"pending":r.queryHash===s.queryHash&&He(Pt);break;case"fulfilled":(Je.status==="error"||Je.data!==Pt.value)&&nt();break;case"rejected":(Je.status!=="error"||Je.error!==Pt.reason)&&nt();break}}return Je}updateResult(r){const n=this.#r,s=this.createResult(this.#t,this.options);if(this.#o=this.#t.state,this.#s=this.options,this.#o.data!==void 0&&(this.#f=this.#t),T0(s,n))return;this.#r=s;const u={},m=()=>{if(!n)return!0;const{notifyOnChangeProps:x}=this.options,v=typeof x=="function"?x():x;if(v==="all"||!v&&!this.#p.size)return!0;const l=new Set(v??this.#p);return this.options.throwOnError&&l.add("error"),Object.keys(this.#r).some(A=>{const R=A;return this.#r[R]!==n[R]&&l.has(R)})};r?.listeners!==!1&&m()&&(u.listeners=!0),this.#T({...u,...r})}#w(){const r=this.#e.getQueryCache().build(this.#e,this.options);if(r===this.#t)return;const n=this.#t;this.#t=r,this.#n=r.state,this.hasListeners()&&(n?.removeObserver(this),r.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#T(r){hs.batch(()=>{r.listeners&&this.listeners.forEach(n=>{n(this.#r)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function gE(r,n){return rc(n.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&n.retryOnMount===!1)}function Vb(r,n){return gE(r,n)||r.state.data!==void 0&&m1(r,n,n.refetchOnMount)}function m1(r,n,s){if(rc(n.enabled,r)!==!1){const u=typeof s=="function"?s(r):s;return u==="always"||u!==!1&&px(r,n)}return!1}function Ub(r,n,s,u){return(r!==n||rc(u.enabled,r)===!1)&&(!s.suspense||r.state.status!=="error")&&px(r,s)}function px(r,n){return rc(n.enabled,r)!==!1&&r.isStaleByTime(im(n.staleTime,r))}function yE(r,n){return!T0(r.getCurrentResult(),n)}var _E=class extends wm{#e;#t=void 0;#n;#r;constructor(n,s){super(),this.#e=n,this.setOptions(s),this.bindMethods(),this.#o()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){const s=this.options;this.options=this.#e.defaultMutationOptions(n),T0(this.options,s)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),s?.mutationKey&&this.options.mutationKey&&$f(s.mutationKey)!==$f(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(n){this.#o(),this.#s(n)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#o(),this.#s()}mutate(n,s){return this.#r=s,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(n)}#o(){const n=this.#n?.state??k6();this.#t={...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset}}#s(n){hs.batch(()=>{if(this.#r&&this.hasListeners()){const s=this.#t.variables,u=this.#t.context;n?.type==="success"?(this.#r.onSuccess?.(n.data,s,u),this.#r.onSettled?.(n.data,null,s,u)):n?.type==="error"&&(this.#r.onError?.(n.error,s,u),this.#r.onSettled?.(void 0,n.error,s,u))}this.listeners.forEach(s=>{s(this.#t)})})}},D6=j.createContext(void 0),Tm=r=>{const n=j.useContext(D6);if(!n)throw new Error("No QueryClient set, use QueryClientProvider to set one");return n},vE=({client:r,children:n})=>(j.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),V.jsx(D6.Provider,{value:r,children:n})),R6=j.createContext(!1),xE=()=>j.useContext(R6);R6.Provider;function bE(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var wE=j.createContext(bE()),TE=()=>j.useContext(wE);function L6(r,n){return typeof r=="function"?r(...n):!!r}function g1(){}var SE=(r,n)=>{(r.suspense||r.throwOnError||r.experimental_prefetchInRender)&&(n.isReset()||(r.retryOnMount=!1))},PE=r=>{j.useEffect(()=>{r.clearReset()},[r])},CE=({result:r,errorResetBoundary:n,throwOnError:s,query:u})=>r.isError&&!n.isReset()&&!r.isFetching&&u&&L6(s,[r.error,u]),EE=r=>{r.suspense&&(r.staleTime===void 0&&(r.staleTime=1e3),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3)))},ME=(r,n)=>r.isLoading&&r.isFetching&&!n,IE=(r,n)=>r?.suspense&&n.isPending,$b=(r,n,s)=>n.fetchOptimistic(r).catch(()=>{s.clearReset()});function AE(r,n,s){const u=Tm(),m=xE(),x=TE(),v=u.defaultQueryOptions(r);u.getDefaultOptions().queries?._experimental_beforeQuery?.(v),v._optimisticResults=m?"isRestoring":"optimistic",EE(v),SE(v,x),PE(x);const l=!u.getQueryCache().get(v.queryHash),[A]=j.useState(()=>new n(u,v)),R=A.getOptimisticResult(v);if(j.useSyncExternalStore(j.useCallback(L=>{const B=m?g1:A.subscribe(hs.batchCalls(L));return A.updateResult(),B},[A,m]),()=>A.getCurrentResult(),()=>A.getCurrentResult()),j.useEffect(()=>{A.setOptions(v,{listeners:!1})},[v,A]),IE(v,R))throw $b(v,A,x);if(CE({result:R,errorResetBoundary:x,throwOnError:v.throwOnError,query:u.getQueryCache().get(v.queryHash)}))throw R.error;return u.getDefaultOptions().queries?._experimental_afterQuery?.(v,R),v.experimental_prefetchInRender&&!Uf&&ME(R,m)&&(l?$b(v,A,x):u.getQueryCache().get(v.queryHash)?.promise)?.catch(g1).finally(()=>{A.updateResult()}),v.notifyOnChangeProps?R:A.trackResult(R)}function z6(r,n){return AE(r,mE)}function n_(r,n){const s=Tm(),[u]=j.useState(()=>new _E(s,r));j.useEffect(()=>{u.setOptions(r)},[u,r]);const m=j.useSyncExternalStore(j.useCallback(v=>u.subscribe(hs.batchCalls(v)),[u]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),x=j.useCallback((v,l)=>{u.mutate(v,l).catch(g1)},[u]);if(m.error&&L6(u.options.throwOnError,[m.error]))throw m.error;return{...m,mutate:x,mutateAsync:m.mutate}}async function kE(r){if(!r.ok){const n=await r.text()||r.statusText;throw new Error(`${r.status}: ${n}`)}}const DE=({on401:r})=>async({queryKey:n})=>{const s=await fetch(n.join("/"),{credentials:"include"});return await kE(s),await s.json()},F6=new pE({defaultOptions:{queries:{queryFn:DE({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),RE=1,LE=1e6;let Iv=0;function zE(){return Iv=(Iv+1)%Number.MAX_SAFE_INTEGER,Iv.toString()}const Av=new Map,Gb=r=>{if(Av.has(r))return;const n=setTimeout(()=>{Av.delete(r),bg({type:"REMOVE_TOAST",toastId:r})},LE);Av.set(r,n)},FE=(r,n)=>{switch(n.type){case"ADD_TOAST":return{...r,toasts:[n.toast,...r.toasts].slice(0,RE)};case"UPDATE_TOAST":return{...r,toasts:r.toasts.map(s=>s.id===n.toast.id?{...s,...n.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=n;return s?Gb(s):r.toasts.forEach(u=>{Gb(u.id)}),{...r,toasts:r.toasts.map(u=>u.id===s||s===void 0?{...u,open:!1}:u)}}case"REMOVE_TOAST":return n.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(s=>s.id!==n.toastId)}}},f0=[];let p0={toasts:[]};function bg(r){p0=FE(p0,r),f0.forEach(n=>{n(p0)})}function OE({...r}){const n=zE(),s=m=>bg({type:"UPDATE_TOAST",toast:{...m,id:n}}),u=()=>bg({type:"DISMISS_TOAST",toastId:n});return bg({type:"ADD_TOAST",toast:{...r,id:n,open:!0,onOpenChange:m=>{m||u()}}}),{id:n,dismiss:u,update:s}}function mx(){const[r,n]=j.useState(p0);return j.useEffect(()=>(f0.push(n),()=>{const s=f0.indexOf(n);s>-1&&f0.splice(s,1)}),[r]),{...r,toast:OE,dismiss:s=>bg({type:"DISMISS_TOAST",toastId:s})}}var Ld=h6();const NE=lx(Ld);function Ht(r,n,{checkForDefaultPrevented:s=!0}={}){return function(m){if(r?.(m),s===!1||!m.defaultPrevented)return n?.(m)}}function qb(r,n){if(typeof r=="function")return r(n);r!=null&&(r.current=n)}function i_(...r){return n=>{let s=!1;const u=r.map(m=>{const x=qb(m,n);return!s&&typeof x=="function"&&(s=!0),x});if(s)return()=>{for(let m=0;m<u.length;m++){const x=u[m];typeof x=="function"?x():qb(r[m],null)}}}}function dn(...r){return j.useCallback(i_(...r),r)}function jE(r,n){const s=j.createContext(n),u=x=>{const{children:v,...l}=x,A=j.useMemo(()=>l,Object.values(l));return V.jsx(s.Provider,{value:A,children:v})};u.displayName=r+"Provider";function m(x){const v=j.useContext(s);if(v)return v;if(n!==void 0)return n;throw new Error(`\`${x}\` must be used within \`${r}\``)}return[u,m]}function nu(r,n=[]){let s=[];function u(x,v){const l=j.createContext(v),A=s.length;s=[...s,v];const R=B=>{const{scope:W,children:re,...ce}=B,Q=W?.[r]?.[A]||l,X=j.useMemo(()=>ce,Object.values(ce));return V.jsx(Q.Provider,{value:X,children:re})};R.displayName=x+"Provider";function L(B,W){const re=W?.[r]?.[A]||l,ce=j.useContext(re);if(ce)return ce;if(v!==void 0)return v;throw new Error(`\`${B}\` must be used within \`${x}\``)}return[R,L]}const m=()=>{const x=s.map(v=>j.createContext(v));return function(l){const A=l?.[r]||x;return j.useMemo(()=>({[`__scope${r}`]:{...l,[r]:A}}),[l,A])}};return m.scopeName=r,[u,BE(m,...n)]}function BE(...r){const n=r[0];if(r.length===1)return n;const s=()=>{const u=r.map(m=>({useScope:m(),scopeName:m.scopeName}));return function(x){const v=u.reduce((l,{useScope:A,scopeName:R})=>{const B=A(x)[`__scope${R}`];return{...l,...B}},{});return j.useMemo(()=>({[`__scope${n.scopeName}`]:v}),[v])}};return s.scopeName=n.scopeName,s}function Gf(r){const n=VE(r),s=j.forwardRef((u,m)=>{const{children:x,...v}=u,l=j.Children.toArray(x),A=l.find(UE);if(A){const R=A.props.children,L=l.map(B=>B===A?j.Children.count(R)>1?j.Children.only(null):j.isValidElement(R)?R.props.children:null:B);return V.jsx(n,{...v,ref:m,children:j.isValidElement(R)?j.cloneElement(R,void 0,L):null})}return V.jsx(n,{...v,ref:m,children:x})});return s.displayName=`${r}.Slot`,s}var O6=Gf("Slot");function VE(r){const n=j.forwardRef((s,u)=>{const{children:m,...x}=s;if(j.isValidElement(m)){const v=GE(m),l=$E(x,m.props);return m.type!==j.Fragment&&(l.ref=u?i_(u,v):v),j.cloneElement(m,l)}return j.Children.count(m)>1?j.Children.only(null):null});return n.displayName=`${r}.SlotClone`,n}var N6=Symbol("radix.slottable");function j6(r){const n=({children:s})=>V.jsx(V.Fragment,{children:s});return n.displayName=`${r}.Slottable`,n.__radixId=N6,n}function UE(r){return j.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===N6}function $E(r,n){const s={...n};for(const u in n){const m=r[u],x=n[u];/^on[A-Z]/.test(u)?m&&x?s[u]=(...l)=>{x(...l),m(...l)}:m&&(s[u]=m):u==="style"?s[u]={...m,...x}:u==="className"&&(s[u]=[m,x].filter(Boolean).join(" "))}return{...r,...s}}function GE(r){let n=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,s=n&&"isReactWarning"in n&&n.isReactWarning;return s?r.ref:(n=Object.getOwnPropertyDescriptor(r,"ref")?.get,s=n&&"isReactWarning"in n&&n.isReactWarning,s?r.props.ref:r.props.ref||r.ref)}function s_(r){const n=r+"CollectionProvider",[s,u]=nu(n),[m,x]=s(n,{collectionRef:{current:null},itemMap:new Map}),v=Q=>{const{scope:X,children:le}=Q,he=gr.useRef(null),_e=gr.useRef(new Map).current;return V.jsx(m,{scope:X,itemMap:_e,collectionRef:he,children:le})};v.displayName=n;const l=r+"CollectionSlot",A=Gf(l),R=gr.forwardRef((Q,X)=>{const{scope:le,children:he}=Q,_e=x(l,le),Ie=dn(X,_e.collectionRef);return V.jsx(A,{ref:Ie,children:he})});R.displayName=l;const L=r+"CollectionItemSlot",B="data-radix-collection-item",W=Gf(L),re=gr.forwardRef((Q,X)=>{const{scope:le,children:he,..._e}=Q,Ie=gr.useRef(null),ke=dn(X,Ie),Je=x(L,le);return gr.useEffect(()=>(Je.itemMap.set(Ie,{ref:Ie,..._e}),()=>{Je.itemMap.delete(Ie)})),V.jsx(W,{[B]:"",ref:ke,children:he})});re.displayName=L;function ce(Q){const X=x(r+"CollectionConsumer",Q);return gr.useCallback(()=>{const he=X.collectionRef.current;if(!he)return[];const _e=Array.from(he.querySelectorAll(`[${B}]`));return Array.from(X.itemMap.values()).sort((Je,He)=>_e.indexOf(Je.ref.current)-_e.indexOf(He.ref.current))},[X.collectionRef,X.itemMap])}return[{Provider:v,Slot:R,ItemSlot:re},ce,u]}var qE=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Fr=qE.reduce((r,n)=>{const s=Gf(`Primitive.${n}`),u=j.forwardRef((m,x)=>{const{asChild:v,...l}=m,A=v?s:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),V.jsx(A,{...l,ref:x})});return u.displayName=`Primitive.${n}`,{...r,[n]:u}},{});function gx(r,n){r&&Ld.flushSync(()=>r.dispatchEvent(n))}function to(r){const n=j.useRef(r);return j.useEffect(()=>{n.current=r}),j.useMemo(()=>(...s)=>n.current?.(...s),[])}function ZE(r,n=globalThis?.document){const s=to(r);j.useEffect(()=>{const u=m=>{m.key==="Escape"&&s(m)};return n.addEventListener("keydown",u,{capture:!0}),()=>n.removeEventListener("keydown",u,{capture:!0})},[s,n])}var WE="DismissableLayer",y1="dismissableLayer.update",HE="dismissableLayer.pointerDownOutside",XE="dismissableLayer.focusOutside",Zb,B6=j.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Sm=j.forwardRef((r,n)=>{const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:u,onPointerDownOutside:m,onFocusOutside:x,onInteractOutside:v,onDismiss:l,...A}=r,R=j.useContext(B6),[L,B]=j.useState(null),W=L?.ownerDocument??globalThis?.document,[,re]=j.useState({}),ce=dn(n,He=>B(He)),Q=Array.from(R.layers),[X]=[...R.layersWithOutsidePointerEventsDisabled].slice(-1),le=Q.indexOf(X),he=L?Q.indexOf(L):-1,_e=R.layersWithOutsidePointerEventsDisabled.size>0,Ie=he>=le,ke=YE(He=>{const nt=He.target,Pt=[...R.branches].some(Ct=>Ct.contains(nt));!Ie||Pt||(m?.(He),v?.(He),He.defaultPrevented||l?.())},W),Je=QE(He=>{const nt=He.target;[...R.branches].some(Ct=>Ct.contains(nt))||(x?.(He),v?.(He),He.defaultPrevented||l?.())},W);return ZE(He=>{he===R.layers.size-1&&(u?.(He),!He.defaultPrevented&&l&&(He.preventDefault(),l()))},W),j.useEffect(()=>{if(L)return s&&(R.layersWithOutsidePointerEventsDisabled.size===0&&(Zb=W.body.style.pointerEvents,W.body.style.pointerEvents="none"),R.layersWithOutsidePointerEventsDisabled.add(L)),R.layers.add(L),Wb(),()=>{s&&R.layersWithOutsidePointerEventsDisabled.size===1&&(W.body.style.pointerEvents=Zb)}},[L,W,s,R]),j.useEffect(()=>()=>{L&&(R.layers.delete(L),R.layersWithOutsidePointerEventsDisabled.delete(L),Wb())},[L,R]),j.useEffect(()=>{const He=()=>re({});return document.addEventListener(y1,He),()=>document.removeEventListener(y1,He)},[]),V.jsx(Fr.div,{...A,ref:ce,style:{pointerEvents:_e?Ie?"auto":"none":void 0,...r.style},onFocusCapture:Ht(r.onFocusCapture,Je.onFocusCapture),onBlurCapture:Ht(r.onBlurCapture,Je.onBlurCapture),onPointerDownCapture:Ht(r.onPointerDownCapture,ke.onPointerDownCapture)})});Sm.displayName=WE;var KE="DismissableLayerBranch",V6=j.forwardRef((r,n)=>{const s=j.useContext(B6),u=j.useRef(null),m=dn(n,u);return j.useEffect(()=>{const x=u.current;if(x)return s.branches.add(x),()=>{s.branches.delete(x)}},[s.branches]),V.jsx(Fr.div,{...r,ref:m})});V6.displayName=KE;function YE(r,n=globalThis?.document){const s=to(r),u=j.useRef(!1),m=j.useRef(()=>{});return j.useEffect(()=>{const x=l=>{if(l.target&&!u.current){let A=function(){U6(HE,s,R,{discrete:!0})};const R={originalEvent:l};l.pointerType==="touch"?(n.removeEventListener("click",m.current),m.current=A,n.addEventListener("click",m.current,{once:!0})):A()}else n.removeEventListener("click",m.current);u.current=!1},v=window.setTimeout(()=>{n.addEventListener("pointerdown",x)},0);return()=>{window.clearTimeout(v),n.removeEventListener("pointerdown",x),n.removeEventListener("click",m.current)}},[n,s]),{onPointerDownCapture:()=>u.current=!0}}function QE(r,n=globalThis?.document){const s=to(r),u=j.useRef(!1);return j.useEffect(()=>{const m=x=>{x.target&&!u.current&&U6(XE,s,{originalEvent:x},{discrete:!1})};return n.addEventListener("focusin",m),()=>n.removeEventListener("focusin",m)},[n,s]),{onFocusCapture:()=>u.current=!0,onBlurCapture:()=>u.current=!1}}function Wb(){const r=new CustomEvent(y1);document.dispatchEvent(r)}function U6(r,n,s,{discrete:u}){const m=s.originalEvent.target,x=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:s});n&&m.addEventListener(r,n,{once:!0}),u?gx(m,x):m.dispatchEvent(x)}var JE=Sm,eM=V6,ro=globalThis?.document?j.useLayoutEffect:()=>{},tM="Portal",Jg=j.forwardRef((r,n)=>{const{container:s,...u}=r,[m,x]=j.useState(!1);ro(()=>x(!0),[]);const v=s||m&&globalThis?.document?.body;return v?NE.createPortal(V.jsx(Fr.div,{...u,ref:n}),v):null});Jg.displayName=tM;function rM(r,n){return j.useReducer((s,u)=>n[s][u]??s,r)}var iu=r=>{const{present:n,children:s}=r,u=nM(n),m=typeof s=="function"?s({present:u.isPresent}):j.Children.only(s),x=dn(u.ref,iM(m));return typeof s=="function"||u.isPresent?j.cloneElement(m,{ref:x}):null};iu.displayName="Presence";function nM(r){const[n,s]=j.useState(),u=j.useRef({}),m=j.useRef(r),x=j.useRef("none"),v=r?"mounted":"unmounted",[l,A]=rM(v,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return j.useEffect(()=>{const R=r0(u.current);x.current=l==="mounted"?R:"none"},[l]),ro(()=>{const R=u.current,L=m.current;if(L!==r){const W=x.current,re=r0(R);r?A("MOUNT"):re==="none"||R?.display==="none"?A("UNMOUNT"):A(L&&W!==re?"ANIMATION_OUT":"UNMOUNT"),m.current=r}},[r,A]),ro(()=>{if(n){let R;const L=n.ownerDocument.defaultView??window,B=re=>{const Q=r0(u.current).includes(re.animationName);if(re.target===n&&Q&&(A("ANIMATION_END"),!m.current)){const X=n.style.animationFillMode;n.style.animationFillMode="forwards",R=L.setTimeout(()=>{n.style.animationFillMode==="forwards"&&(n.style.animationFillMode=X)})}},W=re=>{re.target===n&&(x.current=r0(u.current))};return n.addEventListener("animationstart",W),n.addEventListener("animationcancel",B),n.addEventListener("animationend",B),()=>{L.clearTimeout(R),n.removeEventListener("animationstart",W),n.removeEventListener("animationcancel",B),n.removeEventListener("animationend",B)}}else A("ANIMATION_END")},[n,A]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:j.useCallback(R=>{R&&(u.current=getComputedStyle(R)),s(R)},[])}}function r0(r){return r?.animationName||"none"}function iM(r){let n=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,s=n&&"isReactWarning"in n&&n.isReactWarning;return s?r.ref:(n=Object.getOwnPropertyDescriptor(r,"ref")?.get,s=n&&"isReactWarning"in n&&n.isReactWarning,s?r.props.ref:r.props.ref||r.ref)}function dm({prop:r,defaultProp:n,onChange:s=()=>{}}){const[u,m]=sM({defaultProp:n,onChange:s}),x=r!==void 0,v=x?r:u,l=to(s),A=j.useCallback(R=>{if(x){const B=typeof R=="function"?R(r):R;B!==r&&l(B)}else m(R)},[x,r,m,l]);return[v,A]}function sM({defaultProp:r,onChange:n}){const s=j.useState(r),[u]=s,m=j.useRef(u),x=to(n);return j.useEffect(()=>{m.current!==u&&(x(u),m.current=u)},[u,m,x]),s}var oM="VisuallyHidden",ey=j.forwardRef((r,n)=>V.jsx(Fr.span,{...r,ref:n,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...r.style}}));ey.displayName=oM;var aM=ey,yx="ToastProvider",[_x,lM,cM]=s_("Toast"),[$6]=nu("Toast",[cM]),[uM,o_]=$6(yx),G6=r=>{const{__scopeToast:n,label:s="Notification",duration:u=5e3,swipeDirection:m="right",swipeThreshold:x=50,children:v}=r,[l,A]=j.useState(null),[R,L]=j.useState(0),B=j.useRef(!1),W=j.useRef(!1);return s.trim()||console.error(`Invalid prop \`label\` supplied to \`${yx}\`. Expected non-empty \`string\`.`),V.jsx(_x.Provider,{scope:n,children:V.jsx(uM,{scope:n,label:s,duration:u,swipeDirection:m,swipeThreshold:x,toastCount:R,viewport:l,onViewportChange:A,onToastAdd:j.useCallback(()=>L(re=>re+1),[]),onToastRemove:j.useCallback(()=>L(re=>re-1),[]),isFocusedToastEscapeKeyDownRef:B,isClosePausedRef:W,children:v})})};G6.displayName=yx;var q6="ToastViewport",hM=["F8"],_1="toast.viewportPause",v1="toast.viewportResume",Z6=j.forwardRef((r,n)=>{const{__scopeToast:s,hotkey:u=hM,label:m="Notifications ({hotkey})",...x}=r,v=o_(q6,s),l=lM(s),A=j.useRef(null),R=j.useRef(null),L=j.useRef(null),B=j.useRef(null),W=dn(n,B,v.onViewportChange),re=u.join("+").replace(/Key/g,"").replace(/Digit/g,""),ce=v.toastCount>0;j.useEffect(()=>{const X=le=>{u.length!==0&&u.every(_e=>le[_e]||le.code===_e)&&B.current?.focus()};return document.addEventListener("keydown",X),()=>document.removeEventListener("keydown",X)},[u]),j.useEffect(()=>{const X=A.current,le=B.current;if(ce&&X&&le){const he=()=>{if(!v.isClosePausedRef.current){const Je=new CustomEvent(_1);le.dispatchEvent(Je),v.isClosePausedRef.current=!0}},_e=()=>{if(v.isClosePausedRef.current){const Je=new CustomEvent(v1);le.dispatchEvent(Je),v.isClosePausedRef.current=!1}},Ie=Je=>{!X.contains(Je.relatedTarget)&&_e()},ke=()=>{X.contains(document.activeElement)||_e()};return X.addEventListener("focusin",he),X.addEventListener("focusout",Ie),X.addEventListener("pointermove",he),X.addEventListener("pointerleave",ke),window.addEventListener("blur",he),window.addEventListener("focus",_e),()=>{X.removeEventListener("focusin",he),X.removeEventListener("focusout",Ie),X.removeEventListener("pointermove",he),X.removeEventListener("pointerleave",ke),window.removeEventListener("blur",he),window.removeEventListener("focus",_e)}}},[ce,v.isClosePausedRef]);const Q=j.useCallback(({tabbingDirection:X})=>{const he=l().map(_e=>{const Ie=_e.ref.current,ke=[Ie,...SM(Ie)];return X==="forwards"?ke:ke.reverse()});return(X==="forwards"?he.reverse():he).flat()},[l]);return j.useEffect(()=>{const X=B.current;if(X){const le=he=>{const _e=he.altKey||he.ctrlKey||he.metaKey;if(he.key==="Tab"&&!_e){const ke=document.activeElement,Je=he.shiftKey;if(he.target===X&&Je){R.current?.focus();return}const Pt=Q({tabbingDirection:Je?"backwards":"forwards"}),Ct=Pt.findIndex(Zt=>Zt===ke);kv(Pt.slice(Ct+1))?he.preventDefault():Je?R.current?.focus():L.current?.focus()}};return X.addEventListener("keydown",le),()=>X.removeEventListener("keydown",le)}},[l,Q]),V.jsxs(eM,{ref:A,role:"region","aria-label":m.replace("{hotkey}",re),tabIndex:-1,style:{pointerEvents:ce?void 0:"none"},children:[ce&&V.jsx(x1,{ref:R,onFocusFromOutsideViewport:()=>{const X=Q({tabbingDirection:"forwards"});kv(X)}}),V.jsx(_x.Slot,{scope:s,children:V.jsx(Fr.ol,{tabIndex:-1,...x,ref:W})}),ce&&V.jsx(x1,{ref:L,onFocusFromOutsideViewport:()=>{const X=Q({tabbingDirection:"backwards"});kv(X)}})]})});Z6.displayName=q6;var W6="ToastFocusProxy",x1=j.forwardRef((r,n)=>{const{__scopeToast:s,onFocusFromOutsideViewport:u,...m}=r,x=o_(W6,s);return V.jsx(ey,{"aria-hidden":!0,tabIndex:0,...m,ref:n,style:{position:"fixed"},onFocus:v=>{const l=v.relatedTarget;!x.viewport?.contains(l)&&u()}})});x1.displayName=W6;var a_="Toast",dM="toast.swipeStart",fM="toast.swipeMove",pM="toast.swipeCancel",mM="toast.swipeEnd",H6=j.forwardRef((r,n)=>{const{forceMount:s,open:u,defaultOpen:m,onOpenChange:x,...v}=r,[l=!0,A]=dm({prop:u,defaultProp:m,onChange:x});return V.jsx(iu,{present:s||l,children:V.jsx(_M,{open:l,...v,ref:n,onClose:()=>A(!1),onPause:to(r.onPause),onResume:to(r.onResume),onSwipeStart:Ht(r.onSwipeStart,R=>{R.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Ht(r.onSwipeMove,R=>{const{x:L,y:B}=R.detail.delta;R.currentTarget.setAttribute("data-swipe","move"),R.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${L}px`),R.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${B}px`)}),onSwipeCancel:Ht(r.onSwipeCancel,R=>{R.currentTarget.setAttribute("data-swipe","cancel"),R.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),R.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),R.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),R.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Ht(r.onSwipeEnd,R=>{const{x:L,y:B}=R.detail.delta;R.currentTarget.setAttribute("data-swipe","end"),R.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),R.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),R.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${L}px`),R.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${B}px`),A(!1)})})})});H6.displayName=a_;var[gM,yM]=$6(a_,{onClose(){}}),_M=j.forwardRef((r,n)=>{const{__scopeToast:s,type:u="foreground",duration:m,open:x,onClose:v,onEscapeKeyDown:l,onPause:A,onResume:R,onSwipeStart:L,onSwipeMove:B,onSwipeCancel:W,onSwipeEnd:re,...ce}=r,Q=o_(a_,s),[X,le]=j.useState(null),he=dn(n,ft=>le(ft)),_e=j.useRef(null),Ie=j.useRef(null),ke=m||Q.duration,Je=j.useRef(0),He=j.useRef(ke),nt=j.useRef(0),{onToastAdd:Pt,onToastRemove:Ct}=Q,Zt=to(()=>{X?.contains(document.activeElement)&&Q.viewport?.focus(),v()}),lt=j.useCallback(ft=>{!ft||ft===1/0||(window.clearTimeout(nt.current),Je.current=new Date().getTime(),nt.current=window.setTimeout(Zt,ft))},[Zt]);j.useEffect(()=>{const ft=Q.viewport;if(ft){const gt=()=>{lt(He.current),R?.()},dt=()=>{const mt=new Date().getTime()-Je.current;He.current=He.current-mt,window.clearTimeout(nt.current),A?.()};return ft.addEventListener(_1,dt),ft.addEventListener(v1,gt),()=>{ft.removeEventListener(_1,dt),ft.removeEventListener(v1,gt)}}},[Q.viewport,ke,A,R,lt]),j.useEffect(()=>{x&&!Q.isClosePausedRef.current&&lt(ke)},[x,ke,Q.isClosePausedRef,lt]),j.useEffect(()=>(Pt(),()=>Ct()),[Pt,Ct]);const Et=j.useMemo(()=>X?t4(X):null,[X]);return Q.viewport?V.jsxs(V.Fragment,{children:[Et&&V.jsx(vM,{__scopeToast:s,role:"status","aria-live":u==="foreground"?"assertive":"polite","aria-atomic":!0,children:Et}),V.jsx(gM,{scope:s,onClose:Zt,children:Ld.createPortal(V.jsx(_x.ItemSlot,{scope:s,children:V.jsx(JE,{asChild:!0,onEscapeKeyDown:Ht(l,()=>{Q.isFocusedToastEscapeKeyDownRef.current||Zt(),Q.isFocusedToastEscapeKeyDownRef.current=!1}),children:V.jsx(Fr.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":x?"open":"closed","data-swipe-direction":Q.swipeDirection,...ce,ref:he,style:{userSelect:"none",touchAction:"none",...r.style},onKeyDown:Ht(r.onKeyDown,ft=>{ft.key==="Escape"&&(l?.(ft.nativeEvent),ft.nativeEvent.defaultPrevented||(Q.isFocusedToastEscapeKeyDownRef.current=!0,Zt()))}),onPointerDown:Ht(r.onPointerDown,ft=>{ft.button===0&&(_e.current={x:ft.clientX,y:ft.clientY})}),onPointerMove:Ht(r.onPointerMove,ft=>{if(!_e.current)return;const gt=ft.clientX-_e.current.x,dt=ft.clientY-_e.current.y,mt=!!Ie.current,Xe=["left","right"].includes(Q.swipeDirection),Be=["left","up"].includes(Q.swipeDirection)?Math.min:Math.max,_t=Xe?Be(0,gt):0,Re=Xe?0:Be(0,dt),at=ft.pointerType==="touch"?10:2,nr={x:_t,y:Re},er={originalEvent:ft,delta:nr};mt?(Ie.current=nr,n0(fM,B,er,{discrete:!1})):Hb(nr,Q.swipeDirection,at)?(Ie.current=nr,n0(dM,L,er,{discrete:!1}),ft.target.setPointerCapture(ft.pointerId)):(Math.abs(gt)>at||Math.abs(dt)>at)&&(_e.current=null)}),onPointerUp:Ht(r.onPointerUp,ft=>{const gt=Ie.current,dt=ft.target;if(dt.hasPointerCapture(ft.pointerId)&&dt.releasePointerCapture(ft.pointerId),Ie.current=null,_e.current=null,gt){const mt=ft.currentTarget,Xe={originalEvent:ft,delta:gt};Hb(gt,Q.swipeDirection,Q.swipeThreshold)?n0(mM,re,Xe,{discrete:!0}):n0(pM,W,Xe,{discrete:!0}),mt.addEventListener("click",Be=>Be.preventDefault(),{once:!0})}})})})}),Q.viewport)})]}):null}),vM=r=>{const{__scopeToast:n,children:s,...u}=r,m=o_(a_,n),[x,v]=j.useState(!1),[l,A]=j.useState(!1);return wM(()=>v(!0)),j.useEffect(()=>{const R=window.setTimeout(()=>A(!0),1e3);return()=>window.clearTimeout(R)},[]),l?null:V.jsx(Jg,{asChild:!0,children:V.jsx(ey,{...u,children:x&&V.jsxs(V.Fragment,{children:[m.label," ",s]})})})},xM="ToastTitle",X6=j.forwardRef((r,n)=>{const{__scopeToast:s,...u}=r;return V.jsx(Fr.div,{...u,ref:n})});X6.displayName=xM;var bM="ToastDescription",K6=j.forwardRef((r,n)=>{const{__scopeToast:s,...u}=r;return V.jsx(Fr.div,{...u,ref:n})});K6.displayName=bM;var Y6="ToastAction",Q6=j.forwardRef((r,n)=>{const{altText:s,...u}=r;return s.trim()?V.jsx(e4,{altText:s,asChild:!0,children:V.jsx(vx,{...u,ref:n})}):(console.error(`Invalid prop \`altText\` supplied to \`${Y6}\`. Expected non-empty \`string\`.`),null)});Q6.displayName=Y6;var J6="ToastClose",vx=j.forwardRef((r,n)=>{const{__scopeToast:s,...u}=r,m=yM(J6,s);return V.jsx(e4,{asChild:!0,children:V.jsx(Fr.button,{type:"button",...u,ref:n,onClick:Ht(r.onClick,m.onClose)})})});vx.displayName=J6;var e4=j.forwardRef((r,n)=>{const{__scopeToast:s,altText:u,...m}=r;return V.jsx(Fr.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":u||void 0,...m,ref:n})});function t4(r){const n=[];return Array.from(r.childNodes).forEach(u=>{if(u.nodeType===u.TEXT_NODE&&u.textContent&&n.push(u.textContent),TM(u)){const m=u.ariaHidden||u.hidden||u.style.display==="none",x=u.dataset.radixToastAnnounceExclude==="";if(!m)if(x){const v=u.dataset.radixToastAnnounceAlt;v&&n.push(v)}else n.push(...t4(u))}}),n}function n0(r,n,s,{discrete:u}){const m=s.originalEvent.currentTarget,x=new CustomEvent(r,{bubbles:!0,cancelable:!0,detail:s});n&&m.addEventListener(r,n,{once:!0}),u?gx(m,x):m.dispatchEvent(x)}var Hb=(r,n,s=0)=>{const u=Math.abs(r.x),m=Math.abs(r.y),x=u>m;return n==="left"||n==="right"?x&&u>s:!x&&m>s};function wM(r=()=>{}){const n=to(r);ro(()=>{let s=0,u=0;return s=window.requestAnimationFrame(()=>u=window.requestAnimationFrame(n)),()=>{window.cancelAnimationFrame(s),window.cancelAnimationFrame(u)}},[n])}function TM(r){return r.nodeType===r.ELEMENT_NODE}function SM(r){const n=[],s=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:u=>{const m=u.tagName==="INPUT"&&u.type==="hidden";return u.disabled||u.hidden||m?NodeFilter.FILTER_SKIP:u.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)n.push(s.currentNode);return n}function kv(r){const n=document.activeElement;return r.some(s=>s===n?!0:(s.focus(),document.activeElement!==n))}var PM=G6,r4=Z6,n4=H6,i4=X6,s4=K6,o4=Q6,a4=vx;function l4(r){var n,s,u="";if(typeof r=="string"||typeof r=="number")u+=r;else if(typeof r=="object")if(Array.isArray(r)){var m=r.length;for(n=0;n<m;n++)r[n]&&(s=l4(r[n]))&&(u&&(u+=" "),u+=s)}else for(s in r)r[s]&&(u&&(u+=" "),u+=s);return u}function c4(){for(var r,n,s=0,u="",m=arguments.length;s<m;s++)(r=arguments[s])&&(n=l4(r))&&(u&&(u+=" "),u+=n);return u}const Xb=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,Kb=c4,xx=(r,n)=>s=>{var u;if(n?.variants==null)return Kb(r,s?.class,s?.className);const{variants:m,defaultVariants:x}=n,v=Object.keys(m).map(R=>{const L=s?.[R],B=x?.[R];if(L===null)return null;const W=Xb(L)||Xb(B);return m[R][W]}),l=s&&Object.entries(s).reduce((R,L)=>{let[B,W]=L;return W===void 0||(R[B]=W),R},{}),A=n==null||(u=n.compoundVariants)===null||u===void 0?void 0:u.reduce((R,L)=>{let{class:B,className:W,...re}=L;return Object.entries(re).every(ce=>{let[Q,X]=ce;return Array.isArray(X)?X.includes({...x,...l}[Q]):{...x,...l}[Q]===X})?[...R,B,W]:R},[]);return Kb(r,v,A,s?.class,s?.className)};const CM=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),u4=(...r)=>r.filter((n,s,u)=>!!n&&u.indexOf(n)===s).join(" ");var EM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const MM=j.forwardRef(({color:r="currentColor",size:n=24,strokeWidth:s=2,absoluteStrokeWidth:u,className:m="",children:x,iconNode:v,...l},A)=>j.createElement("svg",{ref:A,...EM,width:n,height:n,stroke:r,strokeWidth:u?Number(s)*24/Number(n):s,className:u4("lucide",m),...l},[...v.map(([R,L])=>j.createElement(R,L)),...Array.isArray(x)?x:[x]]));const En=(r,n)=>{const s=j.forwardRef(({className:u,...m},x)=>j.createElement(MM,{ref:x,iconNode:n,className:u4(`lucide-${CM(r)}`,u),...m}));return s.displayName=`${r}`,s};const IM=En("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);const AM=En("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);const h4=En("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const bx=En("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const kM=En("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const d4=En("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const DM=En("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const RM=En("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const LM=En("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const zM=En("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const FM=En("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);const OM=En("Fish",[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]]);const NM=En("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);const jM=En("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);const BM=En("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);const VM=En("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);const P0=En("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const UM=En("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const f4=En("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const p4=En("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);const $M=En("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);const GM=En("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);const qM=En("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const ZM=En("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const WM=En("Snowflake",[["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"m20 16-4-4 4-4",key:"rquw4f"}],["path",{d:"m4 8 4 4-4 4",key:"12s3z9"}],["path",{d:"m16 4-4 4-4-4",key:"1tumq1"}],["path",{d:"m8 20 4-4 4 4",key:"9p200w"}]]);const HM=En("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const XM=En("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]);const KM=En("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const YM=En("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);const C0=En("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),wx="-",QM=r=>{const n=eI(r),{conflictingClassGroups:s,conflictingClassGroupModifiers:u}=r;return{getClassGroupId:v=>{const l=v.split(wx);return l[0]===""&&l.length!==1&&l.shift(),m4(l,n)||JM(v)},getConflictingClassGroupIds:(v,l)=>{const A=s[v]||[];return l&&u[v]?[...A,...u[v]]:A}}},m4=(r,n)=>{if(r.length===0)return n.classGroupId;const s=r[0],u=n.nextPart.get(s),m=u?m4(r.slice(1),u):void 0;if(m)return m;if(n.validators.length===0)return;const x=r.join(wx);return n.validators.find(({validator:v})=>v(x))?.classGroupId},Yb=/^\[(.+)\]$/,JM=r=>{if(Yb.test(r)){const n=Yb.exec(r)[1],s=n?.substring(0,n.indexOf(":"));if(s)return"arbitrary.."+s}},eI=r=>{const{theme:n,prefix:s}=r,u={nextPart:new Map,validators:[]};return rI(Object.entries(r.classGroups),s).forEach(([x,v])=>{b1(v,u,x,n)}),u},b1=(r,n,s,u)=>{r.forEach(m=>{if(typeof m=="string"){const x=m===""?n:Qb(n,m);x.classGroupId=s;return}if(typeof m=="function"){if(tI(m)){b1(m(u),n,s,u);return}n.validators.push({validator:m,classGroupId:s});return}Object.entries(m).forEach(([x,v])=>{b1(v,Qb(n,x),s,u)})})},Qb=(r,n)=>{let s=r;return n.split(wx).forEach(u=>{s.nextPart.has(u)||s.nextPart.set(u,{nextPart:new Map,validators:[]}),s=s.nextPart.get(u)}),s},tI=r=>r.isThemeGetter,rI=(r,n)=>n?r.map(([s,u])=>{const m=u.map(x=>typeof x=="string"?n+x:typeof x=="object"?Object.fromEntries(Object.entries(x).map(([v,l])=>[n+v,l])):x);return[s,m]}):r,nI=r=>{if(r<1)return{get:()=>{},set:()=>{}};let n=0,s=new Map,u=new Map;const m=(x,v)=>{s.set(x,v),n++,n>r&&(n=0,u=s,s=new Map)};return{get(x){let v=s.get(x);if(v!==void 0)return v;if((v=u.get(x))!==void 0)return m(x,v),v},set(x,v){s.has(x)?s.set(x,v):m(x,v)}}},g4="!",iI=r=>{const{separator:n,experimentalParseClassName:s}=r,u=n.length===1,m=n[0],x=n.length,v=l=>{const A=[];let R=0,L=0,B;for(let X=0;X<l.length;X++){let le=l[X];if(R===0){if(le===m&&(u||l.slice(X,X+x)===n)){A.push(l.slice(L,X)),L=X+x;continue}if(le==="/"){B=X;continue}}le==="["?R++:le==="]"&&R--}const W=A.length===0?l:l.substring(L),re=W.startsWith(g4),ce=re?W.substring(1):W,Q=B&&B>L?B-L:void 0;return{modifiers:A,hasImportantModifier:re,baseClassName:ce,maybePostfixModifierPosition:Q}};return s?l=>s({className:l,parseClassName:v}):v},sI=r=>{if(r.length<=1)return r;const n=[];let s=[];return r.forEach(u=>{u[0]==="["?(n.push(...s.sort(),u),s=[]):s.push(u)}),n.push(...s.sort()),n},oI=r=>({cache:nI(r.cacheSize),parseClassName:iI(r),...QM(r)}),aI=/\s+/,lI=(r,n)=>{const{parseClassName:s,getClassGroupId:u,getConflictingClassGroupIds:m}=n,x=[],v=r.trim().split(aI);let l="";for(let A=v.length-1;A>=0;A-=1){const R=v[A],{modifiers:L,hasImportantModifier:B,baseClassName:W,maybePostfixModifierPosition:re}=s(R);let ce=!!re,Q=u(ce?W.substring(0,re):W);if(!Q){if(!ce){l=R+(l.length>0?" "+l:l);continue}if(Q=u(W),!Q){l=R+(l.length>0?" "+l:l);continue}ce=!1}const X=sI(L).join(":"),le=B?X+g4:X,he=le+Q;if(x.includes(he))continue;x.push(he);const _e=m(Q,ce);for(let Ie=0;Ie<_e.length;++Ie){const ke=_e[Ie];x.push(le+ke)}l=R+(l.length>0?" "+l:l)}return l};function cI(){let r=0,n,s,u="";for(;r<arguments.length;)(n=arguments[r++])&&(s=y4(n))&&(u&&(u+=" "),u+=s);return u}const y4=r=>{if(typeof r=="string")return r;let n,s="";for(let u=0;u<r.length;u++)r[u]&&(n=y4(r[u]))&&(s&&(s+=" "),s+=n);return s};function uI(r,...n){let s,u,m,x=v;function v(A){const R=n.reduce((L,B)=>B(L),r());return s=oI(R),u=s.cache.get,m=s.cache.set,x=l,l(A)}function l(A){const R=u(A);if(R)return R;const L=lI(A,s);return m(A,L),L}return function(){return x(cI.apply(null,arguments))}}const ti=r=>{const n=s=>s[r]||[];return n.isThemeGetter=!0,n},_4=/^\[(?:([a-z-]+):)?(.+)\]$/i,hI=/^\d+\/\d+$/,dI=new Set(["px","full","screen"]),fI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,pI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,mI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,gI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,yI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ku=r=>sm(r)||dI.has(r)||hI.test(r),_d=r=>Pm(r,"length",PI),sm=r=>!!r&&!Number.isNaN(Number(r)),Dv=r=>Pm(r,"number",sm),ug=r=>!!r&&Number.isInteger(Number(r)),_I=r=>r.endsWith("%")&&sm(r.slice(0,-1)),zr=r=>_4.test(r),vd=r=>fI.test(r),vI=new Set(["length","size","percentage"]),xI=r=>Pm(r,vI,v4),bI=r=>Pm(r,"position",v4),wI=new Set(["image","url"]),TI=r=>Pm(r,wI,EI),SI=r=>Pm(r,"",CI),hg=()=>!0,Pm=(r,n,s)=>{const u=_4.exec(r);return u?u[1]?typeof n=="string"?u[1]===n:n.has(u[1]):s(u[2]):!1},PI=r=>pI.test(r)&&!mI.test(r),v4=()=>!1,CI=r=>gI.test(r),EI=r=>yI.test(r),MI=()=>{const r=ti("colors"),n=ti("spacing"),s=ti("blur"),u=ti("brightness"),m=ti("borderColor"),x=ti("borderRadius"),v=ti("borderSpacing"),l=ti("borderWidth"),A=ti("contrast"),R=ti("grayscale"),L=ti("hueRotate"),B=ti("invert"),W=ti("gap"),re=ti("gradientColorStops"),ce=ti("gradientColorStopPositions"),Q=ti("inset"),X=ti("margin"),le=ti("opacity"),he=ti("padding"),_e=ti("saturate"),Ie=ti("scale"),ke=ti("sepia"),Je=ti("skew"),He=ti("space"),nt=ti("translate"),Pt=()=>["auto","contain","none"],Ct=()=>["auto","hidden","clip","visible","scroll"],Zt=()=>["auto",zr,n],lt=()=>[zr,n],Et=()=>["",Ku,_d],ft=()=>["auto",sm,zr],gt=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],dt=()=>["solid","dashed","dotted","double","none"],mt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Xe=()=>["start","end","center","between","around","evenly","stretch"],Be=()=>["","0",zr],_t=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Re=()=>[sm,zr];return{cacheSize:500,separator:":",theme:{colors:[hg],spacing:[Ku,_d],blur:["none","",vd,zr],brightness:Re(),borderColor:[r],borderRadius:["none","","full",vd,zr],borderSpacing:lt(),borderWidth:Et(),contrast:Re(),grayscale:Be(),hueRotate:Re(),invert:Be(),gap:lt(),gradientColorStops:[r],gradientColorStopPositions:[_I,_d],inset:Zt(),margin:Zt(),opacity:Re(),padding:lt(),saturate:Re(),scale:Re(),sepia:Be(),skew:Re(),space:lt(),translate:lt()},classGroups:{aspect:[{aspect:["auto","square","video",zr]}],container:["container"],columns:[{columns:[vd]}],"break-after":[{"break-after":_t()}],"break-before":[{"break-before":_t()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...gt(),zr]}],overflow:[{overflow:Ct()}],"overflow-x":[{"overflow-x":Ct()}],"overflow-y":[{"overflow-y":Ct()}],overscroll:[{overscroll:Pt()}],"overscroll-x":[{"overscroll-x":Pt()}],"overscroll-y":[{"overscroll-y":Pt()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[Q]}],"inset-x":[{"inset-x":[Q]}],"inset-y":[{"inset-y":[Q]}],start:[{start:[Q]}],end:[{end:[Q]}],top:[{top:[Q]}],right:[{right:[Q]}],bottom:[{bottom:[Q]}],left:[{left:[Q]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ug,zr]}],basis:[{basis:Zt()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",zr]}],grow:[{grow:Be()}],shrink:[{shrink:Be()}],order:[{order:["first","last","none",ug,zr]}],"grid-cols":[{"grid-cols":[hg]}],"col-start-end":[{col:["auto",{span:["full",ug,zr]},zr]}],"col-start":[{"col-start":ft()}],"col-end":[{"col-end":ft()}],"grid-rows":[{"grid-rows":[hg]}],"row-start-end":[{row:["auto",{span:[ug,zr]},zr]}],"row-start":[{"row-start":ft()}],"row-end":[{"row-end":ft()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",zr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",zr]}],gap:[{gap:[W]}],"gap-x":[{"gap-x":[W]}],"gap-y":[{"gap-y":[W]}],"justify-content":[{justify:["normal",...Xe()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Xe(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Xe(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[he]}],px:[{px:[he]}],py:[{py:[he]}],ps:[{ps:[he]}],pe:[{pe:[he]}],pt:[{pt:[he]}],pr:[{pr:[he]}],pb:[{pb:[he]}],pl:[{pl:[he]}],m:[{m:[X]}],mx:[{mx:[X]}],my:[{my:[X]}],ms:[{ms:[X]}],me:[{me:[X]}],mt:[{mt:[X]}],mr:[{mr:[X]}],mb:[{mb:[X]}],ml:[{ml:[X]}],"space-x":[{"space-x":[He]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[He]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",zr,n]}],"min-w":[{"min-w":[zr,n,"min","max","fit"]}],"max-w":[{"max-w":[zr,n,"none","full","min","max","fit","prose",{screen:[vd]},vd]}],h:[{h:[zr,n,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[zr,n,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[zr,n,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[zr,n,"auto","min","max","fit"]}],"font-size":[{text:["base",vd,_d]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Dv]}],"font-family":[{font:[hg]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",zr]}],"line-clamp":[{"line-clamp":["none",sm,Dv]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ku,zr]}],"list-image":[{"list-image":["none",zr]}],"list-style-type":[{list:["none","disc","decimal",zr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[le]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[le]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...dt(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ku,_d]}],"underline-offset":[{"underline-offset":["auto",Ku,zr]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:lt()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",zr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",zr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[le]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...gt(),bI]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",xI]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},TI]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[ce]}],"gradient-via-pos":[{via:[ce]}],"gradient-to-pos":[{to:[ce]}],"gradient-from":[{from:[re]}],"gradient-via":[{via:[re]}],"gradient-to":[{to:[re]}],rounded:[{rounded:[x]}],"rounded-s":[{"rounded-s":[x]}],"rounded-e":[{"rounded-e":[x]}],"rounded-t":[{"rounded-t":[x]}],"rounded-r":[{"rounded-r":[x]}],"rounded-b":[{"rounded-b":[x]}],"rounded-l":[{"rounded-l":[x]}],"rounded-ss":[{"rounded-ss":[x]}],"rounded-se":[{"rounded-se":[x]}],"rounded-ee":[{"rounded-ee":[x]}],"rounded-es":[{"rounded-es":[x]}],"rounded-tl":[{"rounded-tl":[x]}],"rounded-tr":[{"rounded-tr":[x]}],"rounded-br":[{"rounded-br":[x]}],"rounded-bl":[{"rounded-bl":[x]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[le]}],"border-style":[{border:[...dt(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[le]}],"divide-style":[{divide:dt()}],"border-color":[{border:[m]}],"border-color-x":[{"border-x":[m]}],"border-color-y":[{"border-y":[m]}],"border-color-s":[{"border-s":[m]}],"border-color-e":[{"border-e":[m]}],"border-color-t":[{"border-t":[m]}],"border-color-r":[{"border-r":[m]}],"border-color-b":[{"border-b":[m]}],"border-color-l":[{"border-l":[m]}],"divide-color":[{divide:[m]}],"outline-style":[{outline:["",...dt()]}],"outline-offset":[{"outline-offset":[Ku,zr]}],"outline-w":[{outline:[Ku,_d]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:Et()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[le]}],"ring-offset-w":[{"ring-offset":[Ku,_d]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",vd,SI]}],"shadow-color":[{shadow:[hg]}],opacity:[{opacity:[le]}],"mix-blend":[{"mix-blend":[...mt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":mt()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[u]}],contrast:[{contrast:[A]}],"drop-shadow":[{"drop-shadow":["","none",vd,zr]}],grayscale:[{grayscale:[R]}],"hue-rotate":[{"hue-rotate":[L]}],invert:[{invert:[B]}],saturate:[{saturate:[_e]}],sepia:[{sepia:[ke]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[u]}],"backdrop-contrast":[{"backdrop-contrast":[A]}],"backdrop-grayscale":[{"backdrop-grayscale":[R]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[L]}],"backdrop-invert":[{"backdrop-invert":[B]}],"backdrop-opacity":[{"backdrop-opacity":[le]}],"backdrop-saturate":[{"backdrop-saturate":[_e]}],"backdrop-sepia":[{"backdrop-sepia":[ke]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[v]}],"border-spacing-x":[{"border-spacing-x":[v]}],"border-spacing-y":[{"border-spacing-y":[v]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",zr]}],duration:[{duration:Re()}],ease:[{ease:["linear","in","out","in-out",zr]}],delay:[{delay:Re()}],animate:[{animate:["none","spin","ping","pulse","bounce",zr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[Ie]}],"scale-x":[{"scale-x":[Ie]}],"scale-y":[{"scale-y":[Ie]}],rotate:[{rotate:[ug,zr]}],"translate-x":[{"translate-x":[nt]}],"translate-y":[{"translate-y":[nt]}],"skew-x":[{"skew-x":[Je]}],"skew-y":[{"skew-y":[Je]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",zr]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",zr]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":lt()}],"scroll-mx":[{"scroll-mx":lt()}],"scroll-my":[{"scroll-my":lt()}],"scroll-ms":[{"scroll-ms":lt()}],"scroll-me":[{"scroll-me":lt()}],"scroll-mt":[{"scroll-mt":lt()}],"scroll-mr":[{"scroll-mr":lt()}],"scroll-mb":[{"scroll-mb":lt()}],"scroll-ml":[{"scroll-ml":lt()}],"scroll-p":[{"scroll-p":lt()}],"scroll-px":[{"scroll-px":lt()}],"scroll-py":[{"scroll-py":lt()}],"scroll-ps":[{"scroll-ps":lt()}],"scroll-pe":[{"scroll-pe":lt()}],"scroll-pt":[{"scroll-pt":lt()}],"scroll-pr":[{"scroll-pr":lt()}],"scroll-pb":[{"scroll-pb":lt()}],"scroll-pl":[{"scroll-pl":lt()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",zr]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[Ku,_d,Dv]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},II=uI(MI);function lr(...r){return II(c4(r))}const AI=PM,x4=j.forwardRef(({className:r,...n},s)=>V.jsx(r4,{ref:s,className:lr("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",r),...n}));x4.displayName=r4.displayName;const kI=xx("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),b4=j.forwardRef(({className:r,variant:n,...s},u)=>V.jsx(n4,{ref:u,className:lr(kI({variant:n}),r),...s}));b4.displayName=n4.displayName;const DI=j.forwardRef(({className:r,...n},s)=>V.jsx(o4,{ref:s,className:lr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",r),...n}));DI.displayName=o4.displayName;const w4=j.forwardRef(({className:r,...n},s)=>V.jsx(a4,{ref:s,className:lr("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",r),"toast-close":"",...n,children:V.jsx(C0,{className:"h-4 w-4"})}));w4.displayName=a4.displayName;const T4=j.forwardRef(({className:r,...n},s)=>V.jsx(i4,{ref:s,className:lr("text-sm font-semibold",r),...n}));T4.displayName=i4.displayName;const S4=j.forwardRef(({className:r,...n},s)=>V.jsx(s4,{ref:s,className:lr("text-sm opacity-90",r),...n}));S4.displayName=s4.displayName;function RI(){const{toasts:r}=mx();return V.jsxs(AI,{children:[r.map(function({id:n,title:s,description:u,action:m,...x}){return V.jsxs(b4,{...x,children:[V.jsxs("div",{className:"grid gap-1",children:[s&&V.jsx(T4,{children:s}),u&&V.jsx(S4,{children:u})]}),m,V.jsx(w4,{})]},n)}),V.jsx(x4,{})]})}var LI=d6[" useId ".trim().toString()]||(()=>{}),zI=0;function th(r){const[n,s]=j.useState(LI());return ro(()=>{s(u=>u??String(zI++))},[r]),n?`radix-${n}`:""}const FI=["top","right","bottom","left"],Pd=Math.min,Sa=Math.max,E0=Math.round,i0=Math.floor,Kc=r=>({x:r,y:r}),OI={left:"right",right:"left",bottom:"top",top:"bottom"},NI={start:"end",end:"start"};function w1(r,n,s){return Sa(r,Pd(n,s))}function ih(r,n){return typeof r=="function"?r(n):r}function sh(r){return r.split("-")[0]}function Cm(r){return r.split("-")[1]}function Tx(r){return r==="x"?"y":"x"}function Sx(r){return r==="y"?"height":"width"}function Cd(r){return["top","bottom"].includes(sh(r))?"y":"x"}function Px(r){return Tx(Cd(r))}function jI(r,n,s){s===void 0&&(s=!1);const u=Cm(r),m=Px(r),x=Sx(m);let v=m==="x"?u===(s?"end":"start")?"right":"left":u==="start"?"bottom":"top";return n.reference[x]>n.floating[x]&&(v=M0(v)),[v,M0(v)]}function BI(r){const n=M0(r);return[T1(r),n,T1(n)]}function T1(r){return r.replace(/start|end/g,n=>NI[n])}function VI(r,n,s){const u=["left","right"],m=["right","left"],x=["top","bottom"],v=["bottom","top"];switch(r){case"top":case"bottom":return s?n?m:u:n?u:m;case"left":case"right":return n?x:v;default:return[]}}function UI(r,n,s,u){const m=Cm(r);let x=VI(sh(r),s==="start",u);return m&&(x=x.map(v=>v+"-"+m),n&&(x=x.concat(x.map(T1)))),x}function M0(r){return r.replace(/left|right|bottom|top/g,n=>OI[n])}function $I(r){return{top:0,right:0,bottom:0,left:0,...r}}function P4(r){return typeof r!="number"?$I(r):{top:r,right:r,bottom:r,left:r}}function I0(r){const{x:n,y:s,width:u,height:m}=r;return{width:u,height:m,top:s,left:n,right:n+u,bottom:s+m,x:n,y:s}}function Jb(r,n,s){let{reference:u,floating:m}=r;const x=Cd(n),v=Px(n),l=Sx(v),A=sh(n),R=x==="y",L=u.x+u.width/2-m.width/2,B=u.y+u.height/2-m.height/2,W=u[l]/2-m[l]/2;let re;switch(A){case"top":re={x:L,y:u.y-m.height};break;case"bottom":re={x:L,y:u.y+u.height};break;case"right":re={x:u.x+u.width,y:B};break;case"left":re={x:u.x-m.width,y:B};break;default:re={x:u.x,y:u.y}}switch(Cm(n)){case"start":re[v]-=W*(s&&R?-1:1);break;case"end":re[v]+=W*(s&&R?-1:1);break}return re}const GI=async(r,n,s)=>{const{placement:u="bottom",strategy:m="absolute",middleware:x=[],platform:v}=s,l=x.filter(Boolean),A=await(v.isRTL==null?void 0:v.isRTL(n));let R=await v.getElementRects({reference:r,floating:n,strategy:m}),{x:L,y:B}=Jb(R,u,A),W=u,re={},ce=0;for(let Q=0;Q<l.length;Q++){const{name:X,fn:le}=l[Q],{x:he,y:_e,data:Ie,reset:ke}=await le({x:L,y:B,initialPlacement:u,placement:W,strategy:m,middlewareData:re,rects:R,platform:v,elements:{reference:r,floating:n}});L=he??L,B=_e??B,re={...re,[X]:{...re[X],...Ie}},ke&&ce<=50&&(ce++,typeof ke=="object"&&(ke.placement&&(W=ke.placement),ke.rects&&(R=ke.rects===!0?await v.getElementRects({reference:r,floating:n,strategy:m}):ke.rects),{x:L,y:B}=Jb(R,W,A)),Q=-1)}return{x:L,y:B,placement:W,strategy:m,middlewareData:re}};async function Mg(r,n){var s;n===void 0&&(n={});const{x:u,y:m,platform:x,rects:v,elements:l,strategy:A}=r,{boundary:R="clippingAncestors",rootBoundary:L="viewport",elementContext:B="floating",altBoundary:W=!1,padding:re=0}=ih(n,r),ce=P4(re),X=l[W?B==="floating"?"reference":"floating":B],le=I0(await x.getClippingRect({element:(s=await(x.isElement==null?void 0:x.isElement(X)))==null||s?X:X.contextElement||await(x.getDocumentElement==null?void 0:x.getDocumentElement(l.floating)),boundary:R,rootBoundary:L,strategy:A})),he=B==="floating"?{x:u,y:m,width:v.floating.width,height:v.floating.height}:v.reference,_e=await(x.getOffsetParent==null?void 0:x.getOffsetParent(l.floating)),Ie=await(x.isElement==null?void 0:x.isElement(_e))?await(x.getScale==null?void 0:x.getScale(_e))||{x:1,y:1}:{x:1,y:1},ke=I0(x.convertOffsetParentRelativeRectToViewportRelativeRect?await x.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:he,offsetParent:_e,strategy:A}):he);return{top:(le.top-ke.top+ce.top)/Ie.y,bottom:(ke.bottom-le.bottom+ce.bottom)/Ie.y,left:(le.left-ke.left+ce.left)/Ie.x,right:(ke.right-le.right+ce.right)/Ie.x}}const qI=r=>({name:"arrow",options:r,async fn(n){const{x:s,y:u,placement:m,rects:x,platform:v,elements:l,middlewareData:A}=n,{element:R,padding:L=0}=ih(r,n)||{};if(R==null)return{};const B=P4(L),W={x:s,y:u},re=Px(m),ce=Sx(re),Q=await v.getDimensions(R),X=re==="y",le=X?"top":"left",he=X?"bottom":"right",_e=X?"clientHeight":"clientWidth",Ie=x.reference[ce]+x.reference[re]-W[re]-x.floating[ce],ke=W[re]-x.reference[re],Je=await(v.getOffsetParent==null?void 0:v.getOffsetParent(R));let He=Je?Je[_e]:0;(!He||!await(v.isElement==null?void 0:v.isElement(Je)))&&(He=l.floating[_e]||x.floating[ce]);const nt=Ie/2-ke/2,Pt=He/2-Q[ce]/2-1,Ct=Pd(B[le],Pt),Zt=Pd(B[he],Pt),lt=Ct,Et=He-Q[ce]-Zt,ft=He/2-Q[ce]/2+nt,gt=w1(lt,ft,Et),dt=!A.arrow&&Cm(m)!=null&&ft!==gt&&x.reference[ce]/2-(ft<lt?Ct:Zt)-Q[ce]/2<0,mt=dt?ft<lt?ft-lt:ft-Et:0;return{[re]:W[re]+mt,data:{[re]:gt,centerOffset:ft-gt-mt,...dt&&{alignmentOffset:mt}},reset:dt}}}),ZI=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(n){var s,u;const{placement:m,middlewareData:x,rects:v,initialPlacement:l,platform:A,elements:R}=n,{mainAxis:L=!0,crossAxis:B=!0,fallbackPlacements:W,fallbackStrategy:re="bestFit",fallbackAxisSideDirection:ce="none",flipAlignment:Q=!0,...X}=ih(r,n);if((s=x.arrow)!=null&&s.alignmentOffset)return{};const le=sh(m),he=Cd(l),_e=sh(l)===l,Ie=await(A.isRTL==null?void 0:A.isRTL(R.floating)),ke=W||(_e||!Q?[M0(l)]:BI(l)),Je=ce!=="none";!W&&Je&&ke.push(...UI(l,Q,ce,Ie));const He=[l,...ke],nt=await Mg(n,X),Pt=[];let Ct=((u=x.flip)==null?void 0:u.overflows)||[];if(L&&Pt.push(nt[le]),B){const ft=jI(m,v,Ie);Pt.push(nt[ft[0]],nt[ft[1]])}if(Ct=[...Ct,{placement:m,overflows:Pt}],!Pt.every(ft=>ft<=0)){var Zt,lt;const ft=(((Zt=x.flip)==null?void 0:Zt.index)||0)+1,gt=He[ft];if(gt)return{data:{index:ft,overflows:Ct},reset:{placement:gt}};let dt=(lt=Ct.filter(mt=>mt.overflows[0]<=0).sort((mt,Xe)=>mt.overflows[1]-Xe.overflows[1])[0])==null?void 0:lt.placement;if(!dt)switch(re){case"bestFit":{var Et;const mt=(Et=Ct.filter(Xe=>{if(Je){const Be=Cd(Xe.placement);return Be===he||Be==="y"}return!0}).map(Xe=>[Xe.placement,Xe.overflows.filter(Be=>Be>0).reduce((Be,_t)=>Be+_t,0)]).sort((Xe,Be)=>Xe[1]-Be[1])[0])==null?void 0:Et[0];mt&&(dt=mt);break}case"initialPlacement":dt=l;break}if(m!==dt)return{reset:{placement:dt}}}return{}}}};function ew(r,n){return{top:r.top-n.height,right:r.right-n.width,bottom:r.bottom-n.height,left:r.left-n.width}}function tw(r){return FI.some(n=>r[n]>=0)}const WI=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(n){const{rects:s}=n,{strategy:u="referenceHidden",...m}=ih(r,n);switch(u){case"referenceHidden":{const x=await Mg(n,{...m,elementContext:"reference"}),v=ew(x,s.reference);return{data:{referenceHiddenOffsets:v,referenceHidden:tw(v)}}}case"escaped":{const x=await Mg(n,{...m,altBoundary:!0}),v=ew(x,s.floating);return{data:{escapedOffsets:v,escaped:tw(v)}}}default:return{}}}}};async function HI(r,n){const{placement:s,platform:u,elements:m}=r,x=await(u.isRTL==null?void 0:u.isRTL(m.floating)),v=sh(s),l=Cm(s),A=Cd(s)==="y",R=["left","top"].includes(v)?-1:1,L=x&&A?-1:1,B=ih(n,r);let{mainAxis:W,crossAxis:re,alignmentAxis:ce}=typeof B=="number"?{mainAxis:B,crossAxis:0,alignmentAxis:null}:{mainAxis:B.mainAxis||0,crossAxis:B.crossAxis||0,alignmentAxis:B.alignmentAxis};return l&&typeof ce=="number"&&(re=l==="end"?ce*-1:ce),A?{x:re*L,y:W*R}:{x:W*R,y:re*L}}const XI=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(n){var s,u;const{x:m,y:x,placement:v,middlewareData:l}=n,A=await HI(n,r);return v===((s=l.offset)==null?void 0:s.placement)&&(u=l.arrow)!=null&&u.alignmentOffset?{}:{x:m+A.x,y:x+A.y,data:{...A,placement:v}}}}},KI=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(n){const{x:s,y:u,placement:m}=n,{mainAxis:x=!0,crossAxis:v=!1,limiter:l={fn:X=>{let{x:le,y:he}=X;return{x:le,y:he}}},...A}=ih(r,n),R={x:s,y:u},L=await Mg(n,A),B=Cd(sh(m)),W=Tx(B);let re=R[W],ce=R[B];if(x){const X=W==="y"?"top":"left",le=W==="y"?"bottom":"right",he=re+L[X],_e=re-L[le];re=w1(he,re,_e)}if(v){const X=B==="y"?"top":"left",le=B==="y"?"bottom":"right",he=ce+L[X],_e=ce-L[le];ce=w1(he,ce,_e)}const Q=l.fn({...n,[W]:re,[B]:ce});return{...Q,data:{x:Q.x-s,y:Q.y-u,enabled:{[W]:x,[B]:v}}}}}},YI=function(r){return r===void 0&&(r={}),{options:r,fn(n){const{x:s,y:u,placement:m,rects:x,middlewareData:v}=n,{offset:l=0,mainAxis:A=!0,crossAxis:R=!0}=ih(r,n),L={x:s,y:u},B=Cd(m),W=Tx(B);let re=L[W],ce=L[B];const Q=ih(l,n),X=typeof Q=="number"?{mainAxis:Q,crossAxis:0}:{mainAxis:0,crossAxis:0,...Q};if(A){const _e=W==="y"?"height":"width",Ie=x.reference[W]-x.floating[_e]+X.mainAxis,ke=x.reference[W]+x.reference[_e]-X.mainAxis;re<Ie?re=Ie:re>ke&&(re=ke)}if(R){var le,he;const _e=W==="y"?"width":"height",Ie=["top","left"].includes(sh(m)),ke=x.reference[B]-x.floating[_e]+(Ie&&((le=v.offset)==null?void 0:le[B])||0)+(Ie?0:X.crossAxis),Je=x.reference[B]+x.reference[_e]+(Ie?0:((he=v.offset)==null?void 0:he[B])||0)-(Ie?X.crossAxis:0);ce<ke?ce=ke:ce>Je&&(ce=Je)}return{[W]:re,[B]:ce}}}},QI=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(n){var s,u;const{placement:m,rects:x,platform:v,elements:l}=n,{apply:A=()=>{},...R}=ih(r,n),L=await Mg(n,R),B=sh(m),W=Cm(m),re=Cd(m)==="y",{width:ce,height:Q}=x.floating;let X,le;B==="top"||B==="bottom"?(X=B,le=W===(await(v.isRTL==null?void 0:v.isRTL(l.floating))?"start":"end")?"left":"right"):(le=B,X=W==="end"?"top":"bottom");const he=Q-L.top-L.bottom,_e=ce-L.left-L.right,Ie=Pd(Q-L[X],he),ke=Pd(ce-L[le],_e),Je=!n.middlewareData.shift;let He=Ie,nt=ke;if((s=n.middlewareData.shift)!=null&&s.enabled.x&&(nt=_e),(u=n.middlewareData.shift)!=null&&u.enabled.y&&(He=he),Je&&!W){const Ct=Sa(L.left,0),Zt=Sa(L.right,0),lt=Sa(L.top,0),Et=Sa(L.bottom,0);re?nt=ce-2*(Ct!==0||Zt!==0?Ct+Zt:Sa(L.left,L.right)):He=Q-2*(lt!==0||Et!==0?lt+Et:Sa(L.top,L.bottom))}await A({...n,availableWidth:nt,availableHeight:He});const Pt=await v.getDimensions(l.floating);return ce!==Pt.width||Q!==Pt.height?{reset:{rects:!0}}:{}}}};function l_(){return typeof window<"u"}function Em(r){return C4(r)?(r.nodeName||"").toLowerCase():"#document"}function Ea(r){var n;return(r==null||(n=r.ownerDocument)==null?void 0:n.defaultView)||window}function su(r){var n;return(n=(C4(r)?r.ownerDocument:r.document)||window.document)==null?void 0:n.documentElement}function C4(r){return l_()?r instanceof Node||r instanceof Ea(r).Node:!1}function ac(r){return l_()?r instanceof Element||r instanceof Ea(r).Element:!1}function eu(r){return l_()?r instanceof HTMLElement||r instanceof Ea(r).HTMLElement:!1}function rw(r){return!l_()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof Ea(r).ShadowRoot}function ty(r){const{overflow:n,overflowX:s,overflowY:u,display:m}=lc(r);return/auto|scroll|overlay|hidden|clip/.test(n+u+s)&&!["inline","contents"].includes(m)}function JI(r){return["table","td","th"].includes(Em(r))}function c_(r){return[":popover-open",":modal"].some(n=>{try{return r.matches(n)}catch{return!1}})}function Cx(r){const n=Ex(),s=ac(r)?lc(r):r;return["transform","translate","scale","rotate","perspective"].some(u=>s[u]?s[u]!=="none":!1)||(s.containerType?s.containerType!=="normal":!1)||!n&&(s.backdropFilter?s.backdropFilter!=="none":!1)||!n&&(s.filter?s.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(u=>(s.willChange||"").includes(u))||["paint","layout","strict","content"].some(u=>(s.contain||"").includes(u))}function eA(r){let n=Ed(r);for(;eu(n)&&!fm(n);){if(Cx(n))return n;if(c_(n))return null;n=Ed(n)}return null}function Ex(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function fm(r){return["html","body","#document"].includes(Em(r))}function lc(r){return Ea(r).getComputedStyle(r)}function u_(r){return ac(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function Ed(r){if(Em(r)==="html")return r;const n=r.assignedSlot||r.parentNode||rw(r)&&r.host||su(r);return rw(n)?n.host:n}function E4(r){const n=Ed(r);return fm(n)?r.ownerDocument?r.ownerDocument.body:r.body:eu(n)&&ty(n)?n:E4(n)}function Ig(r,n,s){var u;n===void 0&&(n=[]),s===void 0&&(s=!0);const m=E4(r),x=m===((u=r.ownerDocument)==null?void 0:u.body),v=Ea(m);if(x){const l=S1(v);return n.concat(v,v.visualViewport||[],ty(m)?m:[],l&&s?Ig(l):[])}return n.concat(m,Ig(m,[],s))}function S1(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function M4(r){const n=lc(r);let s=parseFloat(n.width)||0,u=parseFloat(n.height)||0;const m=eu(r),x=m?r.offsetWidth:s,v=m?r.offsetHeight:u,l=E0(s)!==x||E0(u)!==v;return l&&(s=x,u=v),{width:s,height:u,$:l}}function Mx(r){return ac(r)?r:r.contextElement}function om(r){const n=Mx(r);if(!eu(n))return Kc(1);const s=n.getBoundingClientRect(),{width:u,height:m,$:x}=M4(n);let v=(x?E0(s.width):s.width)/u,l=(x?E0(s.height):s.height)/m;return(!v||!Number.isFinite(v))&&(v=1),(!l||!Number.isFinite(l))&&(l=1),{x:v,y:l}}const tA=Kc(0);function I4(r){const n=Ea(r);return!Ex()||!n.visualViewport?tA:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function rA(r,n,s){return n===void 0&&(n=!1),!s||n&&s!==Ea(r)?!1:n}function qf(r,n,s,u){n===void 0&&(n=!1),s===void 0&&(s=!1);const m=r.getBoundingClientRect(),x=Mx(r);let v=Kc(1);n&&(u?ac(u)&&(v=om(u)):v=om(r));const l=rA(x,s,u)?I4(x):Kc(0);let A=(m.left+l.x)/v.x,R=(m.top+l.y)/v.y,L=m.width/v.x,B=m.height/v.y;if(x){const W=Ea(x),re=u&&ac(u)?Ea(u):u;let ce=W,Q=S1(ce);for(;Q&&u&&re!==ce;){const X=om(Q),le=Q.getBoundingClientRect(),he=lc(Q),_e=le.left+(Q.clientLeft+parseFloat(he.paddingLeft))*X.x,Ie=le.top+(Q.clientTop+parseFloat(he.paddingTop))*X.y;A*=X.x,R*=X.y,L*=X.x,B*=X.y,A+=_e,R+=Ie,ce=Ea(Q),Q=S1(ce)}}return I0({width:L,height:B,x:A,y:R})}function Ix(r,n){const s=u_(r).scrollLeft;return n?n.left+s:qf(su(r)).left+s}function A4(r,n,s){s===void 0&&(s=!1);const u=r.getBoundingClientRect(),m=u.left+n.scrollLeft-(s?0:Ix(r,u)),x=u.top+n.scrollTop;return{x:m,y:x}}function nA(r){let{elements:n,rect:s,offsetParent:u,strategy:m}=r;const x=m==="fixed",v=su(u),l=n?c_(n.floating):!1;if(u===v||l&&x)return s;let A={scrollLeft:0,scrollTop:0},R=Kc(1);const L=Kc(0),B=eu(u);if((B||!B&&!x)&&((Em(u)!=="body"||ty(v))&&(A=u_(u)),eu(u))){const re=qf(u);R=om(u),L.x=re.x+u.clientLeft,L.y=re.y+u.clientTop}const W=v&&!B&&!x?A4(v,A,!0):Kc(0);return{width:s.width*R.x,height:s.height*R.y,x:s.x*R.x-A.scrollLeft*R.x+L.x+W.x,y:s.y*R.y-A.scrollTop*R.y+L.y+W.y}}function iA(r){return Array.from(r.getClientRects())}function sA(r){const n=su(r),s=u_(r),u=r.ownerDocument.body,m=Sa(n.scrollWidth,n.clientWidth,u.scrollWidth,u.clientWidth),x=Sa(n.scrollHeight,n.clientHeight,u.scrollHeight,u.clientHeight);let v=-s.scrollLeft+Ix(r);const l=-s.scrollTop;return lc(u).direction==="rtl"&&(v+=Sa(n.clientWidth,u.clientWidth)-m),{width:m,height:x,x:v,y:l}}function oA(r,n){const s=Ea(r),u=su(r),m=s.visualViewport;let x=u.clientWidth,v=u.clientHeight,l=0,A=0;if(m){x=m.width,v=m.height;const R=Ex();(!R||R&&n==="fixed")&&(l=m.offsetLeft,A=m.offsetTop)}return{width:x,height:v,x:l,y:A}}function aA(r,n){const s=qf(r,!0,n==="fixed"),u=s.top+r.clientTop,m=s.left+r.clientLeft,x=eu(r)?om(r):Kc(1),v=r.clientWidth*x.x,l=r.clientHeight*x.y,A=m*x.x,R=u*x.y;return{width:v,height:l,x:A,y:R}}function nw(r,n,s){let u;if(n==="viewport")u=oA(r,s);else if(n==="document")u=sA(su(r));else if(ac(n))u=aA(n,s);else{const m=I4(r);u={x:n.x-m.x,y:n.y-m.y,width:n.width,height:n.height}}return I0(u)}function k4(r,n){const s=Ed(r);return s===n||!ac(s)||fm(s)?!1:lc(s).position==="fixed"||k4(s,n)}function lA(r,n){const s=n.get(r);if(s)return s;let u=Ig(r,[],!1).filter(l=>ac(l)&&Em(l)!=="body"),m=null;const x=lc(r).position==="fixed";let v=x?Ed(r):r;for(;ac(v)&&!fm(v);){const l=lc(v),A=Cx(v);!A&&l.position==="fixed"&&(m=null),(x?!A&&!m:!A&&l.position==="static"&&!!m&&["absolute","fixed"].includes(m.position)||ty(v)&&!A&&k4(r,v))?u=u.filter(L=>L!==v):m=l,v=Ed(v)}return n.set(r,u),u}function cA(r){let{element:n,boundary:s,rootBoundary:u,strategy:m}=r;const v=[...s==="clippingAncestors"?c_(n)?[]:lA(n,this._c):[].concat(s),u],l=v[0],A=v.reduce((R,L)=>{const B=nw(n,L,m);return R.top=Sa(B.top,R.top),R.right=Pd(B.right,R.right),R.bottom=Pd(B.bottom,R.bottom),R.left=Sa(B.left,R.left),R},nw(n,l,m));return{width:A.right-A.left,height:A.bottom-A.top,x:A.left,y:A.top}}function uA(r){const{width:n,height:s}=M4(r);return{width:n,height:s}}function hA(r,n,s){const u=eu(n),m=su(n),x=s==="fixed",v=qf(r,!0,x,n);let l={scrollLeft:0,scrollTop:0};const A=Kc(0);if(u||!u&&!x)if((Em(n)!=="body"||ty(m))&&(l=u_(n)),u){const W=qf(n,!0,x,n);A.x=W.x+n.clientLeft,A.y=W.y+n.clientTop}else m&&(A.x=Ix(m));const R=m&&!u&&!x?A4(m,l):Kc(0),L=v.left+l.scrollLeft-A.x-R.x,B=v.top+l.scrollTop-A.y-R.y;return{x:L,y:B,width:v.width,height:v.height}}function Rv(r){return lc(r).position==="static"}function iw(r,n){if(!eu(r)||lc(r).position==="fixed")return null;if(n)return n(r);let s=r.offsetParent;return su(r)===s&&(s=s.ownerDocument.body),s}function D4(r,n){const s=Ea(r);if(c_(r))return s;if(!eu(r)){let m=Ed(r);for(;m&&!fm(m);){if(ac(m)&&!Rv(m))return m;m=Ed(m)}return s}let u=iw(r,n);for(;u&&JI(u)&&Rv(u);)u=iw(u,n);return u&&fm(u)&&Rv(u)&&!Cx(u)?s:u||eA(r)||s}const dA=async function(r){const n=this.getOffsetParent||D4,s=this.getDimensions,u=await s(r.floating);return{reference:hA(r.reference,await n(r.floating),r.strategy),floating:{x:0,y:0,width:u.width,height:u.height}}};function fA(r){return lc(r).direction==="rtl"}const pA={convertOffsetParentRelativeRectToViewportRelativeRect:nA,getDocumentElement:su,getClippingRect:cA,getOffsetParent:D4,getElementRects:dA,getClientRects:iA,getDimensions:uA,getScale:om,isElement:ac,isRTL:fA};function R4(r,n){return r.x===n.x&&r.y===n.y&&r.width===n.width&&r.height===n.height}function mA(r,n){let s=null,u;const m=su(r);function x(){var l;clearTimeout(u),(l=s)==null||l.disconnect(),s=null}function v(l,A){l===void 0&&(l=!1),A===void 0&&(A=1),x();const R=r.getBoundingClientRect(),{left:L,top:B,width:W,height:re}=R;if(l||n(),!W||!re)return;const ce=i0(B),Q=i0(m.clientWidth-(L+W)),X=i0(m.clientHeight-(B+re)),le=i0(L),_e={rootMargin:-ce+"px "+-Q+"px "+-X+"px "+-le+"px",threshold:Sa(0,Pd(1,A))||1};let Ie=!0;function ke(Je){const He=Je[0].intersectionRatio;if(He!==A){if(!Ie)return v();He?v(!1,He):u=setTimeout(()=>{v(!1,1e-7)},1e3)}He===1&&!R4(R,r.getBoundingClientRect())&&v(),Ie=!1}try{s=new IntersectionObserver(ke,{..._e,root:m.ownerDocument})}catch{s=new IntersectionObserver(ke,_e)}s.observe(r)}return v(!0),x}function gA(r,n,s,u){u===void 0&&(u={});const{ancestorScroll:m=!0,ancestorResize:x=!0,elementResize:v=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:A=!1}=u,R=Mx(r),L=m||x?[...R?Ig(R):[],...Ig(n)]:[];L.forEach(le=>{m&&le.addEventListener("scroll",s,{passive:!0}),x&&le.addEventListener("resize",s)});const B=R&&l?mA(R,s):null;let W=-1,re=null;v&&(re=new ResizeObserver(le=>{let[he]=le;he&&he.target===R&&re&&(re.unobserve(n),cancelAnimationFrame(W),W=requestAnimationFrame(()=>{var _e;(_e=re)==null||_e.observe(n)})),s()}),R&&!A&&re.observe(R),re.observe(n));let ce,Q=A?qf(r):null;A&&X();function X(){const le=qf(r);Q&&!R4(Q,le)&&s(),Q=le,ce=requestAnimationFrame(X)}return s(),()=>{var le;L.forEach(he=>{m&&he.removeEventListener("scroll",s),x&&he.removeEventListener("resize",s)}),B?.(),(le=re)==null||le.disconnect(),re=null,A&&cancelAnimationFrame(ce)}}const yA=XI,_A=KI,vA=ZI,xA=QI,bA=WI,sw=qI,wA=YI,TA=(r,n,s)=>{const u=new Map,m={platform:pA,...s},x={...m.platform,_c:u};return GI(r,n,{...m,platform:x})};var m0=typeof document<"u"?j.useLayoutEffect:j.useEffect;function A0(r,n){if(r===n)return!0;if(typeof r!=typeof n)return!1;if(typeof r=="function"&&r.toString()===n.toString())return!0;let s,u,m;if(r&&n&&typeof r=="object"){if(Array.isArray(r)){if(s=r.length,s!==n.length)return!1;for(u=s;u--!==0;)if(!A0(r[u],n[u]))return!1;return!0}if(m=Object.keys(r),s=m.length,s!==Object.keys(n).length)return!1;for(u=s;u--!==0;)if(!{}.hasOwnProperty.call(n,m[u]))return!1;for(u=s;u--!==0;){const x=m[u];if(!(x==="_owner"&&r.$$typeof)&&!A0(r[x],n[x]))return!1}return!0}return r!==r&&n!==n}function L4(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function ow(r,n){const s=L4(r);return Math.round(n*s)/s}function Lv(r){const n=j.useRef(r);return m0(()=>{n.current=r}),n}function SA(r){r===void 0&&(r={});const{placement:n="bottom",strategy:s="absolute",middleware:u=[],platform:m,elements:{reference:x,floating:v}={},transform:l=!0,whileElementsMounted:A,open:R}=r,[L,B]=j.useState({x:0,y:0,strategy:s,placement:n,middlewareData:{},isPositioned:!1}),[W,re]=j.useState(u);A0(W,u)||re(u);const[ce,Q]=j.useState(null),[X,le]=j.useState(null),he=j.useCallback(Xe=>{Xe!==Je.current&&(Je.current=Xe,Q(Xe))},[]),_e=j.useCallback(Xe=>{Xe!==He.current&&(He.current=Xe,le(Xe))},[]),Ie=x||ce,ke=v||X,Je=j.useRef(null),He=j.useRef(null),nt=j.useRef(L),Pt=A!=null,Ct=Lv(A),Zt=Lv(m),lt=Lv(R),Et=j.useCallback(()=>{if(!Je.current||!He.current)return;const Xe={placement:n,strategy:s,middleware:W};Zt.current&&(Xe.platform=Zt.current),TA(Je.current,He.current,Xe).then(Be=>{const _t={...Be,isPositioned:lt.current!==!1};ft.current&&!A0(nt.current,_t)&&(nt.current=_t,Ld.flushSync(()=>{B(_t)}))})},[W,n,s,Zt,lt]);m0(()=>{R===!1&&nt.current.isPositioned&&(nt.current.isPositioned=!1,B(Xe=>({...Xe,isPositioned:!1})))},[R]);const ft=j.useRef(!1);m0(()=>(ft.current=!0,()=>{ft.current=!1}),[]),m0(()=>{if(Ie&&(Je.current=Ie),ke&&(He.current=ke),Ie&&ke){if(Ct.current)return Ct.current(Ie,ke,Et);Et()}},[Ie,ke,Et,Ct,Pt]);const gt=j.useMemo(()=>({reference:Je,floating:He,setReference:he,setFloating:_e}),[he,_e]),dt=j.useMemo(()=>({reference:Ie,floating:ke}),[Ie,ke]),mt=j.useMemo(()=>{const Xe={position:s,left:0,top:0};if(!dt.floating)return Xe;const Be=ow(dt.floating,L.x),_t=ow(dt.floating,L.y);return l?{...Xe,transform:"translate("+Be+"px, "+_t+"px)",...L4(dt.floating)>=1.5&&{willChange:"transform"}}:{position:s,left:Be,top:_t}},[s,l,dt.floating,L.x,L.y]);return j.useMemo(()=>({...L,update:Et,refs:gt,elements:dt,floatingStyles:mt}),[L,Et,gt,dt,mt])}const PA=r=>{function n(s){return{}.hasOwnProperty.call(s,"current")}return{name:"arrow",options:r,fn(s){const{element:u,padding:m}=typeof r=="function"?r(s):r;return u&&n(u)?u.current!=null?sw({element:u.current,padding:m}).fn(s):{}:u?sw({element:u,padding:m}).fn(s):{}}}},CA=(r,n)=>({...yA(r),options:[r,n]}),EA=(r,n)=>({..._A(r),options:[r,n]}),MA=(r,n)=>({...wA(r),options:[r,n]}),IA=(r,n)=>({...vA(r),options:[r,n]}),AA=(r,n)=>({...xA(r),options:[r,n]}),kA=(r,n)=>({...bA(r),options:[r,n]}),DA=(r,n)=>({...PA(r),options:[r,n]});var RA="Arrow",z4=j.forwardRef((r,n)=>{const{children:s,width:u=10,height:m=5,...x}=r;return V.jsx(Fr.svg,{...x,ref:n,width:u,height:m,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:r.asChild?s:V.jsx("polygon",{points:"0,0 30,0 15,10"})})});z4.displayName=RA;var LA=z4;function zA(r){const[n,s]=j.useState(void 0);return ro(()=>{if(r){s({width:r.offsetWidth,height:r.offsetHeight});const u=new ResizeObserver(m=>{if(!Array.isArray(m)||!m.length)return;const x=m[0];let v,l;if("borderBoxSize"in x){const A=x.borderBoxSize,R=Array.isArray(A)?A[0]:A;v=R.inlineSize,l=R.blockSize}else v=r.offsetWidth,l=r.offsetHeight;s({width:v,height:l})});return u.observe(r,{box:"border-box"}),()=>u.unobserve(r)}else s(void 0)},[r]),n}var Ax="Popper",[F4,Mm]=nu(Ax),[FA,O4]=F4(Ax),N4=r=>{const{__scopePopper:n,children:s}=r,[u,m]=j.useState(null);return V.jsx(FA,{scope:n,anchor:u,onAnchorChange:m,children:s})};N4.displayName=Ax;var j4="PopperAnchor",B4=j.forwardRef((r,n)=>{const{__scopePopper:s,virtualRef:u,...m}=r,x=O4(j4,s),v=j.useRef(null),l=dn(n,v);return j.useEffect(()=>{x.onAnchorChange(u?.current||v.current)}),u?null:V.jsx(Fr.div,{...m,ref:l})});B4.displayName=j4;var kx="PopperContent",[OA,NA]=F4(kx),V4=j.forwardRef((r,n)=>{const{__scopePopper:s,side:u="bottom",sideOffset:m=0,align:x="center",alignOffset:v=0,arrowPadding:l=0,avoidCollisions:A=!0,collisionBoundary:R=[],collisionPadding:L=0,sticky:B="partial",hideWhenDetached:W=!1,updatePositionStrategy:re="optimized",onPlaced:ce,...Q}=r,X=O4(kx,s),[le,he]=j.useState(null),_e=dn(n,St=>he(St)),[Ie,ke]=j.useState(null),Je=zA(Ie),He=Je?.width??0,nt=Je?.height??0,Pt=u+(x!=="center"?"-"+x:""),Ct=typeof L=="number"?L:{top:0,right:0,bottom:0,left:0,...L},Zt=Array.isArray(R)?R:[R],lt=Zt.length>0,Et={padding:Ct,boundary:Zt.filter(BA),altBoundary:lt},{refs:ft,floatingStyles:gt,placement:dt,isPositioned:mt,middlewareData:Xe}=SA({strategy:"fixed",placement:Pt,whileElementsMounted:(...St)=>gA(...St,{animationFrame:re==="always"}),elements:{reference:X.anchor},middleware:[CA({mainAxis:m+nt,alignmentAxis:v}),A&&EA({mainAxis:!0,crossAxis:!1,limiter:B==="partial"?MA():void 0,...Et}),A&&IA({...Et}),AA({...Et,apply:({elements:St,rects:Gt,availableWidth:yr,availableHeight:cr})=>{const{width:Lr,height:jr}=Gt.reference,Fn=St.floating.style;Fn.setProperty("--radix-popper-available-width",`${yr}px`),Fn.setProperty("--radix-popper-available-height",`${cr}px`),Fn.setProperty("--radix-popper-anchor-width",`${Lr}px`),Fn.setProperty("--radix-popper-anchor-height",`${jr}px`)}}),Ie&&DA({element:Ie,padding:l}),VA({arrowWidth:He,arrowHeight:nt}),W&&kA({strategy:"referenceHidden",...Et})]}),[Be,_t]=G4(dt),Re=to(ce);ro(()=>{mt&&Re?.()},[mt,Re]);const at=Xe.arrow?.x,nr=Xe.arrow?.y,er=Xe.arrow?.centerOffset!==0,[ir,sr]=j.useState();return ro(()=>{le&&sr(window.getComputedStyle(le).zIndex)},[le]),V.jsx("div",{ref:ft.setFloating,"data-radix-popper-content-wrapper":"",style:{...gt,transform:mt?gt.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ir,"--radix-popper-transform-origin":[Xe.transformOrigin?.x,Xe.transformOrigin?.y].join(" "),...Xe.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:r.dir,children:V.jsx(OA,{scope:s,placedSide:Be,onArrowChange:ke,arrowX:at,arrowY:nr,shouldHideArrow:er,children:V.jsx(Fr.div,{"data-side":Be,"data-align":_t,...Q,ref:_e,style:{...Q.style,animation:mt?void 0:"none"}})})})});V4.displayName=kx;var U4="PopperArrow",jA={top:"bottom",right:"left",bottom:"top",left:"right"},$4=j.forwardRef(function(n,s){const{__scopePopper:u,...m}=n,x=NA(U4,u),v=jA[x.placedSide];return V.jsx("span",{ref:x.onArrowChange,style:{position:"absolute",left:x.arrowX,top:x.arrowY,[v]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[x.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[x.placedSide],visibility:x.shouldHideArrow?"hidden":void 0},children:V.jsx(LA,{...m,ref:s,style:{...m.style,display:"block"}})})});$4.displayName=U4;function BA(r){return r!==null}var VA=r=>({name:"transformOrigin",options:r,fn(n){const{placement:s,rects:u,middlewareData:m}=n,v=m.arrow?.centerOffset!==0,l=v?0:r.arrowWidth,A=v?0:r.arrowHeight,[R,L]=G4(s),B={start:"0%",center:"50%",end:"100%"}[L],W=(m.arrow?.x??0)+l/2,re=(m.arrow?.y??0)+A/2;let ce="",Q="";return R==="bottom"?(ce=v?B:`${W}px`,Q=`${-A}px`):R==="top"?(ce=v?B:`${W}px`,Q=`${u.floating.height+A}px`):R==="right"?(ce=`${-A}px`,Q=v?B:`${re}px`):R==="left"&&(ce=`${u.floating.width+A}px`,Q=v?B:`${re}px`),{data:{x:ce,y:Q}}}});function G4(r){const[n,s="center"]=r.split("-");return[n,s]}var q4=N4,Dx=B4,Rx=V4,Lx=$4,[h_]=nu("Tooltip",[Mm]),zx=Mm(),Z4="TooltipProvider",UA=700,aw="tooltip.open",[$A,W4]=h_(Z4),H4=r=>{const{__scopeTooltip:n,delayDuration:s=UA,skipDelayDuration:u=300,disableHoverableContent:m=!1,children:x}=r,v=j.useRef(!0),l=j.useRef(!1),A=j.useRef(0);return j.useEffect(()=>{const R=A.current;return()=>window.clearTimeout(R)},[]),V.jsx($A,{scope:n,isOpenDelayedRef:v,delayDuration:s,onOpen:j.useCallback(()=>{window.clearTimeout(A.current),v.current=!1},[]),onClose:j.useCallback(()=>{window.clearTimeout(A.current),A.current=window.setTimeout(()=>v.current=!0,u)},[u]),isPointerInTransitRef:l,onPointerInTransitChange:j.useCallback(R=>{l.current=R},[]),disableHoverableContent:m,children:x})};H4.displayName=Z4;var X4="Tooltip",[AG,d_]=h_(X4),P1="TooltipTrigger",GA=j.forwardRef((r,n)=>{const{__scopeTooltip:s,...u}=r,m=d_(P1,s),x=W4(P1,s),v=zx(s),l=j.useRef(null),A=dn(n,l,m.onTriggerChange),R=j.useRef(!1),L=j.useRef(!1),B=j.useCallback(()=>R.current=!1,[]);return j.useEffect(()=>()=>document.removeEventListener("pointerup",B),[B]),V.jsx(Dx,{asChild:!0,...v,children:V.jsx(Fr.button,{"aria-describedby":m.open?m.contentId:void 0,"data-state":m.stateAttribute,...u,ref:A,onPointerMove:Ht(r.onPointerMove,W=>{W.pointerType!=="touch"&&!L.current&&!x.isPointerInTransitRef.current&&(m.onTriggerEnter(),L.current=!0)}),onPointerLeave:Ht(r.onPointerLeave,()=>{m.onTriggerLeave(),L.current=!1}),onPointerDown:Ht(r.onPointerDown,()=>{m.open&&m.onClose(),R.current=!0,document.addEventListener("pointerup",B,{once:!0})}),onFocus:Ht(r.onFocus,()=>{R.current||m.onOpen()}),onBlur:Ht(r.onBlur,m.onClose),onClick:Ht(r.onClick,m.onClose)})})});GA.displayName=P1;var qA="TooltipPortal",[kG,ZA]=h_(qA,{forceMount:void 0}),pm="TooltipContent",K4=j.forwardRef((r,n)=>{const s=ZA(pm,r.__scopeTooltip),{forceMount:u=s.forceMount,side:m="top",...x}=r,v=d_(pm,r.__scopeTooltip);return V.jsx(iu,{present:u||v.open,children:v.disableHoverableContent?V.jsx(Y4,{side:m,...x,ref:n}):V.jsx(WA,{side:m,...x,ref:n})})}),WA=j.forwardRef((r,n)=>{const s=d_(pm,r.__scopeTooltip),u=W4(pm,r.__scopeTooltip),m=j.useRef(null),x=dn(n,m),[v,l]=j.useState(null),{trigger:A,onClose:R}=s,L=m.current,{onPointerInTransitChange:B}=u,W=j.useCallback(()=>{l(null),B(!1)},[B]),re=j.useCallback((ce,Q)=>{const X=ce.currentTarget,le={x:ce.clientX,y:ce.clientY},he=QA(le,X.getBoundingClientRect()),_e=JA(le,he),Ie=ek(Q.getBoundingClientRect()),ke=rk([..._e,...Ie]);l(ke),B(!0)},[B]);return j.useEffect(()=>()=>W(),[W]),j.useEffect(()=>{if(A&&L){const ce=X=>re(X,L),Q=X=>re(X,A);return A.addEventListener("pointerleave",ce),L.addEventListener("pointerleave",Q),()=>{A.removeEventListener("pointerleave",ce),L.removeEventListener("pointerleave",Q)}}},[A,L,re,W]),j.useEffect(()=>{if(v){const ce=Q=>{const X=Q.target,le={x:Q.clientX,y:Q.clientY},he=A?.contains(X)||L?.contains(X),_e=!tk(le,v);he?W():_e&&(W(),R())};return document.addEventListener("pointermove",ce),()=>document.removeEventListener("pointermove",ce)}},[A,L,v,R,W]),V.jsx(Y4,{...r,ref:x})}),[HA,XA]=h_(X4,{isInside:!1}),KA=j6("TooltipContent"),Y4=j.forwardRef((r,n)=>{const{__scopeTooltip:s,children:u,"aria-label":m,onEscapeKeyDown:x,onPointerDownOutside:v,...l}=r,A=d_(pm,s),R=zx(s),{onClose:L}=A;return j.useEffect(()=>(document.addEventListener(aw,L),()=>document.removeEventListener(aw,L)),[L]),j.useEffect(()=>{if(A.trigger){const B=W=>{W.target?.contains(A.trigger)&&L()};return window.addEventListener("scroll",B,{capture:!0}),()=>window.removeEventListener("scroll",B,{capture:!0})}},[A.trigger,L]),V.jsx(Sm,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:x,onPointerDownOutside:v,onFocusOutside:B=>B.preventDefault(),onDismiss:L,children:V.jsxs(Rx,{"data-state":A.stateAttribute,...R,...l,ref:n,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[V.jsx(KA,{children:u}),V.jsx(HA,{scope:s,isInside:!0,children:V.jsx(aM,{id:A.contentId,role:"tooltip",children:m||u})})]})})});K4.displayName=pm;var Q4="TooltipArrow",YA=j.forwardRef((r,n)=>{const{__scopeTooltip:s,...u}=r,m=zx(s);return XA(Q4,s).isInside?null:V.jsx(Lx,{...m,...u,ref:n})});YA.displayName=Q4;function QA(r,n){const s=Math.abs(n.top-r.y),u=Math.abs(n.bottom-r.y),m=Math.abs(n.right-r.x),x=Math.abs(n.left-r.x);switch(Math.min(s,u,m,x)){case x:return"left";case m:return"right";case s:return"top";case u:return"bottom";default:throw new Error("unreachable")}}function JA(r,n,s=5){const u=[];switch(n){case"top":u.push({x:r.x-s,y:r.y+s},{x:r.x+s,y:r.y+s});break;case"bottom":u.push({x:r.x-s,y:r.y-s},{x:r.x+s,y:r.y-s});break;case"left":u.push({x:r.x+s,y:r.y-s},{x:r.x+s,y:r.y+s});break;case"right":u.push({x:r.x-s,y:r.y-s},{x:r.x-s,y:r.y+s});break}return u}function ek(r){const{top:n,right:s,bottom:u,left:m}=r;return[{x:m,y:n},{x:s,y:n},{x:s,y:u},{x:m,y:u}]}function tk(r,n){const{x:s,y:u}=r;let m=!1;for(let x=0,v=n.length-1;x<n.length;v=x++){const l=n[x].x,A=n[x].y,R=n[v].x,L=n[v].y;A>u!=L>u&&s<(R-l)*(u-A)/(L-A)+l&&(m=!m)}return m}function rk(r){const n=r.slice();return n.sort((s,u)=>s.x<u.x?-1:s.x>u.x?1:s.y<u.y?-1:s.y>u.y?1:0),nk(n)}function nk(r){if(r.length<=1)return r.slice();const n=[];for(let u=0;u<r.length;u++){const m=r[u];for(;n.length>=2;){const x=n[n.length-1],v=n[n.length-2];if((x.x-v.x)*(m.y-v.y)>=(x.y-v.y)*(m.x-v.x))n.pop();else break}n.push(m)}n.pop();const s=[];for(let u=r.length-1;u>=0;u--){const m=r[u];for(;s.length>=2;){const x=s[s.length-1],v=s[s.length-2];if((x.x-v.x)*(m.y-v.y)>=(x.y-v.y)*(m.x-v.x))s.pop();else break}s.push(m)}return s.pop(),n.length===1&&s.length===1&&n[0].x===s[0].x&&n[0].y===s[0].y?n:n.concat(s)}var ik=H4,J4=K4;const sk=ik,ok=j.forwardRef(({className:r,sideOffset:n=4,...s},u)=>V.jsx(J4,{ref:u,sideOffset:n,className:lr("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",r),...s}));ok.displayName=J4.displayName;const ak={"map.title":{ru:" ",tj:" ",en:"Map of Tajikistan"},"map.colorful":{ru:"",tj:"",en:"Colorful"},"map.minimal":{ru:"",tj:"",en:"Minimal"},"map.locations":{ru:"",tj:"",en:"Locations"},"map.noLocations":{ru:" ",tj:" ",en:"No locations"},"map.loading":{ru:"...",tj:"...",en:"Loading..."},"map.description":{ru:"",tj:"",en:"Description"},"map.coordinates":{ru:"",tj:"",en:"Coordinates"},"map.close":{ru:"",tj:"",en:"Close"},"map.viewDetails":{ru:"",tj:"",en:"View Details"},"filter.title":{ru:"",tj:"",en:"Filters"},"lang.ru":{ru:"",tj:"",en:"Russian"},"lang.tj":{ru:"",tj:"",en:"Tajik"},"lang.en":{ru:"",tj:"",en:"English"}},e5=j.createContext(void 0);function lk({children:r}){const[n,s]=j.useState(()=>{if(typeof window<"u"){const m=localStorage.getItem("language");if(m&&["ru","tj","en"].includes(m))return m}return"ru"});j.useEffect(()=>{localStorage.setItem("language",n)},[n]);const u=m=>{const x=ak[m];return x?x[n]||x.ru||m:(console.warn(`Translation missing for key: ${m}`),m)};return V.jsx(e5.Provider,{value:{language:n,setLanguage:s,t:u},children:r})}function t5(){const r=j.useContext(e5);if(!r)throw new Error("useLanguage must be used within a LanguageProvider");return r}const r5=j.forwardRef(({className:r,...n},s)=>V.jsx("div",{ref:s,className:lr("shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",r),...n}));r5.displayName="Card";const ck=j.forwardRef(({className:r,...n},s)=>V.jsx("div",{ref:s,className:lr("flex flex-col space-y-1.5 p-6",r),...n}));ck.displayName="CardHeader";const uk=j.forwardRef(({className:r,...n},s)=>V.jsx("div",{ref:s,className:lr("text-2xl font-semibold leading-none tracking-tight",r),...n}));uk.displayName="CardTitle";const hk=j.forwardRef(({className:r,...n},s)=>V.jsx("div",{ref:s,className:lr("text-sm text-muted-foreground",r),...n}));hk.displayName="CardDescription";const n5=j.forwardRef(({className:r,...n},s)=>V.jsx("div",{ref:s,className:lr("p-6 pt-0",r),...n}));n5.displayName="CardContent";const dk=j.forwardRef(({className:r,...n},s)=>V.jsx("div",{ref:s,className:lr("flex items-center p-6 pt-0",r),...n}));dk.displayName="CardFooter";function fk(){return V.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:V.jsx(r5,{className:"w-full max-w-md mx-4",children:V.jsxs(n5,{className:"pt-6",children:[V.jsxs("div",{className:"flex mb-4 gap-2",children:[V.jsx(DM,{className:"h-8 w-8 text-red-500"}),V.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),V.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}const pk="modulepreload",mk=function(r){return"/"+r},lw={},gk=function(n,s,u){let m=Promise.resolve();if(s&&s.length>0){let R=function(L){return Promise.all(L.map(B=>Promise.resolve(B).then(W=>({status:"fulfilled",value:W}),W=>({status:"rejected",reason:W}))))};var v=R;document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),A=l?.nonce||l?.getAttribute("nonce");m=R(s.map(L=>{if(L=mk(L),L in lw)return;lw[L]=!0;const B=L.endsWith(".css"),W=B?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${L}"]${W}`))return;const re=document.createElement("link");if(re.rel=B?"stylesheet":pk,B||(re.as="script"),re.crossOrigin="",re.href=L,A&&re.setAttribute("nonce",A),document.head.appendChild(re),B)return new Promise((ce,Q)=>{re.addEventListener("load",ce),re.addEventListener("error",()=>Q(new Error(`Unable to preload CSS for ${L}`)))})}))}function x(l){const A=new Event("vite:preloadError",{cancelable:!0});if(A.payload=l,window.dispatchEvent(A),!A.defaultPrevented)throw l}return m.then(l=>{for(const A of l||[])A.status==="rejected"&&x(A.reason);return n().catch(x)})},yk=j.createContext(null);function _k(r,n){const s=Array.isArray(r)?r[0]:r?r.x:0,u=Array.isArray(r)?r[1]:r?r.y:0,m=Array.isArray(n)?n[0]:n?n.x:0,x=Array.isArray(n)?n[1]:n?n.y:0;return s===m&&u===x}function Yo(r,n){if(r===n)return!0;if(!r||!n)return!1;if(Array.isArray(r)){if(!Array.isArray(n)||r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(!Yo(r[s],n[s]))return!1;return!0}else if(Array.isArray(n))return!1;if(typeof r=="object"&&typeof n=="object"){const s=Object.keys(r),u=Object.keys(n);if(s.length!==u.length)return!1;for(const m of s)if(!n.hasOwnProperty(m)||!Yo(r[m],n[m]))return!1;return!0}return!1}function cw(r){return{longitude:r.center.lng,latitude:r.center.lat,zoom:r.zoom,pitch:r.pitch,bearing:r.bearing,padding:r.padding}}function uw(r,n){const s=n.viewState||n,u={};if("longitude"in s&&"latitude"in s&&(s.longitude!==r.center.lng||s.latitude!==r.center.lat)){const m=r.center.constructor;u.center=new m(s.longitude,s.latitude)}return"zoom"in s&&s.zoom!==r.zoom&&(u.zoom=s.zoom),"bearing"in s&&s.bearing!==r.bearing&&(u.bearing=s.bearing),"pitch"in s&&s.pitch!==r.pitch&&(u.pitch=s.pitch),s.padding&&r.padding&&!Yo(s.padding,r.padding)&&(u.padding=s.padding),u}const vk=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function hw(r){if(!r)return null;if(typeof r=="string"||("toJS"in r&&(r=r.toJS()),!r.layers))return r;const n={};for(const u of r.layers)n[u.id]=u;const s=r.layers.map(u=>{let m=null;"interactive"in u&&(m=Object.assign({},u),delete m.interactive);const x=n[u.ref];if(x){m=m||Object.assign({},u),delete m.ref;for(const v of vk)v in x&&(m[v]=x[v])}return m||u});return{...r,layers:s}}const dw={version:8,sources:{},layers:[]},fw={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},pw={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},mw={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},xk=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],bk=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class mm{constructor(n,s,u){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=m=>{const x=this.props[mw[m.type]];x?x(m):m.type==="error"&&console.error(m.error)},this._onCameraEvent=m=>{if(this._internalUpdate)return;m.viewState=this._propsedCameraUpdate||cw(this._map.transform);const x=this.props[pw[m.type]];x&&x(m)},this._onCameraUpdate=m=>this._internalUpdate?m:(this._propsedCameraUpdate=cw(m),uw(m,this.props)),this._onPointerEvent=m=>{(m.type==="mousemove"||m.type==="mouseout")&&this._updateHover(m);const x=this.props[fw[m.type]];x&&(this.props.interactiveLayerIds&&m.type!=="mouseover"&&m.type!=="mouseout"&&(m.features=this._hoveredFeatures||this._queryRenderedFeatures(m.point)),x(m),delete m.features)},this._MapClass=n,this.props=s,this._initialize(u)}get map(){return this._map}setProps(n){const s=this.props;this.props=n;const u=this._updateSettings(n,s),m=this._updateSize(n),x=this._updateViewState(n);this._updateStyle(n,s),this._updateStyleComponents(n),this._updateHandlers(n,s),(u||m||x&&!this._map.isMoving())&&this.redraw()}static reuse(n,s){const u=mm.savedMaps.pop();if(!u)return null;const m=u.map,x=m.getContainer();for(s.className=x.className;x.childNodes.length>0;)s.appendChild(x.childNodes[0]);m._container=s;const v=m._resizeObserver;v&&(v.disconnect(),v.observe(s)),u.setProps({...n,styleDiffing:!1}),m.resize();const{initialViewState:l}=n;return l&&(l.bounds?m.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):u._updateViewState(l)),m.isStyleLoaded()?m.fire("load"):m.once("style.load",()=>m.fire("load")),m._update(),u}_initialize(n){const{props:s}=this,{mapStyle:u=dw}=s,m={...s,...s.initialViewState,container:n,style:hw(u)},x=m.initialViewState||m.viewState||m;if(Object.assign(m,{center:[x.longitude||0,x.latitude||0],zoom:x.zoom||0,pitch:x.pitch||0,bearing:x.bearing||0}),s.gl){const l=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=l,s.gl)}const v=new this._MapClass(m);x.padding&&v.setPadding(x.padding),s.cursor&&(v.getCanvas().style.cursor=s.cursor),v.transformCameraUpdate=this._onCameraUpdate,v.on("style.load",()=>{this._styleComponents={light:v.getLight(),sky:v.getSky(),projection:v.getProjection?.(),terrain:v.getTerrain()},this._updateStyleComponents(this.props)}),v.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const l in fw)v.on(l,this._onPointerEvent);for(const l in pw)v.on(l,this._onCameraEvent);for(const l in mw)v.on(l,this._onEvent);this._map=v}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),mm.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const n=this._map;n.style&&(n._frame&&(n._frame.cancel(),n._frame=null),n._render())}_updateSize(n){const{viewState:s}=n;if(s){const u=this._map;if(s.width!==u.transform.width||s.height!==u.transform.height)return u.resize(),!0}return!1}_updateViewState(n){const s=this._map,u=s.transform;if(!s.isMoving()){const x=uw(u,n);if(Object.keys(x).length>0)return this._internalUpdate=!0,s.jumpTo(x),this._internalUpdate=!1,!0}return!1}_updateSettings(n,s){const u=this._map;let m=!1;for(const x of xk)x in n&&!Yo(n[x],s[x])&&(m=!0,u[`set${x[0].toUpperCase()}${x.slice(1)}`]?.call(u,n[x]));return m}_updateStyle(n,s){if(n.cursor!==s.cursor&&(this._map.getCanvas().style.cursor=n.cursor||""),n.mapStyle!==s.mapStyle){const{mapStyle:u=dw,styleDiffing:m=!0}=n,x={diff:m};"localIdeographFontFamily"in n&&(x.localIdeographFontFamily=n.localIdeographFontFamily),this._map.setStyle(hw(u),x)}}_updateStyleComponents({light:n,projection:s,sky:u,terrain:m}){const x=this._map,v=this._styleComponents;x.style._loaded&&(n&&!Yo(n,v.light)&&(v.light=n,x.setLight(n)),s&&!Yo(s,v.projection)&&s!==v.projection?.type&&(v.projection=typeof s=="string"?{type:s}:s,x.setProjection?.(v.projection)),u&&!Yo(u,v.sky)&&(v.sky=u,x.setSky(u)),m!==void 0&&!Yo(m,v.terrain)&&(!m||x.getSource(m.source))&&(v.terrain=m,x.setTerrain(m)))}_updateHandlers(n,s){const u=this._map;for(const m of bk){const x=n[m]??!0,v=s[m]??!0;Yo(x,v)||(x?u[m].enable(x):u[m].disable())}}_queryRenderedFeatures(n){const s=this._map,{interactiveLayerIds:u=[]}=this.props;try{return s.queryRenderedFeatures(n,{layers:u.filter(s.getLayer.bind(s))})}catch{return[]}}_updateHover(n){const{props:s}=this;if(s.interactiveLayerIds&&(s.onMouseMove||s.onMouseEnter||s.onMouseLeave)){const m=n.type,x=this._hoveredFeatures?.length>0,v=this._queryRenderedFeatures(n.point),l=v.length>0;!l&&x&&(n.type="mouseleave",this._onPointerEvent(n)),this._hoveredFeatures=v,l&&!x&&(n.type="mouseenter",this._onPointerEvent(n)),n.type=m}else this._hoveredFeatures=null}}mm.savedMaps=[];const wk=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Tk(r){if(!r)return null;const n=r.map,s={getMap:()=>n};for(const u of Sk(n))!(u in s)&&!wk.includes(u)&&(s[u]=n[u].bind(n));return s}function Sk(r){const n=new Set;let s=r;for(;s;){for(const u of Object.getOwnPropertyNames(s))u[0]!=="_"&&typeof r[u]=="function"&&u!=="fire"&&u!=="setEventedParent"&&n.add(u);s=Object.getPrototypeOf(s)}return Array.from(n)}const Pk=typeof document<"u"?j.useLayoutEffect:j.useEffect;function Ck(r,n){const{RTLTextPlugin:s,maxParallelImageRequests:u,workerCount:m,workerUrl:x}=n;if(s&&r.getRTLTextPluginStatus&&r.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:v,lazy:l=!0}=typeof s=="string"?{pluginUrl:s}:s;r.setRTLTextPlugin(v,A=>{A&&console.error(A)},l)}u!==void 0&&r.setMaxParallelImageRequests(u),m!==void 0&&r.setWorkerCount(m),x!==void 0&&r.setWorkerUrl(x)}const Im=j.createContext(null);function Ek(r,n){const s=j.useContext(yk),[u,m]=j.useState(null),x=j.useRef(),{current:v}=j.useRef({mapLib:null,map:null});j.useEffect(()=>{const R=r.mapLib;let L=!0,B;return Promise.resolve(R||gk(()=>Promise.resolve().then(()=>Qk),void 0)).then(W=>{if(!L)return;if(!W)throw new Error("Invalid mapLib");const re="Map"in W?W:W.default;if(!re.Map)throw new Error("Invalid mapLib");Ck(re,r),r.reuseMaps&&(B=mm.reuse(r,x.current)),B||(B=new mm(re.Map,r,x.current)),v.map=Tk(B),v.mapLib=re,m(B),s?.onMapMount(v.map,r.id)}).catch(W=>{const{onError:re}=r;re?re({type:"error",target:null,originalEvent:null,error:W}):console.error(W)}),()=>{L=!1,B&&(s?.onMapUnmount(r.id),r.reuseMaps?B.recycle():B.destroy())}},[]),Pk(()=>{u&&u.setProps(r)}),j.useImperativeHandle(n,()=>v.map,[u]);const l=j.useMemo(()=>({position:"relative",width:"100%",height:"100%",...r.style}),[r.style]),A={height:"100%"};return j.createElement("div",{id:r.id,ref:x,style:l},u&&j.createElement(Im.Provider,{value:v},j.createElement("div",{"mapboxgl-children":"",style:A},r.children)))}const Mk=j.forwardRef(Ek),Ik=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function ch(r,n){if(!r||!n)return;const s=r.style;for(const u in n){const m=n[u];Number.isFinite(m)&&!Ik.test(u)?s[u]=`${m}px`:s[u]=m}}function i5(r,n){if(r===n)return null;const s=gw(r),u=gw(n),m=[];for(const x of u)s.has(x)||m.push(x);for(const x of s)u.has(x)||m.push(x);return m.length===0?null:m}function gw(r){return new Set(r?r.trim().split(/\s+/):[])}const Ak=j.memo(j.forwardRef((r,n)=>{const{map:s,mapLib:u}=j.useContext(Im),m=j.useRef({props:r}),x=j.useMemo(()=>{let le=!1;j.Children.forEach(r.children,Ie=>{Ie&&(le=!0)});const he={...r,element:le?document.createElement("div"):void 0},_e=new u.Marker(he);return _e.setLngLat([r.longitude,r.latitude]),_e.getElement().addEventListener("click",Ie=>{m.current.props.onClick?.({type:"click",target:_e,originalEvent:Ie})}),_e.on("dragstart",Ie=>{const ke=Ie;ke.lngLat=x.getLngLat(),m.current.props.onDragStart?.(ke)}),_e.on("drag",Ie=>{const ke=Ie;ke.lngLat=x.getLngLat(),m.current.props.onDrag?.(ke)}),_e.on("dragend",Ie=>{const ke=Ie;ke.lngLat=x.getLngLat(),m.current.props.onDragEnd?.(ke)}),_e},[]);j.useEffect(()=>(x.addTo(s.getMap()),()=>{x.remove()}),[]);const{longitude:v,latitude:l,offset:A,style:R,draggable:L=!1,popup:B=null,rotation:W=0,rotationAlignment:re="auto",pitchAlignment:ce="auto"}=r;j.useEffect(()=>{ch(x.getElement(),R)},[R]),j.useImperativeHandle(n,()=>x,[]);const Q=m.current.props;(x.getLngLat().lng!==v||x.getLngLat().lat!==l)&&x.setLngLat([v,l]),A&&!_k(x.getOffset(),A)&&x.setOffset(A),x.isDraggable()!==L&&x.setDraggable(L),x.getRotation()!==W&&x.setRotation(W),x.getRotationAlignment()!==re&&x.setRotationAlignment(re),x.getPitchAlignment()!==ce&&x.setPitchAlignment(ce),x.getPopup()!==B&&x.setPopup(B);const X=i5(Q.className,r.className);if(X)for(const le of X)x.toggleClassName(le);return m.current.props=r,Ld.createPortal(r.children,x.getElement())})),kk=j.memo(j.forwardRef((r,n)=>{const{map:s,mapLib:u}=j.useContext(Im),m=j.useMemo(()=>document.createElement("div"),[]),x=j.useRef({props:r}),v=j.useMemo(()=>{const l={...r},A=new u.Popup(l);return A.setLngLat([r.longitude,r.latitude]),A.once("open",R=>{x.current.props.onOpen?.(R)}),A},[]);if(j.useEffect(()=>{const l=A=>{x.current.props.onClose?.(A)};return v.on("close",l),v.setDOMContent(m).addTo(s.getMap()),()=>{v.off("close",l),v.isOpen()&&v.remove()}},[]),j.useEffect(()=>{ch(v.getElement(),r.style)},[r.style]),j.useImperativeHandle(n,()=>v,[]),v.isOpen()){const l=x.current.props;(v.getLngLat().lng!==r.longitude||v.getLngLat().lat!==r.latitude)&&v.setLngLat([r.longitude,r.latitude]),r.offset&&!Yo(l.offset,r.offset)&&v.setOffset(r.offset),(l.anchor!==r.anchor||l.maxWidth!==r.maxWidth)&&(v.options.anchor=r.anchor,v.setMaxWidth(r.maxWidth));const A=i5(l.className,r.className);if(A)for(const R of A)v.toggleClassName(R);x.current.props=r}return Ld.createPortal(r.children,m)}));function Yf(r,n,s,u){const m=j.useContext(Im),x=j.useMemo(()=>r(m),[]);return j.useEffect(()=>{const v=n,l=null,A=typeof n=="function"?n:null,{map:R}=m;return R.hasControl(x)||(R.addControl(x,v?.position),l&&l(m)),()=>{A&&A(m),R.hasControl(x)&&R.removeControl(x)}},[]),x}function Dk(r){const n=Yf(({mapLib:s})=>new s.AttributionControl(r),{position:r.position});return j.useEffect(()=>{ch(n._container,r.style)},[r.style]),null}j.memo(Dk);function Rk(r){const n=Yf(({mapLib:s})=>new s.FullscreenControl({container:r.containerId&&document.getElementById(r.containerId)}),{position:r.position});return j.useEffect(()=>{ch(n._controlContainer,r.style)},[r.style]),null}const Lk=j.memo(Rk);function zk(r,n){const s=j.useRef({props:r}),u=Yf(({mapLib:m})=>{const x=new m.GeolocateControl(r),v=x._setupUI;return x._setupUI=()=>{x._container.hasChildNodes()||v()},x.on("geolocate",l=>{s.current.props.onGeolocate?.(l)}),x.on("error",l=>{s.current.props.onError?.(l)}),x.on("outofmaxbounds",l=>{s.current.props.onOutOfMaxBounds?.(l)}),x.on("trackuserlocationstart",l=>{s.current.props.onTrackUserLocationStart?.(l)}),x.on("trackuserlocationend",l=>{s.current.props.onTrackUserLocationEnd?.(l)}),x},{position:r.position});return s.current.props=r,j.useImperativeHandle(n,()=>u,[]),j.useEffect(()=>{ch(u._container,r.style)},[r.style]),null}j.memo(j.forwardRef(zk));function Fk(r){const n=Yf(({mapLib:s})=>new s.NavigationControl(r),{position:r.position});return j.useEffect(()=>{ch(n._container,r.style)},[r.style]),null}const Ok=j.memo(Fk);function Nk(r){const n=Yf(({mapLib:x})=>new x.ScaleControl(r),{position:r.position}),s=j.useRef(r),u=s.current;s.current=r;const{style:m}=r;return r.maxWidth!==void 0&&r.maxWidth!==u.maxWidth&&(n.options.maxWidth=r.maxWidth),r.unit!==void 0&&r.unit!==u.unit&&n.setUnit(r.unit),j.useEffect(()=>{ch(n._container,m)},[m]),null}const jk=j.memo(Nk);function Bk(r){const n=Yf(({mapLib:s})=>new s.TerrainControl(r),{position:r.position});return j.useEffect(()=>{ch(n._container,r.style)},[r.style]),null}j.memo(Bk);function Vk(r){const n=Yf(({mapLib:s})=>new s.LogoControl(r),{position:r.position});return j.useEffect(()=>{ch(n._container,r.style)},[r.style]),null}j.memo(Vk);function k0(r,n){if(!r)throw new Error(n)}let Uk=0;function $k(r,n,s){if(r.style&&r.style._loaded){const u={...s};return delete u.id,delete u.children,r.addSource(n,u),r.getSource(n)}return null}function Gk(r,n,s){k0(n.id===s.id,"source id changed"),k0(n.type===s.type,"source type changed");let u="",m=0;for(const v in n)v!=="children"&&v!=="id"&&!Yo(s[v],n[v])&&(u=v,m++);if(!m)return;const x=n.type;if(x==="geojson")r.setData(n.data);else if(x==="image")r.updateImage({url:n.url,coordinates:n.coordinates});else switch(u){case"coordinates":r.setCoordinates?.(n.coordinates);break;case"url":r.setUrl?.(n.url);break;case"tiles":r.setTiles?.(n.tiles);break;default:console.warn(`Unable to update <Source> prop: ${u}`)}}function qk(r){const n=j.useContext(Im).map.getMap(),s=j.useRef(r),[,u]=j.useState(0),m=j.useMemo(()=>r.id||`jsx-source-${Uk++}`,[]);j.useEffect(()=>{if(n){const v=()=>setTimeout(()=>u(l=>l+1),0);return n.on("styledata",v),v(),()=>{if(n.off("styledata",v),n.style&&n.style._loaded&&n.getSource(m)){const l=n.getStyle()?.layers;if(l)for(const A of l)A.source===m&&n.removeLayer(A.id);n.removeSource(m)}}}},[n]);let x=n&&n.style&&n.getSource(m);return x?Gk(x,r,s.current):x=$k(n,m,r),s.current=r,x&&j.Children.map(r.children,v=>v&&j.cloneElement(v,{source:m}))||null}function Zk(r,n,s,u){if(k0(s.id===u.id,"layer id changed"),k0(s.type===u.type,"layer type changed"),s.type==="custom"||u.type==="custom")return;const{layout:m={},paint:x={},filter:v,minzoom:l,maxzoom:A,beforeId:R}=s;if(R!==u.beforeId&&r.moveLayer(n,R),m!==u.layout){const L=u.layout||{};for(const B in m)Yo(m[B],L[B])||r.setLayoutProperty(n,B,m[B]);for(const B in L)m.hasOwnProperty(B)||r.setLayoutProperty(n,B,void 0)}if(x!==u.paint){const L=u.paint||{};for(const B in x)Yo(x[B],L[B])||r.setPaintProperty(n,B,x[B]);for(const B in L)x.hasOwnProperty(B)||r.setPaintProperty(n,B,void 0)}Yo(v,u.filter)||r.setFilter(n,v),(l!==u.minzoom||A!==u.maxzoom)&&r.setLayerZoomRange(n,l,A)}function Wk(r,n,s){if(r.style&&r.style._loaded&&(!("source"in s)||r.getSource(s.source))){const u={...s,id:n};delete u.beforeId,r.addLayer(u,s.beforeId)}}let Hk=0;function Xk(r){const n=j.useContext(Im).map.getMap(),s=j.useRef(r),[,u]=j.useState(0),m=j.useMemo(()=>r.id||`jsx-layer-${Hk++}`,[]);if(j.useEffect(()=>{if(n){const v=()=>u(l=>l+1);return n.on("styledata",v),v(),()=>{n.off("styledata",v),n.style&&n.style._loaded&&n.getLayer(m)&&n.removeLayer(m)}}},[n]),n&&n.style&&n.getLayer(m))try{Zk(n,m,r,s.current)}catch(v){console.warn(v)}else Wk(n,m,r);return s.current=r,null}var g0={exports:{}};var Kk=g0.exports,yw;function Yk(){return yw||(yw=1,(function(r,n){(function(s,u){r.exports=u()})(Kk,(function(){var s={},u={};function m(v,l,A){if(u[v]=A,v==="index"){var R="var sharedModule = {}; ("+u.shared+")(sharedModule); ("+u.worker+")(sharedModule);",L={};return u.shared(L),u.index(s,L),typeof window<"u"&&s.setWorkerUrl(window.URL.createObjectURL(new Blob([R],{type:"text/javascript"}))),s}}m("shared",["exports"],(function(v){function l(o,e,i,c){return new(i||(i=Promise))((function(f,y){function _(I){try{C(c.next(I))}catch(D){y(D)}}function T(I){try{C(c.throw(I))}catch(D){y(D)}}function C(I){var D;I.done?f(I.value):(D=I.value,D instanceof i?D:new i((function(O){O(D)}))).then(_,T)}C((c=c.apply(o,e||[])).next())}))}function A(o,e){this.x=o,this.y=e}function R(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var L,B;typeof SuppressedError=="function"&&SuppressedError,A.prototype={clone(){return new A(this.x,this.y)},add(o){return this.clone()._add(o)},sub(o){return this.clone()._sub(o)},multByPoint(o){return this.clone()._multByPoint(o)},divByPoint(o){return this.clone()._divByPoint(o)},mult(o){return this.clone()._mult(o)},div(o){return this.clone()._div(o)},rotate(o){return this.clone()._rotate(o)},rotateAround(o,e){return this.clone()._rotateAround(o,e)},matMult(o){return this.clone()._matMult(o)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(o){return this.x===o.x&&this.y===o.y},dist(o){return Math.sqrt(this.distSqr(o))},distSqr(o){const e=o.x-this.x,i=o.y-this.y;return e*e+i*i},angle(){return Math.atan2(this.y,this.x)},angleTo(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith(o){return this.angleWithSep(o.x,o.y)},angleWithSep(o,e){return Math.atan2(this.x*e-this.y*o,this.x*o+this.y*e)},_matMult(o){const e=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=e,this},_add(o){return this.x+=o.x,this.y+=o.y,this},_sub(o){return this.x-=o.x,this.y-=o.y,this},_mult(o){return this.x*=o,this.y*=o,this},_div(o){return this.x/=o,this.y/=o,this},_multByPoint(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint(o){return this.x/=o.x,this.y/=o.y,this},_unit(){return this._div(this.mag()),this},_perp(){const o=this.y;return this.y=this.x,this.x=-o,this},_rotate(o){const e=Math.cos(o),i=Math.sin(o),c=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=c,this},_rotateAround(o,e){const i=Math.cos(o),c=Math.sin(o),f=e.y+c*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-c*(this.y-e.y),this.y=f,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:A},A.convert=function(o){if(o instanceof A)return o;if(Array.isArray(o))return new A(+o[0],+o[1]);if(o.x!==void 0&&o.y!==void 0)return new A(+o.x,+o.y);throw new Error("Expected [x, y] or {x, y} point format")};var W=(function(){if(B)return L;function o(e,i,c,f){this.cx=3*e,this.bx=3*(c-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(f-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=i,this.p2x=c,this.p2y=f}return B=1,L=o,o.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,i){if(i===void 0&&(i=1e-6),e<0)return 0;if(e>1)return 1;for(var c=e,f=0;f<8;f++){var y=this.sampleCurveX(c)-e;if(Math.abs(y)<i)return c;var _=this.sampleCurveDerivativeX(c);if(Math.abs(_)<1e-6)break;c-=y/_}var T=0,C=1;for(c=e,f=0;f<20&&(y=this.sampleCurveX(c),!(Math.abs(y-e)<i));f++)e>y?T=c:C=c,c=.5*(C-T)+T;return c},solve:function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))}},L})(),re=R(W);let ce,Q;function X(){return ce==null&&(ce=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ce}function le(){if(Q==null&&(Q=!1,X())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let c=0;c<25;c++){const f=4*c;e.fillStyle=`rgb(${f},${f+1},${f+2})`,e.fillRect(c%5,Math.floor(c/5),1,1)}const i=e.getImageData(0,0,5,5).data;for(let c=0;c<100;c++)if(c%4!=3&&i[c]!==c){Q=!0;break}}}return Q||!1}var he=1e-6,_e=typeof Float32Array<"u"?Float32Array:Array;function Ie(){var o=new _e(9);return _e!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function ke(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function Je(){var o=new _e(3);return _e!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function He(o){var e=o[0],i=o[1],c=o[2];return Math.sqrt(e*e+i*i+c*c)}function nt(o,e,i){var c=new _e(3);return c[0]=o,c[1]=e,c[2]=i,c}function Pt(o,e,i){return o[0]=e[0]+i[0],o[1]=e[1]+i[1],o[2]=e[2]+i[2],o}function Ct(o,e,i){return o[0]=e[0]*i,o[1]=e[1]*i,o[2]=e[2]*i,o}function Zt(o,e,i){var c=e[0],f=e[1],y=e[2],_=i[0],T=i[1],C=i[2];return o[0]=f*C-y*T,o[1]=y*_-c*C,o[2]=c*T-f*_,o}var lt,Et=He;function ft(o,e,i){var c=e[0],f=e[1],y=e[2],_=e[3];return o[0]=i[0]*c+i[4]*f+i[8]*y+i[12]*_,o[1]=i[1]*c+i[5]*f+i[9]*y+i[13]*_,o[2]=i[2]*c+i[6]*f+i[10]*y+i[14]*_,o[3]=i[3]*c+i[7]*f+i[11]*y+i[15]*_,o}function gt(){var o=new _e(4);return _e!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function dt(o,e,i,c){var f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",y=Math.PI/360;e*=y,c*=y,i*=y;var _=Math.sin(e),T=Math.cos(e),C=Math.sin(i),I=Math.cos(i),D=Math.sin(c),O=Math.cos(c);switch(f){case"xyz":o[0]=_*I*O+T*C*D,o[1]=T*C*O-_*I*D,o[2]=T*I*D+_*C*O,o[3]=T*I*O-_*C*D;break;case"xzy":o[0]=_*I*O-T*C*D,o[1]=T*C*O-_*I*D,o[2]=T*I*D+_*C*O,o[3]=T*I*O+_*C*D;break;case"yxz":o[0]=_*I*O+T*C*D,o[1]=T*C*O-_*I*D,o[2]=T*I*D-_*C*O,o[3]=T*I*O+_*C*D;break;case"yzx":o[0]=_*I*O+T*C*D,o[1]=T*C*O+_*I*D,o[2]=T*I*D-_*C*O,o[3]=T*I*O-_*C*D;break;case"zxy":o[0]=_*I*O-T*C*D,o[1]=T*C*O+_*I*D,o[2]=T*I*D+_*C*O,o[3]=T*I*O-_*C*D;break;case"zyx":o[0]=_*I*O-T*C*D,o[1]=T*C*O+_*I*D,o[2]=T*I*D-_*C*O,o[3]=T*I*O+_*C*D;break;default:throw new Error("Unknown angle order "+f)}return o}function mt(){var o=new _e(2);return _e!=Float32Array&&(o[0]=0,o[1]=0),o}function Xe(o,e){var i=new _e(2);return i[0]=o,i[1]=e,i}Je(),lt=new _e(4),_e!=Float32Array&&(lt[0]=0,lt[1]=0,lt[2]=0,lt[3]=0),Je(),nt(1,0,0),nt(0,1,0),gt(),gt(),Ie(),mt();const Be=8192;function _t(o,e,i){return e*(Be/(o.tileSize*Math.pow(2,i-o.tileID.overscaledZ)))}function Re(o,e){return(o%e+e)%e}function at(o,e,i){return o*(1-i)+e*i}function nr(o){if(o<=0)return 0;if(o>=1)return 1;const e=o*o,i=e*o;return 4*(o<.5?i:3*(o-e)+i-.75)}function er(o,e,i,c){const f=new re(o,e,i,c);return y=>f.solve(y)}const ir=er(.25,.1,.25,1);function sr(o,e,i){return Math.min(i,Math.max(e,o))}function St(o,e,i){const c=i-e,f=((o-e)%c+c)%c+e;return f===e?i:f}function Gt(o,...e){for(const i of e)for(const c in i)o[c]=i[c];return o}let yr=1;function cr(o,e,i){const c={};for(const f in o)c[f]=e.call(this,o[f],f,o);return c}function Lr(o,e,i){const c={};for(const f in o)e.call(this,o[f],f,o)&&(c[f]=o[f]);return c}function jr(o){return Array.isArray(o)?o.map(jr):typeof o=="object"&&o?cr(o,jr):o}const Fn={};function en(o){Fn[o]||(typeof console<"u"&&console.warn(o),Fn[o]=!0)}function ni(o,e,i){return(i.y-o.y)*(e.x-o.x)>(e.y-o.y)*(i.x-o.x)}function vi(o){return typeof WorkerGlobalScope<"u"&&o!==void 0&&o instanceof WorkerGlobalScope}let Xr=null;function io(o){return typeof ImageBitmap<"u"&&o instanceof ImageBitmap}const Mo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ms(o,e,i,c,f){return l(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(o,{timestamp:0});try{const _=y?.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);const T=_.startsWith("BGR"),C=new Uint8ClampedArray(c*f*4);if(yield y.copyTo(C,(function(I,D,O,U,G){const H=4*Math.max(-D,0),K=(Math.max(0,O)-O)*U*4+H,J=4*U,se=Math.max(0,D),ye=Math.max(0,O);return{rect:{x:se,y:ye,width:Math.min(I.width,D+U)-se,height:Math.min(I.height,O+G)-ye},layout:[{offset:K,stride:J}]}})(o,e,i,c,f)),T)for(let I=0;I<C.length;I+=4){const D=C[I];C[I]=C[I+2],C[I+2]=D}return C}finally{y.close()}}))}let Ae,Ue;function it(o,e,i,c){return o.addEventListener(e,i,c),{unsubscribe:()=>{o.removeEventListener(e,i,c)}}}function Vt(o){return o*Math.PI/180}function Mt(o){return o/Math.PI*180}const xe={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},ee={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},te="AbortError";class oe extends Error{constructor(e=te){super(e instanceof Error?e.message:e),this.name=te,e instanceof Error&&e.stack&&(this.stack=e.stack)}}function we(o){return o.name===te}const Ee={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ne(o){return Ee.REGISTERED_PROTOCOLS[o.substring(0,o.indexOf("://"))]}const Oe="global-dispatcher";class De extends Error{constructor(e,i,c,f){super(`AJAXError: ${i} (${e}): ${c}`),this.status=e,this.statusText=i,this.url=c,this.body=f}}const Ze=()=>vi(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,ut=function(o,e){if(/:\/\//.test(o.url)&&!/^https?:|^file:/.test(o.url)){const c=Ne(o.url);if(c)return c(o,e);if(vi(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,targetMapId:Oe},e)}if(!(/^file:/.test(i=o.url)||/^file:/.test(Ze())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(c,f){return l(this,void 0,void 0,(function*(){const y=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,cache:c.cache,referrer:Ze(),signal:f.signal});let _,T;c.type!=="json"||y.headers.has("Accept")||y.headers.set("Accept","application/json");try{_=yield fetch(y)}catch(I){throw we(I)?I:new De(0,I.message,c.url,new Blob)}if(!_.ok){const I=yield _.blob();throw new De(_.status,_.statusText,c.url,I)}T=c.type==="arrayBuffer"||c.type==="image"?_.arrayBuffer():c.type==="json"?_.json():_.text();const C=yield T;return f.signal.throwIfAborted(),{data:C,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}}))})(o,e);if(vi(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,mustQueue:!0,targetMapId:Oe},e)}var i;return(function(c,f){return new Promise(((y,_)=>{var T;const C=new XMLHttpRequest;C.open(c.method||"GET",c.url,!0),c.type!=="arrayBuffer"&&c.type!=="image"||(C.responseType="arraybuffer");for(const I in c.headers)C.setRequestHeader(I,c.headers[I]);c.type==="json"&&(C.responseType="text",!((T=c.headers)===null||T===void 0)&&T.Accept||C.setRequestHeader("Accept","application/json")),C.withCredentials=c.credentials==="include",C.onerror=()=>{_(new Error(C.statusText))},C.onload=()=>{if(!f.signal.aborted)if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){let I=C.response;if(c.type==="json")try{I=JSON.parse(C.response)}catch(D){return void _(D)}y({data:I,cacheControl:C.getResponseHeader("Cache-Control"),expires:C.getResponseHeader("Expires")})}else{const I=new Blob([C.response],{type:C.getResponseHeader("Content-Type")});_(new De(C.status,C.statusText,c.url,I))}},f.signal.addEventListener("abort",(()=>{C.abort(),_(new oe(f.signal.reason))})),C.send(c.body)}))})(o,e)};function st(o){if(!o||o.indexOf("://")<=0||o.indexOf("data:image/")===0||o.indexOf("blob:")===0)return!0;const e=new URL(o),i=window.location;return e.protocol===i.protocol&&e.host===i.host}function Ot(o,e,i){i[o]&&i[o].indexOf(e)!==-1||(i[o]=i[o]||[],i[o].push(e))}function $t(o,e,i){if(i&&i[o]){const c=i[o].indexOf(e);c!==-1&&i[o].splice(c,1)}}class hr{constructor(e,i={}){Gt(this,i),this.type=e}}class Ur extends hr{constructor(e,i={}){super("error",Gt({error:e},i))}}class kr{on(e,i){return this._listeners=this._listeners||{},Ot(e,i,this._listeners),{unsubscribe:()=>{this.off(e,i)}}}off(e,i){return $t(e,i,this._listeners),$t(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Ot(e,i,this._oneTimeListeners),this):new Promise((c=>this.once(e,c)))}fire(e,i){typeof e=="string"&&(e=new hr(e,i||{}));const c=e.type;if(this.listens(c)){e.target=this;const f=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const T of f)T.call(this,e);const y=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const T of y)$t(c,T,this._oneTimeListeners),T.call(this,e);const _=this._eventedParent;_&&(Gt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(e))}else e instanceof Ur&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var $e={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const an=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function xi(o,e){const i={};for(const c in o)c!=="ref"&&(i[c]=o[c]);return an.forEach((c=>{c in e&&(i[c]=e[c])})),i}function fr(o,e){if(Array.isArray(o)){if(!Array.isArray(e)||o.length!==e.length)return!1;for(let i=0;i<o.length;i++)if(!fr(o[i],e[i]))return!1;return!0}if(typeof o=="object"&&o!==null&&e!==null){if(typeof e!="object"||Object.keys(o).length!==Object.keys(e).length)return!1;for(const i in o)if(!fr(o[i],e[i]))return!1;return!0}return o===e}function Kr(o,e){o.push(e)}function hi(o,e,i){Kr(i,{command:"addSource",args:[o,e[o]]})}function mn(o,e,i){Kr(e,{command:"removeSource",args:[o]}),i[o]=!0}function gn(o,e,i,c){mn(o,i,c),hi(o,e,i)}function tn(o,e,i){let c;for(c in o[i])if(Object.prototype.hasOwnProperty.call(o[i],c)&&c!=="data"&&!fr(o[i][c],e[i][c]))return!1;for(c in e[i])if(Object.prototype.hasOwnProperty.call(e[i],c)&&c!=="data"&&!fr(o[i][c],e[i][c]))return!1;return!0}function On(o,e,i,c,f,y){o=o||{},e=e||{};for(const _ in o)Object.prototype.hasOwnProperty.call(o,_)&&(fr(o[_],e[_])||i.push({command:y,args:[c,_,e[_],f]}));for(const _ in e)Object.prototype.hasOwnProperty.call(e,_)&&!Object.prototype.hasOwnProperty.call(o,_)&&(fr(o[_],e[_])||i.push({command:y,args:[c,_,e[_],f]}))}function ou(o){return o.id}function Jo(o,e){return o[e.id]=e,o}class yt{constructor(e,i,c,f){this.message=(e?`${e}: `:"")+c,f&&(this.identifier=f),i!=null&&i.__line__&&(this.line=i.__line__)}}function bi(o,...e){for(const i of e)for(const c in i)o[c]=i[c];return o}class Ri extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}class hh{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[c,f]of i)this.bindings[c]=f}concat(e){return new hh(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Ls={kind:"null"},Lt={kind:"number"},_r={kind:"string"},Pr={kind:"boolean"},ds={kind:"color"},dh={kind:"projectionDefinition"},Io={kind:"object"},vr={kind:"value"},hc={kind:"collator"},dc={kind:"formatted"},fh={kind:"padding"},fc={kind:"colorArray"},Mn={kind:"numberArray"},pc={kind:"resolvedImage"},ll={kind:"variableAnchorOffsetCollection"};function Bi(o,e){return{kind:"array",itemType:o,N:e}}function qr(o){if(o.kind==="array"){const e=qr(o.itemType);return typeof o.N=="number"?`array<${e}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${e}>`}return o.kind}const ph=[Ls,Lt,_r,Pr,ds,dh,dc,Io,Bi(vr),fh,Mn,fc,pc,ll];function cl(o,e){if(e.kind==="error")return null;if(o.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!cl(o.itemType,e.itemType))&&(typeof o.N!="number"||o.N===e.N))return null}else{if(o.kind===e.kind)return null;if(o.kind==="value"){for(const i of ph)if(!cl(i,e))return null}}return`Expected ${qr(o)} but found ${qr(e)} instead.`}function Aa(o,e){return e.some((i=>i.kind===o.kind))}function Vi(o,e){return e.some((i=>i==="null"?o===null:i==="array"?Array.isArray(o):i==="object"?o&&!Array.isArray(o)&&typeof o=="object":i===typeof o))}function so(o,e){return o.kind==="array"&&e.kind==="array"?o.itemType.kind===e.itemType.kind&&typeof o.N=="number":o.kind===e.kind}const zs=.96422,ul=.82521,mh=4/29,Vn=6/29,au=3*Vn*Vn,lu=Vn*Vn*Vn,ea=Math.PI/180,cu=180/Math.PI;function tp(o){return(o%=360)<0&&(o+=360),o}function rp([o,e,i,c]){let f,y;const _=gh((.2225045*(o=mc(o))+.7168786*(e=mc(e))+.0606169*(i=mc(i)))/1);o===e&&e===i?f=y=_:(f=gh((.4360747*o+.3850649*e+.1430804*i)/zs),y=gh((.0139322*o+.0971045*e+.7141733*i)/ul));const T=116*_-16;return[T<0?0:T,500*(f-_),200*(_-y),c]}function mc(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function gh(o){return o>lu?Math.pow(o,1/3):o/au+mh}function uu([o,e,i,c]){let f=(o+16)/116,y=isNaN(e)?f:f+e/500,_=isNaN(i)?f:f-i/200;return f=1*Nd(f),y=zs*Nd(y),_=ul*Nd(_),[hl(3.1338561*y-1.6168667*f-.4906146*_),hl(-.9787684*y+1.9161415*f+.033454*_),hl(.0719453*y-.2289914*f+1.4052427*_),c]}function hl(o){return(o=o<=.00304?12.92*o:1.055*Math.pow(o,1/2.4)-.055)<0?0:o>1?1:o}function Nd(o){return o>Vn?o*o*o:au*(o-mh)}const jd=Object.hasOwn||function(o,e){return Object.prototype.hasOwnProperty.call(o,e)};function Zr(o,e){return jd(o,e)?o[e]:void 0}function hu(o){return parseInt(o.padEnd(2,o),16)/255}function Bd(o,e){return ka(e?o/100:o,0,1)}function ka(o,e,i){return Math.min(Math.max(e,o),i)}function yh(o){return!o.some(Number.isNaN)}const gc={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function ta(o,e,i){return o+i*(e-o)}function Da(o,e,i){return o.map(((c,f)=>ta(c,e[f],i)))}class xr{constructor(e,i,c,f=1,y=!0){this.r=e,this.g=i,this.b=c,this.a=f,y||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[e,i,c,f]))}static parse(e){if(e instanceof xr)return e;if(typeof e!="string")return;const i=(function(c){if((c=c.toLowerCase().trim())==="transparent")return[0,0,0,0];const f=Zr(gc,c);if(f){const[_,T,C]=f;return[_/255,T/255,C/255,1]}if(c.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(c)){const _=c.length<6?1:2;let T=1;return[hu(c.slice(T,T+=_)),hu(c.slice(T,T+=_)),hu(c.slice(T,T+=_)),hu(c.slice(T,T+_)||"ff")]}if(c.startsWith("rgb")){const _=c.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[T,C,I,D,O,U,G,H,K,J,se,ye]=_,ae=[D||" ",G||" ",J].join("");if(ae==="  "||ae==="  /"||ae===",,"||ae===",,,"){const ue=[I,U,K].join(""),ve=ue==="%%%"?100:ue===""?255:0;if(ve){const Ce=[ka(+C/ve,0,1),ka(+O/ve,0,1),ka(+H/ve,0,1),se?Bd(+se,ye):1];if(yh(Ce))return Ce}}return}}const y=c.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[_,T,C,I,D,O,U,G,H]=y,K=[C||" ",D||" ",U].join("");if(K==="  "||K==="  /"||K===",,"||K===",,,"){const J=[+T,ka(+I,0,100),ka(+O,0,100),G?Bd(+G,H):1];if(yh(J))return(function([se,ye,ae,ue]){function ve(Ce){const je=(Ce+se/30)%12,ot=ye*Math.min(ae,1-ae);return ae-ot*Math.max(-1,Math.min(je-3,9-je,1))}return se=tp(se),ye/=100,ae/=100,[ve(0),ve(8),ve(4),ue]})(J)}}})(e);return i?new xr(...i,!1):void 0}get rgb(){const{r:e,g:i,b:c,a:f}=this,y=f||1/0;return this.overwriteGetter("rgb",[e/y,i/y,c/y,f])}get hcl(){return this.overwriteGetter("hcl",(function(e){const[i,c,f,y]=rp(e),_=Math.sqrt(c*c+f*f);return[Math.round(1e4*_)?tp(Math.atan2(f,c)*cu):NaN,_,i,y]})(this.rgb))}get lab(){return this.overwriteGetter("lab",rp(this.rgb))}overwriteGetter(e,i){return Object.defineProperty(this,e,{value:i}),i}toString(){const[e,i,c,f]=this.rgb;return`rgba(${[e,i,c].map((y=>Math.round(255*y))).join(",")},${f})`}static interpolate(e,i,c,f="rgb"){switch(f){case"rgb":{const[y,_,T,C]=Da(e.rgb,i.rgb,c);return new xr(y,_,T,C,!1)}case"hcl":{const[y,_,T,C]=e.hcl,[I,D,O,U]=i.hcl;let G,H;if(isNaN(y)||isNaN(I))isNaN(y)?isNaN(I)?G=NaN:(G=I,T!==1&&T!==0||(H=D)):(G=y,O!==1&&O!==0||(H=_));else{let ae=I-y;I>y&&ae>180?ae-=360:I<y&&y-I>180&&(ae+=360),G=y+c*ae}const[K,J,se,ye]=(function([ae,ue,ve,Ce]){return ae=isNaN(ae)?0:ae*ea,uu([ve,Math.cos(ae)*ue,Math.sin(ae)*ue,Ce])})([G,H??ta(_,D,c),ta(T,O,c),ta(C,U,c)]);return new xr(K,J,se,ye,!1)}case"lab":{const[y,_,T,C]=uu(Da(e.lab,i.lab,c));return new xr(y,_,T,C,!1)}}}}xr.black=new xr(0,0,0,1),xr.white=new xr(1,1,1,1),xr.transparent=new xr(0,0,0,0),xr.red=new xr(1,0,0,1);class Ao{constructor(e,i,c){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Ra=["bottom","center","top"];class ko{constructor(e,i,c,f,y,_){this.text=e,this.image=i,this.scale=c,this.fontStack=f,this.textColor=y,this.verticalAlign=_}}class wi{constructor(e){this.sections=e}static fromString(e){return new wi([new ko(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((e=>e.text.length!==0||e.image&&e.image.name.length!==0))}static factory(e){return e instanceof wi?e:wi.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map((e=>e.text)).join("")}}class ii{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ii)return e;if(typeof e=="number")return new ii([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const i of e)if(typeof i!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new ii(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,c){return new ii(Da(e.values,i.values,c))}}class Yr{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Yr)return e;if(typeof e=="number")return new Yr([e]);if(Array.isArray(e)){for(const i of e)if(typeof i!="number")return;return new Yr(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,c){return new Yr(Da(e.values,i.values,c))}}class ur{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ur)return e;if(typeof e=="string"){const c=xr.parse(e);return c?new ur([c]):void 0}if(!Array.isArray(e))return;const i=[];for(const c of e){if(typeof c!="string")return;const f=xr.parse(c);if(!f)return;i.push(f)}return new ur(i)}toString(){return JSON.stringify(this.values)}static interpolate(e,i,c,f="rgb"){const y=[];if(e.values.length!=i.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${i.values.length}), cannot interpolate.`);for(let _=0;_<e.values.length;_++)y.push(xr.interpolate(e.values[_],i.values[_],c,f));return new ur(y)}}class ln extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const Fs=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class rs{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof rs)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let i=0;i<e.length;i+=2){const c=e[i],f=e[i+1];if(typeof c!="string"||!Fs.has(c)||!Array.isArray(f)||f.length!==2||typeof f[0]!="number"||typeof f[1]!="number")return}return new rs(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,c){const f=e.values,y=i.values;if(f.length!==y.length)throw new ln(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${i.toString()}`);const _=[];for(let T=0;T<f.length;T+=2){if(f[T]!==y[T])throw new ln(`Cannot interpolate values containing mismatched anchors. from[${T}]: ${f[T]}, to[${T}]: ${y[T]}`);_.push(f[T]);const[C,I]=f[T+1],[D,O]=y[T+1];_.push([ta(C,D,c),ta(I,O,c)])}return new rs(_)}}class fs{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new fs({name:e,available:!1}):null}}class Ti{constructor(e,i,c){this.from=e,this.to=i,this.transition=c}static interpolate(e,i,c){return new Ti(e,i,c)}static parse(e){return e instanceof Ti?e:Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number"?new Ti(e[0],e[1],e[2]):typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number"?new Ti(e.from,e.to,e.transition):typeof e=="string"?new Ti(e,e,1):void 0}}function dl(o,e,i,c){return typeof o=="number"&&o>=0&&o<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[o,e,i,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[o,e,i,c]:[o,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function La(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof Ti||o instanceof xr||o instanceof Ao||o instanceof wi||o instanceof ii||o instanceof Yr||o instanceof ur||o instanceof rs||o instanceof fs)return!0;if(Array.isArray(o)){for(const e of o)if(!La(e))return!1;return!0}if(typeof o=="object"){for(const e in o)if(!La(o[e]))return!1;return!0}return!1}function bn(o){if(o===null)return Ls;if(typeof o=="string")return _r;if(typeof o=="boolean")return Pr;if(typeof o=="number")return Lt;if(o instanceof xr)return ds;if(o instanceof Ti)return dh;if(o instanceof Ao)return hc;if(o instanceof wi)return dc;if(o instanceof ii)return fh;if(o instanceof Yr)return Mn;if(o instanceof ur)return fc;if(o instanceof rs)return ll;if(o instanceof fs)return pc;if(Array.isArray(o)){const e=o.length;let i;for(const c of o){const f=bn(c);if(i){if(i===f)continue;i=vr;break}i=f}return Bi(i||vr,e)}return Io}function oo(o){const e=typeof o;return o===null?"":e==="string"||e==="number"||e==="boolean"?String(o):o instanceof xr||o instanceof Ti||o instanceof wi||o instanceof ii||o instanceof Yr||o instanceof ur||o instanceof rs||o instanceof fs?o.toString():JSON.stringify(o)}class ns{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!La(e[1]))return i.error("invalid value");const c=e[1];let f=bn(c);const y=i.expectedType;return f.kind!=="array"||f.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(f=y),new ns(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const fl={string:_r,number:Lt,boolean:Pr,object:Io};class ps{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let c,f=1;const y=e[0];if(y==="array"){let T,C;if(e.length>2){const I=e[1];if(typeof I!="string"||!(I in fl)||I==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);T=fl[I],f++}else T=vr;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);C=e[2],f++}c=Bi(T,C)}else{if(!fl[y])throw new Error(`Types doesn't contain name = ${y}`);c=fl[y]}const _=[];for(;f<e.length;f++){const T=i.parse(e[f],f,vr);if(!T)return null;_.push(T)}return new ps(c,_)}evaluate(e){for(let i=0;i<this.args.length;i++){const c=this.args[i].evaluate(e);if(!cl(this.type,bn(c)))return c;if(i===this.args.length-1)throw new ln(`Expected value to be of type ${qr(this.type)}, but found ${qr(bn(c))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const pl={"to-boolean":Pr,"to-color":ds,"to-number":Lt,"to-string":_r};class ao{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const c=e[0];if(!pl[c])throw new Error(`Can't parse ${c} as it is not part of the known types`);if((c==="to-boolean"||c==="to-string")&&e.length!==2)return i.error("Expected one argument.");const f=pl[c],y=[];for(let _=1;_<e.length;_++){const T=i.parse(e[_],_,vr);if(!T)return null;y.push(T)}return new ao(f,y)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let i,c;for(const f of this.args){if(i=f.evaluate(e),c=null,i instanceof xr)return i;if(typeof i=="string"){const y=e.parseColor(i);if(y)return y}else if(Array.isArray(i)&&(c=i.length<3||i.length>4?`Invalid rgba value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:dl(i[0],i[1],i[2],i[3]),!c))return new xr(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new ln(c||`Could not parse color from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"padding":{let i;for(const c of this.args){i=c.evaluate(e);const f=ii.parse(i);if(f)return f}throw new ln(`Could not parse padding from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"numberArray":{let i;for(const c of this.args){i=c.evaluate(e);const f=Yr.parse(i);if(f)return f}throw new ln(`Could not parse numberArray from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"colorArray":{let i;for(const c of this.args){i=c.evaluate(e);const f=ur.parse(i);if(f)return f}throw new ln(`Could not parse colorArray from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"variableAnchorOffsetCollection":{let i;for(const c of this.args){i=c.evaluate(e);const f=rs.parse(i);if(f)return f}throw new ln(`Could not parse variableAnchorOffsetCollection from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"number":{let i=null;for(const c of this.args){if(i=c.evaluate(e),i===null)return 0;const f=Number(i);if(!isNaN(f))return f}throw new ln(`Could not convert ${JSON.stringify(i)} to number.`)}case"formatted":return wi.fromString(oo(this.args[0].evaluate(e)));case"resolvedImage":return fs.fromString(oo(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return oo(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const du=["Unknown","Point","LineString","Polygon"];class fu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?du[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let i=this._parseColorCache.get(e);return i||(i=xr.parse(e),this._parseColorCache.set(e,i)),i}}class za{constructor(e,i,c=[],f,y=new hh,_=[]){this.registry=e,this.path=c,this.key=c.map((T=>`[${T}]`)).join(""),this.scope=y,this.errors=_,this.expectedType=f,this._isConstant=i}parse(e,i,c,f,y={}){return i?this.concat(i,c,f)._parse(e,y):this._parse(e,y)}_parse(e,i){function c(f,y,_){return _==="assert"?new ps(y,[f]):_==="coerce"?new ao(y,[f]):f}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=e[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[f];if(y){let _=y.parse(e,this);if(!_)return null;if(this.expectedType){const T=this.expectedType,C=_.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||C.kind!=="value"){if(T.kind==="projectionDefinition"&&["string","array"].includes(C.kind)||["color","formatted","resolvedImage"].includes(T.kind)&&["value","string"].includes(C.kind)||["padding","numberArray"].includes(T.kind)&&["value","number","array"].includes(C.kind)||T.kind==="colorArray"&&["value","string","array"].includes(C.kind)||T.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(C.kind))_=c(_,T,i.typeAnnotation||"coerce");else if(this.checkSubtype(T,C))return null}else _=c(_,T,i.typeAnnotation||"assert")}if(!(_ instanceof ns)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const T=new fu;try{_=new ns(_.type,_.evaluate(T))}catch(C){return this.error(C.message),null}}return _}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,c){const f=typeof e=="number"?this.path.concat(e):this.path,y=c?this.scope.concat(c):this.scope;return new za(this.registry,this._isConstant,f,i||null,y,this.errors)}error(e,...i){const c=`${this.key}${i.map((f=>`[${f}]`)).join("")}`;this.errors.push(new Ri(c,e))}checkSubtype(e,i){const c=cl(e,i);return c&&this.error(c),c}}class Br{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const c=[];for(let y=1;y<e.length-1;y+=2){const _=e[y];if(typeof _!="string")return i.error(`Expected string, but found ${typeof _} instead.`,y);if(/[^a-zA-Z0-9_]/.test(_))return i.error("Variable names must contain only alphanumeric characters or '_'.",y);const T=i.parse(e[y+1],y+1);if(!T)return null;c.push([_,T])}const f=i.parse(e[e.length-1],e.length-1,i.expectedType,c);return f?new Br(c,f):null}outputDefined(){return this.result.outputDefined()}}class Fa{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const c=e[1];return i.scope.has(c)?new Fa(c,i.scope.get(c)):i.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Mr{constructor(e,i,c){this.type=e,this.index=i,this.input=c}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=i.parse(e[1],1,Lt),f=i.parse(e[2],2,Bi(i.expectedType||vr));return c&&f?new Mr(f.type.itemType,c,f):null}evaluate(e){const i=this.index.evaluate(e),c=this.input.evaluate(e);if(i<0)throw new ln(`Array index out of bounds: ${i} < 0.`);if(i>=c.length)throw new ln(`Array index out of bounds: ${i} > ${c.length-1}.`);if(i!==Math.floor(i))throw new ln(`Array index must be an integer, but found ${i} instead.`);return c[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class br{constructor(e,i){this.type=Pr,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=i.parse(e[1],1,vr),f=i.parse(e[2],2,vr);return c&&f?Aa(c.type,[Pr,_r,Lt,Ls,vr])?new br(c,f):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${qr(c.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(!c)return!1;if(!Vi(i,["boolean","string","number","null"]))throw new ln(`Expected first argument to be of type boolean, string, number or null, but found ${qr(bn(i))} instead.`);if(!Vi(c,["string","array"]))throw new ln(`Expected second argument to be of type array or string, but found ${qr(bn(c))} instead.`);return c.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class ra{constructor(e,i,c){this.type=Lt,this.needle=e,this.haystack=i,this.fromIndex=c}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const c=i.parse(e[1],1,vr),f=i.parse(e[2],2,vr);if(!c||!f)return null;if(!Aa(c.type,[Pr,_r,Lt,Ls,vr]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${qr(c.type)} instead`);if(e.length===4){const y=i.parse(e[3],3,Lt);return y?new ra(c,f,y):null}return new ra(c,f)}evaluate(e){const i=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(!Vi(i,["boolean","string","number","null"]))throw new ln(`Expected first argument to be of type boolean, string, number or null, but found ${qr(bn(i))} instead.`);let f;if(this.fromIndex&&(f=this.fromIndex.evaluate(e)),Vi(c,["string"])){const y=c.indexOf(i,f);return y===-1?-1:[...c.slice(0,y)].length}if(Vi(c,["array"]))return c.indexOf(i,f);throw new ln(`Expected second argument to be of type array or string, but found ${qr(bn(c))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Ir{constructor(e,i,c,f,y,_){this.inputType=e,this.type=i,this.input=c,this.cases=f,this.outputs=y,this.otherwise=_}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let c,f;i.expectedType&&i.expectedType.kind!=="value"&&(f=i.expectedType);const y={},_=[];for(let I=2;I<e.length-1;I+=2){let D=e[I];const O=e[I+1];Array.isArray(D)||(D=[D]);const U=i.concat(I);if(D.length===0)return U.error("Expected at least one branch label.");for(const H of D){if(typeof H!="number"&&typeof H!="string")return U.error("Branch labels must be numbers or strings.");if(typeof H=="number"&&Math.abs(H)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof H=="number"&&Math.floor(H)!==H)return U.error("Numeric branch labels must be integer values.");if(c){if(U.checkSubtype(c,bn(H)))return null}else c=bn(H);if(y[String(H)]!==void 0)return U.error("Branch labels must be unique.");y[String(H)]=_.length}const G=i.parse(O,I,f);if(!G)return null;f=f||G.type,_.push(G)}const T=i.parse(e[1],1,vr);if(!T)return null;const C=i.parse(e[e.length-1],e.length-1,f);return C?T.type.kind!=="value"&&i.concat(1).checkSubtype(c,T.type)?null:new Ir(c,f,T,y,_,C):null}evaluate(e){const i=this.input.evaluate(e);return(bn(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class yc{constructor(e,i,c){this.type=e,this.branches=i,this.otherwise=c}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let c;i.expectedType&&i.expectedType.kind!=="value"&&(c=i.expectedType);const f=[];for(let _=1;_<e.length-1;_+=2){const T=i.parse(e[_],_,Pr);if(!T)return null;const C=i.parse(e[_+1],_+1,c);if(!C)return null;f.push([T,C]),c=c||C.type}const y=i.parse(e[e.length-1],e.length-1,c);if(!y)return null;if(!c)throw new Error("Can't infer output type");return new yc(c,f,y)}evaluate(e){for(const[i,c]of this.branches)if(i.evaluate(e))return c.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,c]of this.branches)e(i),e(c);e(this.otherwise)}outputDefined(){return this.branches.every((([e,i])=>i.outputDefined()))&&this.otherwise.outputDefined()}}class Nn{constructor(e,i,c,f){this.type=e,this.input=i,this.beginIndex=c,this.endIndex=f}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const c=i.parse(e[1],1,vr),f=i.parse(e[2],2,Lt);if(!c||!f)return null;if(!Aa(c.type,[Bi(vr),_r,vr]))return i.error(`Expected first argument to be of type array or string, but found ${qr(c.type)} instead`);if(e.length===4){const y=i.parse(e[3],3,Lt);return y?new Nn(c.type,c,f,y):null}return new Nn(c.type,c,f)}evaluate(e){const i=this.input.evaluate(e),c=this.beginIndex.evaluate(e);let f;if(this.endIndex&&(f=this.endIndex.evaluate(e)),Vi(i,["string"]))return[...i].slice(c,f).join("");if(Vi(i,["array"]))return i.slice(c,f);throw new ln(`Expected first argument to be of type array or string, but found ${qr(bn(i))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function lo(o,e){const i=o.length-1;let c,f,y=0,_=i,T=0;for(;y<=_;)if(T=Math.floor((y+_)/2),c=o[T],f=o[T+1],c<=e){if(T===i||e<f)return T;y=T+1}else{if(!(c>e))throw new ln("Input is not a number.");_=T-1}return 0}class Do{constructor(e,i,c){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[f,y]of c)this.labels.push(f),this.outputs.push(y)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const c=i.parse(e[1],1,Lt);if(!c)return null;const f=[];let y=null;i.expectedType&&i.expectedType.kind!=="value"&&(y=i.expectedType);for(let _=1;_<e.length;_+=2){const T=_===1?-1/0:e[_],C=e[_+1],I=_,D=_+1;if(typeof T!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(f.length&&f[f.length-1][0]>=T)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const O=i.parse(C,D,y);if(!O)return null;y=y||O.type,f.push([T,O])}return new Do(y,c,f)}evaluate(e){const i=this.labels,c=this.outputs;if(i.length===1)return c[0].evaluate(e);const f=this.input.evaluate(e);if(f<=i[0])return c[0].evaluate(e);const y=i.length;return f>=i[y-1]?c[y-1].evaluate(e):c[lo(i,f)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function _c(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var pu,mu,Vd=(function(){if(mu)return pu;function o(e,i,c,f){this.cx=3*e,this.bx=3*(c-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(f-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=i,this.p2x=c,this.p2y=f}return mu=1,pu=o,o.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,i){if(i===void 0&&(i=1e-6),e<0)return 0;if(e>1)return 1;for(var c=e,f=0;f<8;f++){var y=this.sampleCurveX(c)-e;if(Math.abs(y)<i)return c;var _=this.sampleCurveDerivativeX(c);if(Math.abs(_)<1e-6)break;c-=y/_}var T=0,C=1;for(c=e,f=0;f<20&&(y=this.sampleCurveX(c),!(Math.abs(y-e)<i));f++)e>y?T=c:C=c,c=.5*(C-T)+T;return c},solve:function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))}},pu})(),vc=_c(Vd);class Si{constructor(e,i,c,f,y){this.type=e,this.operator=i,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(const[_,T]of y)this.labels.push(_),this.outputs.push(T)}static interpolationFactor(e,i,c,f){let y=0;if(e.name==="exponential")y=co(i,e.base,c,f);else if(e.name==="linear")y=co(i,1,c,f);else if(e.name==="cubic-bezier"){const _=e.controlPoints;y=new vc(_[0],_[1],_[2],_[3]).solve(co(i,1,c,f))}return y}static parse(e,i){let[c,f,y,..._]=e;if(!Array.isArray(f)||f.length===0)return i.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const I=f[1];if(typeof I!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:I}}else{if(f[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const I=f.slice(1);if(I.length!==4||I.some((D=>typeof D!="number"||D<0||D>1)))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:I}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(y=i.parse(y,2,Lt),!y)return null;const T=[];let C=null;c!=="interpolate-hcl"&&c!=="interpolate-lab"||i.expectedType==fc?i.expectedType&&i.expectedType.kind!=="value"&&(C=i.expectedType):C=ds;for(let I=0;I<_.length;I+=2){const D=_[I],O=_[I+1],U=I+3,G=I+4;if(typeof D!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(T.length&&T[T.length-1][0]>=D)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const H=i.parse(O,G,C);if(!H)return null;C=C||H.type,T.push([D,H])}return so(C,Lt)||so(C,dh)||so(C,ds)||so(C,fh)||so(C,Mn)||so(C,fc)||so(C,ll)||so(C,Bi(Lt))?new Si(C,c,f,y,T):i.error(`Type ${qr(C)} is not interpolatable.`)}evaluate(e){const i=this.labels,c=this.outputs;if(i.length===1)return c[0].evaluate(e);const f=this.input.evaluate(e);if(f<=i[0])return c[0].evaluate(e);const y=i.length;if(f>=i[y-1])return c[y-1].evaluate(e);const _=lo(i,f),T=Si.interpolationFactor(this.interpolation,f,i[_],i[_+1]),C=c[_].evaluate(e),I=c[_+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return ta(C,I,T);case"color":return xr.interpolate(C,I,T);case"padding":return ii.interpolate(C,I,T);case"colorArray":return ur.interpolate(C,I,T);case"numberArray":return Yr.interpolate(C,I,T);case"variableAnchorOffsetCollection":return rs.interpolate(C,I,T);case"array":return Da(C,I,T);case"projectionDefinition":return Ti.interpolate(C,I,T)}case"interpolate-hcl":switch(this.type.kind){case"color":return xr.interpolate(C,I,T,"hcl");case"colorArray":return ur.interpolate(C,I,T,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return xr.interpolate(C,I,T,"lab");case"colorArray":return ur.interpolate(C,I,T,"lab")}}}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function co(o,e,i,c){const f=c-i,y=o-i;return f===0?0:e===1?y/f:(Math.pow(e,y)-1)/(Math.pow(e,f)-1)}const In={color:xr.interpolate,number:ta,padding:ii.interpolate,numberArray:Yr.interpolate,colorArray:ur.interpolate,variableAnchorOffsetCollection:rs.interpolate,array:Da};class ml{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let c=null;const f=i.expectedType;f&&f.kind!=="value"&&(c=f);const y=[];for(const T of e.slice(1)){const C=i.parse(T,1+y.length,c,void 0,{typeAnnotation:"omit"});if(!C)return null;c=c||C.type,y.push(C)}if(!c)throw new Error("No output type");const _=f&&y.some((T=>cl(f,T.type)));return new ml(_?vr:c,y)}evaluate(e){let i,c=null,f=0;for(const y of this.args)if(f++,c=y.evaluate(e),c&&c instanceof fs&&!c.available&&(i||(i=c.name),c=null,f===this.args.length&&(c=i)),c!==null)break;return c}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}function Ud(o,e){return o==="=="||o==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function gl(o,e,i,c){return c.compare(e,i)===0}function Un(o,e,i){const c=o!=="=="&&o!=="!=";return class s5{constructor(y,_,T){this.type=Pr,this.lhs=y,this.rhs=_,this.collator=T,this.hasUntypedArgument=y.type.kind==="value"||_.type.kind==="value"}static parse(y,_){if(y.length!==3&&y.length!==4)return _.error("Expected two or three arguments.");const T=y[0];let C=_.parse(y[1],1,vr);if(!C)return null;if(!Ud(T,C.type))return _.concat(1).error(`"${T}" comparisons are not supported for type '${qr(C.type)}'.`);let I=_.parse(y[2],2,vr);if(!I)return null;if(!Ud(T,I.type))return _.concat(2).error(`"${T}" comparisons are not supported for type '${qr(I.type)}'.`);if(C.type.kind!==I.type.kind&&C.type.kind!=="value"&&I.type.kind!=="value")return _.error(`Cannot compare types '${qr(C.type)}' and '${qr(I.type)}'.`);c&&(C.type.kind==="value"&&I.type.kind!=="value"?C=new ps(I.type,[C]):C.type.kind!=="value"&&I.type.kind==="value"&&(I=new ps(C.type,[I])));let D=null;if(y.length===4){if(C.type.kind!=="string"&&I.type.kind!=="string"&&C.type.kind!=="value"&&I.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(D=_.parse(y[3],3,hc),!D)return null}return new s5(C,I,D)}evaluate(y){const _=this.lhs.evaluate(y),T=this.rhs.evaluate(y);if(c&&this.hasUntypedArgument){const C=bn(_),I=bn(T);if(C.kind!==I.kind||C.kind!=="string"&&C.kind!=="number")throw new ln(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${C.kind}, ${I.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const C=bn(_),I=bn(T);if(C.kind!=="string"||I.kind!=="string")return e(y,_,T)}return this.collator?i(y,_,T,this.collator.evaluate(y)):e(y,_,T)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const np=Un("==",(function(o,e,i){return e===i}),gl),$d=Un("!=",(function(o,e,i){return e!==i}),(function(o,e,i,c){return!gl(0,e,i,c)})),ip=Un("<",(function(o,e,i){return e<i}),(function(o,e,i,c){return c.compare(e,i)<0})),Dm=Un(">",(function(o,e,i){return e>i}),(function(o,e,i,c){return c.compare(e,i)>0})),yl=Un("<=",(function(o,e,i){return e<=i}),(function(o,e,i,c){return c.compare(e,i)<=0})),_h=Un(">=",(function(o,e,i){return e>=i}),(function(o,e,i,c){return c.compare(e,i)>=0}));class xc{constructor(e,i,c){this.type=hc,this.locale=c,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const c=e[1];if(typeof c!="object"||Array.isArray(c))return i.error("Collator options argument must be an object.");const f=i.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,Pr);if(!f)return null;const y=i.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,Pr);if(!y)return null;let _=null;return c.locale&&(_=i.parse(c.locale,1,_r),!_)?null:new xc(f,y,_)}evaluate(e){return new Ao(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Gd{constructor(e,i,c,f,y){this.type=_r,this.number=e,this.locale=i,this.currency=c,this.minFractionDigits=f,this.maxFractionDigits=y}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const c=i.parse(e[1],1,Lt);if(!c)return null;const f=e[2];if(typeof f!="object"||Array.isArray(f))return i.error("NumberFormat options argument must be an object.");let y=null;if(f.locale&&(y=i.parse(f.locale,1,_r),!y))return null;let _=null;if(f.currency&&(_=i.parse(f.currency,1,_r),!_))return null;let T=null;if(f["min-fraction-digits"]&&(T=i.parse(f["min-fraction-digits"],1,Lt),!T))return null;let C=null;return f["max-fraction-digits"]&&(C=i.parse(f["max-fraction-digits"],1,Lt),!C)?null:new Gd(c,y,_,T,C)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class gu{constructor(e){this.type=dc,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const c=e[1];if(!Array.isArray(c)&&typeof c=="object")return i.error("First argument must be an image or text section.");const f=[];let y=!1;for(let _=1;_<=e.length-1;++_){const T=e[_];if(y&&typeof T=="object"&&!Array.isArray(T)){y=!1;let C=null;if(T["font-scale"]&&(C=i.parse(T["font-scale"],1,Lt),!C))return null;let I=null;if(T["text-font"]&&(I=i.parse(T["text-font"],1,Bi(_r)),!I))return null;let D=null;if(T["text-color"]&&(D=i.parse(T["text-color"],1,ds),!D))return null;let O=null;if(T["vertical-align"]){if(typeof T["vertical-align"]=="string"&&!Ra.includes(T["vertical-align"]))return i.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${T["vertical-align"]}' instead.`);if(O=i.parse(T["vertical-align"],1,_r),!O)return null}const U=f[f.length-1];U.scale=C,U.font=I,U.textColor=D,U.verticalAlign=O}else{const C=i.parse(e[_],1,vr);if(!C)return null;const I=C.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,f.push({content:C,scale:null,font:null,textColor:null,verticalAlign:null})}}return new gu(f)}evaluate(e){return new wi(this.sections.map((i=>{const c=i.content.evaluate(e);return bn(c)===pc?new ko("",c,null,null,null,i.verticalAlign?i.verticalAlign.evaluate(e):null):new ko(oo(c),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null,i.verticalAlign?i.verticalAlign.evaluate(e):null)})))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor),i.verticalAlign&&e(i.verticalAlign)}outputDefined(){return!1}}class Oa{constructor(e){this.type=pc,this.input=e}static parse(e,i){if(e.length!==2)return i.error("Expected two arguments.");const c=i.parse(e[1],1,_r);return c?new Oa(c):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),c=fs.fromString(i);return c&&e.availableImages&&(c.available=e.availableImages.indexOf(i)>-1),c}eachChild(e){e(this.input)}outputDefined(){return!1}}class bc{constructor(e){this.type=Lt,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const c=i.parse(e[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${qr(c.type)} instead.`):new bc(c):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string")return[...i].length;if(Array.isArray(i))return i.length;throw new ln(`Expected value to be of type string or array, but found ${qr(bn(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const si=8192;function sp(o,e){const i=(180+o[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,f=Math.pow(2,e.z);return[Math.round(i*f*si),Math.round(c*f*si)]}function _l(o,e){const i=Math.pow(2,e.z);return[(f=(o[0]/si+e.x)/i,360*f-180),(c=(o[1]/si+e.y)/i,360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90)];var c,f}function yu(o,e){o[0]=Math.min(o[0],e[0]),o[1]=Math.min(o[1],e[1]),o[2]=Math.max(o[2],e[0]),o[3]=Math.max(o[3],e[1])}function vl(o,e){return!(o[0]<=e[0]||o[2]>=e[2]||o[1]<=e[1]||o[3]>=e[3])}function Rm(o,e,i){const c=o[0]-e[0],f=o[1]-e[1],y=o[0]-i[0],_=o[1]-i[1];return c*_-y*f==0&&c*y<=0&&f*_<=0}function vh(o,e,i,c){return(f=[c[0]-i[0],c[1]-i[1]])[0]*(y=[e[0]-o[0],e[1]-o[1]])[1]-f[1]*y[0]!=0&&!(!qd(o,e,i,c)||!qd(i,c,o,e));var f,y}function Lm(o,e,i){for(const c of i)for(let f=0;f<c.length-1;++f)if(vh(o,e,c[f],c[f+1]))return!0;return!1}function wc(o,e,i=!1){let c=!1;for(const T of e)for(let C=0;C<T.length-1;C++){if(Rm(o,T[C],T[C+1]))return i;(y=T[C])[1]>(f=o)[1]!=(_=T[C+1])[1]>f[1]&&f[0]<(_[0]-y[0])*(f[1]-y[1])/(_[1]-y[1])+y[0]&&(c=!c)}var f,y,_;return c}function xh(o,e){for(const i of e)if(wc(o,i))return!0;return!1}function bh(o,e){for(const i of o)if(!wc(i,e))return!1;for(let i=0;i<o.length-1;++i)if(Lm(o[i],o[i+1],e))return!1;return!0}function Tc(o,e){for(const i of e)if(bh(o,i))return!0;return!1}function qd(o,e,i,c){const f=c[0]-i[0],y=c[1]-i[1],_=(o[0]-i[0])*y-f*(o[1]-i[1]),T=(e[0]-i[0])*y-f*(e[1]-i[1]);return _>0&&T<0||_<0&&T>0}function wh(o,e,i){const c=[];for(let f=0;f<o.length;f++){const y=[];for(let _=0;_<o[f].length;_++){const T=sp(o[f][_],i);yu(e,T),y.push(T)}c.push(y)}return c}function Th(o,e,i){const c=[];for(let f=0;f<o.length;f++){const y=wh(o[f],e,i);c.push(y)}return c}function Zd(o,e,i,c){if(o[0]<i[0]||o[0]>i[2]){const f=.5*c;let y=o[0]-i[0]>f?-c:i[0]-o[0]>f?c:0;y===0&&(y=o[0]-i[2]>f?-c:i[2]-o[0]>f?c:0),o[0]+=y}yu(e,o)}function Wd(o,e,i,c){const f=Math.pow(2,c.z)*si,y=[c.x*si,c.y*si],_=[];for(const T of o)for(const C of T){const I=[C.x+y[0],C.y+y[1]];Zd(I,e,i,f),_.push(I)}return _}function Hd(o,e,i,c){const f=Math.pow(2,c.z)*si,y=[c.x*si,c.y*si],_=[];for(const C of o){const I=[];for(const D of C){const O=[D.x+y[0],D.y+y[1]];yu(e,O),I.push(O)}_.push(I)}if(e[2]-e[0]<=f/2){(T=e)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const C of _)for(const I of C)Zd(I,e,i,f)}var T;return _}class Os{constructor(e,i){this.type=Pr,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(La(e[1])){const c=e[1];if(c.type==="FeatureCollection"){const f=[];for(const y of c.features){const{type:_,coordinates:T}=y.geometry;_==="Polygon"&&f.push(T),_==="MultiPolygon"&&f.push(...T)}if(f.length)return new Os(c,{type:"MultiPolygon",coordinates:f})}else if(c.type==="Feature"){const f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Os(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new Os(c,c)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(i,c){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=i.canonicalID();if(c.type==="Polygon"){const T=wh(c.coordinates,y,_),C=Wd(i.geometry(),f,y,_);if(!vl(f,y))return!1;for(const I of C)if(!wc(I,T))return!1}if(c.type==="MultiPolygon"){const T=Th(c.coordinates,y,_),C=Wd(i.geometry(),f,y,_);if(!vl(f,y))return!1;for(const I of C)if(!xh(I,T))return!1}return!0})(e,this.geometries);if(e.geometryType()==="LineString")return(function(i,c){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=i.canonicalID();if(c.type==="Polygon"){const T=wh(c.coordinates,y,_),C=Hd(i.geometry(),f,y,_);if(!vl(f,y))return!1;for(const I of C)if(!bh(I,T))return!1}if(c.type==="MultiPolygon"){const T=Th(c.coordinates,y,_),C=Hd(i.geometry(),f,y,_);if(!vl(f,y))return!1;for(const I of C)if(!Tc(I,T))return!1}return!0})(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let op=class{constructor(o=[],e=(i,c)=>i<c?-1:i>c?1:0){if(this.data=o,this.length=this.data.length,this.compare=e,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:e,compare:i}=this,c=e[o];for(;o>0;){const f=o-1>>1,y=e[f];if(i(c,y)>=0)break;e[o]=y,o=f}e[o]=c}_down(o){const{data:e,compare:i}=this,c=this.length>>1,f=e[o];for(;o<c;){let y=1+(o<<1);const _=y+1;if(_<this.length&&i(e[_],e[y])<0&&(y=_),i(e[y],f)>=0)break;e[o]=e[y],o=y}e[o]=f}};function Xd(o,e,i=0,c=o.length-1,f=Kd){for(;c>i;){if(c-i>600){const C=c-i+1,I=e-i+1,D=Math.log(C),O=.5*Math.exp(2*D/3),U=.5*Math.sqrt(D*O*(C-O)/C)*(I-C/2<0?-1:1);Xd(o,e,Math.max(i,Math.floor(e-I*O/C+U)),Math.min(c,Math.floor(e+(C-I)*O/C+U)),f)}const y=o[e];let _=i,T=c;for(Sc(o,i,e),f(o[c],y)>0&&Sc(o,i,c);_<T;){for(Sc(o,_,T),_++,T--;f(o[_],y)<0;)_++;for(;f(o[T],y)>0;)T--}f(o[i],y)===0?Sc(o,i,T):(T++,Sc(o,T,c)),T<=e&&(i=T+1),e<=T&&(c=T-1)}}function Sc(o,e,i){const c=o[e];o[e]=o[i],o[i]=c}function Kd(o,e){return o<e?-1:o>e?1:0}function _u(o,e){if(o.length<=1)return[o];const i=[];let c,f;for(const y of o){const _=xu(y);_!==0&&(y.area=Math.abs(_),f===void 0&&(f=_<0),f===_<0?(c&&i.push(c),c=[y]):c.push(y))}if(c&&i.push(c),e>1)for(let y=0;y<i.length;y++)i[y].length<=e||(Xd(i[y],e,1,i[y].length-1,vu),i[y]=i[y].slice(0,e));return i}function vu(o,e){return e.area-o.area}function xu(o){let e=0;for(let i,c,f=0,y=o.length,_=y-1;f<y;_=f++)i=o[f],c=o[_],e+=(c.x-i.x)*(i.y+c.y);return e}const ap=1/298.257223563,Na=ap*(2-ap),lp=Math.PI/180;class Sh{constructor(e){const i=6378.137*lp*1e3,c=Math.cos(e*lp),f=1/(1-Na*(1-c*c)),y=Math.sqrt(f);this.kx=i*y*c,this.ky=i*y*f*(1-Na)}distance(e,i){const c=this.wrap(e[0]-i[0])*this.kx,f=(e[1]-i[1])*this.ky;return Math.sqrt(c*c+f*f)}pointOnLine(e,i){let c,f,y,_,T=1/0;for(let C=0;C<e.length-1;C++){let I=e[C][0],D=e[C][1],O=this.wrap(e[C+1][0]-I)*this.kx,U=(e[C+1][1]-D)*this.ky,G=0;O===0&&U===0||(G=(this.wrap(i[0]-I)*this.kx*O+(i[1]-D)*this.ky*U)/(O*O+U*U),G>1?(I=e[C+1][0],D=e[C+1][1]):G>0&&(I+=O/this.kx*G,D+=U/this.ky*G)),O=this.wrap(i[0]-I)*this.kx,U=(i[1]-D)*this.ky;const H=O*O+U*U;H<T&&(T=H,c=I,f=D,y=C,_=G)}return{point:[c,f],index:y,t:Math.max(0,Math.min(1,_))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function Ph(o,e){return e[0]-o[0]}function Pc(o){return o[1]-o[0]+1}function Ns(o,e){return o[1]>=o[0]&&o[1]<e}function bu(o,e){if(o[0]>o[1])return[null,null];const i=Pc(o);if(e){if(i===2)return[o,null];const f=Math.floor(i/2);return[[o[0],o[0]+f],[o[0]+f,o[1]]]}if(i===1)return[o,null];const c=Math.floor(i/2)-1;return[[o[0],o[0]+c],[o[0]+c+1,o[1]]]}function Ch(o,e){if(!Ns(e,o.length))return[1/0,1/0,-1/0,-1/0];const i=[1/0,1/0,-1/0,-1/0];for(let c=e[0];c<=e[1];++c)yu(i,o[c]);return i}function Yd(o){const e=[1/0,1/0,-1/0,-1/0];for(const i of o)for(const c of i)yu(e,c);return e}function Qd(o){return o[0]!==-1/0&&o[1]!==-1/0&&o[2]!==1/0&&o[3]!==1/0}function Eh(o,e,i){if(!Qd(o)||!Qd(e))return NaN;let c=0,f=0;return o[2]<e[0]&&(c=e[0]-o[2]),o[0]>e[2]&&(c=o[0]-e[2]),o[1]>e[3]&&(f=o[1]-e[3]),o[3]<e[1]&&(f=e[1]-o[3]),i.distance([0,0],[c,f])}function xl(o,e,i){const c=i.pointOnLine(e,o);return i.distance(o,c.point)}function Jd(o,e,i,c,f){const y=Math.min(xl(o,[i,c],f),xl(e,[i,c],f)),_=Math.min(xl(i,[o,e],f),xl(c,[o,e],f));return Math.min(y,_)}function uo(o,e,i,c,f){if(!Ns(e,o.length)||!Ns(c,i.length))return 1/0;let y=1/0;for(let _=e[0];_<e[1];++_){const T=o[_],C=o[_+1];for(let I=c[0];I<c[1];++I){const D=i[I],O=i[I+1];if(vh(T,C,D,O))return 0;y=Math.min(y,Jd(T,C,D,O,f))}}return y}function Cc(o,e,i,c,f){if(!Ns(e,o.length)||!Ns(c,i.length))return NaN;let y=1/0;for(let _=e[0];_<=e[1];++_)for(let T=c[0];T<=c[1];++T)if(y=Math.min(y,f.distance(o[_],i[T])),y===0)return y;return y}function cp(o,e,i){if(wc(o,e,!0))return 0;let c=1/0;for(const f of e){const y=f[0],_=f[f.length-1];if(y!==_&&(c=Math.min(c,xl(o,[_,y],i)),c===0))return c;const T=i.pointOnLine(f,o);if(c=Math.min(c,i.distance(o,T.point)),c===0)return c}return c}function up(o,e,i,c){if(!Ns(e,o.length))return NaN;for(let y=e[0];y<=e[1];++y)if(wc(o[y],i,!0))return 0;let f=1/0;for(let y=e[0];y<e[1];++y){const _=o[y],T=o[y+1];for(const C of i)for(let I=0,D=C.length,O=D-1;I<D;O=I++){const U=C[O],G=C[I];if(vh(_,T,U,G))return 0;f=Math.min(f,Jd(_,T,U,G,c))}}return f}function ef(o,e){for(const i of o)for(const c of i)if(wc(c,e,!0))return!0;return!1}function hp(o,e,i,c=1/0){const f=Yd(o),y=Yd(e);if(c!==1/0&&Eh(f,y,i)>=c)return c;if(vl(f,y)){if(ef(o,e))return 0}else if(ef(e,o))return 0;let _=1/0;for(const T of o)for(let C=0,I=T.length,D=I-1;C<I;D=C++){const O=T[D],U=T[C];for(const G of e)for(let H=0,K=G.length,J=K-1;H<K;J=H++){const se=G[J],ye=G[H];if(vh(O,U,se,ye))return 0;_=Math.min(_,Jd(O,U,se,ye,i))}}return _}function Vr(o,e,i,c,f,y){if(!y)return;const _=Eh(Ch(c,y),f,i);_<e&&o.push([_,y,[0,0]])}function Mh(o,e,i,c,f,y,_){if(!y||!_)return;const T=Eh(Ch(c,y),Ch(f,_),i);T<e&&o.push([T,y,_])}function Ih(o,e,i,c,f=1/0){let y=Math.min(c.distance(o[0],i[0][0]),f);if(y===0)return y;const _=new op([[0,[0,o.length-1],[0,0]]],Ph),T=Yd(i);for(;_.length>0;){const C=_.pop();if(C[0]>=y)continue;const I=C[1],D=e?50:100;if(Pc(I)<=D){if(!Ns(I,o.length))return NaN;if(e){const O=up(o,I,i,c);if(isNaN(O)||O===0)return O;y=Math.min(y,O)}else for(let O=I[0];O<=I[1];++O){const U=cp(o[O],i,c);if(y=Math.min(y,U),y===0)return 0}}else{const O=bu(I,e);Vr(_,y,c,o,T,O[0]),Vr(_,y,c,o,T,O[1])}}return y}function na(o,e,i,c,f,y=1/0){let _=Math.min(y,f.distance(o[0],i[0]));if(_===0)return _;const T=new op([[0,[0,o.length-1],[0,i.length-1]]],Ph);for(;T.length>0;){const C=T.pop();if(C[0]>=_)continue;const I=C[1],D=C[2],O=e?50:100,U=c?50:100;if(Pc(I)<=O&&Pc(D)<=U){if(!Ns(I,o.length)&&Ns(D,i.length))return NaN;let G;if(e&&c)G=uo(o,I,i,D,f),_=Math.min(_,G);else if(e&&!c){const H=o.slice(I[0],I[1]+1);for(let K=D[0];K<=D[1];++K)if(G=xl(i[K],H,f),_=Math.min(_,G),_===0)return _}else if(!e&&c){const H=i.slice(D[0],D[1]+1);for(let K=I[0];K<=I[1];++K)if(G=xl(o[K],H,f),_=Math.min(_,G),_===0)return _}else G=Cc(o,I,i,D,f),_=Math.min(_,G)}else{const G=bu(I,e),H=bu(D,c);Mh(T,_,f,o,i,G[0],H[0]),Mh(T,_,f,o,i,G[0],H[1]),Mh(T,_,f,o,i,G[1],H[0]),Mh(T,_,f,o,i,G[1],H[1])}}return _}function wu(o){return o.type==="MultiPolygon"?o.coordinates.map((e=>({type:"Polygon",coordinates:e}))):o.type==="MultiLineString"?o.coordinates.map((e=>({type:"LineString",coordinates:e}))):o.type==="MultiPoint"?o.coordinates.map((e=>({type:"Point",coordinates:e}))):[o]}class ho{constructor(e,i){this.type=Lt,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(La(e[1])){const c=e[1];if(c.type==="FeatureCollection")return new ho(c,c.features.map((f=>wu(f.geometry))).flat());if(c.type==="Feature")return new ho(c,wu(c.geometry));if("type"in c&&"coordinates"in c)return new ho(c,wu(c))}return i.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(i,c){const f=i.geometry(),y=f.flat().map((C=>_l([C.x,C.y],i.canonical)));if(f.length===0)return NaN;const _=new Sh(y[0][1]);let T=1/0;for(const C of c){switch(C.type){case"Point":T=Math.min(T,na(y,!1,[C.coordinates],!1,_,T));break;case"LineString":T=Math.min(T,na(y,!1,C.coordinates,!0,_,T));break;case"Polygon":T=Math.min(T,Ih(y,!1,C.coordinates,_,T))}if(T===0)return T}return T})(e,this.geometries);if(e.geometryType()==="LineString")return(function(i,c){const f=i.geometry(),y=f.flat().map((C=>_l([C.x,C.y],i.canonical)));if(f.length===0)return NaN;const _=new Sh(y[0][1]);let T=1/0;for(const C of c){switch(C.type){case"Point":T=Math.min(T,na(y,!0,[C.coordinates],!1,_,T));break;case"LineString":T=Math.min(T,na(y,!0,C.coordinates,!0,_,T));break;case"Polygon":T=Math.min(T,Ih(y,!0,C.coordinates,_,T))}if(T===0)return T}return T})(e,this.geometries);if(e.geometryType()==="Polygon")return(function(i,c){const f=i.geometry();if(f.length===0||f[0].length===0)return NaN;const y=_u(f,0).map((C=>C.map((I=>I.map((D=>_l([D.x,D.y],i.canonical))))))),_=new Sh(y[0][0][0][1]);let T=1/0;for(const C of c)for(const I of y){switch(C.type){case"Point":T=Math.min(T,Ih([C.coordinates],!1,I,_,T));break;case"LineString":T=Math.min(T,Ih(C.coordinates,!0,I,_,T));break;case"Polygon":T=Math.min(T,hp(I,C.coordinates,_,T))}if(T===0)return T}return T})(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class bl{constructor(e){this.type=vr,this.key=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const c=e[1];return c==null?i.error("Global state property must be defined."):typeof c!="string"?i.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new bl(c)}evaluate(e){var i;const c=(i=e.globals)===null||i===void 0?void 0:i.globalState;return c&&Object.keys(c).length!==0?Zr(c,this.key):null}eachChild(){}outputDefined(){return!1}}const wl={"==":np,"!=":$d,">":Dm,"<":ip,">=":_h,"<=":yl,array:ps,at:Mr,boolean:ps,case:yc,coalesce:ml,collator:xc,format:gu,image:Oa,in:br,"index-of":ra,interpolate:Si,"interpolate-hcl":Si,"interpolate-lab":Si,length:bc,let:Br,literal:ns,match:Ir,number:ps,"number-format":Gd,object:ps,slice:Nn,step:Do,string:ps,"to-boolean":ao,"to-color":ao,"to-number":ao,"to-string":ao,var:Fa,within:Os,distance:ho,"global-state":bl};class is{constructor(e,i,c,f){this.name=e,this.type=i,this._evaluate=c,this.args=f}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,i){const c=e[0],f=is.definitions[c];if(!f)return i.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(f)?f[0]:f.type,_=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,T=_.filter((([I])=>!Array.isArray(I)||I.length===e.length-1));let C=null;for(const[I,D]of T){C=new za(i.registry,Tu,i.path,null,i.scope);const O=[];let U=!1;for(let G=1;G<e.length;G++){const H=e[G],K=Array.isArray(I)?I[G-1]:I.type,J=C.parse(H,1+O.length,K);if(!J){U=!0;break}O.push(J)}if(!U)if(Array.isArray(I)&&I.length!==O.length)C.error(`Expected ${I.length} arguments, but found ${O.length} instead.`);else{for(let G=0;G<O.length;G++){const H=Array.isArray(I)?I[G]:I.type,K=O[G];C.concat(G+1).checkSubtype(H,K.type)}if(C.errors.length===0)return new is(c,y,D,O)}}if(T.length===1)i.errors.push(...C.errors);else{const I=(T.length?T:_).map((([O])=>{return U=O,Array.isArray(U)?`(${U.map(qr).join(", ")})`:`(${qr(U.type)}...)`;var U})).join(" | "),D=[];for(let O=1;O<e.length;O++){const U=i.parse(e[O],1+D.length);if(!U)return null;D.push(qr(U.type))}i.error(`Expected arguments of type ${I}, but found (${D.join(", ")}) instead.`)}return null}static register(e,i){is.definitions=i;for(const c in i)e[c]=is}}function Tl(o,[e,i,c,f]){e=e.evaluate(o),i=i.evaluate(o),c=c.evaluate(o);const y=f?f.evaluate(o):1,_=dl(e,i,c,y);if(_)throw new ln(_);return new xr(e/255,i/255,c/255,y,!1)}function Ah(o,e){return o in e}function kh(o,e){const i=e[o];return i===void 0?null:i}function Ro(o){return{type:o}}function Tu(o){if(o instanceof Fa)return Tu(o.boundExpression);if(o instanceof is&&o.name==="error"||o instanceof xc||o instanceof Os||o instanceof ho||o instanceof bl)return!1;const e=o instanceof ao||o instanceof ps;let i=!0;return o.eachChild((c=>{i=e?i&&Tu(c):i&&c instanceof ns})),!!i&&Su(o)&&Pu(o,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Su(o){if(o instanceof is&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof Os||o instanceof ho)return!1;let e=!0;return o.eachChild((i=>{e&&!Su(i)&&(e=!1)})),e}function Ec(o){if(o instanceof is&&o.name==="feature-state")return!1;let e=!0;return o.eachChild((i=>{e&&!Ec(i)&&(e=!1)})),e}function Pu(o,e){if(o instanceof is&&e.indexOf(o.name)>=0)return!1;let i=!0;return o.eachChild((c=>{i&&!Pu(c,e)&&(i=!1)})),i}function tf(o){return{result:"success",value:o}}function Sl(o){return{result:"error",value:o}}function Is(o){return o["property-type"]==="data-driven"||o["property-type"]==="cross-faded-data-driven"}function Dh(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function Cu(o){return!!o.expression&&o.expression.interpolated}function Er(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function Rh(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)&&bn(o)===Io}function Eu(o){return o}function dp(o,e){const i=o.stops&&typeof o.stops[0][0]=="object",c=i||!(i||o.property!==void 0),f=o.type||(Cu(e)?"exponential":"interval"),y=(function(D){switch(D.type){case"color":return xr.parse;case"padding":return ii.parse;case"numberArray":return Yr.parse;case"colorArray":return ur.parse;default:return null}})(e);if(y&&((o=bi({},o)).stops&&(o.stops=o.stops.map((D=>[D[0],y(D[1])]))),o.default=y(o.default?o.default:e.default)),o.colorSpace&&(_=o.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${o.colorSpace}"`);var _;const T=(function(D){switch(D){case"exponential":return Lh;case"interval":return An;case"categorical":return fp;case"identity":return zh;default:throw new Error(`Unknown function type "${D}"`)}})(f);let C,I;if(f==="categorical"){C=Object.create(null);for(const D of o.stops)C[D[0]]=D[1];I=typeof o.stops[0][0]}if(i){const D={},O=[];for(let H=0;H<o.stops.length;H++){const K=o.stops[H],J=K[0].zoom;D[J]===void 0&&(D[J]={zoom:J,type:o.type,property:o.property,default:o.default,stops:[]},O.push(J)),D[J].stops.push([K[0].value,K[1]])}const U=[];for(const H of O)U.push([D[H].zoom,dp(D[H],e)]);const G={name:"linear"};return{kind:"composite",interpolationType:G,interpolationFactor:Si.interpolationFactor.bind(void 0,G),zoomStops:U.map((H=>H[0])),evaluate:({zoom:H},K)=>Lh({stops:U,base:o.base},e,H).evaluate(H,K)}}if(c){const D=f==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:Si.interpolationFactor.bind(void 0,D),zoomStops:o.stops.map((O=>O[0])),evaluate:({zoom:O})=>T(o,e,O,C,I)}}return{kind:"source",evaluate(D,O){const U=O&&O.properties?O.properties[o.property]:void 0;return U===void 0?Mc(o.default,e.default):T(o,e,U,C,I)}}}function Mc(o,e,i){return o!==void 0?o:e!==void 0?e:i!==void 0?i:void 0}function fp(o,e,i,c,f){return Mc(typeof i===f?c[i]:void 0,o.default,e.default)}function An(o,e,i){if(Er(i)!=="number")return Mc(o.default,e.default);const c=o.stops.length;if(c===1||i<=o.stops[0][0])return o.stops[0][1];if(i>=o.stops[c-1][0])return o.stops[c-1][1];const f=lo(o.stops.map((y=>y[0])),i);return o.stops[f][1]}function Lh(o,e,i){const c=o.base!==void 0?o.base:1;if(Er(i)!=="number")return Mc(o.default,e.default);const f=o.stops.length;if(f===1||i<=o.stops[0][0])return o.stops[0][1];if(i>=o.stops[f-1][0])return o.stops[f-1][1];const y=lo(o.stops.map((D=>D[0])),i),_=(function(D,O,U,G){const H=G-U,K=D-U;return H===0?0:O===1?K/H:(Math.pow(O,K)-1)/(Math.pow(O,H)-1)})(i,c,o.stops[y][0],o.stops[y+1][0]),T=o.stops[y][1],C=o.stops[y+1][1],I=In[e.type]||Eu;return typeof T.evaluate=="function"?{evaluate(...D){const O=T.evaluate.apply(void 0,D),U=C.evaluate.apply(void 0,D);if(O!==void 0&&U!==void 0)return I(O,U,_,o.colorSpace)}}:I(T,C,_,o.colorSpace)}function zh(o,e,i){switch(e.type){case"color":i=xr.parse(i);break;case"formatted":i=wi.fromString(i.toString());break;case"resolvedImage":i=fs.fromString(i.toString());break;case"padding":i=ii.parse(i);break;case"colorArray":i=ur.parse(i);break;case"numberArray":i=Yr.parse(i);break;default:Er(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0)}return Mc(i,o.default,e.default)}is.register(wl,{error:[{kind:"error"},[_r],(o,[e])=>{throw new ln(e.evaluate(o))}],typeof:[_r,[vr],(o,[e])=>qr(bn(e.evaluate(o)))],"to-rgba":[Bi(Lt,4),[ds],(o,[e])=>{const[i,c,f,y]=e.evaluate(o).rgb;return[255*i,255*c,255*f,y]}],rgb:[ds,[Lt,Lt,Lt],Tl],rgba:[ds,[Lt,Lt,Lt,Lt],Tl],has:{type:Pr,overloads:[[[_r],(o,[e])=>Ah(e.evaluate(o),o.properties())],[[_r,Io],(o,[e,i])=>Ah(e.evaluate(o),i.evaluate(o))]]},get:{type:vr,overloads:[[[_r],(o,[e])=>kh(e.evaluate(o),o.properties())],[[_r,Io],(o,[e,i])=>kh(e.evaluate(o),i.evaluate(o))]]},"feature-state":[vr,[_r],(o,[e])=>kh(e.evaluate(o),o.featureState||{})],properties:[Io,[],o=>o.properties()],"geometry-type":[_r,[],o=>o.geometryType()],id:[vr,[],o=>o.id()],zoom:[Lt,[],o=>o.globals.zoom],"heatmap-density":[Lt,[],o=>o.globals.heatmapDensity||0],elevation:[Lt,[],o=>o.globals.elevation||0],"line-progress":[Lt,[],o=>o.globals.lineProgress||0],accumulated:[vr,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[Lt,Ro(Lt),(o,e)=>{let i=0;for(const c of e)i+=c.evaluate(o);return i}],"*":[Lt,Ro(Lt),(o,e)=>{let i=1;for(const c of e)i*=c.evaluate(o);return i}],"-":{type:Lt,overloads:[[[Lt,Lt],(o,[e,i])=>e.evaluate(o)-i.evaluate(o)],[[Lt],(o,[e])=>-e.evaluate(o)]]},"/":[Lt,[Lt,Lt],(o,[e,i])=>e.evaluate(o)/i.evaluate(o)],"%":[Lt,[Lt,Lt],(o,[e,i])=>e.evaluate(o)%i.evaluate(o)],ln2:[Lt,[],()=>Math.LN2],pi:[Lt,[],()=>Math.PI],e:[Lt,[],()=>Math.E],"^":[Lt,[Lt,Lt],(o,[e,i])=>Math.pow(e.evaluate(o),i.evaluate(o))],sqrt:[Lt,[Lt],(o,[e])=>Math.sqrt(e.evaluate(o))],log10:[Lt,[Lt],(o,[e])=>Math.log(e.evaluate(o))/Math.LN10],ln:[Lt,[Lt],(o,[e])=>Math.log(e.evaluate(o))],log2:[Lt,[Lt],(o,[e])=>Math.log(e.evaluate(o))/Math.LN2],sin:[Lt,[Lt],(o,[e])=>Math.sin(e.evaluate(o))],cos:[Lt,[Lt],(o,[e])=>Math.cos(e.evaluate(o))],tan:[Lt,[Lt],(o,[e])=>Math.tan(e.evaluate(o))],asin:[Lt,[Lt],(o,[e])=>Math.asin(e.evaluate(o))],acos:[Lt,[Lt],(o,[e])=>Math.acos(e.evaluate(o))],atan:[Lt,[Lt],(o,[e])=>Math.atan(e.evaluate(o))],min:[Lt,Ro(Lt),(o,e)=>Math.min(...e.map((i=>i.evaluate(o))))],max:[Lt,Ro(Lt),(o,e)=>Math.max(...e.map((i=>i.evaluate(o))))],abs:[Lt,[Lt],(o,[e])=>Math.abs(e.evaluate(o))],round:[Lt,[Lt],(o,[e])=>{const i=e.evaluate(o);return i<0?-Math.round(-i):Math.round(i)}],floor:[Lt,[Lt],(o,[e])=>Math.floor(e.evaluate(o))],ceil:[Lt,[Lt],(o,[e])=>Math.ceil(e.evaluate(o))],"filter-==":[Pr,[_r,vr],(o,[e,i])=>o.properties()[e.value]===i.value],"filter-id-==":[Pr,[vr],(o,[e])=>o.id()===e.value],"filter-type-==":[Pr,[_r],(o,[e])=>o.geometryType()===e.value],"filter-<":[Pr,[_r,vr],(o,[e,i])=>{const c=o.properties()[e.value],f=i.value;return typeof c==typeof f&&c<f}],"filter-id-<":[Pr,[vr],(o,[e])=>{const i=o.id(),c=e.value;return typeof i==typeof c&&i<c}],"filter->":[Pr,[_r,vr],(o,[e,i])=>{const c=o.properties()[e.value],f=i.value;return typeof c==typeof f&&c>f}],"filter-id->":[Pr,[vr],(o,[e])=>{const i=o.id(),c=e.value;return typeof i==typeof c&&i>c}],"filter-<=":[Pr,[_r,vr],(o,[e,i])=>{const c=o.properties()[e.value],f=i.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[Pr,[vr],(o,[e])=>{const i=o.id(),c=e.value;return typeof i==typeof c&&i<=c}],"filter->=":[Pr,[_r,vr],(o,[e,i])=>{const c=o.properties()[e.value],f=i.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[Pr,[vr],(o,[e])=>{const i=o.id(),c=e.value;return typeof i==typeof c&&i>=c}],"filter-has":[Pr,[vr],(o,[e])=>e.value in o.properties()],"filter-has-id":[Pr,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[Pr,[Bi(_r)],(o,[e])=>e.value.indexOf(o.geometryType())>=0],"filter-id-in":[Pr,[Bi(vr)],(o,[e])=>e.value.indexOf(o.id())>=0],"filter-in-small":[Pr,[_r,Bi(vr)],(o,[e,i])=>i.value.indexOf(o.properties()[e.value])>=0],"filter-in-large":[Pr,[_r,Bi(vr)],(o,[e,i])=>(function(c,f,y,_){for(;y<=_;){const T=y+_>>1;if(f[T]===c)return!0;f[T]>c?_=T-1:y=T+1}return!1})(o.properties()[e.value],i.value,0,i.value.length-1)],all:{type:Pr,overloads:[[[Pr,Pr],(o,[e,i])=>e.evaluate(o)&&i.evaluate(o)],[Ro(Pr),(o,e)=>{for(const i of e)if(!i.evaluate(o))return!1;return!0}]]},any:{type:Pr,overloads:[[[Pr,Pr],(o,[e,i])=>e.evaluate(o)||i.evaluate(o)],[Ro(Pr),(o,e)=>{for(const i of e)if(i.evaluate(o))return!0;return!1}]]},"!":[Pr,[Pr],(o,[e])=>!e.evaluate(o)],"is-supported-script":[Pr,[_r],(o,[e])=>{const i=o.globals&&o.globals.isSupportedScript;return!i||i(e.evaluate(o))}],upcase:[_r,[_r],(o,[e])=>e.evaluate(o).toUpperCase()],downcase:[_r,[_r],(o,[e])=>e.evaluate(o).toLowerCase()],concat:[_r,Ro(vr),(o,e)=>e.map((i=>oo(i.evaluate(o)))).join("")],"resolved-locale":[_r,[hc],(o,[e])=>e.evaluate(o).resolvedLocale()]});class Pl{constructor(e,i,c){this.expression=e,this._warningHistory={},this._evaluator=new fu,this._defaultValue=i?(function(f){if(f.type==="color"&&Rh(f.default))return new xr(0,0,0,0);switch(f.type){case"color":return xr.parse(f.default)||null;case"padding":return ii.parse(f.default)||null;case"numberArray":return Yr.parse(f.default)||null;case"colorArray":return ur.parse(f.default)||null;case"variableAnchorOffsetCollection":return rs.parse(f.default)||null;case"projectionDefinition":return Ti.parse(f.default)||null;default:return f.default===void 0?null:f.default}})(i):null,this._enumValues=i&&i.type==="enum"?i.values:null,this._globalState=c}evaluateWithoutErrorHandling(e,i,c,f,y,_){return this._globalState&&(e=Ua(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=c,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(e,i,c,f,y,_){this._globalState&&(e=Ua(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new ln(`Expected value to be one of ${Object.keys(this._enumValues).map((C=>JSON.stringify(C))).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function Cl(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in wl}function El(o,e,i){const c=new za(wl,Tu,[],e?(function(y){const _={color:ds,string:_r,number:Lt,enum:_r,boolean:Pr,formatted:dc,padding:fh,numberArray:Mn,colorArray:fc,projectionDefinition:dh,resolvedImage:pc,variableAnchorOffsetCollection:ll};return y.type==="array"?Bi(_[y.value]||vr,y.length):_[y.type]})(e):void 0),f=c.parse(o,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?tf(new Pl(f,e,i)):Sl(c.errors)}class ja{constructor(e,i,c){this.kind=e,this._styleExpression=i,this.isStateDependent=e!=="constant"&&!Ec(i.expression),this.globalStateRefs=Va(i.expression),this._globalState=c}evaluateWithoutErrorHandling(e,i,c,f,y,_){return this._globalState&&(e=Ua(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,i,c,f,y,_)}evaluate(e,i,c,f,y,_){return this._globalState&&(e=Ua(e,this._globalState)),this._styleExpression.evaluate(e,i,c,f,y,_)}}class Ic{constructor(e,i,c,f,y){this.kind=e,this.zoomStops=c,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!Ec(i.expression),this.globalStateRefs=Va(i.expression),this.interpolationType=f,this._globalState=y}evaluateWithoutErrorHandling(e,i,c,f,y,_){return this._globalState&&(e=Ua(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,i,c,f,y,_)}evaluate(e,i,c,f,y,_){return this._globalState&&(e=Ua(e,this._globalState)),this._styleExpression.evaluate(e,i,c,f,y,_)}interpolationFactor(e,i,c){return this.interpolationType?Si.interpolationFactor(this.interpolationType,e,i,c):0}}function Ba(o,e,i){const c=El(o,e,i);if(c.result==="error")return c;const f=c.value.expression,y=Su(f);if(!y&&!Is(e))return Sl([new Ri("","data expressions not supported")]);const _=Pu(f,["zoom"]);if(!_&&!Dh(e))return Sl([new Ri("","zoom expressions not supported")]);const T=Fh(f);return T||_?T instanceof Ri?Sl([T]):T instanceof Si&&!Cu(e)?Sl([new Ri("",'"interpolate" expressions cannot be used with this property')]):tf(T?new Ic(y?"camera":"composite",c.value,T.labels,T instanceof Si?T.interpolation:void 0,i):new ja(y?"constant":"source",c.value,i)):Sl([new Ri("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Mu{constructor(e,i){this._parameters=e,this._specification=i,bi(this,dp(this._parameters,this._specification))}static deserialize(e){return new Mu(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Fh(o){let e=null;if(o instanceof Br)e=Fh(o.result);else if(o instanceof ml){for(const i of o.args)if(e=Fh(i),e)break}else(o instanceof Do||o instanceof Si)&&o.input instanceof is&&o.input.name==="zoom"&&(e=o);return e instanceof Ri||o.eachChild((i=>{const c=Fh(i);c instanceof Ri?e=c:!e&&c?e=new Ri("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&c&&e!==c&&(e=new Ri("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function Va(o,e=new Set){return o instanceof bl&&e.add(o.key),o.eachChild((i=>{Va(i,e)})),e}function Ua(o,e){const{zoom:i,heatmapDensity:c,elevation:f,lineProgress:y,isSupportedScript:_,accumulated:T}=o??{};return{zoom:i,heatmapDensity:c,elevation:f,lineProgress:y,isSupportedScript:_,accumulated:T,globalState:e}}function Ac(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const e of o.slice(1))if(!Ac(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const Oh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ml(o,e){if(o==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Ac(o)||(o=Il(o));const i=El(o,Oh,e);if(i.result==="error")throw new Error(i.value.map((c=>`${c.key}: ${c.message}`)).join(", "));return{filter:(c,f,y)=>i.value.evaluate(c,f,{},y),needGeometry:Nh(o),getGlobalStateRefs:()=>Va(i.value.expression)}}function rf(o,e){return o<e?-1:o>e?1:0}function Nh(o){if(!Array.isArray(o))return!1;if(o[0]==="within"||o[0]==="distance")return!0;for(let e=1;e<o.length;e++)if(Nh(o[e]))return!0;return!1}function Il(o){if(!o)return!0;const e=o[0];return o.length<=1?e!=="any":e==="=="?jh(o[1],o[2],"=="):e==="!="?Iu(jh(o[1],o[2],"==")):e==="<"||e===">"||e==="<="||e===">="?jh(o[1],o[2],e):e==="any"?(i=o.slice(1),["any"].concat(i.map(Il))):e==="all"?["all"].concat(o.slice(1).map(Il)):e==="none"?["all"].concat(o.slice(1).map(Il).map(Iu)):e==="in"?nf(o[1],o.slice(2)):e==="!in"?Iu(nf(o[1],o.slice(2))):e==="has"?pp(o[1]):e!=="!has"||Iu(pp(o[1]));var i}function jh(o,e,i){switch(o){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,o,e]}}function nf(o,e){if(e.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((i=>typeof i!=typeof e[0]))?["filter-in-large",o,["literal",e.sort(rf)]]:["filter-in-small",o,["literal",e]]}}function pp(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function Iu(o){return["!",o]}function kc(o){const e=typeof o;if(e==="number"||e==="boolean"||e==="string"||o==null)return JSON.stringify(o);if(Array.isArray(o)){let f="[";for(const y of o)f+=`${kc(y)},`;return`${f}]`}const i=Object.keys(o).sort();let c="{";for(let f=0;f<i.length;f++)c+=`${JSON.stringify(i[f])}:${kc(o[i[f]])},`;return`${c}}`}function ia(o){let e="";for(const i of an)e+=`/${kc(o[i])}`;return e}function sf(o){const e=o.value;return e?[new yt(o.key,e,"constants have been deprecated as of v8")]:[]}function yn(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function Ui(o){if(Array.isArray(o))return o.map(Ui);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const e={};for(const i in o)e[i]=Ui(o[i]);return e}return yn(o)}function Li(o){const e=o.key,i=o.value,c=o.valueSpec||{},f=o.objectElementValidators||{},y=o.style,_=o.styleSpec,T=o.validateSpec;let C=[];const I=Er(i);if(I!=="object")return[new yt(e,i,`object expected, ${I} found`)];for(const D in i){const O=D.split(".")[0],U=Zr(c,O)||c["*"];let G;if(Zr(f,O))G=f[O];else if(Zr(c,O)){if(i[D]===void 0)continue;G=T}else if(f["*"])G=f["*"];else{if(!c["*"]){C.push(new yt(e,i[D],`unknown property "${D}"`));continue}G=T}C=C.concat(G({key:(e&&`${e}.`)+D,value:i[D],valueSpec:U,style:y,styleSpec:_,object:i,objectKey:D,validateSpec:T},i))}for(const D in c)f[D]||c[D].required&&c[D].default===void 0&&i[D]===void 0&&C.push(new yt(e,i,`missing required property "${D}"`));return C}function js(o){const e=o.value,i=o.valueSpec,c=o.style,f=o.styleSpec,y=o.key,_=o.arrayElementValidator||o.validateSpec;if(Er(e)!=="array")return[new yt(y,e,`array expected, ${Er(e)} found`)];if(i.length&&e.length!==i.length)return[new yt(y,e,`array length ${i.length} expected, length ${e.length} found`)];let T={type:i.value,values:i.values};f.$version<7&&(T.function=i.function),Er(i.value)==="object"&&(T=i.value);let C=[];for(let I=0;I<e.length;I++)C=C.concat(_({array:e,arrayIndex:I,value:e[I],valueSpec:T,validateSpec:o.validateSpec,style:c,styleSpec:f,key:`${y}[${I}]`}));return C}function Al(o){const e=o.key,i=o.value,c=o.valueSpec;let f=Er(i);return f==="number"&&i!=i&&(f="NaN"),f!=="number"?[new yt(e,i,`number expected, ${f} found`)]:"minimum"in c&&i<c.minimum?[new yt(e,i,`${i} is less than the minimum value ${c.minimum}`)]:"maximum"in c&&i>c.maximum?[new yt(e,i,`${i} is greater than the maximum value ${c.maximum}`)]:[]}function Bh(o){const e=o.valueSpec,i=yn(o.value.type);let c,f,y,_={};const T=i!=="categorical"&&o.value.property===void 0,C=!T,I=Er(o.value.stops)==="array"&&Er(o.value.stops[0])==="array"&&Er(o.value.stops[0][0])==="object",D=Li({key:o.key,value:o.value,valueSpec:o.styleSpec.function,validateSpec:o.validateSpec,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(G){if(i==="identity")return[new yt(G.key,G.value,'identity function may not have a "stops" property')];let H=[];const K=G.value;return H=H.concat(js({key:G.key,value:K,valueSpec:G.valueSpec,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec,arrayElementValidator:O})),Er(K)==="array"&&K.length===0&&H.push(new yt(G.key,K,"array must have at least one stop")),H},default:function(G){return G.validateSpec({key:G.key,value:G.value,valueSpec:e,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec})}}});return i==="identity"&&T&&D.push(new yt(o.key,o.value,'missing required property "property"')),i==="identity"||o.value.stops||D.push(new yt(o.key,o.value,'missing required property "stops"')),i==="exponential"&&o.valueSpec.expression&&!Cu(o.valueSpec)&&D.push(new yt(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(C&&!Is(o.valueSpec)?D.push(new yt(o.key,o.value,"property functions not supported")):T&&!Dh(o.valueSpec)&&D.push(new yt(o.key,o.value,"zoom functions not supported"))),i!=="categorical"&&!I||o.value.property!==void 0||D.push(new yt(o.key,o.value,'"property" property is required')),D;function O(G){let H=[];const K=G.value,J=G.key;if(Er(K)!=="array")return[new yt(J,K,`array expected, ${Er(K)} found`)];if(K.length!==2)return[new yt(J,K,`array length 2 expected, length ${K.length} found`)];if(I){if(Er(K[0])!=="object")return[new yt(J,K,`object expected, ${Er(K[0])} found`)];if(K[0].zoom===void 0)return[new yt(J,K,"object stop key must have zoom")];if(K[0].value===void 0)return[new yt(J,K,"object stop key must have value")];if(y&&y>yn(K[0].zoom))return[new yt(J,K[0].zoom,"stop zoom values must appear in ascending order")];yn(K[0].zoom)!==y&&(y=yn(K[0].zoom),f=void 0,_={}),H=H.concat(Li({key:`${J}[0]`,value:K[0],valueSpec:{zoom:{}},validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec,objectElementValidators:{zoom:Al,value:U}}))}else H=H.concat(U({key:`${J}[0]`,value:K[0],validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec},K));return Cl(Ui(K[1]))?H.concat([new yt(`${J}[1]`,K[1],"expressions are not allowed in function stops.")]):H.concat(G.validateSpec({key:`${J}[1]`,value:K[1],valueSpec:e,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec}))}function U(G,H){const K=Er(G.value),J=yn(G.value),se=G.value!==null?G.value:H;if(c){if(K!==c)return[new yt(G.key,se,`${K} stop domain type must match previous stop domain type ${c}`)]}else c=K;if(K!=="number"&&K!=="string"&&K!=="boolean")return[new yt(G.key,se,"stop domain value must be a number, string, or boolean")];if(K!=="number"&&i!=="categorical"){let ye=`number expected, ${K} found`;return Is(e)&&i===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new yt(G.key,se,ye)]}return i!=="categorical"||K!=="number"||isFinite(J)&&Math.floor(J)===J?i!=="categorical"&&K==="number"&&f!==void 0&&J<f?[new yt(G.key,se,"stop domain values must appear in ascending order")]:(f=J,i==="categorical"&&J in _?[new yt(G.key,se,"stop domain values must be unique")]:(_[J]=!0,[])):[new yt(G.key,se,`integer expected, found ${J}`)]}}function $a(o){const e=(o.expressionContext==="property"?Ba:El)(Ui(o.value),o.valueSpec);if(e.result==="error")return e.value.map((c=>new yt(`${o.key}${c.key}`,o.value,c.message)));const i=e.value.expression||e.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!i.outputDefined())return[new yt(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!Ec(i))return[new yt(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter"&&!Ec(i))return[new yt(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!Pu(i,["zoom","feature-state"]))return[new yt(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!Su(i))return[new yt(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function fo(o){const e=o.key,i=o.value,c=Er(i);return c!=="string"?[new yt(e,i,`color expected, ${c} found`)]:xr.parse(String(i))?[]:[new yt(e,i,`color expected, "${i}" found`)]}function po(o){const e=o.key,i=o.value,c=o.valueSpec,f=[];return Array.isArray(c.values)?c.values.indexOf(yn(i))===-1&&f.push(new yt(e,i,`expected one of [${c.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(c.values).indexOf(yn(i))===-1&&f.push(new yt(e,i,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(i)} found`)),f}function mo(o){return Ac(Ui(o.value))?$a(bi({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Au(o)}function Au(o){const e=o.value,i=o.key;if(Er(e)!=="array")return[new yt(i,e,`array expected, ${Er(e)} found`)];const c=o.styleSpec;let f,y=[];if(e.length<1)return[new yt(i,e,"filter array must have at least 1 element")];switch(y=y.concat(po({key:`${i}[0]`,value:e[0],valueSpec:c.filter_operator,style:o.style,styleSpec:o.styleSpec})),yn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&yn(e[1])==="$type"&&y.push(new yt(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&y.push(new yt(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(f=Er(e[1]),f!=="string"&&y.push(new yt(`${i}[1]`,e[1],`string expected, ${f} found`)));for(let _=2;_<e.length;_++)f=Er(e[_]),yn(e[1])==="$type"?y=y.concat(po({key:`${i}[${_}]`,value:e[_],valueSpec:c.geometry_type,style:o.style,styleSpec:o.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&y.push(new yt(`${i}[${_}]`,e[_],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let _=1;_<e.length;_++)y=y.concat(Au({key:`${i}[${_}]`,value:e[_],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":f=Er(e[1]),e.length!==2?y.push(new yt(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):f!=="string"&&y.push(new yt(`${i}[1]`,e[1],`string expected, ${f} found`))}return y}function Vh(o,e){const i=o.key,c=o.validateSpec,f=o.style,y=o.styleSpec,_=o.value,T=o.objectKey,C=y[`${e}_${o.layerType}`];if(!C)return[];const I=T.match(/^(.*)-transition$/);if(e==="paint"&&I&&C[I[1]]&&C[I[1]].transition)return c({key:i,value:_,valueSpec:y.transition,style:f,styleSpec:y});const D=o.valueSpec||C[T];if(!D)return[new yt(i,_,`unknown property "${T}"`)];let O;if(Er(_)==="string"&&Is(D)&&!D.tokens&&(O=/^{([^}]+)}$/.exec(_)))return[new yt(i,_,`"${T}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(O[1])} }\`.`)];const U=[];return o.layerType==="symbol"&&T==="text-font"&&Rh(Ui(_))&&yn(_.type)==="identity"&&U.push(new yt(i,_,'"text-font" does not support identity functions')),U.concat(c({key:o.key,value:_,valueSpec:D,style:f,styleSpec:y,expressionContext:"property",propertyType:e,propertyKey:T}))}function kl(o){return Vh(o,"paint")}function sa(o){return Vh(o,"layout")}function wn(o){let e=[];const i=o.value,c=o.key,f=o.style,y=o.styleSpec;if(Er(i)!=="object")return[new yt(c,i,`object expected, ${Er(i)} found`)];i.type||i.ref||e.push(new yt(c,i,'either "type" or "ref" is required'));let _=yn(i.type);const T=yn(i.ref);if(i.id){const C=yn(i.id);for(let I=0;I<o.arrayIndex;I++){const D=f.layers[I];yn(D.id)===C&&e.push(new yt(c,i.id,`duplicate layer id "${i.id}", previously used at line ${D.id.__line__}`))}}if("ref"in i){let C;["type","source","source-layer","filter","layout"].forEach((I=>{I in i&&e.push(new yt(c,i[I],`"${I}" is prohibited for ref layers`))})),f.layers.forEach((I=>{yn(I.id)===T&&(C=I)})),C?C.ref?e.push(new yt(c,i.ref,"ref cannot reference another ref layer")):_=yn(C.type):e.push(new yt(c,i.ref,`ref layer "${T}" not found`))}else if(_!=="background")if(i.source){const C=f.sources&&f.sources[i.source],I=C&&yn(C.type);C?I==="vector"&&_==="raster"?e.push(new yt(c,i.source,`layer "${i.id}" requires a raster source`)):I!=="raster-dem"&&_==="hillshade"||I!=="raster-dem"&&_==="color-relief"?e.push(new yt(c,i.source,`layer "${i.id}" requires a raster-dem source`)):I==="raster"&&_!=="raster"?e.push(new yt(c,i.source,`layer "${i.id}" requires a vector source`)):I!=="vector"||i["source-layer"]?I==="raster-dem"&&_!=="hillshade"&&_!=="color-relief"?e.push(new yt(c,i.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):_!=="line"||!i.paint||!i.paint["line-gradient"]||I==="geojson"&&C.lineMetrics||e.push(new yt(c,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new yt(c,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new yt(c,i.source,`source "${i.source}" not found`))}else e.push(new yt(c,i,'missing required property "source"'));return e=e.concat(Li({key:c,value:i,valueSpec:y.layer,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,objectElementValidators:{"*":()=>[],type:()=>o.validateSpec({key:`${c}.type`,value:i.type,valueSpec:y.layer.type,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,object:i,objectKey:"type"}),filter:mo,layout:C=>Li({layer:i,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":I=>sa(bi({layerType:_},I))}}),paint:C=>Li({layer:i,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":I=>kl(bi({layerType:_},I))}})}})),e}function Wr(o){const e=o.value,i=o.key,c=Er(e);return c!=="string"?[new yt(i,e,`string expected, ${c} found`)]:[]}const Lo={promoteId:function({key:o,value:e}){if(Er(e)==="string")return Wr({key:o,value:e});{const i=[];for(const c in e)i.push(...Wr({key:`${o}.${c}`,value:e[c]}));return i}}};function Pi(o){const e=o.value,i=o.key,c=o.styleSpec,f=o.style,y=o.validateSpec;if(!e.type)return[new yt(i,e,'"type" is required')];const _=yn(e.type);let T;switch(_){case"vector":case"raster":return T=Li({key:i,value:e,valueSpec:c[`source_${_.replace("-","_")}`],style:o.style,styleSpec:c,objectElementValidators:Lo,validateSpec:y}),T;case"raster-dem":return T=(function(C){var I;const D=(I=C.sourceName)!==null&&I!==void 0?I:"",O=C.value,U=C.styleSpec,G=U.source_raster_dem,H=C.style;let K=[];const J=Er(O);if(O===void 0)return K;if(J!=="object")return K.push(new yt("source_raster_dem",O,`object expected, ${J} found`)),K;const se=yn(O.encoding)==="custom",ye=["redFactor","greenFactor","blueFactor","baseShift"],ae=C.value.encoding?`"${C.value.encoding}"`:"Default";for(const ue in O)!se&&ye.includes(ue)?K.push(new yt(ue,O[ue],`In "${D}": "${ue}" is only valid when "encoding" is set to "custom". ${ae} encoding found`)):G[ue]?K=K.concat(C.validateSpec({key:ue,value:O[ue],valueSpec:G[ue],validateSpec:C.validateSpec,style:H,styleSpec:U})):K.push(new yt(ue,O[ue],`unknown property "${ue}"`));return K})({sourceName:i,value:e,style:o.style,styleSpec:c,validateSpec:y}),T;case"geojson":if(T=Li({key:i,value:e,valueSpec:c.source_geojson,style:f,styleSpec:c,validateSpec:y,objectElementValidators:Lo}),e.cluster)for(const C in e.clusterProperties){const[I,D]=e.clusterProperties[C],O=typeof I=="string"?[I,["accumulated"],["get",C]]:I;T.push(...$a({key:`${i}.${C}.map`,value:D,expressionContext:"cluster-map"})),T.push(...$a({key:`${i}.${C}.reduce`,value:O,expressionContext:"cluster-reduce"}))}return T;case"video":return Li({key:i,value:e,valueSpec:c.source_video,style:f,validateSpec:y,styleSpec:c});case"image":return Li({key:i,value:e,valueSpec:c.source_image,style:f,validateSpec:y,styleSpec:c});case"canvas":return[new yt(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return po({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Ci(o){const e=o.value,i=o.styleSpec,c=i.light,f=o.style;let y=[];const _=Er(e);if(e===void 0)return y;if(_!=="object")return y=y.concat([new yt("light",e,`object expected, ${_} found`)]),y;for(const T in e){const C=T.match(/^(.*)-transition$/);y=y.concat(C&&c[C[1]]&&c[C[1]].transition?o.validateSpec({key:T,value:e[T],valueSpec:i.transition,validateSpec:o.validateSpec,style:f,styleSpec:i}):c[T]?o.validateSpec({key:T,value:e[T],valueSpec:c[T],validateSpec:o.validateSpec,style:f,styleSpec:i}):[new yt(T,e[T],`unknown property "${T}"`)])}return y}function Ga(o){const e=o.value,i=o.styleSpec,c=i.sky,f=o.style,y=Er(e);if(e===void 0)return[];if(y!=="object")return[new yt("sky",e,`object expected, ${y} found`)];let _=[];for(const T in e)_=_.concat(c[T]?o.validateSpec({key:T,value:e[T],valueSpec:c[T],style:f,styleSpec:i}):[new yt(T,e[T],`unknown property "${T}"`)]);return _}function qa(o){const e=o.value,i=o.styleSpec,c=i.terrain,f=o.style;let y=[];const _=Er(e);if(e===void 0)return y;if(_!=="object")return y=y.concat([new yt("terrain",e,`object expected, ${_} found`)]),y;for(const T in e)y=y.concat(c[T]?o.validateSpec({key:T,value:e[T],valueSpec:c[T],validateSpec:o.validateSpec,style:f,styleSpec:i}):[new yt(T,e[T],`unknown property "${T}"`)]);return y}function $i(o){let e=[];const i=o.value,c=o.key;if(Array.isArray(i)){const f=[],y=[];for(const _ in i)i[_].id&&f.includes(i[_].id)&&e.push(new yt(c,i,`all the sprites' ids must be unique, but ${i[_].id} is duplicated`)),f.push(i[_].id),i[_].url&&y.includes(i[_].url)&&e.push(new yt(c,i,`all the sprites' URLs must be unique, but ${i[_].url} is duplicated`)),y.push(i[_].url),e=e.concat(Li({key:`${c}[${_}]`,value:i[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:o.validateSpec}));return e}return Wr({key:c,value:i})}function ku(o){return!!o&&o.constructor===Object}function Uh(o){return ku(o.value)?[]:[new yt(o.key,o.value,`object expected, ${Er(o.value)} found`)]}const $h={"*":()=>[],array:js,boolean:function(o){const e=o.value,i=o.key,c=Er(e);return c!=="boolean"?[new yt(i,e,`boolean expected, ${c} found`)]:[]},number:Al,color:fo,constants:sf,enum:po,filter:mo,function:Bh,layer:wn,object:Li,source:Pi,light:Ci,sky:Ga,terrain:qa,projection:function(o){const e=o.value,i=o.styleSpec,c=i.projection,f=o.style,y=Er(e);if(e===void 0)return[];if(y!=="object")return[new yt("projection",e,`object expected, ${y} found`)];let _=[];for(const T in e)_=_.concat(c[T]?o.validateSpec({key:T,value:e[T],valueSpec:c[T],style:f,styleSpec:i}):[new yt(T,e[T],`unknown property "${T}"`)]);return _},projectionDefinition:function(o){const e=o.key;let i=o.value;i=i instanceof String?i.valueOf():i;const c=Er(i);return c!=="array"||(function(f){return Array.isArray(f)&&f.length===3&&typeof f[0]=="string"&&typeof f[1]=="string"&&typeof f[2]=="number"})(i)||(function(f){return!!["interpolate","step","literal"].includes(f[0])})(i)?["array","string"].includes(c)?[]:[new yt(e,i,`projection expected, invalid type "${c}" found`)]:[new yt(e,i,`projection expected, invalid array ${JSON.stringify(i)} found`)]},string:Wr,formatted:function(o){return Wr(o).length===0?[]:$a(o)},resolvedImage:function(o){return Wr(o).length===0?[]:$a(o)},padding:function(o){const e=o.key,i=o.value;if(Er(i)==="array"){if(i.length<1||i.length>4)return[new yt(e,i,`padding requires 1 to 4 values; ${i.length} values found`)];const c={type:"number"};let f=[];for(let y=0;y<i.length;y++)f=f.concat(o.validateSpec({key:`${e}[${y}]`,value:i[y],validateSpec:o.validateSpec,valueSpec:c}));return f}return Al({key:e,value:i,valueSpec:{}})},numberArray:function(o){const e=o.key,i=o.value;if(Er(i)==="array"){const c={type:"number"};if(i.length<1)return[new yt(e,i,"array length at least 1 expected, length 0 found")];let f=[];for(let y=0;y<i.length;y++)f=f.concat(o.validateSpec({key:`${e}[${y}]`,value:i[y],validateSpec:o.validateSpec,valueSpec:c}));return f}return Al({key:e,value:i,valueSpec:{}})},colorArray:function(o){const e=o.key,i=o.value;if(Er(i)==="array"){if(i.length<1)return[new yt(e,i,"array length at least 1 expected, length 0 found")];let c=[];for(let f=0;f<i.length;f++)c=c.concat(fo({key:`${e}[${f}]`,value:i[f]}));return c}return fo({key:e,value:i})},variableAnchorOffsetCollection:function(o){const e=o.key,i=o.value,c=Er(i),f=o.styleSpec;if(c!=="array"||i.length<1||i.length%2!=0)return[new yt(e,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let _=0;_<i.length;_+=2)y=y.concat(po({key:`${e}[${_}]`,value:i[_],valueSpec:f.layout_symbol["text-anchor"]})),y=y.concat(js({key:`${e}[${_+1}]`,value:i[_+1],valueSpec:{length:2,value:"number"},validateSpec:o.validateSpec,style:o.style,styleSpec:f}));return y},sprite:$i,state:Uh,fontFaces:function(o){const e=o.key,i=o.value,c=o.validateSpec,f=o.styleSpec,y=o.style;if(!ku(i))return[new yt(e,i,`object expected, ${Er(i)} found`)];const _=[];for(const T in i){const C=i[T],I=Er(C);if(I==="string")_.push(...Wr({key:`${e}.${T}`,value:C}));else if(I==="array"){const D={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[O,U]of C.entries())_.push(...Li({key:`${e}.${T}[${O}]`,value:U,valueSpec:D,styleSpec:f,style:y,validateSpec:c}))}else _.push(new yt(`${e}.${T}`,C,`string or array expected, ${I} found`))}return _}};function go(o){const e=o.value,i=o.valueSpec,c=o.styleSpec;return o.validateSpec=go,i.expression&&Rh(yn(e))?Bh(o):i.expression&&Cl(Ui(e))?$a(o):i.type&&$h[i.type]?$h[i.type](o):Li(bi({},o,{valueSpec:i.type?c[i.type]:i}))}function of(o){const e=o.value,i=o.key,c=Wr(o);return c.length||(e.indexOf("{fontstack}")===-1&&c.push(new yt(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&c.push(new yt(i,e,'"glyphs" url must include a "{range}" token'))),c}function oi(o,e=$e){let i=[];return i=i.concat(go({key:"",value:o,valueSpec:e.$root,styleSpec:e,style:o,validateSpec:go,objectElementValidators:{glyphs:of,"*":()=>[]}})),o.constants&&(i=i.concat(sf({key:"constants",value:o.constants}))),Gh(i)}function ms(o){return function(e){return o(Object.assign({},e,{validateSpec:go}))}}function Gh(o){return[].concat(o).sort(((e,i)=>e.line-i.line))}function Bs(o){return function(...e){return Gh(o.apply(this,e))}}oi.source=Bs(ms(Pi)),oi.sprite=Bs(ms($i)),oi.glyphs=Bs(ms(of)),oi.light=Bs(ms(Ci)),oi.sky=Bs(ms(Ga)),oi.terrain=Bs(ms(qa)),oi.state=Bs(ms(Uh)),oi.layer=Bs(ms(wn)),oi.filter=Bs(ms(mo)),oi.paintProperty=Bs(ms(kl)),oi.layoutProperty=Bs(ms(sa));const zm={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class Vs{constructor(e,i){this._globalState=i,this.setValue(e)}evaluate(){var e;return(e=this._literalValue)!==null&&e!==void 0?e:this._compiledValue.evaluate({})}setValue(e){if(e==null||e==="visible"||e==="none")return this._literalValue=e==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const i=El(e,zm,this._globalState);if(i.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(i.value.map((c=>`${c.key}: ${c.message}`)).join(", "));this._literalValue=void 0,this._compiledValue=i.value,this._globalStateRefs=Va(i.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const zo=$e,$n=oi,Za=$n.light,Du=$n.sky,Us=$n.paintProperty,$s=$n.layoutProperty;function Gs(o,e){let i=!1;if(e&&e.length)for(const c of e)o.fire(new Ur(new Error(c.message))),i=!0;return i}class gs{constructor(e,i,c){const f=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const _=new Int32Array(this.arrayBuffer);e=_[0],this.d=(i=_[1])+2*(c=_[2]);for(let C=0;C<this.d*this.d;C++){const I=_[3+C],D=_[3+C+1];f.push(I===D?null:_.subarray(I,D))}const T=_[3+f.length+1];this.keys=_.subarray(_[3+f.length],T),this.bboxes=_.subarray(T),this.insert=this._insertReadonly}else{this.d=i+2*c;for(let _=0;_<this.d*this.d;_++)f.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=e,this.padding=c,this.scale=i/e,this.uid=0;const y=c/i*e;this.min=-y,this.max=e+y}insert(e,i,c,f,y){this._forEachCell(i,c,f,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(i),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,i,c,f,y,_){this.cells[y].push(_)}query(e,i,c,f,y){const _=this.min,T=this.max;if(e<=_&&i<=_&&T<=c&&T<=f&&!y)return Array.prototype.slice.call(this.keys);{const C=[];return this._forEachCell(e,i,c,f,this._queryCell,C,{},y),C}}_queryCell(e,i,c,f,y,_,T,C){const I=this.cells[y];if(I!==null){const D=this.keys,O=this.bboxes;for(let U=0;U<I.length;U++){const G=I[U];if(T[G]===void 0){const H=4*G;(C?C(O[H+0],O[H+1],O[H+2],O[H+3]):e<=O[H+2]&&i<=O[H+3]&&c>=O[H+0]&&f>=O[H+1])?(T[G]=!0,_.push(D[G])):T[G]=!1}}}}_forEachCell(e,i,c,f,y,_,T,C){const I=this._convertToCellCoord(e),D=this._convertToCellCoord(i),O=this._convertToCellCoord(c),U=this._convertToCellCoord(f);for(let G=I;G<=O;G++)for(let H=D;H<=U;H++){const K=this.d*H+G;if((!C||C(this._convertFromCellCoord(G),this._convertFromCellCoord(H),this._convertFromCellCoord(G+1),this._convertFromCellCoord(H+1)))&&y.call(this,e,i,c,f,K,_,T,C))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,i=3+this.cells.length+1+1;let c=0;for(let _=0;_<this.cells.length;_++)c+=this.cells[_].length;const f=new Int32Array(i+c+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let y=i;for(let _=0;_<e.length;_++){const T=e[_];f[3+_]=y,f.set(T,y),y+=T.length}return f[3+e.length]=y,f.set(this.keys,y),y+=this.keys.length,f[3+e.length+1]=y,f.set(this.bboxes,y),y+=this.bboxes.length,f.buffer}static serialize(e,i){const c=e.toArrayBuffer();return i&&i.push(c),{buffer:c}}static deserialize(e){return new gs(e.buffer)}}const di={};function zt(o,e,i={}){if(di[o])throw new Error(`${o} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:o,writeable:!1}),di[o]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}zt("Object",Object),zt("Set",Set),zt("TransferableGridIndex",gs),zt("Color",xr),zt("Error",Error),zt("AJAXError",De),zt("ResolvedImage",fs),zt("StylePropertyFunction",Mu),zt("StyleExpression",Pl,{omit:["_evaluator"]}),zt("ZoomDependentExpression",Ic),zt("ZoomConstantExpression",ja),zt("CompoundExpression",is,{omit:["_evaluate"]});for(const o in wl)wl[o]._classRegistryKey||zt(`Expression_${o}`,wl[o]);function Ru(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function Lu(o){return o.$name||o.constructor._classRegistryKey}function Wa(o){return!(function(e){if(e===null||typeof e!="object")return!1;const i=Lu(e);return!(!i||i==="Object")})(o)&&(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||o instanceof Error||Ru(o)||io(o)||ArrayBuffer.isView(o)||o instanceof ImageData)}function zi(o,e){if(Wa(o))return(Ru(o)||io(o))&&e&&e.push(o),ArrayBuffer.isView(o)&&e&&e.push(o.buffer),o instanceof ImageData&&e&&e.push(o.data.buffer),o;if(Array.isArray(o)){const y=[];for(const _ of o)y.push(zi(_,e));return y}if(typeof o!="object")throw new Error("can't serialize object of type "+typeof o);const i=Lu(o);if(!i)throw new Error(`can't serialize object of unregistered class ${o.constructor.name}`);if(!di[i])throw new Error(`${i} is not registered.`);const{klass:c}=di[i],f=c.serialize?c.serialize(o,e):{};if(c.serialize){if(e&&f===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in o){if(!o.hasOwnProperty(y)||di[i].omit.indexOf(y)>=0)continue;const _=o[y];f[y]=di[i].shallow.indexOf(y)>=0?_:zi(_,e)}o instanceof Error&&(f.message=o.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return i!=="Object"&&(f.$name=i),f}function Fi(o){if(Wa(o))return o;if(Array.isArray(o))return o.map(Fi);if(typeof o!="object")throw new Error("can't deserialize object of type "+typeof o);const e=Lu(o)||"Object";if(!di[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:i}=di[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(o);const c=Object.create(i.prototype);for(const f of Object.keys(o)){if(f==="$name")continue;const y=o[f];c[f]=di[e].shallow.indexOf(f)>=0?y:Fi(y)}return c}class Tn{constructor(){this.first=!0}update(e,i){const c=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=i),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=c,!0))}}function ss(o){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(o))}function qh(o){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(o))}function af(o){return/\s/u.test(String.fromCodePoint(o))}function Ha(o){for(const e of o)if(qh(e.codePointAt(0)))return!0;return!1}function lf(o){for(const e of o)if(!cf(e.codePointAt(0)))return!1;return!0}function zu(o){const e=o.map((i=>{try{return new RegExp(`\\p{sc=${i}}`,"u").source}catch{return null}})).filter((i=>i));return new RegExp(e.join("|"),"u")}const Dl=zu(["Arab","Dupl","Mong","Ougr","Syrc"]);function cf(o){return!Dl.test(String.fromCodePoint(o))}function Xa(o){return!(qh(o)||(e=o,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(e))));var e}const Zh=zu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function uf(o){return Zh.test(String.fromCodePoint(o))}function Rl(o,e){return!(!e&&uf(o)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(o)))}function Fu(o){for(const e of o)if(uf(e.codePointAt(0)))return!0;return!1}const oa=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(o){this.pluginStatus=o.pluginStatus,this.pluginURL=o.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(o){if(oa.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=o.applyArabicShaping,this.processBidirectionalText=o.processBidirectionalText,this.processStyledBidirectionalText=o.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(o,e){return l(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(o.pluginStatus!=="loading")return this.setState(o),o;const i=o.pluginURL,c=new Promise((y=>{this.loadScriptResolve=y}));e(i);const f=new Promise((y=>setTimeout((()=>y()),this.TIMEOUT)));if(yield Promise.race([c,f]),this.isParsed()){const y={pluginStatus:"loaded",pluginURL:i};return this.setState(y),y}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${i}`)}))}};class rn{constructor(e,i){this.isSupportedScript=Dc,this.zoom=e,i?(this.now=i.now||0,this.fadeDuration=i.fadeDuration||0,this.zoomHistory=i.zoomHistory||new Tn,this.transition=i.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Tn,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,i=e-Math.floor(e),c=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*i}}}function Dc(o){return(function(e,i){for(const c of e)if(!Rl(c.codePointAt(0),i))return!1;return!0})(o,oa.getRTLTextPluginStatus()==="loaded")}const Rc="-transition";class Ll{constructor(e,i,c){this.property=e,this.value=i,this.expression=(function(f,y,_){if(Rh(f))return new Mu(f,y);if(Cl(f)){const T=Ba(f,y,_);if(T.result==="error")throw new Error(T.value.map((C=>`${C.key}: ${C.message}`)).join(", "));return T.value}{let T=f;return y.type==="color"&&typeof f=="string"?T=xr.parse(f):y.type!=="padding"||typeof f!="number"&&!Array.isArray(f)?y.type!=="numberArray"||typeof f!="number"&&!Array.isArray(f)?y.type!=="colorArray"||typeof f!="string"&&!Array.isArray(f)?y.type==="variableAnchorOffsetCollection"&&Array.isArray(f)?T=rs.parse(f):y.type==="projectionDefinition"&&typeof f=="string"&&(T=Ti.parse(f)):T=ur.parse(f):T=Yr.parse(f):T=ii.parse(f),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>T}}})(i===void 0?e.specification.default:i,e.specification,c)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(e,i,c){return this.property.possiblyEvaluate(this,e,i,c)}}class zl{constructor(e,i){this.property=e,this.value=new Ll(e,void 0,i)}transitioned(e,i){return new Wh(this.property,this.value,i,Gt({},e.transition,this.transition),e.now)}untransitioned(){return new Wh(this.property,this.value,null,{},0)}}class Ka{constructor(e,i){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._globalState=i}getValue(e){return jr(this._values[e].value.value)}setValue(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new zl(this._values[e].property,this._globalState)),this._values[e].value=new Ll(this._values[e].property,i===null?void 0:jr(i),this._globalState)}getTransition(e){return jr(this._values[e].transition)}setTransition(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new zl(this._values[e].property,this._globalState)),this._values[e].transition=jr(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const c=this.getValue(i);c!==void 0&&(e[i]=c);const f=this.getTransition(i);f!==void 0&&(e[`${i}${Rc}`]=f)}return e}transitioned(e,i){const c=new Hh(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(e,i._values[f]);return c}untransitioned(){const e=new Hh(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class Wh{constructor(e,i,c,f,y){this.property=e,this.value=i,this.begin=y+f.delay||0,this.end=this.begin+f.duration||0,e.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(e,i,c){const f=e.now||0,y=this.value.possiblyEvaluate(e,i,c),_=this.prior;if(_){if(f>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(f<this.begin)return _.possiblyEvaluate(e,i,c);{const T=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(e,i,c),y,nr(T))}}return y}}class Hh{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,c){const f=new Fo(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(e,i,c);return f}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Xh{constructor(e,i){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._globalState=i}hasValue(e){return this._values[e].value!==void 0}getValue(e){return jr(this._values[e].value)}setValue(e,i){this._values[e]=new Ll(this._values[e].property,i===null?void 0:jr(i),this._globalState)}serialize(){const e={};for(const i of Object.keys(this._values)){const c=this.getValue(i);c!==void 0&&(e[i]=c)}return e}possiblyEvaluate(e,i,c){const f=new Fo(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(e,i,c);return f}}class As{constructor(e,i,c){this.property=e,this.value=i,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,c,f){return this.property.evaluate(this.value,this.parameters,e,i,c,f)}}class Fo{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class jt{constructor(e){this.specification=e}possiblyEvaluate(e,i){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(i)}interpolate(e,i,c){const f=In[this.specification.type];return f?f(e,i,c):e}}class Kt{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,c,f){return new As(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},c,f)}:e.expression,i)}interpolate(e,i,c){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new As(this,{kind:"constant",value:void 0},e.parameters);const f=In[this.specification.type];if(f){const y=f(e.value.value,i.value.value,c);return new As(this,{kind:"constant",value:y},e.parameters)}return e}evaluate(e,i,c,f,y,_){return e.kind==="constant"?e.value:e.evaluate(i,c,f,y,_)}}class Fl extends Kt{possiblyEvaluate(e,i,c,f){if(e.value===void 0)return new As(this,{kind:"constant",value:void 0},i);if(e.expression.kind==="constant"){const y=e.expression.evaluate(i,null,{},c,f),_=e.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,T=this._calculate(_,_,_,i);return new As(this,{kind:"constant",value:T},i)}if(e.expression.kind==="camera"){const y=this._calculate(e.expression.evaluate({zoom:i.zoom-1}),e.expression.evaluate({zoom:i.zoom}),e.expression.evaluate({zoom:i.zoom+1}),i);return new As(this,{kind:"constant",value:y},i)}return new As(this,e.expression,i)}evaluate(e,i,c,f,y,_){if(e.kind==="source"){const T=e.evaluate(i,c,f,y,_);return this._calculate(T,T,T,i)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(i.zoom)-1},c,f),e.evaluate({zoom:Math.floor(i.zoom)},c,f),e.evaluate({zoom:Math.floor(i.zoom)+1},c,f),i):e.value}_calculate(e,i,c,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:c,to:i}}interpolate(e){return e}}class Ou{constructor(e){this.specification=e}possiblyEvaluate(e,i,c,f){if(e.value!==void 0){if(e.expression.kind==="constant"){const y=e.expression.evaluate(i,null,{},c,f);return this._calculate(y,y,y,i)}return this._calculate(e.expression.evaluate(new rn(Math.floor(i.zoom-1),i)),e.expression.evaluate(new rn(Math.floor(i.zoom),i)),e.expression.evaluate(new rn(Math.floor(i.zoom+1),i)),i)}}_calculate(e,i,c,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:c,to:i}}interpolate(e){return e}}class qs{constructor(e){this.specification=e}possiblyEvaluate(e,i,c,f){return!!e.expression.evaluate(i,null,{},c,f)}interpolate(){return!1}}class Hn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in e){const c=e[i];c.specification.overridable&&this.overridableProperties.push(i);const f=this.defaultPropertyValues[i]=new Ll(c,void 0,void 0),y=this.defaultTransitionablePropertyValues[i]=new zl(c,void 0);this.defaultTransitioningPropertyValues[i]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=f.possiblyEvaluate({})}}}zt("DataDrivenProperty",Kt),zt("DataConstantProperty",jt),zt("CrossFadedDataDrivenProperty",Fl),zt("CrossFadedProperty",Ou),zt("ColorRampProperty",qs);class ys extends kr{constructor(e,i,c){if(super(),this.id=e.id,this.type=e.type,this._globalState=c,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},this._visibilityExpression=(function(f,y){return new Vs(f,y)})(this.visibility,c),e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter,this._featureFilter=Ml(e.filter,c)),i.layout&&(this._unevaluatedLayout=new Xh(i.layout,c)),i.paint)){this._transitionablePaint=new Ka(i.paint,c);for(const f in e.paint)this.setPaintProperty(f,e.paint[f],{validate:!1});for(const f in e.layout)this.setLayoutProperty(f,e.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Fo(i.paint)}}setFilter(e){this.filter=e,this._featureFilter=Ml(e,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}getLayoutAffectingGlobalStateRefs(){const e=new Set;for(const i of this._visibilityExpression.getGlobalStateRefs())e.add(i);if(this._unevaluatedLayout)for(const i in this._unevaluatedLayout._values){const c=this._unevaluatedLayout._values[i];for(const f of c.getGlobalStateRefs())e.add(f)}for(const i of this._featureFilter.getGlobalStateRefs())e.add(i);return e}getPaintAffectingGlobalStateRefs(){var e;const i=new globalThis.Map;if(this._transitionablePaint)for(const c in this._transitionablePaint._values){const f=this._transitionablePaint._values[c].value;for(const y of f.getGlobalStateRefs()){const _=(e=i.get(y))!==null&&e!==void 0?e:[];_.push({name:c,value:f.value}),i.set(y,_)}}return i}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(e,i,c={}){if(i==null||!this._validate($s,`layers.${this.id}.layout.${e}`,e,i,c))return e==="visibility"?(this.visibility=i,this._visibilityExpression.setValue(i),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(e,i)}getPaintProperty(e){return e.endsWith(Rc)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,c={}){if(i!=null&&this._validate(Us,`layers.${this.id}.paint.${e}`,e,i,c))return!1;if(e.endsWith(Rc))return this._transitionablePaint.setTransition(e.slice(0,-11),i||void 0),!1;{const f=this._transitionablePaint._values[e],y=f.property.specification["property-type"]==="cross-faded-data-driven",_=f.value.isDataDriven(),T=f.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const C=this._transitionablePaint._values[e].value;return C.isDataDriven()||_||y||this._handleOverridablePaintPropertyUpdate(e,T,C)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,i,c){return!1}isHidden(e=this.minzoom,i=!1){return!!(this.minzoom&&e<(i?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&e>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(e,i){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Lr(e,((i,c)=>!(i===void 0||c==="layout"&&!Object.keys(i).length||c==="paint"&&!Object.keys(i).length)))}_validate(e,i,c,f,y={}){return(!y||y.validate!==!1)&&Gs(this,e.call($n,{key:i,layerType:this.type,objectKey:c,value:f,styleSpec:$e,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof As&&Is(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}}let Kh;var Oo={get paint(){return Kh=Kh||new Hn({"raster-opacity":new jt($e.paint_raster["raster-opacity"]),"raster-hue-rotate":new jt($e.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new jt($e.paint_raster["raster-brightness-min"]),"raster-brightness-max":new jt($e.paint_raster["raster-brightness-max"]),"raster-saturation":new jt($e.paint_raster["raster-saturation"]),"raster-contrast":new jt($e.paint_raster["raster-contrast"]),"raster-resampling":new jt($e.paint_raster["raster-resampling"]),"raster-fade-duration":new jt($e.paint_raster["raster-fade-duration"])})}};class Ya extends ys{constructor(e,i){super(e,Oo,i)}}const Yh={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Lc{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class _n{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Gn(o,e=1){let i=0,c=0;return{members:o.map((f=>{const y=Yh[f.type].BYTES_PER_ELEMENT,_=i=yo(i,Math.max(e,y)),T=f.components||1;return c=Math.max(c,y),i+=y*T,{name:f.name,type:f.type,components:T,offset:_}})),size:yo(i,Math.max(c,e)),alignment:e}}function yo(o,e){return Math.ceil(o/e)*e}class _s extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const c=this.length;return this.resize(c+1),this.emplace(c,e,i)}emplace(e,i,c){const f=2*e;return this.int16[f+0]=i,this.int16[f+1]=c,e}}_s.prototype.bytesPerElement=4,zt("StructArrayLayout2i4",_s);class Qa extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,c)}emplace(e,i,c,f){const y=3*e;return this.int16[y+0]=i,this.int16[y+1]=c,this.int16[y+2]=f,e}}Qa.prototype.bytesPerElement=6,zt("StructArrayLayout3i6",Qa);class Ol extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c,f){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,c,f)}emplace(e,i,c,f,y){const _=4*e;return this.int16[_+0]=i,this.int16[_+1]=c,this.int16[_+2]=f,this.int16[_+3]=y,e}}Ol.prototype.bytesPerElement=8,zt("StructArrayLayout4i8",Ol);class No extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,y,_){const T=this.length;return this.resize(T+1),this.emplace(T,e,i,c,f,y,_)}emplace(e,i,c,f,y,_,T){const C=6*e;return this.int16[C+0]=i,this.int16[C+1]=c,this.int16[C+2]=f,this.int16[C+3]=y,this.int16[C+4]=_,this.int16[C+5]=T,e}}No.prototype.bytesPerElement=12,zt("StructArrayLayout2i4i12",No);class Nu extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,y,_){const T=this.length;return this.resize(T+1),this.emplace(T,e,i,c,f,y,_)}emplace(e,i,c,f,y,_,T){const C=4*e,I=8*e;return this.int16[C+0]=i,this.int16[C+1]=c,this.uint8[I+4]=f,this.uint8[I+5]=y,this.uint8[I+6]=_,this.uint8[I+7]=T,e}}Nu.prototype.bytesPerElement=8,zt("StructArrayLayout2i4ub8",Nu);class jo extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const c=this.length;return this.resize(c+1),this.emplace(c,e,i)}emplace(e,i,c){const f=2*e;return this.float32[f+0]=i,this.float32[f+1]=c,e}}jo.prototype.bytesPerElement=8,zt("StructArrayLayout2f8",jo);class Bo extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,y,_,T,C,I,D){const O=this.length;return this.resize(O+1),this.emplace(O,e,i,c,f,y,_,T,C,I,D)}emplace(e,i,c,f,y,_,T,C,I,D,O){const U=10*e;return this.uint16[U+0]=i,this.uint16[U+1]=c,this.uint16[U+2]=f,this.uint16[U+3]=y,this.uint16[U+4]=_,this.uint16[U+5]=T,this.uint16[U+6]=C,this.uint16[U+7]=I,this.uint16[U+8]=D,this.uint16[U+9]=O,e}}Bo.prototype.bytesPerElement=20,zt("StructArrayLayout10ui20",Bo);class zc extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,y,_,T,C){const I=this.length;return this.resize(I+1),this.emplace(I,e,i,c,f,y,_,T,C)}emplace(e,i,c,f,y,_,T,C,I){const D=8*e;return this.uint16[D+0]=i,this.uint16[D+1]=c,this.uint16[D+2]=f,this.uint16[D+3]=y,this.uint16[D+4]=_,this.uint16[D+5]=T,this.uint16[D+6]=C,this.uint16[D+7]=I,e}}zc.prototype.bytesPerElement=16,zt("StructArrayLayout8ui16",zc);class vn extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,y,_,T,C,I,D,O,U){const G=this.length;return this.resize(G+1),this.emplace(G,e,i,c,f,y,_,T,C,I,D,O,U)}emplace(e,i,c,f,y,_,T,C,I,D,O,U,G){const H=12*e;return this.int16[H+0]=i,this.int16[H+1]=c,this.int16[H+2]=f,this.int16[H+3]=y,this.uint16[H+4]=_,this.uint16[H+5]=T,this.uint16[H+6]=C,this.uint16[H+7]=I,this.int16[H+8]=D,this.int16[H+9]=O,this.int16[H+10]=U,this.int16[H+11]=G,e}}vn.prototype.bytesPerElement=24,zt("StructArrayLayout4i4ui4i24",vn);class Nl extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,c)}emplace(e,i,c,f){const y=3*e;return this.float32[y+0]=i,this.float32[y+1]=c,this.float32[y+2]=f,e}}Nl.prototype.bytesPerElement=12,zt("StructArrayLayout3f12",Nl);class jl extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}jl.prototype.bytesPerElement=4,zt("StructArrayLayout1ul4",jl);class ju extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,y,_,T,C,I){const D=this.length;return this.resize(D+1),this.emplace(D,e,i,c,f,y,_,T,C,I)}emplace(e,i,c,f,y,_,T,C,I,D){const O=10*e,U=5*e;return this.int16[O+0]=i,this.int16[O+1]=c,this.int16[O+2]=f,this.int16[O+3]=y,this.int16[O+4]=_,this.int16[O+5]=T,this.uint32[U+3]=C,this.uint16[O+8]=I,this.uint16[O+9]=D,e}}ju.prototype.bytesPerElement=20,zt("StructArrayLayout6i1ul2ui20",ju);class aa extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,y,_){const T=this.length;return this.resize(T+1),this.emplace(T,e,i,c,f,y,_)}emplace(e,i,c,f,y,_,T){const C=6*e;return this.int16[C+0]=i,this.int16[C+1]=c,this.int16[C+2]=f,this.int16[C+3]=y,this.int16[C+4]=_,this.int16[C+5]=T,e}}aa.prototype.bytesPerElement=12,zt("StructArrayLayout2i2i2i12",aa);class la extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,y){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,c,f,y)}emplace(e,i,c,f,y,_){const T=4*e,C=8*e;return this.float32[T+0]=i,this.float32[T+1]=c,this.float32[T+2]=f,this.int16[C+6]=y,this.int16[C+7]=_,e}}la.prototype.bytesPerElement=16,zt("StructArrayLayout2f1f2i16",la);class ca extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,y,_){const T=this.length;return this.resize(T+1),this.emplace(T,e,i,c,f,y,_)}emplace(e,i,c,f,y,_,T){const C=16*e,I=4*e,D=8*e;return this.uint8[C+0]=i,this.uint8[C+1]=c,this.float32[I+1]=f,this.float32[I+2]=y,this.int16[D+6]=_,this.int16[D+7]=T,e}}ca.prototype.bytesPerElement=16,zt("StructArrayLayout2ub2f2i16",ca);class xn extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,c)}emplace(e,i,c,f){const y=3*e;return this.uint16[y+0]=i,this.uint16[y+1]=c,this.uint16[y+2]=f,e}}xn.prototype.bytesPerElement=6,zt("StructArrayLayout3ui6",xn);class kn extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,y,_,T,C,I,D,O,U,G,H,K,J,se){const ye=this.length;return this.resize(ye+1),this.emplace(ye,e,i,c,f,y,_,T,C,I,D,O,U,G,H,K,J,se)}emplace(e,i,c,f,y,_,T,C,I,D,O,U,G,H,K,J,se,ye){const ae=24*e,ue=12*e,ve=48*e;return this.int16[ae+0]=i,this.int16[ae+1]=c,this.uint16[ae+2]=f,this.uint16[ae+3]=y,this.uint32[ue+2]=_,this.uint32[ue+3]=T,this.uint32[ue+4]=C,this.uint16[ae+10]=I,this.uint16[ae+11]=D,this.uint16[ae+12]=O,this.float32[ue+7]=U,this.float32[ue+8]=G,this.uint8[ve+36]=H,this.uint8[ve+37]=K,this.uint8[ve+38]=J,this.uint32[ue+10]=se,this.int16[ae+22]=ye,e}}kn.prototype.bytesPerElement=48,zt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",kn);class ai extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,y,_,T,C,I,D,O,U,G,H,K,J,se,ye,ae,ue,ve,Ce,je,ot,tt,ht,At,pt){const rt=this.length;return this.resize(rt+1),this.emplace(rt,e,i,c,f,y,_,T,C,I,D,O,U,G,H,K,J,se,ye,ae,ue,ve,Ce,je,ot,tt,ht,At,pt)}emplace(e,i,c,f,y,_,T,C,I,D,O,U,G,H,K,J,se,ye,ae,ue,ve,Ce,je,ot,tt,ht,At,pt,rt){const Ye=32*e,Bt=16*e;return this.int16[Ye+0]=i,this.int16[Ye+1]=c,this.int16[Ye+2]=f,this.int16[Ye+3]=y,this.int16[Ye+4]=_,this.int16[Ye+5]=T,this.int16[Ye+6]=C,this.int16[Ye+7]=I,this.uint16[Ye+8]=D,this.uint16[Ye+9]=O,this.uint16[Ye+10]=U,this.uint16[Ye+11]=G,this.uint16[Ye+12]=H,this.uint16[Ye+13]=K,this.uint16[Ye+14]=J,this.uint16[Ye+15]=se,this.uint16[Ye+16]=ye,this.uint16[Ye+17]=ae,this.uint16[Ye+18]=ue,this.uint16[Ye+19]=ve,this.uint16[Ye+20]=Ce,this.uint16[Ye+21]=je,this.uint16[Ye+22]=ot,this.uint32[Bt+12]=tt,this.float32[Bt+13]=ht,this.float32[Bt+14]=At,this.uint16[Ye+30]=pt,this.uint16[Ye+31]=rt,e}}ai.prototype.bytesPerElement=64,zt("StructArrayLayout8i15ui1ul2f2ui64",ai);class Bl extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}Bl.prototype.bytesPerElement=4,zt("StructArrayLayout1f4",Bl);class Ja extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,c)}emplace(e,i,c,f){const y=3*e;return this.uint16[6*e+0]=i,this.float32[y+1]=c,this.float32[y+2]=f,e}}Ja.prototype.bytesPerElement=12,zt("StructArrayLayout1ui2f12",Ja);class Vl extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,c)}emplace(e,i,c,f){const y=4*e;return this.uint32[2*e+0]=i,this.uint16[y+2]=c,this.uint16[y+3]=f,e}}Vl.prototype.bytesPerElement=8,zt("StructArrayLayout1ul2ui8",Vl);class b extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const c=this.length;return this.resize(c+1),this.emplace(c,e,i)}emplace(e,i,c){const f=2*e;return this.uint16[f+0]=i,this.uint16[f+1]=c,e}}b.prototype.bytesPerElement=4,zt("StructArrayLayout2ui4",b);class t extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}t.prototype.bytesPerElement=2,zt("StructArrayLayout1ui2",t);class a extends _n{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,c,f)}emplace(e,i,c,f,y){const _=4*e;return this.float32[_+0]=i,this.float32[_+1]=c,this.float32[_+2]=f,this.float32[_+3]=y,e}}a.prototype.bytesPerElement=16,zt("StructArrayLayout4f16",a);class d extends Lc{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new A(this.anchorPointX,this.anchorPointY)}}d.prototype.size=20;class g extends ju{get(e){return new d(this,e)}}zt("CollisionBoxArray",g);class w extends Lc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}w.prototype.size=48;class P extends kn{get(e){return new w(this,e)}}zt("PlacedSymbolArray",P);class E extends Lc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}E.prototype.size=64;class k extends ai{get(e){return new E(this,e)}}zt("SymbolInstanceArray",k);class z extends Bl{getoffsetX(e){return this.float32[1*e+0]}}zt("GlyphOffsetArray",z);class N extends Qa{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}zt("SymbolLineVertexArray",N);class Z extends Lc{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Z.prototype.size=12;class q extends Ja{get(e){return new Z(this,e)}}zt("TextAnchorOffsetArray",q);class Y extends Lc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Y.prototype.size=8;class ne extends Vl{get(e){return new Y(this,e)}}zt("FeatureIndexArray",ne);class de extends _s{}class pe extends _s{}class fe extends _s{}class me extends No{}class Se extends Nu{}class ge extends jo{}class Te extends Bo{}class Me extends zc{}class be extends vn{}class ze extends Nl{}class Ke extends jl{}class Ve extends aa{}class Ge extends ca{}class qe extends xn{}class vt extends b{}const bt=Gn([{name:"a_pos",components:2,type:"Int16"}],4),{members:ct}=bt;class kt{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,i,c,f){const y=this.segments[this.segments.length-1];return e>kt.MAX_VERTEX_ARRAY_LENGTH&&en(`Max vertices per segment is ${kt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${kt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!y||y.vertexLength+e>kt.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==f?this.createNewSegment(i,c,f):y}createNewSegment(e,i,c){const f={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0,vaos:{}};return c!==void 0&&(f.sortKey=c),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(f),f}getOrCreateLatestSegment(e,i,c){return this.prepareSegment(0,e,i,c)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,c,f){return new kt([{vertexOffset:e,primitiveOffset:i,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}function pr(o,e){return 256*(o=sr(Math.floor(o),0,255))+sr(Math.floor(e),0,255)}kt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,zt("SegmentVector",kt);const Qr=Gn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Sn=Gn([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var cn,Pn,un,Cn={exports:{}},Dn={exports:{}},Ei={exports:{}},Kn=(function(){if(un)return Cn.exports;un=1;var o=(cn||(cn=1,Dn.exports=function(i,c){var f,y,_,T,C,I,D,O;for(y=i.length-(f=3&i.length),_=c,C=3432918353,I=461845907,O=0;O<y;)D=255&i.charCodeAt(O)|(255&i.charCodeAt(++O))<<8|(255&i.charCodeAt(++O))<<16|(255&i.charCodeAt(++O))<<24,++O,_=27492+(65535&(T=5*(65535&(_=(_^=D=(65535&(D=(D=(65535&D)*C+(((D>>>16)*C&65535)<<16)&4294967295)<<15|D>>>17))*I+(((D>>>16)*I&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(D=0,f){case 3:D^=(255&i.charCodeAt(O+2))<<16;case 2:D^=(255&i.charCodeAt(O+1))<<8;case 1:_^=D=(65535&(D=(D=(65535&(D^=255&i.charCodeAt(O)))*C+(((D>>>16)*C&65535)<<16)&4294967295)<<15|D>>>17))*I+(((D>>>16)*I&65535)<<16)&4294967295}return _^=i.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),Dn.exports),e=(Pn||(Pn=1,Ei.exports=function(i,c){for(var f,y=i.length,_=c^y,T=0;y>=4;)f=1540483477*(65535&(f=255&i.charCodeAt(T)|(255&i.charCodeAt(++T))<<8|(255&i.charCodeAt(++T))<<16|(255&i.charCodeAt(++T))<<24))+((1540483477*(f>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),y-=4,++T;switch(y){case 3:_^=(255&i.charCodeAt(T+2))<<16;case 2:_^=(255&i.charCodeAt(T+1))<<8;case 1:_=1540483477*(65535&(_^=255&i.charCodeAt(T)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),Ei.exports);return Cn.exports=o,Cn.exports.murmur3=o,Cn.exports.murmur2=e,Cn.exports})(),Hr=R(Kn);class fi{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,c,f){this.ids.push(_o(e)),this.positions.push(i,c,f)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const i=_o(e);let c=0,f=this.ids.length-1;for(;c<f;){const _=c+f>>1;this.ids[_]>=i?f=_:c=_+1}const y=[];for(;this.ids[c]===i;)y.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return y}static serialize(e,i){const c=new Float64Array(e.ids),f=new Uint32Array(e.positions);return Vo(c,f,0,c.length-1),i&&i.push(c.buffer,f.buffer),{ids:c,positions:f}}static deserialize(e){const i=new fi;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function _o(o){const e=+o;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Hr(String(o))}function Vo(o,e,i,c){for(;i<c;){const f=o[i+c>>1];let y=i-1,_=c+1;for(;;){do y++;while(o[y]<f);do _--;while(o[_]>f);if(y>=_)break;vo(o,y,_),vo(e,3*y,3*_),vo(e,3*y+1,3*_+1),vo(e,3*y+2,3*_+2)}_-i<c-_?(Vo(o,e,i,_),i=_+1):(Vo(o,e,_+1,c),c=_)}}function vo(o,e,i){const c=o[e];o[e]=o[i],o[i]=c}zt("FeaturePositionMap",fi);class os{constructor(e,i){this.gl=e.gl,this.location=i}}class ua extends os{constructor(e,i){super(e,i),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Uo extends os{constructor(e,i){super(e,i),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class ha extends os{constructor(e,i){super(e,i),this.current=xr.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const vs=new Float32Array(16);function $o(o){return[pr(255*o.r,255*o.g),pr(255*o.b,255*o.a)]}class Zs{constructor(e,i,c){this.value=e,this.uniformNames=i.map((f=>`u_${f}`)),this.type=c}setUniform(e,i,c){e.set(c.constantOr(this.value))}getBinding(e,i,c){return this.type==="color"?new ha(e,i):new ua(e,i)}}class Ws{constructor(e,i){this.uniformNames=i.map((c=>`u_${c}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=e.tlbr}setConstantDashPositions(e,i){this.dashTo=[0,e.y,e.height,e.width],this.dashFrom=[0,i.y,i.height,i.width]}setUniform(e,i,c,f){let y=null;f==="u_pattern_to"?y=this.patternTo:f==="u_pattern_from"?y=this.patternFrom:f==="u_dasharray_to"?y=this.dashTo:f==="u_dasharray_from"?y=this.dashFrom:f==="u_pixel_ratio_to"?y=this.pixelRatioTo:f==="u_pixel_ratio_from"&&(y=this.pixelRatioFrom),y!==null&&e.set(y)}getBinding(e,i,c){return c.substr(0,9)==="u_pattern"||c.substr(0,12)==="u_dasharray_"?new Uo(e,i):new ua(e,i)}}class pn{constructor(e,i,c,f){this.expression=e,this.type=c,this.maxValue=0,this.paintVertexAttributes=i.map((y=>({name:`a_${y}`,type:"Float32",components:c==="color"?2:1,offset:0}))),this.paintVertexArray=new f}populatePaintArray(e,i,c){const f=this.paintVertexArray.length,y=this.expression.evaluate(new rn(0,c),i,{},c.canonical,[],c.formattedSection);this.paintVertexArray.resize(e),this._setPaintValue(f,e,y)}updatePaintArray(e,i,c,f,y){const _=this.expression.evaluate(new rn(0,y),c,f);this._setPaintValue(e,i,_)}_setPaintValue(e,i,c){if(this.type==="color"){const f=$o(c);for(let y=e;y<i;y++)this.paintVertexArray.emplace(y,f[0],f[1])}else{for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class hn{constructor(e,i,c,f,y,_){this.expression=e,this.uniformNames=i.map((T=>`u_${T}_t`)),this.type=c,this.useIntegerZoom=f,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=i.map((T=>({name:`a_${T}`,type:"Float32",components:c==="color"?4:2,offset:0}))),this.paintVertexArray=new _}populatePaintArray(e,i,c){const f=this.expression.evaluate(new rn(this.zoom,c),i,{},c.canonical,[],c.formattedSection),y=this.expression.evaluate(new rn(this.zoom+1,c),i,{},c.canonical,[],c.formattedSection),_=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(_,e,f,y)}updatePaintArray(e,i,c,f,y){const _=this.expression.evaluate(new rn(this.zoom,y),c,f),T=this.expression.evaluate(new rn(this.zoom+1,y),c,f);this._setPaintValue(e,i,_,T)}_setPaintValue(e,i,c,f){if(this.type==="color"){const y=$o(c),_=$o(f);for(let T=e;T<i;T++)this.paintVertexArray.emplace(T,y[0],y[1],_[0],_[1])}else{for(let y=e;y<i;y++)this.paintVertexArray.emplace(y,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i){const c=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,f=sr(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);e.set(f)}getBinding(e,i,c){return new ua(e,i)}}class li{constructor(e,i,c,f,y,_){this.expression=e,this.type=i,this.useIntegerZoom=c,this.zoom=f,this.layerId=_,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(e,i,c){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(f,e,this.getPositionIds(i),c)}updatePaintArray(e,i,c,f,y){this._setPaintValues(e,i,this.getPositionIds(c),y)}_setPaintValues(e,i,c,f){const y=this.getPositions(f);if(!y||!c)return;const _=y[c.min],T=y[c.mid],C=y[c.max];if(_&&T&&C)for(let I=e;I<i;I++)this.emplace(this.zoomInPaintVertexArray,I,T,_),this.emplace(this.zoomOutPaintVertexArray,I,T,C)}upload(e){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const i=this.getVertexAttributes();this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,i,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,i,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class pi extends li{getPositions(e){return e.imagePositions}getPositionIds(e){return e.patterns&&e.patterns[this.layerId]}getVertexAttributes(){return Qr.members}emplace(e,i,c,f){e.emplace(i,c.tlbr[0],c.tlbr[1],c.tlbr[2],c.tlbr[3],f.tlbr[0],f.tlbr[1],f.tlbr[2],f.tlbr[3],c.pixelRatio,f.pixelRatio)}}class as extends li{getPositions(e){return e.dashPositions}getPositionIds(e){return e.dashes&&e.dashes[this.layerId]}getVertexAttributes(){return Sn.members}emplace(e,i,c,f){e.emplace(i,0,c.y,c.height,c.width,0,f.y,f.height,f.width)}}class Gi{constructor(e,i,c){this.binders={},this._buffers=[];const f=[];for(const y in e.paint._values){if(!c(y))continue;const _=e.paint.get(y);if(!(_ instanceof As&&Is(_.property.specification)))continue;const T=mp(y,e.type),C=_.value,I=_.property.specification.type,D=_.property.useIntegerZoom,O=_.property.specification["property-type"],U=O==="cross-faded"||O==="cross-faded-data-driven";if(C.kind==="constant")this.binders[y]=U?new Ws(C.value,T):new Zs(C.value,T,I),f.push(`/u_${y}`);else if(C.kind==="source"||U){const G=hf(y,I,"source");this.binders[y]=U?y==="line-dasharray"?new as(C,I,D,i,G,e.id):new pi(C,I,D,i,G,e.id):new pn(C,T,I,G),f.push(`/a_${y}`)}else{const G=hf(y,I,"composite");this.binders[y]=new hn(C,T,I,D,i,G),f.push(`/z_${y}`)}}this.cacheKey=f.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof pn||i instanceof hn?i.maxValue:0}populatePaintArrays(e,i,c){for(const f in this.binders){const y=this.binders[f];(y instanceof pn||y instanceof hn||y instanceof li)&&y.populatePaintArray(e,i,c)}}setConstantPatternPositions(e,i){for(const c in this.binders){const f=this.binders[c];f instanceof Ws&&f.setConstantPatternPositions(e,i)}}setConstantDashPositions(e,i){for(const c in this.binders){const f=this.binders[c];f instanceof Ws&&f.setConstantDashPositions(e,i)}}updatePaintArrays(e,i,c,f,y){let _=!1;for(const T in e){const C=i.getPositions(T);for(const I of C){const D=c.feature(I.index);for(const O in this.binders){const U=this.binders[O];if((U instanceof pn||U instanceof hn||U instanceof li)&&U.expression.isStateDependent===!0){const G=f.paint.get(O);U.expression=G.value,U.updatePaintArray(I.start,I.end,D,e[T],y),_=!0}}}}return _}defines(){const e=[];for(const i in this.binders){const c=this.binders[i];(c instanceof Zs||c instanceof Ws)&&e.push(...c.uniformNames.map((f=>`#define HAS_UNIFORM_${f}`)))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const c=this.binders[i];if(c instanceof pn||c instanceof hn)for(let f=0;f<c.paintVertexAttributes.length;f++)e.push(c.paintVertexAttributes[f].name);else if(c instanceof li){const f=c.getVertexAttributes();for(const y of f)e.push(y.name)}}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const c=this.binders[i];if(c instanceof Zs||c instanceof Ws||c instanceof hn)for(const f of c.uniformNames)e.push(f)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,i){const c=[];for(const f in this.binders){const y=this.binders[f];if(y instanceof Zs||y instanceof Ws||y instanceof hn){for(const _ of y.uniformNames)if(i[_]){const T=y.getBinding(e,i[_],_);c.push({name:_,property:f,binding:T})}}}return c}setUniforms(e,i,c,f){for(const{name:y,property:_,binding:T}of i)this.binders[_].setUniform(T,f,c.get(_),y)}updatePaintBuffers(e){this._buffers=[];for(const i in this.binders){const c=this.binders[i];if(e&&c instanceof li){const f=e.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(c instanceof pn||c instanceof hn)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(e){for(const i in this.binders){const c=this.binders[i];(c instanceof pn||c instanceof hn||c instanceof li)&&c.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof pn||i instanceof hn||i instanceof li)&&i.destroy()}}}class el{constructor(e,i,c=()=>!0){this.programConfigurations={};for(const f of e)this.programConfigurations[f.id]=new Gi(f,i,c);this.needsUpload=!1,this._featureMap=new fi,this._bufferOffset=0}populatePaintArrays(e,i,c,f){for(const y in this.programConfigurations)this.programConfigurations[y].populatePaintArrays(e,i,f);i.id!==void 0&&this._featureMap.add(i.id,c,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,c,f){for(const y of c)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(e,this._featureMap,i,y,f)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function mp(o,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(`${e}-`,"").replace(/-/g,"_")]}function hf(o,e,i){const c={color:{source:jo,composite:a},number:{source:Bl,composite:jo}},f=(function(y){return{"line-pattern":{source:Te,composite:Te},"fill-pattern":{source:Te,composite:Te},"fill-extrusion-pattern":{source:Te,composite:Te},"line-dasharray":{source:Me,composite:Me}}[y]})(o);return f&&f[i]||c[e][i]}zt("ConstantBinder",Zs),zt("CrossFadedConstantBinder",Ws),zt("SourceExpressionBinder",pn),zt("CrossFadedPatternBinder",pi),zt("CrossFadedDasharrayBinder",as),zt("CompositeExpressionBinder",hn),zt("ProgramConfiguration",Gi,{omit:["_buffers"]}),zt("ProgramConfigurationSet",el);const Qh=Math.pow(2,14)-1,da=-Qh-1;function Go(o){const e=Be/o.extent,i=o.loadGeometry();for(let c=0;c<i.length;c++){const f=i[c];for(let y=0;y<f.length;y++){const _=f[y],T=Math.round(_.x*e),C=Math.round(_.y*e);_.x=sr(T,da,Qh),_.y=sr(C,da,Qh),(T<_.x||T>_.x+1||C<_.y||C>_.y+1)&&en("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function fa(o,e){return{type:o.type,id:o.id,properties:o.properties,geometry:e?Go(o):[]}}const Bu=-32768;function Jh(o,e,i,c,f){o.emplaceBack(Bu+8*e+c,Bu+8*i+f)}class Vu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new pe,this.indexArray=new qe,this.segments=new kt,this.programConfigurations=new el(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,c){const f=this.layers[0],y=[];let _=null,T=!1,C=f.type==="heatmap";if(f.type==="circle"){const D=f;_=D.layout.get("circle-sort-key"),T=!_.isConstant(),C=C||D.paint.get("circle-pitch-alignment")==="map"}const I=C?i.subdivisionGranularity.circle:1;for(const{feature:D,id:O,index:U,sourceLayerIndex:G}of e){const H=this.layers[0]._featureFilter.needGeometry,K=fa(D,H);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),K,c))continue;const J=T?_.evaluate(K,{},c):void 0,se={id:O,properties:D.properties,type:D.type,sourceLayerIndex:G,index:U,geometry:H?K.geometry:Go(D),patterns:{},sortKey:J};y.push(se)}T&&y.sort(((D,O)=>D.sortKey-O.sortKey));for(const D of y){const{geometry:O,index:U,sourceLayerIndex:G}=D,H=e[U].feature;this.addFeature(D,O,U,c,I),i.featureIndex.insert(H,O,U,G,this.index)}}update(e,i,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:c})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ct),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,c,f,y=1){let _;switch(y){case 1:_=[0,7];break;case 3:_=[0,2,5,7];break;case 5:_=[0,1,3,4,6,7];break;case 7:_=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${y}; valid values are 1, 3, 5, 7.`)}const T=_.length;for(const C of i)for(const I of C){const D=I.x,O=I.y;if(D<0||D>=Be||O<0||O>=Be)continue;const U=this.segments.prepareSegment(T*T,this.layoutVertexArray,this.indexArray,e.sortKey),G=U.vertexLength;for(let H=0;H<T;H++)for(let K=0;K<T;K++)Jh(this.layoutVertexArray,D,O,_[K],_[H]);for(let H=0;H<T-1;H++)for(let K=0;K<T-1;K++){const J=G+H*T+K,se=G+(H+1)*T+K;this.indexArray.emplaceBack(J,se+1,J+1),this.indexArray.emplaceBack(J,se,se+1)}U.vertexLength+=T*T,U.primitiveLength+=(T-1)*(T-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,{imagePositions:{},canonical:f})}}function Fc(o,e){for(let i=0;i<o.length;i++)if(Ul(e,o[i]))return!0;for(let i=0;i<e.length;i++)if(Ul(o,e[i]))return!0;return!!td(o,e)}function ed(o,e,i){return!!Ul(o,e)||!!gp(e,o,i)}function Fm(o,e){if(o.length===1)return Nm(e,o[0]);for(let i=0;i<e.length;i++){const c=e[i];for(let f=0;f<c.length;f++)if(Ul(o,c[f]))return!0}for(let i=0;i<o.length;i++)if(Nm(e,o[i]))return!0;for(let i=0;i<e.length;i++)if(td(o,e[i]))return!0;return!1}function Om(o,e,i){if(o.length>1){if(td(o,e))return!0;for(let c=0;c<e.length;c++)if(gp(e[c],o,i))return!0}for(let c=0;c<o.length;c++)if(gp(o[c],e,i))return!0;return!1}function td(o,e){if(o.length===0||e.length===0)return!1;for(let i=0;i<o.length-1;i++){const c=o[i],f=o[i+1];for(let y=0;y<e.length-1;y++)if(D_(c,f,e[y],e[y+1]))return!0}return!1}function D_(o,e,i,c){return ni(o,i,c)!==ni(e,i,c)&&ni(o,e,i)!==ni(o,e,c)}function gp(o,e,i){const c=i*i;if(e.length===1)return o.distSqr(e[0])<c;for(let f=1;f<e.length;f++)if(yp(o,e[f-1],e[f])<c)return!0;return!1}function yp(o,e,i){const c=e.distSqr(i);if(c===0)return o.distSqr(e);const f=((o.x-e.x)*(i.x-e.x)+(o.y-e.y)*(i.y-e.y))/c;return o.distSqr(f<0?e:f>1?i:i.sub(e)._mult(f)._add(e))}function Nm(o,e){let i,c,f,y=!1;for(let _=0;_<o.length;_++){i=o[_];for(let T=0,C=i.length-1;T<i.length;C=T++)c=i[T],f=i[C],c.y>e.y!=f.y>e.y&&e.x<(f.x-c.x)*(e.y-c.y)/(f.y-c.y)+c.x&&(y=!y)}return y}function Ul(o,e){let i=!1;for(let c=0,f=o.length-1;c<o.length;f=c++){const y=o[c],_=o[f];y.y>e.y!=_.y>e.y&&e.x<(_.x-y.x)*(e.y-y.y)/(_.y-y.y)+y.x&&(i=!i)}return i}function $l(o,e,i){const c=i[0],f=i[2];if(o.x<c.x&&e.x<c.x||o.x>f.x&&e.x>f.x||o.y<c.y&&e.y<c.y||o.y>f.y&&e.y>f.y)return!1;const y=ni(o,e,i[0]);return y!==ni(o,e,i[1])||y!==ni(o,e,i[2])||y!==ni(o,e,i[3])}function rd(o,e,i){const c=e.paint.get(o).value;return c.kind==="constant"?c.value:i.programConfigurations.get(e.id).getMaxValue(o)}function df(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function nd(o,e,i,c,f){if(!e[0]&&!e[1])return o;const y=A.convert(e)._mult(f);i==="viewport"&&y._rotate(-c);const _=[];for(let T=0;T<o.length;T++)_.push(o[T].sub(y));return _}function dy(o){const e=[];for(let i=0;i<o.length;i++){const c=o[i],f=e.at(-1);(i===0||f&&!c.equals(f))&&e.push(c)}return e}function fy({queryGeometry:o,size:e},i){return ed(o,i,e)}function ff({queryGeometry:o,size:e,transform:i,unwrappedTileID:c,getElevation:f},y){return ed(o,y,e*(i.projectTileCoordinates(y.x,y.y,c,f).signedDistanceFromCamera/i.cameraToCenterDistance))}function xs({queryGeometry:o,size:e,transform:i,unwrappedTileID:c,getElevation:f},y){const _=i.projectTileCoordinates(y.x,y.y,c,f).signedDistanceFromCamera,T=e*(i.cameraToCenterDistance/_);return ed(o,id(y,i,c,f),T)}function R_({queryGeometry:o,size:e,transform:i,unwrappedTileID:c,getElevation:f},y){return ed(o,id(y,i,c,f),e)}function py({queryGeometry:o,size:e,transform:i,unwrappedTileID:c,getElevation:f,pitchAlignment:y="map",pitchScale:_="map"},T){const C=y==="map"?_==="map"?fy:ff:_==="map"?xs:R_,I={queryGeometry:o,size:e,transform:i,unwrappedTileID:c,getElevation:f};for(const D of T)for(const O of D)if(C(I,O))return!0;return!1}function id(o,e,i,c){const f=e.projectTileCoordinates(o.x,o.y,i,c).point;return new A((.5*f.x+.5)*e.width,(.5*-f.y+.5)*e.height)}let ls,my;zt("CircleBucket",Vu,{omit:["layers"]});var Qt={get paint(){return my=my||new Hn({"circle-radius":new Kt($e.paint_circle["circle-radius"]),"circle-color":new Kt($e.paint_circle["circle-color"]),"circle-blur":new Kt($e.paint_circle["circle-blur"]),"circle-opacity":new Kt($e.paint_circle["circle-opacity"]),"circle-translate":new jt($e.paint_circle["circle-translate"]),"circle-translate-anchor":new jt($e.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new jt($e.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new jt($e.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Kt($e.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Kt($e.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Kt($e.paint_circle["circle-stroke-opacity"])})},get layout(){return ls=ls||new Hn({"circle-sort-key":new Kt($e.layout_circle["circle-sort-key"])})}};class sd extends ys{constructor(e,i){super(e,Qt,i)}createBucket(e){return new Vu(e)}queryRadius(e){const i=e;return rd("circle-radius",this,i)+rd("circle-stroke-width",this,i)+df(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:c,geometry:f,transform:y,pixelsToTileUnits:_,unwrappedTileID:T,getElevation:C}){const I=nd(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-y.bearingInRadians,_),D=this.paint.get("circle-radius").evaluate(i,c)+this.paint.get("circle-stroke-width").evaluate(i,c),O=this.paint.get("circle-pitch-scale"),U=this.paint.get("circle-pitch-alignment");let G,H;return U==="map"?(G=I,H=D*_):(G=(function(K,J,se,ye){return K.map((ae=>id(ae,J,se,ye)))})(I,y,T,C),H=D),py({queryGeometry:G,size:H,transform:y,unwrappedTileID:T,getElevation:C,pitchAlignment:U,pitchScale:O},f)}}class _p extends Vu{}let jm;zt("HeatmapBucket",_p,{omit:["layers"]});var L_={get paint(){return jm=jm||new Hn({"heatmap-radius":new Kt($e.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Kt($e.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new jt($e.paint_heatmap["heatmap-intensity"]),"heatmap-color":new qs($e.paint_heatmap["heatmap-color"]),"heatmap-opacity":new jt($e.paint_heatmap["heatmap-opacity"])})}};function Uu(o,{width:e,height:i},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==e*i*c)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${e*i*c}`)}else f=new Uint8Array(e*i*c);return o.width=e,o.height=i,o.data=f,o}function pf(o,{width:e,height:i},c){if(e===o.width&&i===o.height)return;const f=Uu({},{width:e,height:i},c);mf(o,f,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,e),height:Math.min(o.height,i)},c),o.width=e,o.height=i,o.data=f.data}function mf(o,e,i,c,f,y){if(f.width===0||f.height===0)return e;if(f.width>o.width||f.height>o.height||i.x>o.width-f.width||i.y>o.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>e.width||f.height>e.height||c.x>e.width-f.width||c.y>e.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const _=o.data,T=e.data;if(_===T)throw new Error("srcData equals dstData, so image is already copied");for(let C=0;C<f.height;C++){const I=((i.y+C)*o.width+i.x)*y,D=((c.y+C)*e.width+c.x)*y;for(let O=0;O<f.width*y;O++)T[D+O]=_[I+O]}return e}class od{constructor(e,i){Uu(this,e,1,i)}resize(e){pf(this,e,1)}clone(){return new od({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,c,f,y){mf(e,i,c,f,y,1)}}class bs{constructor(e,i){Uu(this,e,4,i)}resize(e){pf(this,e,4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new bs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,c,f,y){mf(e,i,c,f,y,4)}setPixel(e,i,c){const f=4*(e*this.width+i);this.data[f+0]=Math.round(255*c.r/c.a),this.data[f+1]=Math.round(255*c.g/c.a),this.data[f+2]=Math.round(255*c.b/c.a),this.data[f+3]=Math.round(255*c.a)}}function Bm(o){const e={},i=o.resolution||256,c=o.clips?o.clips.length:1,f=o.image||new bs({width:i,height:c});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const y=(_,T,C)=>{e[o.evaluationKey]=C;const I=o.expression.evaluate(e);f.setPixel(_/4/i,T/4,I)};if(o.clips)for(let _=0,T=0;_<c;++_,T+=4*i)for(let C=0,I=0;C<i;C++,I+=4){const D=C/(i-1),{start:O,end:U}=o.clips[_];y(T,I,O*(1-D)+U*D)}else for(let _=0,T=0;_<i;_++,T+=4)y(0,T,_/(i-1));return f}zt("AlphaImage",od),zt("RGBAImage",bs);const gf="big-fb";class Vm extends ys{createBucket(e){return new _p(e)}constructor(e,i){super(e,L_,i),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Bm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(gf)&&this.heatmapFbos.delete(gf)}queryRadius(e){return rd("heatmap-radius",this,e)}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:c,geometry:f,transform:y,pixelsToTileUnits:_,unwrappedTileID:T,getElevation:C}){return py({queryGeometry:e,size:this.paint.get("heatmap-radius").evaluate(i,c)*_,transform:y,unwrappedTileID:T,getElevation:C},f)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let qi;var pa={get paint(){return qi=qi||new Hn({"hillshade-illumination-direction":new jt($e.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new jt($e.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new jt($e.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new jt($e.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new jt($e.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new jt($e.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new jt($e.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new jt($e.paint_hillshade["hillshade-method"])})}};class Oc extends ys{constructor(e,i){super(e,pa,i),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,i=this.paint.get("hillshade-illumination-altitude").values,c=this.paint.get("hillshade-highlight-color").values,f=this.paint.get("hillshade-shadow-color").values;const y=Math.max(e.length,i.length,c.length,f.length);e=e.concat(Array(y-e.length).fill(e.at(-1))),i=i.concat(Array(y-i.length).fill(i.at(-1))),c=c.concat(Array(y-c.length).fill(c.at(-1))),f=f.concat(Array(y-f.length).fill(f.at(-1)));const _=i.map(Vt);return{directionRadians:e.map(Vt),altitudeRadians:_,shadowColor:f,highlightColor:c}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let Um;var gy={get paint(){return Um=Um||new Hn({"color-relief-opacity":new jt($e["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new qs($e["paint_color-relief"]["color-relief-color"])})}};class xo{constructor(e,i,c,f){this.context=e,this.format=c,this.texture=e.gl.createTexture(),this.update(i,f)}update(e,i,c){const{width:f,height:y}=e,_=!(this.size&&this.size[0]===f&&this.size[1]===y||c),{context:T}=this,{gl:C}=T;if(this.useMipmap=!!(i&&i.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!i||i.premultiply!==!1)),_)this.size=[f,y],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||io(e)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,e):C.texImage2D(C.TEXTURE_2D,0,this.format,f,y,0,this.format,C.UNSIGNED_BYTE,e.data);else{const{x:I,y:D}=c||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||io(e)?C.texSubImage2D(C.TEXTURE_2D,0,I,D,C.RGBA,C.UNSIGNED_BYTE,e):C.texSubImage2D(C.TEXTURE_2D,0,I,D,f,y,C.RGBA,C.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D),T.pixelStoreUnpackFlipY.setDefault(),T.pixelStoreUnpack.setDefault(),T.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,i,c){const{context:f}=this,{gl:y}=f;y.bindTexture(y.TEXTURE_2D,this.texture),c!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=y.LINEAR),e!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,e),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,c||e),this.filter=e),i!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,i),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class $m{constructor(e,i,c,f=1,y=1,_=1,T=0){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(c&&!["mapbox","terrarium","custom"].includes(c))return void en(`"${c}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=i.height;const C=this.dim=i.height-2;switch(this.data=new Uint32Array(i.data.buffer),c){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=f,this.greenFactor=y,this.blueFactor=_,this.baseShift=T;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let I=0;I<C;I++)this.data[this._idx(-1,I)]=this.data[this._idx(0,I)],this.data[this._idx(C,I)]=this.data[this._idx(C-1,I)],this.data[this._idx(I,-1)]=this.data[this._idx(I,0)],this.data[this._idx(I,C)]=this.data[this._idx(I,C-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(C,-1)]=this.data[this._idx(C-1,0)],this.data[this._idx(-1,C)]=this.data[this._idx(0,C-1)],this.data[this._idx(C,C)]=this.data[this._idx(C-1,C-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let I=0;I<C;I++)for(let D=0;D<C;D++){const O=this.get(I,D);O>this.max&&(this.max=O),O<this.min&&(this.min=O)}}get(e,i){const c=new Uint8Array(this.data.buffer),f=4*this._idx(e,i);return this.unpack(c[f],c[f+1],c[f+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${e}, y: ${i}, dim: ${this.dim}`);return(i+1)*this.stride+(e+1)}unpack(e,i,c){return e*this.redFactor+i*this.greenFactor+c*this.blueFactor-this.baseShift}pack(e){return ma(e,this.getUnpackVector())}getPixels(){return new bs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,i,c){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let f=i*this.dim,y=i*this.dim+this.dim,_=c*this.dim,T=c*this.dim+this.dim;switch(i){case-1:f=y-1;break;case 1:y=f+1}switch(c){case-1:_=T-1;break;case 1:T=_+1}const C=-i*this.dim,I=-c*this.dim;for(let D=_;D<T;D++)for(let O=f;O<y;O++)this.data[this._idx(O,D)]=e.data[this._idx(O+C,D+I)]}}function ma(o,e){const i=e[0],c=e[1],f=e[2],y=e[3],_=Math.min(i,c,f),T=Math.round((o+y)/_);return{r:Math.floor(T*_/i)%256,g:Math.floor(T*_/c)%256,b:Math.floor(T*_/f)%256}}zt("DEMData",$m);class z_ extends ys{constructor(e,i){super(e,gy,i)}_createColorRamp(e){const i={elevationStops:[],colorStops:[]},c=this._transitionablePaint._values["color-relief-color"].value.expression;if(c instanceof ja&&c._styleExpression.expression instanceof Si){this.colorRampExpression=c;const _=c._styleExpression.expression;i.elevationStops=_.labels,i.colorStops=[];for(const T of i.elevationStops)i.colorStops.push(_.evaluate({globals:{elevation:T}}))}if(i.elevationStops.length<1&&(i.elevationStops=[0],i.colorStops=[xr.transparent]),i.elevationStops.length<2&&(i.elevationStops.push(i.elevationStops[0]+1),i.colorStops.push(i.colorStops[0])),i.elevationStops.length<=e)return i;const f={elevationStops:[],colorStops:[]},y=(i.elevationStops.length-1)/(e-1);for(let _=0;_<i.elevationStops.length-.5;_+=y)f.elevationStops.push(i.elevationStops[Math.round(_)]),f.colorStops.push(i.colorStops[Math.round(_)]);return en(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${e}, provided: ${i.elevationStops.length}`),f}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(e,i,c){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const f=this._createColorRamp(i),y=new bs({width:f.colorStops.length,height:1}),_=new bs({width:f.colorStops.length,height:1});for(let T=0;T<f.elevationStops.length;T++){const C=ma(f.elevationStops[T],c);_.setPixel(0,T,new xr(C.r/255,C.g/255,C.b/255,1)),y.setPixel(0,T,f.colorStops[T])}return this.colorRampTextures={elevationTexture:new xo(e,_,e.gl.RGBA),colorTexture:new xo(e,y,e.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const yy=Gn([{name:"a_pos",components:2,type:"Int16"}],4),{members:_y}=yy;function yf(o,e,i){const c=i.patternDependencies;let f=!1;for(const y of e){const _=y.paint.get(`${o}-pattern`);_.isConstant()||(f=!0);const T=_.constantOr(null);T&&(f=!0,c[T.to]=!0,c[T.from]=!0)}return f}function vp(o,e,i,c,f){const{zoom:y}=c,_=f.patternDependencies;for(const T of e){const C=T.paint.get(`${o}-pattern`).value;if(C.kind!=="constant"){let I=C.evaluate({zoom:y-1},i,{},f.availableImages),D=C.evaluate({zoom:y},i,{},f.availableImages),O=C.evaluate({zoom:y+1},i,{},f.availableImages);I=I&&I.name?I.name:I,D=D&&D.name?D.name:D,O=O&&O.name?O.name:O,_[I]=!0,_[D]=!0,_[O]=!0,i.patterns[T.id]={min:I,mid:D,max:O}}}return i}function vy(o,e,i,c,f){let y;if(f===(function(_,T,C,I){let D=0;for(let O=T,U=C-I;O<C;O+=I)D+=(_[U]-_[O])*(_[O+1]+_[U+1]),U=O;return D})(o,e,i,c)>0)for(let _=e;_<i;_+=c)y=ql(_/c|0,o[_],o[_+1],y);else for(let _=i-c;_>=e;_-=c)y=ql(_/c|0,o[_],o[_+1],y);return y&&Oi(y,y.next)&&(Vc(y),y=y.next),y}function tl(o,e){if(!o)return o;e||(e=o);let i,c=o;do if(i=!1,c.steiner||!Oi(c,c.next)&&Rn(c.prev,c,c.next)!==0)c=c.next;else{if(Vc(c),c=e=c.prev,c===c.next)break;i=!0}while(i||c!==e);return e}function $u(o,e,i,c,f,y,_){if(!o)return;!_&&y&&(function(C,I,D,O){let U=C;do U.z===0&&(U.z=mi(U.x,U.y,I,D,O)),U.prevZ=U.prev,U.nextZ=U.next,U=U.next;while(U!==C);U.prevZ.nextZ=null,U.prevZ=null,(function(G){let H,K=1;do{let J,se=G;G=null;let ye=null;for(H=0;se;){H++;let ae=se,ue=0;for(let Ce=0;Ce<K&&(ue++,ae=ae.nextZ,ae);Ce++);let ve=K;for(;ue>0||ve>0&&ae;)ue!==0&&(ve===0||!ae||se.z<=ae.z)?(J=se,se=se.nextZ,ue--):(J=ae,ae=ae.nextZ,ve--),ye?ye.nextZ=J:G=J,J.prevZ=ye,ye=J;se=ae}ye.nextZ=null,K*=2}while(H>1)})(U)})(o,c,f,y);let T=o;for(;o.prev!==o.next;){const C=o.prev,I=o.next;if(y?Jr(o,c,f,y):qo(o))e.push(C.i,o.i,I.i),Vc(o),o=I.next,T=I.next;else if((o=I)===T){_?_===1?$u(o=Zi(tl(o),e),e,i,c,f,y,2):_===2&&Mi(o,e,i,c,f,y):$u(tl(o),e,i,c,f,y,1);break}}}function qo(o){const e=o.prev,i=o,c=o.next;if(Rn(e,i,c)>=0)return!1;const f=e.x,y=i.x,_=c.x,T=e.y,C=i.y,I=c.y,D=Math.min(f,y,_),O=Math.min(T,C,I),U=Math.max(f,y,_),G=Math.max(T,C,I);let H=c.next;for(;H!==e;){if(H.x>=D&&H.x<=U&&H.y>=O&&H.y<=G&&jc(f,T,y,C,_,I,H.x,H.y)&&Rn(H.prev,H,H.next)>=0)return!1;H=H.next}return!0}function Jr(o,e,i,c){const f=o.prev,y=o,_=o.next;if(Rn(f,y,_)>=0)return!1;const T=f.x,C=y.x,I=_.x,D=f.y,O=y.y,U=_.y,G=Math.min(T,C,I),H=Math.min(D,O,U),K=Math.max(T,C,I),J=Math.max(D,O,U),se=mi(G,H,e,i,c),ye=mi(K,J,e,i,c);let ae=o.prevZ,ue=o.nextZ;for(;ae&&ae.z>=se&&ue&&ue.z<=ye;){if(ae.x>=G&&ae.x<=K&&ae.y>=H&&ae.y<=J&&ae!==f&&ae!==_&&jc(T,D,C,O,I,U,ae.x,ae.y)&&Rn(ae.prev,ae,ae.next)>=0||(ae=ae.prevZ,ue.x>=G&&ue.x<=K&&ue.y>=H&&ue.y<=J&&ue!==f&&ue!==_&&jc(T,D,C,O,I,U,ue.x,ue.y)&&Rn(ue.prev,ue,ue.next)>=0))return!1;ue=ue.nextZ}for(;ae&&ae.z>=se;){if(ae.x>=G&&ae.x<=K&&ae.y>=H&&ae.y<=J&&ae!==f&&ae!==_&&jc(T,D,C,O,I,U,ae.x,ae.y)&&Rn(ae.prev,ae,ae.next)>=0)return!1;ae=ae.prevZ}for(;ue&&ue.z<=ye;){if(ue.x>=G&&ue.x<=K&&ue.y>=H&&ue.y<=J&&ue!==f&&ue!==_&&jc(T,D,C,O,I,U,ue.x,ue.y)&&Rn(ue.prev,ue,ue.next)>=0)return!1;ue=ue.nextZ}return!0}function Zi(o,e){let i=o;do{const c=i.prev,f=i.next.next;!Oi(c,f)&&xp(c,i,i.next,f)&&Bc(c,f)&&Bc(f,c)&&(e.push(c.i,i.i,f.i),Vc(i),Vc(i.next),i=o=f),i=i.next}while(i!==o);return tl(i)}function Mi(o,e,i,c,f,y){let _=o;do{let T=_.next.next;for(;T!==_.prev;){if(_.i!==T.i&&Gm(_,T)){let C=bp(_,T);return _=tl(_,_.next),C=tl(C,C.next),$u(_,e,i,c,f,y,0),void $u(C,e,i,c,f,y,0)}T=T.next}_=_.next}while(_!==o)}function cs(o,e){let i=o.x-e.x;return i===0&&(i=o.y-e.y,i===0)&&(i=(o.next.y-o.y)/(o.next.x-o.x)-(e.next.y-e.y)/(e.next.x-e.x)),i}function bo(o,e){const i=(function(f,y){let _=y;const T=f.x,C=f.y;let I,D=-1/0;if(Oi(f,_))return _;do{if(Oi(f,_.next))return _.next;if(C<=_.y&&C>=_.next.y&&_.next.y!==_.y){const K=_.x+(C-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(K<=T&&K>D&&(D=K,I=_.x<_.next.x?_:_.next,K===T))return I}_=_.next}while(_!==y);if(!I)return null;const O=I,U=I.x,G=I.y;let H=1/0;_=I;do{if(T>=_.x&&_.x>=U&&T!==_.x&&Nc(C<G?T:D,C,U,G,C<G?D:T,C,_.x,_.y)){const K=Math.abs(C-_.y)/(T-_.x);Bc(_,f)&&(K<H||K===H&&(_.x>I.x||_.x===I.x&&ad(I,_)))&&(I=_,H=K)}_=_.next}while(_!==O);return I})(o,e);if(!i)return e;const c=bp(i,o);return tl(c,c.next),tl(i,i.next)}function ad(o,e){return Rn(o.prev,o,e.prev)<0&&Rn(e.next,o,o.next)<0}function mi(o,e,i,c,f){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-i)*f|0)|o<<8))|o<<4))|o<<2))|o<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-c)*f|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function _f(o){let e=o,i=o;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==o);return i}function Nc(o,e,i,c,f,y,_,T){return(f-_)*(e-T)>=(o-_)*(y-T)&&(o-_)*(c-T)>=(i-_)*(e-T)&&(i-_)*(y-T)>=(f-_)*(c-T)}function jc(o,e,i,c,f,y,_,T){return!(o===_&&e===T)&&Nc(o,e,i,c,f,y,_,T)}function Gm(o,e){return o.next.i!==e.i&&o.prev.i!==e.i&&!(function(i,c){let f=i;do{if(f.i!==i.i&&f.next.i!==i.i&&f.i!==c.i&&f.next.i!==c.i&&xp(f,f.next,i,c))return!0;f=f.next}while(f!==i);return!1})(o,e)&&(Bc(o,e)&&Bc(e,o)&&(function(i,c){let f=i,y=!1;const _=(i.x+c.x)/2,T=(i.y+c.y)/2;do f.y>T!=f.next.y>T&&f.next.y!==f.y&&_<(f.next.x-f.x)*(T-f.y)/(f.next.y-f.y)+f.x&&(y=!y),f=f.next;while(f!==i);return y})(o,e)&&(Rn(o.prev,o,e.prev)||Rn(o,e.prev,e))||Oi(o,e)&&Rn(o.prev,o,o.next)>0&&Rn(e.prev,e,e.next)>0)}function Rn(o,e,i){return(e.y-o.y)*(i.x-e.x)-(e.x-o.x)*(i.y-e.y)}function Oi(o,e){return o.x===e.x&&o.y===e.y}function xp(o,e,i,c){const f=Zo(Rn(o,e,i)),y=Zo(Rn(o,e,c)),_=Zo(Rn(i,c,o)),T=Zo(Rn(i,c,e));return f!==y&&_!==T||!(f!==0||!Gl(o,i,e))||!(y!==0||!Gl(o,c,e))||!(_!==0||!Gl(i,o,c))||!(T!==0||!Gl(i,e,c))}function Gl(o,e,i){return e.x<=Math.max(o.x,i.x)&&e.x>=Math.min(o.x,i.x)&&e.y<=Math.max(o.y,i.y)&&e.y>=Math.min(o.y,i.y)}function Zo(o){return o>0?1:o<0?-1:0}function Bc(o,e){return Rn(o.prev,o,o.next)<0?Rn(o,e,o.next)>=0&&Rn(o,o.prev,e)>=0:Rn(o,e,o.prev)<0||Rn(o,o.next,e)<0}function bp(o,e){const i=rl(o.i,o.x,o.y),c=rl(e.i,e.x,e.y),f=o.next,y=e.prev;return o.next=e,e.prev=o,i.next=f,f.prev=i,c.next=i,i.prev=c,y.next=c,c.prev=y,c}function ql(o,e,i,c){const f=rl(o,e,i);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function Vc(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function rl(o,e,i){return{i:o,x:e,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Zl{constructor(e,i){if(i>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=i}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class Uc{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}Uc.noSubdivision=new Uc({fill:new Zl(0,0),line:new Zl(0,0),tile:new Zl(0,0),stencil:new Zl(0,0),circle:1}),zt("SubdivisionGranularityExpression",Zl),zt("SubdivisionGranularitySetting",Uc);const $c=-32768,Gc=32767;class wp{constructor(e,i){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=Be/e,this._canonical=i}_getKey(e,i){return(e+=32768)<<16|i+32768}_vertexToIndex(e,i){if(e<-32768||i<-32768||e>32767||i>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const c=0|Math.round(e),f=0|Math.round(i),y=this._getKey(c,f);if(this._vertexDictionary.has(y))return this._vertexDictionary.get(y);const _=this._vertexBuffer.length/2;return this._vertexDictionary.set(y,_),this._vertexBuffer.push(c,f),_}_subdivideTrianglesScanline(e){if(this._granularity<2)return(function(f,y){const _=[];for(let T=0;T<y.length;T+=3){const C=y[T],I=y[T+1],D=y[T+2],O=f[2*C],U=f[2*C+1];(f[2*I]-O)*(f[2*D+1]-U)-(f[2*I+1]-U)*(f[2*D]-O)>0?(_.push(C),_.push(D),_.push(I)):(_.push(C),_.push(I),_.push(D))}return _})(this._vertexBuffer,e);const i=[],c=e.length;for(let f=0;f<c;f+=3){const y=[e[f+0],e[f+1],e[f+2]],_=[this._vertexBuffer[2*e[f+0]+0],this._vertexBuffer[2*e[f+0]+1],this._vertexBuffer[2*e[f+1]+0],this._vertexBuffer[2*e[f+1]+1],this._vertexBuffer[2*e[f+2]+0],this._vertexBuffer[2*e[f+2]+1]];let T=1/0,C=1/0,I=-1/0,D=-1/0;for(let K=0;K<3;K++){const J=_[2*K],se=_[2*K+1];T=Math.min(T,J),I=Math.max(I,J),C=Math.min(C,se),D=Math.max(D,se)}if(T===I||C===D)continue;const O=Math.floor(T/this._granularityCellSize),U=Math.ceil(I/this._granularityCellSize),G=Math.floor(C/this._granularityCellSize),H=Math.ceil(D/this._granularityCellSize);if(O!==U||G!==H)for(let K=G;K<H;K++){const J=this._scanlineGenerateVertexRingForCellRow(K,_,y);ga(this._vertexBuffer,J,i)}else i.push(...y)}return i}_scanlineGenerateVertexRingForCellRow(e,i,c){const f=e*this._granularityCellSize,y=f+this._granularityCellSize,_=[];for(let T=0;T<3;T++){const C=i[2*T],I=i[2*T+1],D=i[2*(T+1)%6],O=i[(2*(T+1)+1)%6],U=i[2*(T+2)%6],G=i[(2*(T+2)+1)%6],H=D-C,K=O-I,J=H===0,se=K===0,ye=(f-I)/K,ae=(y-I)/K,ue=Math.min(ye,ae),ve=Math.max(ye,ae);if(!se&&(ue>=1||ve<=0)||se&&(I<f||I>y)){O>=f&&O<=y&&_.push(c[(T+1)%3]);continue}!se&&ue>0&&_.push(this._vertexToIndex(C+H*ue,I+K*ue));const Ce=C+H*Math.max(ue,0),je=C+H*Math.min(ve,1);J||this._generateIntraEdgeVertices(_,C,I,D,O,Ce,je),!se&&ve<1&&_.push(this._vertexToIndex(C+H*ve,I+K*ve)),(se||O>=f&&O<=y)&&_.push(c[(T+1)%3]),!se&&(O<=f||O>=y)&&this._generateInterEdgeVertices(_,C,I,D,O,U,G,je,f,y)}return _}_generateIntraEdgeVertices(e,i,c,f,y,_,T){const C=f-i,I=y-c,D=I===0,O=D?Math.min(i,f):Math.min(_,T),U=D?Math.max(i,f):Math.max(_,T),G=Math.floor(O/this._granularityCellSize)+1,H=Math.ceil(U/this._granularityCellSize)-1;if(D?i<f:_<T)for(let K=G;K<=H;K++){const J=K*this._granularityCellSize;e.push(this._vertexToIndex(J,c+I*(J-i)/C))}else for(let K=H;K>=G;K--){const J=K*this._granularityCellSize;e.push(this._vertexToIndex(J,c+I*(J-i)/C))}}_generateInterEdgeVertices(e,i,c,f,y,_,T,C,I,D){const O=y-c,U=_-f,G=T-y,H=(I-y)/G,K=(D-y)/G,J=Math.min(H,K),se=Math.max(H,K),ye=f+U*J;let ae=Math.floor(Math.min(ye,C)/this._granularityCellSize)+1,ue=Math.ceil(Math.max(ye,C)/this._granularityCellSize)-1,ve=C<ye;const Ce=G===0;if(Ce&&(T===I||T===D))return;if(Ce||J>=1||se<=0){const ot=c-T,tt=_+(i-_)*Math.min((I-T)/ot,(D-T)/ot);ae=Math.floor(Math.min(tt,C)/this._granularityCellSize)+1,ue=Math.ceil(Math.max(tt,C)/this._granularityCellSize)-1,ve=C<tt}const je=O>0?D:I;if(ve)for(let ot=ae;ot<=ue;ot++)e.push(this._vertexToIndex(ot*this._granularityCellSize,je));else for(let ot=ue;ot>=ae;ot--)e.push(this._vertexToIndex(ot*this._granularityCellSize,je))}_generateOutline(e){const i=[];for(const c of e){const f=Hs(c,this._granularity,!0),y=this._pointArrayToIndices(f),_=[];for(let T=1;T<y.length;T++)_.push(y[T-1]),_.push(y[T]);i.push(_)}return i}_handlePoles(e){let i=!1,c=!1;this._canonical&&(this._canonical.y===0&&(i=!0),this._canonical.y===(1<<this._canonical.z)-1&&(c=!0)),(i||c)&&this._fillPoles(e,i,c)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let i=0;i<e.length;i+=2){const c=e[i+1];c===$c&&(e[i+1]=-32767),c===Gc&&(e[i+1]=32766)}}_generatePoleQuad(e,i,c,f,y,_){f>y!=(_===$c)?(e.push(i),e.push(c),e.push(this._vertexToIndex(f,_)),e.push(c),e.push(this._vertexToIndex(y,_)),e.push(this._vertexToIndex(f,_))):(e.push(c),e.push(i),e.push(this._vertexToIndex(f,_)),e.push(this._vertexToIndex(y,_)),e.push(c),e.push(this._vertexToIndex(f,_)))}_fillPoles(e,i,c){const f=this._vertexBuffer,y=Be,_=e.length;for(let T=2;T<_;T+=3){const C=e[T-2],I=e[T-1],D=e[T],O=f[2*C],U=f[2*C+1],G=f[2*I],H=f[2*I+1],K=f[2*D],J=f[2*D+1];i&&(U===0&&H===0&&this._generatePoleQuad(e,C,I,O,G,$c),H===0&&J===0&&this._generatePoleQuad(e,I,D,G,K,$c),J===0&&U===0&&this._generatePoleQuad(e,D,C,K,O,$c)),c&&(U===y&&H===y&&this._generatePoleQuad(e,C,I,O,G,Gc),H===y&&J===y&&this._generatePoleQuad(e,I,D,G,K,Gc),J===y&&U===y&&this._generatePoleQuad(e,D,C,K,O,Gc))}}_initializeVertices(e){for(let i=0;i<e.length;i+=2)this._vertexToIndex(e[i],e[i+1])}subdividePolygonInternal(e,i){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:c,holeIndices:f}=(function(T){const C=[],I=[];for(const D of T)if(D.length!==0){D!==T[0]&&C.push(I.length/2);for(let O=0;O<D.length;O++)I.push(D[O].x),I.push(D[O].y)}return{flattened:I,holeIndices:C}})(e);let y;this._initializeVertices(c);try{const T=(function(I,D,O=2){const U=D&&D.length,G=U?D[0]*O:I.length;let H=vy(I,0,G,O,!0);const K=[];if(!H||H.next===H.prev)return K;let J,se,ye;if(U&&(H=(function(ae,ue,ve,Ce){const je=[];for(let ot=0,tt=ue.length;ot<tt;ot++){const ht=vy(ae,ue[ot]*Ce,ot<tt-1?ue[ot+1]*Ce:ae.length,Ce,!1);ht===ht.next&&(ht.steiner=!0),je.push(_f(ht))}je.sort(cs);for(let ot=0;ot<je.length;ot++)ve=bo(je[ot],ve);return ve})(I,D,H,O)),I.length>80*O){J=I[0],se=I[1];let ae=J,ue=se;for(let ve=O;ve<G;ve+=O){const Ce=I[ve],je=I[ve+1];Ce<J&&(J=Ce),je<se&&(se=je),Ce>ae&&(ae=Ce),je>ue&&(ue=je)}ye=Math.max(ae-J,ue-se),ye=ye!==0?32767/ye:0}return $u(H,K,O,J,se,ye,0),K})(c,f),C=this._convertIndices(c,T);y=this._subdivideTrianglesScanline(C)}catch(T){console.error(T)}let _=[];return i&&(_=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(y),{verticesFlattened:this._vertexBuffer,indicesTriangles:y,indicesLineList:_}}_convertIndices(e,i){const c=[];for(let f=0;f<i.length;f++)c.push(this._vertexToIndex(e[2*i[f]],e[2*i[f]+1]));return c}_pointArrayToIndices(e){const i=[];for(let c=0;c<e.length;c++){const f=e[c];i.push(this._vertexToIndex(f.x,f.y))}return i}}function ws(o,e,i,c=!0){return new wp(i,e).subdividePolygonInternal(o,c)}function Hs(o,e,i=!1){if(!o||o.length<1)return[];if(o.length<2)return[];const c=o[0],f=o[o.length-1],y=i&&(c.x!==f.x||c.y!==f.y);if(e<2)return y?[...o,o[0]]:[...o];const _=Math.floor(Be/e),T=[];T.push(new A(o[0].x,o[0].y));const C=o.length,I=y?C:C-1;for(let D=0;D<I;D++){const O=o[D],U=D<C-1?o[D+1]:o[0],G=O.x,H=O.y,K=U.x,J=U.y,se=G!==K,ye=H!==J;if(!se&&!ye)continue;const ae=K-G,ue=J-H,ve=Math.abs(ae),Ce=Math.abs(ue);let je=G,ot=H;for(;;){const ht=ae>0?(Math.floor(je/_)+1)*_:(Math.ceil(je/_)-1)*_,At=ue>0?(Math.floor(ot/_)+1)*_:(Math.ceil(ot/_)-1)*_,pt=Math.abs(je-ht),rt=Math.abs(ot-At),Ye=Math.abs(je-K),Bt=Math.abs(ot-J),Nt=se?pt/ve:Number.POSITIVE_INFINITY,Ut=ye?rt/Ce:Number.POSITIVE_INFINITY;if((Ye<=pt||!se)&&(Bt<=rt||!ye))break;if(Nt<Ut&&se||!ye){je=ht,ot+=ue*Nt;const Ft=new A(je,Math.round(ot));T[T.length-1].x===Ft.x&&T[T.length-1].y===Ft.y||T.push(Ft)}else{je+=ae*Ut,ot=At;const Ft=new A(Math.round(je),ot);T[T.length-1].x===Ft.x&&T[T.length-1].y===Ft.y||T.push(Ft)}}const tt=new A(K,J);T[T.length-1].x===tt.x&&T[T.length-1].y===tt.y||T.push(tt)}return T}function ga(o,e,i){if(e.length===0)throw new Error("Subdivision vertex ring is empty.");let c=0,f=o[2*e[0]];for(let C=1;C<e.length;C++){const I=o[2*e[C]];I<f&&(f=I,c=C)}const y=e.length;let _=c,T=(_+1)%y;for(;;){const C=_-1>=0?_-1:y-1,I=(T+1)%y,D=o[2*e[C]],O=o[2*e[I]],U=o[2*e[_]],G=o[2*e[_]+1],H=o[2*e[T]+1];let K=!1;if(D<O)K=!0;else if(D>O)K=!1;else{const J=H-G,se=-(o[2*e[T]]-U),ye=G<H?1:-1;((D-U)*J+(o[2*e[C]+1]-G)*se)*ye>((O-U)*J+(o[2*e[I]+1]-G)*se)*ye&&(K=!0)}if(K){const J=e[C],se=e[_],ye=e[T];J!==se&&J!==ye&&se!==ye&&i.push(ye,se,J),_--,_<0&&(_=y-1)}else{const J=e[I],se=e[_],ye=e[T];J!==se&&J!==ye&&se!==ye&&i.push(ye,se,J),T++,T>=y&&(T=0)}if(C===I)break}}function ks(o,e,i,c,f,y,_,T,C){const I=f.length/2,D=_&&T&&C;if(I<kt.MAX_VERTEX_ARRAY_LENGTH){const O=e.prepareSegment(I,i,c),U=O.vertexLength;for(let K=0;K<y.length;K+=3)c.emplaceBack(U+y[K],U+y[K+1],U+y[K+2]);let G,H;O.vertexLength+=I,O.primitiveLength+=y.length/3,D&&(H=_.prepareSegment(I,i,T),G=H.vertexLength,H.vertexLength+=I);for(let K=0;K<f.length;K+=2)o(f[K],f[K+1]);if(D)for(let K=0;K<C.length;K++){const J=C[K];for(let se=1;se<J.length;se+=2)T.emplaceBack(G+J[se-1],G+J[se]);H.primitiveLength+=J.length/2}}else(function(O,U,G,H,K,J){const se=[];for(let Ce=0;Ce<H.length/2;Ce++)se.push(-1);const ye={count:0};let ae=0,ue=O.getOrCreateLatestSegment(U,G),ve=ue.vertexLength;for(let Ce=2;Ce<K.length;Ce+=3){const je=K[Ce-2],ot=K[Ce-1],tt=K[Ce];let ht=se[je]<ae,At=se[ot]<ae,pt=se[tt]<ae;ue.vertexLength+((ht?1:0)+(At?1:0)+(pt?1:0))>kt.MAX_VERTEX_ARRAY_LENGTH&&(ue=O.createNewSegment(U,G),ae=ye.count,ht=!0,At=!0,pt=!0,ve=0);const rt=ld(se,H,J,ye,je,ht,ue),Ye=ld(se,H,J,ye,ot,At,ue),Bt=ld(se,H,J,ye,tt,pt,ue);G.emplaceBack(ve+rt-ae,ve+Ye-ae,ve+Bt-ae),ue.primitiveLength++}})(e,i,c,f,y,o),D&&(function(O,U,G,H,K,J){const se=[];for(let Ce=0;Ce<H.length/2;Ce++)se.push(-1);const ye={count:0};let ae=0,ue=O.getOrCreateLatestSegment(U,G),ve=ue.vertexLength;for(let Ce=0;Ce<K.length;Ce++){const je=K[Ce];for(let ot=1;ot<K[Ce].length;ot+=2){const tt=je[ot-1],ht=je[ot];let At=se[tt]<ae,pt=se[ht]<ae;ue.vertexLength+((At?1:0)+(pt?1:0))>kt.MAX_VERTEX_ARRAY_LENGTH&&(ue=O.createNewSegment(U,G),ae=ye.count,At=!0,pt=!0,ve=0);const rt=ld(se,H,J,ye,tt,At,ue),Ye=ld(se,H,J,ye,ht,pt,ue);G.emplaceBack(ve+rt-ae,ve+Ye-ae),ue.primitiveLength++}}})(_,i,T,f,C,o),e.forceNewSegmentOnNextPrepare(),_?.forceNewSegmentOnNextPrepare()}function ld(o,e,i,c,f,y,_){if(y){const T=c.count;return i(e[2*f],e[2*f+1]),o[f]=c.count,c.count++,_.vertexLength++,T}return o[f]}class vf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new fe,this.indexArray=new qe,this.indexArray2=new vt,this.programConfigurations=new el(e.layers,e.zoom),this.segments=new kt,this.segments2=new kt,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,c){this.hasDependencies=yf("fill",this.layers,i);const f=this.layers[0].layout.get("fill-sort-key"),y=!f.isConstant(),_=[];for(const{feature:T,id:C,index:I,sourceLayerIndex:D}of e){const O=this.layers[0]._featureFilter.needGeometry,U=fa(T,O);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),U,c))continue;const G=y?f.evaluate(U,{},c,i.availableImages):void 0,H={id:C,properties:T.properties,type:T.type,sourceLayerIndex:D,index:I,geometry:O?U.geometry:Go(T),patterns:{},sortKey:G};_.push(H)}y&&_.sort(((T,C)=>T.sortKey-C.sortKey));for(const T of _){const{geometry:C,index:I,sourceLayerIndex:D}=T;if(this.hasDependencies){const O=vp("fill",this.layers,T,{zoom:this.zoom},i);this.patternFeatures.push(O)}else this.addFeature(T,C,I,c,{},i.subdivisionGranularity);i.featureIndex.insert(e[I].feature,C,I,D,this.index)}}update(e,i,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:c})}addFeatures(e,i,c){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,i,c,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,_y),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,c,f,y,_){for(const T of _u(i,500)){const C=ws(T,f,_.fill.getGranularityForZoomLevel(f.z)),I=this.layoutVertexArray;ks(((D,O)=>{I.emplaceBack(D,O)}),this.segments,this.layoutVertexArray,this.indexArray,C.verticesFlattened,C.indicesTriangles,this.segments2,this.indexArray2,C.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,{imagePositions:y,canonical:f})}}let Tp,xy;zt("FillBucket",vf,{omit:["layers","patternFeatures"]});var qc={get paint(){return xy=xy||new Hn({"fill-antialias":new jt($e.paint_fill["fill-antialias"]),"fill-opacity":new Kt($e.paint_fill["fill-opacity"]),"fill-color":new Kt($e.paint_fill["fill-color"]),"fill-outline-color":new Kt($e.paint_fill["fill-outline-color"]),"fill-translate":new jt($e.paint_fill["fill-translate"]),"fill-translate-anchor":new jt($e.paint_fill["fill-translate-anchor"]),"fill-pattern":new Fl($e.paint_fill["fill-pattern"])})},get layout(){return Tp=Tp||new Hn({"fill-sort-key":new Kt($e.layout_fill["fill-sort-key"])})}};class by extends ys{constructor(e,i){super(e,qc,i)}recalculate(e,i){super.recalculate(e,i);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new vf(e)}queryRadius(){return df(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:i,transform:c,pixelsToTileUnits:f}){return Fm(nd(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-c.bearingInRadians,f),i)}isTileClipped(){return!0}}const qm=Gn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Gu=Gn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Zm}=qm;class ya{constructor(e,i,c,f,y){this.properties={},this.extent=c,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=f,this._values=y,e.readFields(wy,this,i)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const i=e.readVarint()+e.pos,c=[];let f,y=1,_=0,T=0,C=0;for(;e.pos<i;){if(_<=0){const I=e.readVarint();y=7&I,_=I>>3}if(_--,y===1||y===2)T+=e.readSVarint(),C+=e.readSVarint(),y===1&&(f&&c.push(f),f=[]),f&&f.push(new A(T,C));else{if(y!==7)throw new Error(`unknown command ${y}`);f&&f.push(f[0].clone())}}return f&&c.push(f),c}bbox(){const e=this._pbf;e.pos=this._geometry;const i=e.readVarint()+e.pos;let c=1,f=0,y=0,_=0,T=1/0,C=-1/0,I=1/0,D=-1/0;for(;e.pos<i;){if(f<=0){const O=e.readVarint();c=7&O,f=O>>3}if(f--,c===1||c===2)y+=e.readSVarint(),_+=e.readSVarint(),y<T&&(T=y),y>C&&(C=y),_<I&&(I=_),_>D&&(D=_);else if(c!==7)throw new Error(`unknown command ${c}`)}return[T,I,C,D]}toGeoJSON(e,i,c){const f=this.extent*Math.pow(2,c),y=this.extent*e,_=this.extent*i,T=this.loadGeometry();function C(U){return[360*(U.x+y)/f-180,360/Math.PI*Math.atan(Math.exp((1-2*(U.y+_)/f)*Math.PI))-90]}function I(U){return U.map(C)}let D;if(this.type===1){const U=[];for(const H of T)U.push(H[0]);const G=I(U);D=U.length===1?{type:"Point",coordinates:G[0]}:{type:"MultiPoint",coordinates:G}}else if(this.type===2){const U=T.map(I);D=U.length===1?{type:"LineString",coordinates:U[0]}:{type:"MultiLineString",coordinates:U}}else{if(this.type!==3)throw new Error("unknown feature type");{const U=Wm(T),G=[];for(const H of U)G.push(H.map(I));D=G.length===1?{type:"Polygon",coordinates:G[0]}:{type:"MultiPolygon",coordinates:G}}}const O={type:"Feature",geometry:D,properties:this.properties};return this.id!=null&&(O.id=this.id),O}}function wy(o,e,i){o===1?e.id=i.readVarint():o===2?(function(c,f){const y=c.readVarint()+c.pos;for(;c.pos<y;){const _=f._keys[c.readVarint()],T=f._values[c.readVarint()];f.properties[_]=T}})(i,e):o===3?e.type=i.readVarint():o===4&&(e._geometry=i.pos)}function Wm(o){const e=o.length;if(e<=1)return[o];const i=[];let c,f;for(let y=0;y<e;y++){const _=Hm(o[y]);_!==0&&(f===void 0&&(f=_<0),f===_<0?(c&&i.push(c),c=[o[y]]):c&&c.push(o[y]))}return c&&i.push(c),i}function Hm(o){let e=0;for(let i,c,f=0,y=o.length,_=y-1;f<y;_=f++)i=o[f],c=o[_],e+=(c.x-i.x)*(i.y+c.y);return e}ya.types=["Unknown","Point","LineString","Polygon"];class Sp{constructor(e,i){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(F_,this,i),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const i=this._pbf.readVarint()+this._pbf.pos;return new ya(this._pbf,i,this.extent,this._keys,this._values)}}function F_(o,e,i){o===15?e.version=i.readVarint():o===1?e.name=i.readString():o===5?e.extent=i.readVarint():o===2?e._features.push(i.pos):o===3?e._keys.push(i.readString()):o===4&&e._values.push((function(c){let f=null;const y=c.readVarint()+c.pos;for(;c.pos<y;){const _=c.readVarint()>>3;f=_===1?c.readString():_===2?c.readFloat():_===3?c.readDouble():_===4?c.readVarint64():_===5?c.readVarint():_===6?c.readSVarint():_===7?c.readBoolean():null}if(f==null)throw new Error("unknown feature value");return f})(i))}class Ty{constructor(e,i){this.layers=e.readFields(Sy,{},i)}}function Sy(o,e,i){if(o===3){const c=new Sp(i,i.readVarint()+i.pos);c.length&&(e[c.name]=c)}}const Pp=Math.pow(2,13);function _a(o,e,i,c,f,y,_,T){o.emplaceBack(e,i,2*Math.floor(c*Pp)+_,f*Pp*2,y*Pp*2,Math.round(T))}class Xm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new me,this.centroidVertexArray=new de,this.indexArray=new qe,this.programConfigurations=new el(e.layers,e.zoom),this.segments=new kt,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,c){this.features=[],this.hasDependencies=yf("fill-extrusion",this.layers,i);for(const{feature:f,id:y,index:_,sourceLayerIndex:T}of e){const C=this.layers[0]._featureFilter.needGeometry,I=fa(f,C);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),I,c))continue;const D={id:y,sourceLayerIndex:T,index:_,geometry:C?I.geometry:Go(f),properties:f.properties,type:f.type,patterns:{}};this.hasDependencies?this.features.push(vp("fill-extrusion",this.layers,D,{zoom:this.zoom},i)):this.addFeature(D,D.geometry,_,c,{},i.subdivisionGranularity),i.featureIndex.insert(f,D.geometry,_,T,this.index,!0)}}addFeatures(e,i,c){for(const f of this.features){const{geometry:y}=f;this.addFeature(f,y,f.index,i,c,e.subdivisionGranularity)}}update(e,i,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:c})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zm),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Gu.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,i,c,f,y,_){for(const T of _u(i,500)){const C={x:0,y:0,sampleCount:0},I=this.layoutVertexArray.length;this.processPolygon(C,f,e,T,_);const D=this.layoutVertexArray.length-I,O=Math.floor(C.x/C.sampleCount),U=Math.floor(C.y/C.sampleCount);for(let G=0;G<D;G++)this.centroidVertexArray.emplaceBack(O,U)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,{imagePositions:y,canonical:f})}processPolygon(e,i,c,f,y){if(f.length<1||Yn(f[0]))return;for(const O of f)O.length!==0&&cd(e,O);const _={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},T=y.fill.getGranularityForZoomLevel(i.z),C=ya.types[c.type]==="Polygon";for(const O of f){if(O.length===0||Yn(O))continue;const U=Hs(O,T,C);this._generateSideFaces(U,_)}if(!C)return;const I=ws(f,i,T,!1),D=this.layoutVertexArray;ks(((O,U)=>{_a(D,O,U,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,I.verticesFlattened,I.indicesTriangles)}_generateSideFaces(e,i){let c=0;for(let f=1;f<e.length;f++){const y=e[f],_=e[f-1];if(Py(y,_))continue;i.segment.vertexLength+4>kt.MAX_VERTEX_ARRAY_LENGTH&&(i.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const T=y.sub(_)._perp()._unit(),C=_.dist(y);c+C>32768&&(c=0),_a(this.layoutVertexArray,y.x,y.y,T.x,T.y,0,0,c),_a(this.layoutVertexArray,y.x,y.y,T.x,T.y,0,1,c),c+=C,_a(this.layoutVertexArray,_.x,_.y,T.x,T.y,0,0,c),_a(this.layoutVertexArray,_.x,_.y,T.x,T.y,0,1,c);const I=i.segment.vertexLength;this.indexArray.emplaceBack(I,I+2,I+1),this.indexArray.emplaceBack(I+1,I+2,I+3),i.segment.vertexLength+=4,i.segment.primitiveLength+=2}}}function cd(o,e){for(let i=0;i<e.length;i++){const c=e[i];i===e.length-1&&e[0].x===c.x&&e[0].y===c.y||(o.x+=c.x,o.y+=c.y,o.sampleCount++)}}function Py(o,e){return o.x===e.x&&(o.x<0||o.x>Be)||o.y===e.y&&(o.y<0||o.y>Be)}function Yn(o){return o.every((e=>e.x<0))||o.every((e=>e.x>Be))||o.every((e=>e.y<0))||o.every((e=>e.y>Be))}let Cy;zt("FillExtrusionBucket",Xm,{omit:["layers","features"]});var Ey={get paint(){return Cy=Cy||new Hn({"fill-extrusion-opacity":new jt($e["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Kt($e["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new jt($e["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new jt($e["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Fl($e["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Kt($e["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Kt($e["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new jt($e["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class O_ extends ys{constructor(e,i){super(e,Ey,i)}createBucket(e){return new Xm(e)}queryRadius(){return df(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:c,geometry:f,transform:y,pixelsToTileUnits:_,pixelPosMatrix:T}){const C=nd(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-y.bearingInRadians,_),I=this.paint.get("fill-extrusion-height").evaluate(i,c),D=this.paint.get("fill-extrusion-base").evaluate(i,c),O=(function(G,H){const K=[];for(const J of G){const se=[J.x,J.y,0,1];ft(se,se,H),K.push(new A(se[0]/se[3],se[1]/se[3]))}return K})(C,T),U=(function(G,H,K,J){const se=[],ye=[],ae=J[8]*H,ue=J[9]*H,ve=J[10]*H,Ce=J[11]*H,je=J[8]*K,ot=J[9]*K,tt=J[10]*K,ht=J[11]*K;for(const At of G){const pt=[],rt=[];for(const Ye of At){const Bt=Ye.x,Nt=Ye.y,Ut=J[0]*Bt+J[4]*Nt+J[12],Ft=J[1]*Bt+J[5]*Nt+J[13],Jt=J[2]*Bt+J[6]*Nt+J[14],$r=J[3]*Bt+J[7]*Nt+J[15],Ar=Jt+ve,qn=$r+Ce,Ps=Ut+je,Ai=Ft+ot,Zn=Jt+tt,jn=$r+ht,sn=new A((Ut+ae)/qn,(Ft+ue)/qn);sn.z=Ar/qn,pt.push(sn);const Jn=new A(Ps/jn,Ai/jn);Jn.z=Zn/jn,rt.push(Jn)}se.push(pt),ye.push(rt)}return[se,ye]})(f,D,I,T);return(function(G,H,K){let J=1/0;Fm(K,H)&&(J=Km(K,H[0]));for(let se=0;se<H.length;se++){const ye=H[se],ae=G[se];for(let ue=0;ue<ye.length-1;ue++){const ve=ye[ue],Ce=[ve,ye[ue+1],ae[ue+1],ae[ue],ve];Fc(K,Ce)&&(J=Math.min(J,Km(K,Ce)))}}return J!==1/0&&J})(U[0],U[1],O)}}function xf(o,e){return o.x*e.x+o.y*e.y}function Km(o,e){if(o.length===1){let i=0;const c=e[i++];let f;for(;!f||c.equals(f);)if(f=e[i++],!f)return 1/0;for(;i<e.length;i++){const y=e[i],_=o[0],T=f.sub(c),C=y.sub(c),I=_.sub(c),D=xf(T,T),O=xf(T,C),U=xf(C,C),G=xf(I,T),H=xf(I,C),K=D*U-O*O,J=(U*G-O*H)/K,se=(D*H-O*G)/K,ye=c.z*(1-J-se)+f.z*J+y.z*se;if(isFinite(ye))return ye}return 1/0}{let i=1/0;for(const c of e)i=Math.min(i,c.z);return i}}const My=Gn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:N_}=My,Wo=Gn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Ym}=Wo,j_=Math.cos(Math.PI/180*37.5),Wl=Math.pow(2,14)/.5;class ud{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((i=>{this.gradients[i.id]={}})),this.layoutVertexArray=new Se,this.layoutVertexArray2=new ge,this.indexArray=new qe,this.programConfigurations=new el(e.layers,e.zoom),this.segments=new kt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,c){this.hasDependencies=yf("line",this.layers,i)||this.hasLineDasharray(this.layers);const f=this.layers[0].layout.get("line-sort-key"),y=!f.isConstant(),_=[];for(const{feature:T,id:C,index:I,sourceLayerIndex:D}of e){const O=this.layers[0]._featureFilter.needGeometry,U=fa(T,O);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),U,c))continue;const G=y?f.evaluate(U,{},c):void 0,H={id:C,properties:T.properties,type:T.type,sourceLayerIndex:D,index:I,geometry:O?U.geometry:Go(T),patterns:{},dashes:{},sortKey:G};_.push(H)}y&&_.sort(((T,C)=>T.sortKey-C.sortKey));for(const T of _){const{geometry:C,index:I,sourceLayerIndex:D}=T;this.hasDependencies?(yf("line",this.layers,i)?vp("line",this.layers,T,{zoom:this.zoom},i):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,T,this.zoom,i),this.patternFeatures.push(T)):this.addFeature(T,C,I,c,{},{},i.subdivisionGranularity),i.featureIndex.insert(e[I].feature,C,I,D,this.index)}}update(e,i,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:c,dashPositions:f})}addFeatures(e,i,c,f){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,i,c,f,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Ym)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,N_),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,c,f,y,_,T){const C=this.layers[0].layout,I=C.get("line-join").evaluate(e,{}),D=C.get("line-cap"),O=C.get("line-miter-limit"),U=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const G of i)this.addLine(G,e,I,D,O,U,f,T);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,{imagePositions:y,dashPositions:_,canonical:f})}addLine(e,i,c,f,y,_,T,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=Hs(e,T?C.line.getGranularityForZoomLevel(T.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ae=0;ae<e.length-1;ae++)this.totalDistance+=e[ae].dist(e[ae+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const I=ya.types[i.type]==="Polygon";let D=e.length;for(;D>=2&&e[D-1].equals(e[D-2]);)D--;let O=0;for(;O<D-1&&e[O].equals(e[O+1]);)O++;if(D<(I?3:2))return;c==="bevel"&&(y=1.05);const U=this.overscaling<=16?122880/(512*this.overscaling):0,G=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let H,K,J,se,ye;this.e1=this.e2=-1,I&&(H=e[D-2],ye=e[O].sub(H)._unit()._perp());for(let ae=O;ae<D;ae++){if(J=ae===D-1?I?e[O+1]:void 0:e[ae+1],J&&e[ae].equals(J))continue;ye&&(se=ye),H&&(K=H),H=e[ae],ye=J?J.sub(H)._unit()._perp():se,se=se||ye;let ue=se.add(ye);ue.x===0&&ue.y===0||ue._unit();const ve=se.x*ye.x+se.y*ye.y,Ce=ue.x*ye.x+ue.y*ye.y,je=Ce!==0?1/Ce:1/0,ot=2*Math.sqrt(2-2*Ce),tt=Ce<j_&&K&&J,ht=se.x*ye.y-se.y*ye.x>0;if(tt&&ae>O){const rt=H.dist(K);if(rt>2*U){const Ye=H.sub(H.sub(K)._mult(U/rt)._round());this.updateDistance(K,Ye),this.addCurrentVertex(Ye,se,0,0,G),K=Ye}}const At=K&&J;let pt=At?c:I?"butt":f;if(At&&pt==="round"&&(je<_?pt="miter":je<=2&&(pt="fakeround")),pt==="miter"&&je>y&&(pt="bevel"),pt==="bevel"&&(je>2&&(pt="flipbevel"),je<y&&(pt="miter")),K&&this.updateDistance(K,H),pt==="miter")ue._mult(je),this.addCurrentVertex(H,ue,0,0,G);else if(pt==="flipbevel"){if(je>100)ue=ye.mult(-1);else{const rt=je*se.add(ye).mag()/se.sub(ye).mag();ue._perp()._mult(rt*(ht?-1:1))}this.addCurrentVertex(H,ue,0,0,G),this.addCurrentVertex(H,ue.mult(-1),0,0,G)}else if(pt==="bevel"||pt==="fakeround"){const rt=-Math.sqrt(je*je-1),Ye=ht?rt:0,Bt=ht?0:rt;if(K&&this.addCurrentVertex(H,se,Ye,Bt,G),pt==="fakeround"){const Nt=Math.round(180*ot/Math.PI/20);for(let Ut=1;Ut<Nt;Ut++){let Ft=Ut/Nt;if(Ft!==.5){const $r=Ft-.5;Ft+=Ft*$r*(Ft-1)*((1.0904+ve*(ve*(3.55645-1.43519*ve)-3.2452))*$r*$r+(.848013+ve*(.215638*ve-1.06021)))}const Jt=ye.sub(se)._mult(Ft)._add(se)._unit()._mult(ht?-1:1);this.addHalfVertex(H,Jt.x,Jt.y,!1,ht,0,G)}}J&&this.addCurrentVertex(H,ye,-Ye,-Bt,G)}else if(pt==="butt")this.addCurrentVertex(H,ue,0,0,G);else if(pt==="square"){const rt=K?1:-1;this.addCurrentVertex(H,ue,rt,rt,G)}else pt==="round"&&(K&&(this.addCurrentVertex(H,se,0,0,G),this.addCurrentVertex(H,se,1,1,G,!0)),J&&(this.addCurrentVertex(H,ye,-1,-1,G,!0),this.addCurrentVertex(H,ye,0,0,G)));if(tt&&ae<D-1){const rt=H.dist(J);if(rt>2*U){const Ye=H.add(J.sub(H)._mult(U/rt)._round());this.updateDistance(H,Ye),this.addCurrentVertex(Ye,ye,0,0,G),H=Ye}}}}addCurrentVertex(e,i,c,f,y,_=!1){const T=i.y*f-i.x,C=-i.y-i.x*f;this.addHalfVertex(e,i.x+i.y*c,i.y-i.x*c,_,!1,c,y),this.addHalfVertex(e,T,C,_,!0,-f,y),this.distance>Wl/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,i,c,f,y,_))}addHalfVertex({x:e,y:i},c,f,y,_,T,C){const I=.5*(this.lineClips?this.scaledDistance*(Wl-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(y?1:0),(i<<1)+(_?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(T===0?0:T<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,D,this.e2),C.primitiveLength++),_?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}hasLineDasharray(e){for(const i of e){const c=i.paint.get("line-dasharray");if(c&&!c.isConstant())return!0}return!1}addLineDashDependencies(e,i,c,f){for(const y of e){const _=y.paint.get("line-dasharray");if(!_||_.value.kind==="constant")continue;const T=y.layout.get("line-cap")==="round",C={dasharray:_.value.evaluate({zoom:c-1},i,{}),round:T},I={dasharray:_.value.evaluate({zoom:c},i,{}),round:T},D={dasharray:_.value.evaluate({zoom:c+1},i,{}),round:T},O=`${C.dasharray.join(",")},${C.round}`,U=`${I.dasharray.join(",")},${I.round}`,G=`${D.dasharray.join(",")},${D.round}`;f.dashDependencies[O]=C,f.dashDependencies[U]=I,f.dashDependencies[G]=D,i.dashes[y.id]={min:O,mid:U,max:G}}}}let Zc,bf;zt("LineBucket",ud,{omit:["layers","patternFeatures"]});var Cp={get paint(){return bf=bf||new Hn({"line-opacity":new Kt($e.paint_line["line-opacity"]),"line-color":new Kt($e.paint_line["line-color"]),"line-translate":new jt($e.paint_line["line-translate"]),"line-translate-anchor":new jt($e.paint_line["line-translate-anchor"]),"line-width":new Kt($e.paint_line["line-width"]),"line-gap-width":new Kt($e.paint_line["line-gap-width"]),"line-offset":new Kt($e.paint_line["line-offset"]),"line-blur":new Kt($e.paint_line["line-blur"]),"line-dasharray":new Fl($e.paint_line["line-dasharray"]),"line-pattern":new Fl($e.paint_line["line-pattern"]),"line-gradient":new qs($e.paint_line["line-gradient"])})},get layout(){return Zc=Zc||new Hn({"line-cap":new jt($e.layout_line["line-cap"]),"line-join":new Kt($e.layout_line["line-join"]),"line-miter-limit":new jt($e.layout_line["line-miter-limit"]),"line-round-limit":new jt($e.layout_line["line-round-limit"]),"line-sort-key":new Kt($e.layout_line["line-sort-key"])})}};class Qm extends Kt{possiblyEvaluate(e,i){return i=new rn(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(e,i)}evaluate(e,i,c,f){return i=Gt({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(e,i,c,f)}}let Ep;class Jm extends ys{constructor(e,i){super(e,Cp,i),this.gradientVersion=0,Ep||(Ep=new Qm(Cp.paint.properties["line-width"].specification),Ep.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const i=this.gradientExpression();this.stepInterpolant=!!(function(c){return c._styleExpression!==void 0})(i)&&i._styleExpression.expression instanceof Do,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,i){super.recalculate(e,i),this.paint._values["line-floorwidth"]=Ep.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new ud(e)}queryRadius(e){const i=e,c=Iy(rd("line-width",this,i),rd("line-gap-width",this,i)),f=rd("line-offset",this,i);return c/2+Math.abs(f)+df(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:c,geometry:f,transform:y,pixelsToTileUnits:_}){const T=nd(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-y.bearingInRadians,_),C=_/2*Iy(this.paint.get("line-width").evaluate(i,c),this.paint.get("line-gap-width").evaluate(i,c)),I=this.paint.get("line-offset").evaluate(i,c);return I&&(f=(function(D,O){const U=[];for(let G=0;G<D.length;G++){const H=dy(D[G]),K=[];for(let J=0;J<H.length;J++){const se=H[J],ye=H[J-1],ae=H[J+1],ue=J===0?new A(0,0):se.sub(ye)._unit()._perp(),ve=J===H.length-1?new A(0,0):ae.sub(se)._unit()._perp(),Ce=ue._add(ve)._unit(),je=Ce.x*ve.x+Ce.y*ve.y;je!==0&&Ce._mult(1/je),K.push(Ce._mult(O)._add(se))}U.push(K)}return U})(f,I*_)),(function(D,O,U){for(let G=0;G<O.length;G++){const H=O[G];if(D.length>=3){for(let K=0;K<H.length;K++)if(Ul(D,H[K]))return!0}if(Om(D,H,U))return!0}return!1})(T,f,C)}isTileClipped(){return!0}}function Iy(o,e){return e>0?e+2*o:o}const Ay=Gn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ky=Gn([{name:"a_projected_pos",components:3,type:"Float32"}],4);Gn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Mp=Gn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Gn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const wf=Gn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Dy=Gn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function eg(o,e,i){return o.sections.forEach((c=>{c.text=(function(f,y,_){const T=y.layout.get("text-transform").evaluate(_,{});return T==="uppercase"?f=f.toLocaleUpperCase():T==="lowercase"&&(f=f.toLocaleLowerCase()),oa.applyArabicShaping&&(f=oa.applyArabicShaping(f)),f})(c.text,e,i)})),o}Gn([{name:"triangle",components:3,type:"Uint16"}]),Gn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Gn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Gn([{type:"Float32",name:"offsetX"}]),Gn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Gn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var Ii=24;const hd={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},tg={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Ip={40:!0};function Ap(o,e,i,c,f,y){if("fontStack"in e){const _=i[e.fontStack],T=_&&_[o];return T?T.metrics.advance*e.scale+f:0}{const _=c[e.imageName];return _?_.displaySize[0]*e.scale*Ii/y+f:0}}function Tf(o,e,i,c){const f=Math.pow(o-e,2);return c?o<e?f/2:2*f:f+Math.abs(i)*i}function Ry(o,e,i){let c=0;return o===10&&(c-=1e4),i&&(c+=150),o!==40&&o!==65288||(c+=50),e!==41&&e!==65289||(c+=50),c}function Ly(o,e,i,c,f,y){let _=null,T=Tf(e,i,f,y);for(const C of c){const I=Tf(e-C.x,i,f,y)+C.badness;I<=T&&(_=C,T=I)}return{index:o,x:e,priorBreak:_,badness:T}}function Sf(o){return o?Sf(o.priorBreak).concat(o.index):[]}class dd{constructor(e="",i=[],c=[]){this.text=e,this.sections=i,this.sectionIndex=c,this.imageSectionID=null}static fromFeature(e,i){const c=new dd;for(let f=0;f<e.sections.length;f++){const y=e.sections[f];y.image?c.addImageSection(y):c.addTextSection(y,i)}return c}length(){return[...this.text].length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}verticalizePunctuation(){this.text=(function(e){let i="",c={premature:!0,value:void 0};const f=e[Symbol.iterator]();let y=f.next();const _=e[Symbol.iterator]();_.next();let T=_.next();for(;!y.done;)i+=!T.done&&Xa(T.value.codePointAt(0))&&!hd[T.value]||!c.premature&&Xa(c.value.codePointAt(0))&&!hd[c.value]||!hd[y.value]?y.value:hd[y.value],c={value:y.value,premature:!1},y=f.next(),T=_.next();return i})(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const e=this.text.match(/^\s*/),i=e?e[0].length:0,c=this.text.match(/\S\s*$/),f=c?c[0].length-1:0;this.text=this.text.substring(i,this.text.length-f),this.sectionIndex=this.sectionIndex.slice(i,this.sectionIndex.length-f)}substring(e,i){const c=[...this.text].slice(e,i).join(""),f=this.sectionIndex.slice(e,i);return new dd(c,this.sections,f)}toCodeUnitIndex(e){return[...this.text].slice(0,e).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,i)=>Math.max(e,this.sections[i].scale)),0)}getMaxImageSize(e){let i=0,c=0;for(let f=0;f<this.length();f++){const y=this.getSection(f);if("imageName"in y){const _=e[y.imageName];if(!_)continue;const T=_.displaySize;i=Math.max(i,T[0]),c=Math.max(c,T[1])}}return{maxImageWidth:i,maxImageHeight:c}}addTextSection(e,i){this.text+=e.text,this.sections.push({scale:e.scale||1,verticalAlign:e.verticalAlign||"bottom",fontStack:e.fontStack||i});const c=this.sections.length-1;this.sectionIndex.push(...[...e.text].map((()=>c)))}addImageSection(e){const i=e.image?e.image.name:"";if(i.length===0)return void en("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push({scale:1,verticalAlign:e.verticalAlign||"bottom",imageName:i}),this.sectionIndex.push(this.sections.length-1)):en("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(e,i,c,f,y){const _=[],T=this.determineAverageLineWidth(e,i,c,f,y),C=this.hasZeroWidthSpaces();let I=0,D=0;const O=this.text[Symbol.iterator]();let U=O.next();const G=this.text[Symbol.iterator]();G.next();let H=G.next();const K=this.text[Symbol.iterator]();K.next(),K.next();let J=K.next();for(;!U.done;){const se=this.getSection(D),ye=U.value.codePointAt(0);if(af(ye)||(I+=Ap(ye,se,c,f,e,y)),!H.done){const ae=ss(ye),ue=H.value.codePointAt(0);(tg[ye]||ae||"imageName"in se||!J.done&&Ip[ue])&&_.push(Ly(D+1,I,T,_,Ry(ye,ue,ae&&C),!1))}D++,U=O.next(),H=G.next(),J=K.next()}return Sf(Ly(this.length(),I,T,_,0,!0))}determineAverageLineWidth(e,i,c,f,y){let _=0,T=0;for(const C of this.text){const I=this.getSection(T);_+=Ap(C.codePointAt(0),I,c,f,e,y),T++}return _/Math.max(1,Math.ceil(_/i))}}const qu=4294967296,zy=1/qu,Pf=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class h{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,i,c=this.length){for(;this.pos<c;){const f=this.readVarint(),y=f>>3,_=this.pos;this.type=7&f,e(y,i,this),this.pos===_&&this.skip(f)}return i}readMessage(e,i){return this.readFields(e,i,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*qu;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*qu;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const i=this.buf;let c,f;return f=i[this.pos++],c=127&f,f<128?c:(f=i[this.pos++],c|=(127&f)<<7,f<128?c:(f=i[this.pos++],c|=(127&f)<<14,f<128?c:(f=i[this.pos++],c|=(127&f)<<21,f<128?c:(f=i[this.pos],c|=(15&f)<<28,(function(y,_,T){const C=T.buf;let I,D;if(D=C[T.pos++],I=(112&D)>>4,D<128||(D=C[T.pos++],I|=(127&D)<<3,D<128)||(D=C[T.pos++],I|=(127&D)<<10,D<128)||(D=C[T.pos++],I|=(127&D)<<17,D<128)||(D=C[T.pos++],I|=(127&D)<<24,D<128)||(D=C[T.pos++],I|=(1&D)<<31,D<128))return p(y,I,_);throw new Error("Expected varint not more than 10 bytes")})(c,e,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2==1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,i=this.pos;return this.pos=e,e-i>=12&&Pf?Pf.decode(this.buf.subarray(i,e)):(function(c,f,y){let _="",T=f;for(;T<y;){const C=c[T];let I,D,O,U=null,G=C>239?4:C>223?3:C>191?2:1;if(T+G>y)break;G===1?C<128&&(U=C):G===2?(I=c[T+1],(192&I)==128&&(U=(31&C)<<6|63&I,U<=127&&(U=null))):G===3?(I=c[T+1],D=c[T+2],(192&I)==128&&(192&D)==128&&(U=(15&C)<<12|(63&I)<<6|63&D,(U<=2047||U>=55296&&U<=57343)&&(U=null))):G===4&&(I=c[T+1],D=c[T+2],O=c[T+3],(192&I)==128&&(192&D)==128&&(192&O)==128&&(U=(15&C)<<18|(63&I)<<12|(63&D)<<6|63&O,(U<=65535||U>=1114112)&&(U=null))),U===null?(U=65533,G=1):U>65535&&(U-=65536,_+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),_+=String.fromCharCode(U),T+=G}return _})(this.buf,i,e)}readBytes(){const e=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,e);return this.pos=e,i}readPackedVarint(e=[],i){const c=this.readPackedEnd();for(;this.pos<c;)e.push(this.readVarint(i));return e}readPackedSVarint(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(e){const i=7&e;if(i===0)for(;this.buf[this.pos++]>127;);else if(i===2)this.pos=this.readVarint()+this.pos;else if(i===5)this.pos+=4;else{if(i!==1)throw new Error(`Unimplemented type: ${i}`);this.pos+=8}}writeTag(e,i){this.writeVarint(e<<3|i)}realloc(e){let i=this.length||16;for(;i<this.pos+e;)i*=2;if(i!==this.length){const c=new Uint8Array(i);c.set(this.buf),this.buf=c,this.dataView=new DataView(c.buffer),this.length=i}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*zy),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*zy),!0),this.pos+=8}writeVarint(e){(e=+e||0)>268435455||e<0?(function(i,c){let f,y;if(i>=0?(f=i%4294967296|0,y=i/4294967296|0):(f=~(-i%4294967296),y=~(-i/4294967296),4294967295^f?f=f+1|0:(f=0,y=y+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),(function(_,T,C){C.buf[C.pos++]=127&_|128,_>>>=7,C.buf[C.pos++]=127&_|128,_>>>=7,C.buf[C.pos++]=127&_|128,_>>>=7,C.buf[C.pos++]=127&_|128,C.buf[C.pos]=127&(_>>>=7)})(f,0,c),(function(_,T){const C=(7&_)<<4;T.buf[T.pos++]|=C|((_>>>=3)?128:0),_&&(T.buf[T.pos++]=127&_|((_>>>=7)?128:0),_&&(T.buf[T.pos++]=127&_|((_>>>=7)?128:0),_&&(T.buf[T.pos++]=127&_|((_>>>=7)?128:0),_&&(T.buf[T.pos++]=127&_|((_>>>=7)?128:0),_&&(T.buf[T.pos++]=127&_)))))})(y,c)})(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))}writeSVarint(e){this.writeVarint(e<0?2*-e-1:2*e)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(4*e.length),this.pos++;const i=this.pos;this.pos=(function(f,y,_){for(let T,C,I=0;I<y.length;I++){if(T=y.charCodeAt(I),T>55295&&T<57344){if(!C){T>56319||I+1===y.length?(f[_++]=239,f[_++]=191,f[_++]=189):C=T;continue}if(T<56320){f[_++]=239,f[_++]=191,f[_++]=189,C=T;continue}T=C-55296<<10|T-56320|65536,C=null}else C&&(f[_++]=239,f[_++]=191,f[_++]=189,C=null);T<128?f[_++]=T:(T<2048?f[_++]=T>>6|192:(T<65536?f[_++]=T>>12|224:(f[_++]=T>>18|240,f[_++]=T>>12&63|128),f[_++]=T>>6&63|128),f[_++]=63&T|128)}return _})(this.buf,e,this.pos);const c=this.pos-i;c>=128&&S(i,c,this),this.pos=i-1,this.writeVarint(c),this.pos+=c}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const i=e.length;this.writeVarint(i),this.realloc(i);for(let c=0;c<i;c++)this.buf[this.pos++]=e[c]}writeRawMessage(e,i){this.pos++;const c=this.pos;e(i,this);const f=this.pos-c;f>=128&&S(c,f,this),this.pos=c-1,this.writeVarint(f),this.pos+=f}writeMessage(e,i,c){this.writeTag(e,2),this.writeRawMessage(i,c)}writePackedVarint(e,i){i.length&&this.writeMessage(e,M,i)}writePackedSVarint(e,i){i.length&&this.writeMessage(e,F,i)}writePackedBoolean(e,i){i.length&&this.writeMessage(e,Pe,i)}writePackedFloat(e,i){i.length&&this.writeMessage(e,$,i)}writePackedDouble(e,i){i.length&&this.writeMessage(e,ie,i)}writePackedFixed32(e,i){i.length&&this.writeMessage(e,Le,i)}writePackedSFixed32(e,i){i.length&&this.writeMessage(e,et,i)}writePackedFixed64(e,i){i.length&&this.writeMessage(e,Tt,i)}writePackedSFixed64(e,i){i.length&&this.writeMessage(e,It,i)}writeBytesField(e,i){this.writeTag(e,2),this.writeBytes(i)}writeFixed32Field(e,i){this.writeTag(e,5),this.writeFixed32(i)}writeSFixed32Field(e,i){this.writeTag(e,5),this.writeSFixed32(i)}writeFixed64Field(e,i){this.writeTag(e,1),this.writeFixed64(i)}writeSFixed64Field(e,i){this.writeTag(e,1),this.writeSFixed64(i)}writeVarintField(e,i){this.writeTag(e,0),this.writeVarint(i)}writeSVarintField(e,i){this.writeTag(e,0),this.writeSVarint(i)}writeStringField(e,i){this.writeTag(e,2),this.writeString(i)}writeFloatField(e,i){this.writeTag(e,5),this.writeFloat(i)}writeDoubleField(e,i){this.writeTag(e,1),this.writeDouble(i)}writeBooleanField(e,i){this.writeVarintField(e,+i)}}function p(o,e,i){return i?4294967296*e+(o>>>0):4294967296*(e>>>0)+(o>>>0)}function S(o,e,i){const c=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(c);for(let f=i.pos-1;f>=o;f--)i.buf[f+c]=i.buf[f]}function M(o,e){for(let i=0;i<o.length;i++)e.writeVarint(o[i])}function F(o,e){for(let i=0;i<o.length;i++)e.writeSVarint(o[i])}function $(o,e){for(let i=0;i<o.length;i++)e.writeFloat(o[i])}function ie(o,e){for(let i=0;i<o.length;i++)e.writeDouble(o[i])}function Pe(o,e){for(let i=0;i<o.length;i++)e.writeBoolean(o[i])}function Le(o,e){for(let i=0;i<o.length;i++)e.writeFixed32(o[i])}function et(o,e){for(let i=0;i<o.length;i++)e.writeSFixed32(o[i])}function Tt(o,e){for(let i=0;i<o.length;i++)e.writeFixed64(o[i])}function It(o,e){for(let i=0;i<o.length;i++)e.writeSFixed64(o[i])}function wt(o,e,i){o===1&&i.readMessage(Xt,e)}function Xt(o,e,i){if(o===3){const{id:c,bitmap:f,width:y,height:_,left:T,top:C,advance:I}=i.readMessage(tr,{});e.push({id:c,bitmap:new od({width:y+6,height:_+6},f),metrics:{width:y,height:_,left:T,top:C,advance:I}})}}function tr(o,e,i){o===1?e.id=i.readVarint():o===2?e.bitmap=i.readBytes():o===3?e.width=i.readVarint():o===4?e.height=i.readVarint():o===5?e.left=i.readSVarint():o===6?e.top=i.readSVarint():o===7&&(e.advance=i.readVarint())}function rr(o){let e=0,i=0;for(const _ of o)e+=_.w*_.h,i=Math.max(i,_.w);o.sort(((_,T)=>T.h-_.h));const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let f=0,y=0;for(const _ of o)for(let T=c.length-1;T>=0;T--){const C=c[T];if(!(_.w>C.w||_.h>C.h)){if(_.x=C.x,_.y=C.y,y=Math.max(y,_.y+_.h),f=Math.max(f,_.x+_.w),_.w===C.w&&_.h===C.h){const I=c.pop();I&&T<c.length&&(c[T]=I)}else _.h===C.h?(C.x+=_.w,C.w-=_.w):_.w===C.w?(C.y+=_.h,C.h-=_.h):(c.push({x:C.x+_.w,y:C.y,w:C.w-_.w,h:_.h}),C.y+=_.h,C.h-=_.h);break}}return{w:f,h:y,fill:e/(f*y)||0}}class Qn{constructor(e,{pixelRatio:i,version:c,stretchX:f,stretchY:y,content:_,textFitWidth:T,textFitHeight:C}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=f,this.stretchY=y,this.content=_,this.version=c,this.textFitWidth=T,this.textFitHeight=C}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class We{constructor(e,i){const c={},f={};this.haveRenderCallbacks=[];const y=[];this.addImages(e,c,y),this.addImages(i,f,y);const{w:_,h:T}=rr(y),C=new bs({width:_||1,height:T||1});for(const I in e){const D=e[I],O=c[I].paddedRect;bs.copy(D.data,C,{x:0,y:0},{x:O.x+1,y:O.y+1},D.data)}for(const I in i){const D=i[I],O=f[I].paddedRect,U=O.x+1,G=O.y+1,H=D.data.width,K=D.data.height;bs.copy(D.data,C,{x:0,y:0},{x:U,y:G},D.data),bs.copy(D.data,C,{x:0,y:K-1},{x:U,y:G-1},{width:H,height:1}),bs.copy(D.data,C,{x:0,y:0},{x:U,y:G+K},{width:H,height:1}),bs.copy(D.data,C,{x:H-1,y:0},{x:U-1,y:G},{width:1,height:K}),bs.copy(D.data,C,{x:0,y:0},{x:U+H,y:G},{width:1,height:K})}this.image=C,this.iconPositions=c,this.patternPositions=f}addImages(e,i,c){for(const f in e){const y=e[f],_={x:0,y:0,w:y.data.width+2,h:y.data.height+2};c.push(_),i[f]=new Qn(_,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(e,i){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in e.updatedImages)this.patchUpdatedImage(this.iconPositions[c],e.getImage(c),i),this.patchUpdatedImage(this.patternPositions[c],e.getImage(c),i)}patchUpdatedImage(e,i,c){if(!e||!i||e.version===i.version)return;e.version=i.version;const[f,y]=e.tl;c.update(i.data,void 0,{x:f,y})}}var Fe;function Qe(o,e,i,c,f,y,_,T,C,I,D,O,U,G,H){const K=dd.fromFeature(o,f);let J;O===v.az.vertical&&K.verticalizePunctuation();let se=K.determineLineBreaks(I,y,e,c,G);const{processBidirectionalText:ye,processStyledBidirectionalText:ae}=oa;if(ye&&K.sections.length===1){J=[],se=se.map((je=>K.toCodeUnitIndex(je)));const Ce=ye(K.toString(),se);for(const je of Ce){const ot=[...je].map((()=>0));J.push(new dd(je,K.sections,ot))}}else if(ae){J=[],se=se.map((tt=>K.toCodeUnitIndex(tt)));let Ce=0;const je=[];for(const tt of K.text)je.push(...Array(tt.length).fill(K.sectionIndex[Ce])),Ce++;const ot=ae(K.text,je,se);for(const tt of ot){const ht=[];let At="";for(const pt of tt[0])ht.push(tt[1][At.length]),At+=pt;J.push(new dd(tt[0],K.sections,ht))}}else J=(function(Ce,je){const ot=[];let tt=0;for(const ht of je)ot.push(Ce.substring(tt,ht)),tt=ht;return tt<Ce.length()&&ot.push(Ce.substring(tt,Ce.length())),ot})(K,se);const ue=[],ve={positionedLines:ue,text:K.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:O,iconsInText:!1,verticalizable:!1};return(function(Ce,je,ot,tt,ht,At,pt,rt,Ye,Bt,Nt,Ut){let Ft=0,Jt=0,$r=0,Ar=0;const qn=rt==="right"?1:rt==="left"?0:.5,Ps=Ii/Ut;let Ai=0;for(const sn of ht){sn.trim();const Jn=sn.getMaxScale(),ci={positionedGlyphs:[],lineOffset:0};Ce.positionedLines[Ai]=ci;const Ln=ci.positionedGlyphs;let wo=0;if(!sn.length()){Jt+=At,++Ai;continue}const Cs=or(tt,sn,Ps);let To=0;for(const Ki of sn.text){const Xn=sn.getSection(To),ki=Ki.codePointAt(0),ei=mr(Ye,Nt,ki),Yi={glyph:ki,imageName:null,x:Ft,y:Jt+-17,vertical:ei,scale:1,fontStack:"",sectionIndex:sn.getSectionIndex(To),metrics:null,rect:null};let Hu;if("fontStack"in Xn){if(Hu=Tr(Xn,ki,ei,Cs,je,ot),!Hu)continue;Yi.fontStack=Xn.fontStack}else{if(Ce.iconsInText=!0,Xn.scale*=Ps,Hu=Wi(Xn,ei,Jn,Cs,tt),!Hu)continue;wo=Math.max(wo,Hu.imageOffset),Yi.imageName=Xn.imageName}const{rect:Kl,metrics:lg,baselineOffset:yd}=Hu;Yi.y+=yd,Yi.scale=Xn.scale,Yi.metrics=lg,Yi.rect=Kl,Ln.push(Yi),ei?(Ce.verticalizable=!0,Ft+=("imageName"in Xn?lg.advance:Ii)*Xn.scale+Bt):Ft+=lg.advance*Xn.scale+Bt,To++}Ln.length!==0&&($r=Math.max(Ft-Bt,$r),nn(Ln,0,Ln.length-1,qn)),Ft=0,ci.lineOffset=Math.max(wo,(Jn-1)*Ii);const nl=At*Jn+wo;Jt+=nl,Ar=Math.max(nl,Ar),++Ai}const{horizontalAlign:Zn,verticalAlign:jn}=Rt(pt);(function(sn,Jn,ci,Ln,wo,Cs,To,nl,Ki){const Xn=(Jn-ci)*wo;let ki=0;ki=Cs!==To?-nl*Ln- -17:-Ln*Ki*To+.5*To;for(const ei of sn)for(const Yi of ei.positionedGlyphs)Yi.x+=Xn,Yi.y+=ki})(Ce.positionedLines,qn,Zn,jn,$r,Ar,At,Jt,ht.length),Ce.top+=-jn*Jt,Ce.bottom=Ce.top+Jt,Ce.left+=-Zn*$r,Ce.right=Ce.left+$r})(ve,e,i,c,J,_,T,C,O,I,U,H),!(function(Ce){for(const je of Ce)if(je.positionedGlyphs.length!==0)return!1;return!0})(ue)&&ve}function Rt(o){let e=.5,i=.5;switch(o){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function or(o,e,i){const c=e.getMaxScale()*Ii,{maxImageWidth:f,maxImageHeight:y}=e.getMaxImageSize(o),_=Math.max(c,y*i);return{verticalLineContentWidth:Math.max(c,f*i),horizontalLineContentHeight:_}}function dr(o){switch(o){case"top":return 0;case"center":return .5;default:return 1}}function mr(o,e,i){return!(o===v.az.horizontal||!e&&!qh(i)||e&&(af(i)||(c=i,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(c)))));var c}function Tr(o,e,i,c,f,y){const _=y[o.fontStack],T=(function(I,D,O,U){if(I&&I.rect)return I;const G=D[O.fontStack],H=G&&G[U];return H?{rect:null,metrics:H.metrics}:null})(_&&_[e],f,o,e);if(T===null)return null;let C;if(i)C=c.verticalLineContentWidth-o.scale*Ii;else{const I=dr(o.verticalAlign);C=(c.horizontalLineContentHeight-o.scale*Ii)*I}return{rect:T.rect,metrics:T.metrics,baselineOffset:C}}function Wi(o,e,i,c,f){const y=f[o.imageName];if(!y)return null;const _=y.paddedRect,T=y.displaySize,C={width:T[0],height:T[1],left:1,top:-3,advance:e?T[1]:T[0]};let I;if(e)I=c.verticalLineContentWidth-T[1]*o.scale;else{const D=dr(o.verticalAlign);I=(c.horizontalLineContentHeight-T[1]*o.scale)*D}return{rect:_,metrics:C,baselineOffset:I,imageOffset:(e?T[0]:T[1])*o.scale-Ii*i}}function nn(o,e,i,c){if(c===0)return;const f=o[i],y=(o[i].x+f.metrics.advance*f.scale)*c;for(let _=e;_<=i;_++)o[_].x-=y}function Wc(o,e,i){const{horizontalAlign:c,verticalAlign:f}=Rt(i),y=e[0]-o.displaySize[0]*c,_=e[1]-o.displaySize[1]*f;return{image:o,top:_,bottom:_+o.displaySize[1],left:y,right:y+o.displaySize[0]}}function Fy(o){var e,i;let c=o.left,f=o.top,y=o.right-c,_=o.bottom-f;const T=(e=o.image.textFitWidth)!==null&&e!==void 0?e:"stretchOrShrink",C=(i=o.image.textFitHeight)!==null&&i!==void 0?i:"stretchOrShrink",I=(o.image.content[2]-o.image.content[0])/(o.image.content[3]-o.image.content[1]);if(C==="proportional"){if(T==="stretchOnly"&&y/_<I||T==="proportional"){const D=Math.ceil(_*I);c*=D/y,y=D}}else if(T==="proportional"&&C==="stretchOnly"&&I!==0&&y/_>I){const D=Math.ceil(y/I);f*=D/_,_=D}return{x1:c,y1:f,x2:c+y,y2:f+_}}function Q2(o,e,i,c,f,y){const _=o.image;let T;if(_.content){const J=_.content,se=_.pixelRatio||1;T=[J[0]/se,J[1]/se,_.displaySize[0]-J[2]/se,_.displaySize[1]-J[3]/se]}const C=e.left*y,I=e.right*y;let D,O,U,G;i==="width"||i==="both"?(G=f[0]+C-c[3],O=f[0]+I+c[1]):(G=f[0]+(C+I-_.displaySize[0])/2,O=G+_.displaySize[0]);const H=e.top*y,K=e.bottom*y;return i==="height"||i==="both"?(D=f[1]+H-c[0],U=f[1]+K+c[2]):(D=f[1]+(H+K-_.displaySize[1])/2,U=D+_.displaySize[1]),{image:_,top:D,right:O,bottom:U,left:G,collisionPadding:T}}zt("ImagePosition",Qn),zt("ImageAtlas",We),v.az=void 0,(Fe=v.az||(v.az={}))[Fe.none=0]="none",Fe[Fe.horizontal=1]="horizontal",Fe[Fe.vertical=2]="vertical",Fe[Fe.horizontalOnly=3]="horizontalOnly";const Zu=128,fd=32640;function J2(o,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new rn(o+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:f}=i;let y=0;for(;y<c.length&&c[y]<=o;)y++;y=Math.max(0,y-1);let _=y;for(;_<c.length&&c[_]<o+1;)_++;_=Math.min(c.length-1,_);const T=c[y],C=c[_];return i.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:C,interpolationType:f}:{kind:"camera",minZoom:T,maxZoom:C,minSize:i.evaluate(new rn(T)),maxSize:i.evaluate(new rn(C)),interpolationType:f}}}function B_(o,e,i){let c="never";const f=o.get(e);return f?c=f:o.get(i)&&(c="always"),c}const bP=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Oy(o,e,i,c,f,y,_,T,C,I,D,O,U){const G=T?Math.min(fd,Math.round(T[0])):0,H=T?Math.min(fd,Math.round(T[1])):0;o.emplaceBack(e,i,Math.round(32*c),Math.round(32*f),y,_,(G<<1)+(C?1:0),H,16*I,16*D,256*O,256*U)}function V_(o,e,i){o.emplaceBack(e.x,e.y,i),o.emplaceBack(e.x,e.y,i),o.emplaceBack(e.x,e.y,i),o.emplaceBack(e.x,e.y,i)}function wP(o){for(const e of o.sections)if(Fu(e.text))return!0;return!1}class U_{constructor(e){this.layoutVertexArray=new be,this.indexArray=new qe,this.programConfigurations=e,this.segments=new kt,this.dynamicLayoutVertexArray=new ze,this.opacityVertexArray=new Ke,this.hasVisibleVertices=!1,this.placedSymbolArray=new P}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,i,c,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ay.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,ky.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,bP,!0),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}zt("SymbolBuffers",U_);class $_{constructor(e,i,c){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new c,this.segments=new kt,this.collisionVertexArray=new Ge}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Mp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}zt("CollisionBuffers",$_);class kp{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((_=>_.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=J2(this.zoom,i["text-size"]),this.iconSizeData=J2(this.zoom,i["icon-size"]);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),y=c.get("symbol-z-order");this.canOverlap=B_(c,"text-overlap","text-allow-overlap")!=="never"||B_(c,"icon-overlap","icon-allow-overlap")!=="never"||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,c.get("symbol-placement")==="point"&&(this.writingModes=c.get("text-writing-mode").map((_=>v.az[_]))),this.stateDependentLayerIds=this.layers.filter((_=>_.isStateDependent())).map((_=>_.id)),this.sourceID=e.sourceID}createArrays(){this.text=new U_(new el(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new U_(new el(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new z,this.lineVertexArray=new N,this.symbolInstances=new k,this.textAnchorOffsets=new q}calculateGlyphDependencies(e,i,c,f,y){for(const _ of e)if(i[_.codePointAt(0)]=!0,(c||f)&&y){const T=hd[_];T&&(i[T.codePointAt(0)]=!0)}}populate(e,i,c){const f=this.layers[0],y=f.layout,_=y.get("text-font"),T=y.get("text-field"),C=y.get("icon-image"),I=(T.value.kind!=="constant"||T.value.value instanceof wi&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),D=C.value.kind!=="constant"||!!C.value.value||Object.keys(C.parameters).length>0,O=y.get("symbol-sort-key");if(this.features=[],!I&&!D)return;const U=i.iconDependencies,G=i.glyphDependencies,H=i.availableImages,K=new rn(this.zoom);for(const{feature:J,id:se,index:ye,sourceLayerIndex:ae}of e){const ue=f._featureFilter.needGeometry,ve=fa(J,ue);if(!f._featureFilter.filter(K,ve,c))continue;let Ce,je;if(ue||(ve.geometry=Go(J)),I){const tt=f.getValueAndResolveTokens("text-field",ve,c,H),ht=wi.factory(tt),At=this.hasRTLText=this.hasRTLText||wP(ht);(!At||oa.getRTLTextPluginStatus()==="unavailable"||At&&oa.isParsed())&&(Ce=eg(ht,f,ve))}if(D){const tt=f.getValueAndResolveTokens("icon-image",ve,c,H);je=tt instanceof fs?tt:fs.fromString(tt)}if(!Ce&&!je)continue;const ot=this.sortFeaturesByKey?O.evaluate(ve,{},c):void 0;if(this.features.push({id:se,text:Ce,icon:je,index:ye,sourceLayerIndex:ae,geometry:ve.geometry,properties:J.properties,type:ya.types[J.type],sortKey:ot}),je&&(U[je.name]=!0),Ce){const tt=_.evaluate(ve,{},c).join(","),ht=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(v.az.vertical)>=0;for(const At of Ce.sections)if(At.image)U[At.image.name]=!0;else{const pt=Ha(Ce.toString()),rt=At.fontStack||tt,Ye=G[rt]=G[rt]||{};this.calculateGlyphDependencies(At.text,Ye,ht,this.allowVerticalPlacement,pt)}}}y.get("symbol-placement")==="line"&&(this.features=(function(J){const se={},ye={},ae=[];let ue=0;function ve(tt){ae.push(J[tt]),ue++}function Ce(tt,ht,At){const pt=ye[tt];return delete ye[tt],ye[ht]=pt,ae[pt].geometry[0].pop(),ae[pt].geometry[0]=ae[pt].geometry[0].concat(At[0]),pt}function je(tt,ht,At){const pt=se[ht];return delete se[ht],se[tt]=pt,ae[pt].geometry[0].shift(),ae[pt].geometry[0]=At[0].concat(ae[pt].geometry[0]),pt}function ot(tt,ht,At){const pt=At?ht[0][ht[0].length-1]:ht[0][0];return`${tt}:${pt.x}:${pt.y}`}for(let tt=0;tt<J.length;tt++){const ht=J[tt],At=ht.geometry,pt=ht.text?ht.text.toString():null;if(!pt){ve(tt);continue}const rt=ot(pt,At),Ye=ot(pt,At,!0);if(rt in ye&&Ye in se&&ye[rt]!==se[Ye]){const Bt=je(rt,Ye,At),Nt=Ce(rt,Ye,ae[Bt].geometry);delete se[rt],delete ye[Ye],ye[ot(pt,ae[Nt].geometry,!0)]=Nt,ae[Bt].geometry=null}else rt in ye?Ce(rt,Ye,At):Ye in se?je(rt,Ye,At):(ve(tt),se[rt]=ue-1,ye[Ye]=ue-1)}return ae.filter((tt=>tt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((J,se)=>J.sortKey-se.sortKey))}update(e,i,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,{imagePositions:c}),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,{imagePositions:c}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const c=this.lineVertexArray.length;if(e.segment!==void 0){let f=e.dist(i[e.segment+1]),y=e.dist(i[e.segment]);const _={};for(let T=e.segment+1;T<i.length;T++)_[T]={x:i[T].x,y:i[T].y,tileUnitDistanceFromAnchor:f},T<i.length-1&&(f+=i[T+1].dist(i[T]));for(let T=e.segment||0;T>=0;T--)_[T]={x:i[T].x,y:i[T].y,tileUnitDistanceFromAnchor:y},T>0&&(y+=i[T-1].dist(i[T]));for(let T=0;T<i.length;T++){const C=_[T];this.lineVertexArray.emplaceBack(C.x,C.y,C.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(e,i,c,f,y,_,T,C,I,D,O,U){const G=e.indexArray,H=e.layoutVertexArray,K=e.segments.prepareSegment(4*i.length,H,G,this.canOverlap?_.sortKey:void 0),J=this.glyphOffsetArray.length,se=K.vertexLength,ye=this.allowVerticalPlacement&&T===v.az.vertical?Math.PI/2:0,ae=_.text&&_.text.sections;for(let ue=0;ue<i.length;ue++){const{tl:ve,tr:Ce,bl:je,br:ot,tex:tt,pixelOffsetTL:ht,pixelOffsetBR:At,minFontScaleX:pt,minFontScaleY:rt,glyphOffset:Ye,isSDF:Bt,sectionIndex:Nt}=i[ue],Ut=K.vertexLength,Ft=Ye[1];Oy(H,C.x,C.y,ve.x,Ft+ve.y,tt.x,tt.y,c,Bt,ht.x,ht.y,pt,rt),Oy(H,C.x,C.y,Ce.x,Ft+Ce.y,tt.x+tt.w,tt.y,c,Bt,At.x,ht.y,pt,rt),Oy(H,C.x,C.y,je.x,Ft+je.y,tt.x,tt.y+tt.h,c,Bt,ht.x,At.y,pt,rt),Oy(H,C.x,C.y,ot.x,Ft+ot.y,tt.x+tt.w,tt.y+tt.h,c,Bt,At.x,At.y,pt,rt),V_(e.dynamicLayoutVertexArray,C,ye),G.emplaceBack(Ut,Ut+2,Ut+1),G.emplaceBack(Ut+1,Ut+2,Ut+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ye[0]),ue!==i.length-1&&Nt===i[ue+1].sectionIndex||e.programConfigurations.populatePaintArrays(H.length,_,_.index,{imagePositions:{},canonical:U,formattedSection:ae&&ae[Nt]})}e.placedSymbolArray.emplaceBack(C.x,C.y,J,this.glyphOffsetArray.length-J,se,I,D,C.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],T,0,!1,0,O)}_addCollisionDebugVertex(e,i,c,f,y,_){return i.emplaceBack(0,0),e.emplaceBack(c.x,c.y,f,y,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(e,i,c,f,y,_,T){const C=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),I=C.vertexLength,D=y.layoutVertexArray,O=y.collisionVertexArray,U=T.anchorX,G=T.anchorY;this._addCollisionDebugVertex(D,O,_,U,G,new A(e,i)),this._addCollisionDebugVertex(D,O,_,U,G,new A(c,i)),this._addCollisionDebugVertex(D,O,_,U,G,new A(c,f)),this._addCollisionDebugVertex(D,O,_,U,G,new A(e,f)),C.vertexLength+=4;const H=y.indexArray;H.emplaceBack(I,I+1),H.emplaceBack(I+1,I+2),H.emplaceBack(I+2,I+3),H.emplaceBack(I+3,I),C.primitiveLength+=4}addDebugCollisionBoxes(e,i,c,f){for(let y=e;y<i;y++){const _=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,f?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,c)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new $_(Ve,wf.members,vt),this.iconCollisionBox=new $_(Ve,wf.members,vt);for(let e=0;e<this.symbolInstances.length;e++){const i=this.symbolInstances.get(e);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}}_deserializeCollisionBoxesForSymbol(e,i,c,f,y,_,T,C,I){const D={};for(let O=i;O<c;O++){const U=e.get(O);D.textBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.textFeatureIndex=U.featureIndex;break}for(let O=f;O<y;O++){const U=e.get(O);D.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.verticalTextFeatureIndex=U.featureIndex;break}for(let O=_;O<T;O++){const U=e.get(O);D.iconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.iconFeatureIndex=U.featureIndex;break}for(let O=C;O<I;O++){const U=e.get(O);D.verticalIconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.verticalIconFeatureIndex=U.featureIndex;break}return D}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const c=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const c=e.placedSymbolArray.get(i),f=c.vertexStartIndex+4*c.numGlyphs;for(let y=c.vertexStartIndex;y<f;y+=4)e.indexArray.emplaceBack(y,y+2,y+1),e.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),c=Math.cos(e),f=[],y=[],_=[];for(let T=0;T<this.symbolInstances.length;++T){_.push(T);const C=this.symbolInstances.get(T);f.push(0|Math.round(i*C.anchorX+c*C.anchorY)),y.push(C.featureIndex)}return _.sort(((T,C)=>f[T]-f[C]||y[C]-y[T])),_}addToSortKeyRanges(e,i){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===i?c.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const c=this.symbolInstances.get(i);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach(((f,y,_)=>{f>=0&&_.indexOf(f)===y&&this.addIndicesForPlacedSymbol(this.text,f)})),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let e3,t3;zt("SymbolBucket",kp,{omit:["layers","collisionBoxArray","features","compareText"]}),kp.MAX_GLYPHS=65535,kp.addDynamicAttributes=V_;var G_={get paint(){return t3=t3||new Hn({"icon-opacity":new Kt($e.paint_symbol["icon-opacity"]),"icon-color":new Kt($e.paint_symbol["icon-color"]),"icon-halo-color":new Kt($e.paint_symbol["icon-halo-color"]),"icon-halo-width":new Kt($e.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Kt($e.paint_symbol["icon-halo-blur"]),"icon-translate":new jt($e.paint_symbol["icon-translate"]),"icon-translate-anchor":new jt($e.paint_symbol["icon-translate-anchor"]),"text-opacity":new Kt($e.paint_symbol["text-opacity"]),"text-color":new Kt($e.paint_symbol["text-color"],{runtimeType:ds,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new Kt($e.paint_symbol["text-halo-color"]),"text-halo-width":new Kt($e.paint_symbol["text-halo-width"]),"text-halo-blur":new Kt($e.paint_symbol["text-halo-blur"]),"text-translate":new jt($e.paint_symbol["text-translate"]),"text-translate-anchor":new jt($e.paint_symbol["text-translate-anchor"])})},get layout(){return e3=e3||new Hn({"symbol-placement":new jt($e.layout_symbol["symbol-placement"]),"symbol-spacing":new jt($e.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new jt($e.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Kt($e.layout_symbol["symbol-sort-key"]),"symbol-z-order":new jt($e.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new jt($e.layout_symbol["icon-allow-overlap"]),"icon-overlap":new jt($e.layout_symbol["icon-overlap"]),"icon-ignore-placement":new jt($e.layout_symbol["icon-ignore-placement"]),"icon-optional":new jt($e.layout_symbol["icon-optional"]),"icon-rotation-alignment":new jt($e.layout_symbol["icon-rotation-alignment"]),"icon-size":new Kt($e.layout_symbol["icon-size"]),"icon-text-fit":new jt($e.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new jt($e.layout_symbol["icon-text-fit-padding"]),"icon-image":new Kt($e.layout_symbol["icon-image"]),"icon-rotate":new Kt($e.layout_symbol["icon-rotate"]),"icon-padding":new Kt($e.layout_symbol["icon-padding"]),"icon-keep-upright":new jt($e.layout_symbol["icon-keep-upright"]),"icon-offset":new Kt($e.layout_symbol["icon-offset"]),"icon-anchor":new Kt($e.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new jt($e.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new jt($e.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new jt($e.layout_symbol["text-rotation-alignment"]),"text-field":new Kt($e.layout_symbol["text-field"]),"text-font":new Kt($e.layout_symbol["text-font"]),"text-size":new Kt($e.layout_symbol["text-size"]),"text-max-width":new Kt($e.layout_symbol["text-max-width"]),"text-line-height":new jt($e.layout_symbol["text-line-height"]),"text-letter-spacing":new Kt($e.layout_symbol["text-letter-spacing"]),"text-justify":new Kt($e.layout_symbol["text-justify"]),"text-radial-offset":new Kt($e.layout_symbol["text-radial-offset"]),"text-variable-anchor":new jt($e.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Kt($e.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Kt($e.layout_symbol["text-anchor"]),"text-max-angle":new jt($e.layout_symbol["text-max-angle"]),"text-writing-mode":new jt($e.layout_symbol["text-writing-mode"]),"text-rotate":new Kt($e.layout_symbol["text-rotate"]),"text-padding":new jt($e.layout_symbol["text-padding"]),"text-keep-upright":new jt($e.layout_symbol["text-keep-upright"]),"text-transform":new Kt($e.layout_symbol["text-transform"]),"text-offset":new Kt($e.layout_symbol["text-offset"]),"text-allow-overlap":new jt($e.layout_symbol["text-allow-overlap"]),"text-overlap":new jt($e.layout_symbol["text-overlap"]),"text-ignore-placement":new jt($e.layout_symbol["text-ignore-placement"]),"text-optional":new jt($e.layout_symbol["text-optional"])})}};class r3{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Ls,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}zt("FormatSectionOverride",r3,{omit:["defaultValue"]});class Ny extends ys{constructor(e,i){super(e,G_,i)}recalculate(e,i){if(super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const y of c)f.indexOf(y)<0&&f.push(y);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,i,c,f){const y=this.layout.get(e).evaluate(i,{},c,f),_=this._unevaluatedLayout._values[e];return _.isDataDriven()||Cl(_.value)||!y?y:(function(T,C){return C.replace(/{([^{}]+)}/g,((I,D)=>T&&D in T?String(T[D]):""))})(i.properties,y)}createBucket(e){return new kp(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of G_.paint.overridableProperties){if(!Ny.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),c=new r3(i),f=new Pl(c,i.property.specification);let y=null;y=i.value.kind==="constant"||i.value.kind==="source"?new ja("source",f):new Ic("composite",f,i.value.zoomStops),this.paint._values[e]=new As(i.property,y,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,c){return!(!this.layout||i.isDataDriven()||c.isDataDriven())&&Ny.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const c=e.get("text-field"),f=G_.paint.properties[i];let y=!1;const _=T=>{for(const C of T)if(f.overrides&&f.overrides.hasOverride(C))return void(y=!0)};if(c.value.kind==="constant"&&c.value.value instanceof wi)_(c.value.value.sections);else if(c.value.kind==="source"||c.value.kind==="composite"){const T=I=>{y||(I instanceof ns&&bn(I.value)===dc?_(I.value.sections):I instanceof gu?_(I.sections):I.eachChild(T))},C=c.value;C._styleExpression&&T(C._styleExpression.expression)}return y}}let n3;var TP={get paint(){return n3=n3||new Hn({"background-color":new jt($e.paint_background["background-color"]),"background-pattern":new Ou($e.paint_background["background-pattern"]),"background-opacity":new jt($e.paint_background["background-opacity"])})}};class SP extends ys{constructor(e,i){super(e,TP,i)}}class PP extends ys{constructor(e,i){super(e,{},i),this.onAdd=c=>{this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)},this.onRemove=c=>{this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class CP{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const EP={once:!0},q_=63710088e-1;class pd{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new pd(St(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,c=this.lat*i,f=e.lat*i,y=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((e.lng-this.lng)*i);return q_*Math.acos(Math.min(y,1))}static convert(e){if(e instanceof pd)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new pd(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new pd(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const i3=2*Math.PI*q_;function s3(o){return i3*Math.cos(o*Math.PI/180)}function o3(o){return(180+o)/360}function a3(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function l3(o,e){return o/s3(e)}function c3(o){return 360*o-180}function jy(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function u3(o,e){return o*s3(jy(e))}class rg{constructor(e,i,c=0){this.x=+e,this.y=+i,this.z=+c}static fromLngLat(e,i=0){const c=pd.convert(e);return new rg(o3(c.lng),a3(c.lat),l3(i,c.lat))}toLngLat(){return new pd(c3(this.x),jy(this.y))}toAltitude(){return u3(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/i3*(e=jy(this.y),1/Math.cos(e*Math.PI/180));var e}}function h3(o,e,i){var c=2*Math.PI*6378137/256/Math.pow(2,i);return[o*c-2*Math.PI*6378137/2,e*c-2*Math.PI*6378137/2]}class Z_{constructor(e,i,c){if(!(function(f,y,_){return!(f<0||f>25||_<0||_>=Math.pow(2,f)||y<0||y>=Math.pow(2,f))})(e,i,c))throw new Error(`x=${i}, y=${c}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=i,this.y=c,this.key=Dp(0,e,e,i,c)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i,c){const f=(function(_,T,C){var I=h3(256*_,256*(T=Math.pow(2,C)-T-1),C),D=h3(256*(_+1),256*(T+1),C);return I[0]+","+I[1]+","+D[0]+","+D[1]})(this.x,this.y,this.z),y=(function(_,T,C){let I,D="";for(let O=_;O>0;O--)I=1<<O-1,D+=(T&I?1:0)+(C&I?2:0);return D})(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,i>1?"@2x":"").replace(/{quadkey}/g,y).replace(/{bbox-epsg-3857}/g,f)}isChildOf(e){const i=this.z-e.z;return i>0&&e.x===this.x>>i&&e.y===this.y>>i}getTilePoint(e){const i=Math.pow(2,this.z);return new A((e.x*i-this.x)*Be,(e.y*i-this.y)*Be)}toString(){return`${this.z}/${this.x}/${this.y}`}}class d3{constructor(e,i){this.wrap=e,this.canonical=i,this.key=Dp(e,i.z,i.z,i.x,i.y)}}class va{constructor(e,i,c,f,y){if(this.terrainRttPosMatrix32f=null,e<c)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${c}`);this.overscaledZ=e,this.wrap=i,this.canonical=new Z_(c,+f,+y),this.key=Dp(i,e,c,f,y)}clone(){return new va(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-e;return e>this.canonical.z?new va(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new va(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(e,i){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-e;return e>this.canonical.z?Dp(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y):Dp(this.wrap*+i,e,e,this.canonical.x>>c,this.canonical.y>>c)}isChildOf(e){if(e.wrap!==this.wrap||this.overscaledZ-e.overscaledZ<=0)return!1;if(e.overscaledZ===0)return this.overscaledZ>0;const i=this.canonical.z-e.canonical.z;return!(i<0)&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new va(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new va(i,this.wrap,i,c,f),new va(i,this.wrap,i,c+1,f),new va(i,this.wrap,i,c,f+1),new va(i,this.wrap,i,c+1,f+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new va(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new va(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new d3(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new rg(e.x-this.wrap,e.y))}}function Dp(o,e,i,c,f){(o*=2)<0&&(o=-1*o-1);const y=1<<i;return(y*y*o+y*f+c).toString(36)+i.toString(36)+e.toString(36)}function W_(o,e){return e?o.properties[e]:o.id}function MP(o,e){const i={id:o.id};if(e.removeAllProperties&&(delete o.removeProperties,delete o.addOrUpdateProperties,delete e.removeProperties),e.removeProperties)for(const c of e.removeProperties){const f=o.addOrUpdateProperties.findIndex((y=>y.key===c));f>-1&&o.addOrUpdateProperties.splice(f,1)}return(o.removeAllProperties||e.removeAllProperties)&&(i.removeAllProperties=!0),(o.removeProperties||e.removeProperties)&&(i.removeProperties=[...o.removeProperties||[],...e.removeProperties||[]]),(o.addOrUpdateProperties||e.addOrUpdateProperties)&&(i.addOrUpdateProperties=[...o.addOrUpdateProperties||[],...e.addOrUpdateProperties||[]]),(o.newGeometry||e.newGeometry)&&(i.newGeometry=e.newGeometry||o.newGeometry),i}function f3(o){var e,i;if(!o)return{};const c={};return c.removeAll=o.removeAll,c.remove=new Set(o.remove||[]),c.add=new Map((e=o.add)===null||e===void 0?void 0:e.map((f=>[f.id,f]))),c.update=new Map((i=o.update)===null||i===void 0?void 0:i.map((f=>[f.id,f]))),c}zt("CanonicalTileID",Z_),zt("OverscaledTileID",va,{omit:["terrainRttPosMatrix32f"]});class Cf{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(e){return this.minX=Math.min(this.minX,e.x),this.minY=Math.min(this.minY,e.y),this.maxX=Math.max(this.maxX,e.x),this.maxY=Math.max(this.maxY,e.y),this}expandBy(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(e){return this.expandBy(-e)}map(e){const i=new Cf;return i.extend(e(new A(this.minX,this.minY))),i.extend(e(new A(this.maxX,this.minY))),i.extend(e(new A(this.minX,this.maxY))),i.extend(e(new A(this.maxX,this.maxY))),i}static fromPoints(e){const i=new Cf;for(const c of e)i.extend(c);return i}contains(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(e){return!this.empty()&&!e.empty()&&e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY}intersects(e){return!this.empty()&&!e.empty()&&e.minX<=this.maxX&&e.maxX>=this.minX&&e.minY<=this.maxY&&e.maxY>=this.minY}}class p3{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const c=e[i];this._stringToNumber[c]=i,this._numberToString[i]=c}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class m3{constructor(e,i,c,f,y){this.type="Feature",this._vectorTileFeature=e,this._x=c,this._y=f,this._z=i,this.properties=e.properties,this.id=y}projectPoint(e,i,c,f){return[360*(e.x+i)/f-180,360/Math.PI*Math.atan(Math.exp((1-2*(e.y+c)/f)*Math.PI))-90]}projectLine(e,i,c,f){return e.map((y=>this.projectPoint(y,i,c,f)))}get geometry(){if(this._geometry)return this._geometry;const e=this._vectorTileFeature,i=e.extent*Math.pow(2,this._z),c=e.extent*this._x,f=e.extent*this._y,y=e.loadGeometry();switch(e.type){case 1:{const _=[];for(const C of y)_.push(C[0]);const T=this.projectLine(_,c,f,i);this._geometry=_.length===1?{type:"Point",coordinates:T[0]}:{type:"MultiPoint",coordinates:T};break}case 2:{const _=y.map((T=>this.projectLine(T,c,f,i)));this._geometry=_.length===1?{type:"LineString",coordinates:_[0]}:{type:"MultiLineString",coordinates:_};break}case 3:{const _=Wm(y),T=[];for(const C of _)T.push(C.map((I=>this.projectLine(I,c,f,i))));this._geometry=T.length===1?{type:"Polygon",coordinates:T[0]}:{type:"MultiPolygon",coordinates:T};break}default:throw new Error(`unknown feature type: ${e.type}`)}return this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&i!=="_x"&&i!=="_y"&&i!=="_z"&&(e[i]=this[i]);return e}}class Rp{_name;dataBuffer;nullabilityBuffer;_size;constructor(e,i,c){this._name=e,this.dataBuffer=i,typeof c=="number"?this._size=c:(this.nullabilityBuffer=c,this._size=c.size())}getValue(e){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(e)?null:this.getValueFromBuffer(e)}has(e){return this.nullabilityBuffer&&this.nullabilityBuffer.get(e)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class By extends Rp{}class H_ extends By{getValueFromBuffer(e){return this.dataBuffer[e]}}class X_ extends By{getValueFromBuffer(e){return this.dataBuffer[e]}}class g3 extends Rp{delta;constructor(e,i,c,f){super(e,i,f),this.delta=c}}class K_ extends g3{constructor(e,i,c,f){super(e,Int32Array.of(i),c,f)}getValueFromBuffer(e){return this.dataBuffer[0]+e*this.delta}}class Y_ extends Rp{constructor(e,i,c){super(e,Int32Array.of(i),c)}getValueFromBuffer(e){return this.dataBuffer[0]}}class IP{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(e,i,c,f,y=4096){this._name=e,this._geometryVector=i,this._idVector=c,this._propertyVectors=f,this._extent=y}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(e){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((i=>[i.name,i])))),this.propertyVectorsMap.get(e)}*[Symbol.iterator](){const e=this.geometryVector[Symbol.iterator]();let i=0;for(;i<this.numFeatures;){let c;this.idVector&&(c=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(i)):this.idVector.getValue(i));const f=e?.next().value,y={};for(const _ of this.propertyVectors){if(!_)continue;const T=_.name,C=_.getValue(i);C!==null&&(y[T]=C)}i++,yield{id:c,geometry:f,properties:y}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const e=[],i=this.geometryVector.getGeometries();for(let c=0;c<this.numFeatures;c++){let f;this.idVector&&(f=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(c)):this.idVector.getValue(c));const y={coordinates:i[c],type:this.geometryVector.geometryType(c)},_={};for(const T of this.propertyVectors){if(!T)continue;const C=T.name,I=T.getValue(c);I!==null&&(_[C]=I)}e.push({id:f,geometry:y,properties:_})}return e}containsMaxSaveIntegerValues(e){return e instanceof H_||e instanceof Y_&&e instanceof K_||e instanceof X_}}class AP{value;constructor(e){this.value=e}get(){return this.value}set(e){this.value=e}increment(){return this.value++}add(e){this.value+=e}}var Dr,Wu,Ts,Hl,Ef,Ho,Hi,Xi,y3,xa;function us(o,e,i){const c=new Int32Array(i);let f=0,y=e.get();for(let _=0;_<c.length;_++){let T=o[y++],C=127&T;T<128||(T=o[y++],C|=(127&T)<<7,T<128||(T=o[y++],C|=(127&T)<<14,T<128||(T=o[y++],C|=(127&T)<<21,T<128||(T=o[y++],C|=(15&T)<<28)))),c[f++]=C}return e.set(y),c}function Vy(o,e,i){const c=new BigInt64Array(i);for(let f=0;f<c.length;f++)c[f]=DP(o,e);return c}function kP(o,e){let i,c;return c=o[e.get()],e.increment(),i=127&c,c<128?i:(c=o[e.get()],e.increment(),i|=(127&c)<<7,c<128?i:(c=o[e.get()],e.increment(),i|=(127&c)<<14,c<128?i:(c=o[e.get()],e.increment(),i|=(127&c)<<21,c<128?i:(c=o[e.get()],i|=(15&c)<<28,(function(f,y,_){let T,C;if(C=y[_.get()],_.increment(),T=(112&C)>>4,C<128||(C=y[_.get()],_.increment(),T|=(127&C)<<3,C<128)||(C=y[_.get()],_.increment(),T|=(127&C)<<10,C<128)||(C=y[_.get()],_.increment(),T|=(127&C)<<17,C<128)||(C=y[_.get()],_.increment(),T|=(127&C)<<24,C<128)||(C=y[_.get()],_.increment(),T|=(1&C)<<31,C<128))return 4294967296*T+(f>>>0);throw new Error("Expected varint not more than 10 bytes")})(i,o,e)))))}function _3(o,e,i,c){throw new Error("FastPFor is not implemented yet.")}function Mf(o){return o>>>1^-(1&o)}function Lp(o){return o>>1n^-(1n&o)}function DP(o,e){let i=0n,c=0,f=e.get();for(;f<o.length;){const y=o[f++];if(i|=BigInt(127&y)<<BigInt(c),!(128&y))break;if(c+=7,c>=64)throw new Error("Varint too long")}return e.set(f),i}function v3(o,e,i){const c=new Int32Array(i);let f=0;for(let y=0;y<e;y++){const _=o[y];c.fill(o[y+e],f,f+_),f+=_}return c}function x3(o,e,i){const c=new BigInt64Array(i);let f=0;for(let y=0;y<e;y++){const _=Number(o[y]);c.fill(o[y+e],f,f+_),f+=_}return c}function b3(o,e,i){const c=new Float64Array(i);let f=0;for(let y=0;y<e;y++){const _=o[y];c.fill(o[y+e],f,f+_),f+=_}return c}function Q_(o){const e=o.length/4*4;let i=1;if(e>=4)for(let c=o[0];i<e-4;i+=4)c=o[i]+=c,c=o[i+1]+=c,c=o[i+2]+=c,c=o[i+3]+=c;for(;i!=o.length;)o[i]+=o[i-1],++i}function w3(o){o[0]=o[0]>>>1^-(1&o[0]),o[1]=o[1]>>>1^-(1&o[1]);const e=o.length/4*4;let i=2;if(e>=4)for(;i<e-4;i+=4){const c=o[i],f=o[i+1],y=o[i+2],_=o[i+3];o[i]=(c>>>1^-(1&c))+o[i-2],o[i+1]=(f>>>1^-(1&f))+o[i-1],o[i+2]=(y>>>1^-(1&y))+o[i],o[i+3]=(_>>>1^-(1&_))+o[i+1]}for(;i!=o.length;i+=2)o[i]=(o[i]>>>1^-(1&o[i]))+o[i-2],o[i+1]=(o[i+1]>>>1^-(1&o[i+1]))+o[i-1]}(function(o){o.NONE="NONE",o.DELTA="DELTA",o.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",o.RLE="RLE",o.MORTON="MORTON",o.PDE="PDE"})(Dr||(Dr={})),(function(o){o.NONE="NONE",o.FAST_PFOR="FAST_PFOR",o.VARINT="VARINT",o.ALP="ALP"})(Wu||(Wu={})),(function(o){o.PRESENT="PRESENT",o.DATA="DATA",o.OFFSET="OFFSET",o.LENGTH="LENGTH"})(Ts||(Ts={}));class J_{_dictionaryType;_offsetType;_lengthType;constructor(e,i,c){this._dictionaryType=e,this._offsetType=i,this._lengthType=c}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function Xs(o,e){const i=(function(c,f){const y=c[f.get()],_=Object.values(Ts)[y>>4];let T=null;switch(_){case Ts.DATA:T=new J_(Object.values(Hl)[15&y]);break;case Ts.OFFSET:T=new J_(null,Object.values(Ef)[15&y]);break;case Ts.LENGTH:T=new J_(null,null,Object.values(Ho)[15&y])}f.increment();const C=c[f.get()],I=Object.values(Dr)[C>>5],D=Object.values(Dr)[C>>2&7],O=Object.values(Wu)[3&C];f.increment();const U=us(c,f,2),G=U[0];return{physicalStreamType:_,logicalStreamType:T,logicalLevelTechnique1:I,logicalLevelTechnique2:D,physicalLevelTechnique:O,numValues:G,byteLength:U[1],decompressedCount:G}})(o,e);return i.logicalLevelTechnique1===Dr.MORTON?(function(c,f,y){const _=us(f,y,2);return{physicalStreamType:c.physicalStreamType,logicalStreamType:c.logicalStreamType,logicalLevelTechnique1:c.logicalLevelTechnique1,logicalLevelTechnique2:c.logicalLevelTechnique2,physicalLevelTechnique:c.physicalLevelTechnique,numValues:c.numValues,byteLength:c.byteLength,decompressedCount:c.decompressedCount,numBits:_[0],coordinateShift:_[1]}})(i,o,e):Dr.RLE!==i.logicalLevelTechnique1&&Dr.RLE!==i.logicalLevelTechnique2||Wu.NONE===i.physicalLevelTechnique?i:(function(c,f,y){const _=us(f,y,2);return{physicalStreamType:c.physicalStreamType,logicalStreamType:c.logicalStreamType,logicalLevelTechnique1:c.logicalLevelTechnique1,logicalLevelTechnique2:c.logicalLevelTechnique2,physicalLevelTechnique:c.physicalLevelTechnique,numValues:c.numValues,byteLength:c.byteLength,decompressedCount:_[1],runs:_[0],numRleValues:_[1]}})(i,o,e)}(function(o){o.NONE="NONE",o.SINGLE="SINGLE",o.SHARED="SHARED",o.VERTEX="VERTEX",o.MORTON="MORTON",o.FSST="FSST"})(Hl||(Hl={})),(function(o){o.VERTEX="VERTEX",o.INDEX="INDEX",o.STRING="STRING",o.KEY="KEY"})(Ef||(Ef={})),(function(o){o.VAR_BINARY="VAR_BINARY",o.GEOMETRIES="GEOMETRIES",o.PARTS="PARTS",o.RINGS="RINGS",o.TRIANGLES="TRIANGLES",o.SYMBOL="SYMBOL",o.DICTIONARY="DICTIONARY"})(Ho||(Ho={})),(function(o){o[o.FLAT=0]="FLAT",o[o.CONST=1]="CONST",o[o.SEQUENCE=2]="SEQUENCE",o[o.DICTIONARY=3]="DICTIONARY",o[o.FSST_DICTIONARY=4]="FSST_DICTIONARY"})(Hi||(Hi={}));class Xl{values;_size;constructor(e,i){this.values=e,this._size=i}get(e){const i=Math.floor(e/8);return(this.values[i]>>e%8&1)==1}set(e,i){const c=Math.floor(e/8);this.values[c]=this.values[c]|(i?1:0)<<e%8}getInt(e){const i=Math.floor(e/8);return this.values[i]>>e%8&1}size(){return this._size}getBuffer(){return this.values}}function Ks(o,e,i,c,f){return(function(y,_,T){switch(_.logicalLevelTechnique1){case Dr.DELTA:return _.logicalLevelTechnique2===Dr.RLE?(function(C,I,D){const O=new Int32Array(D);let U=0,G=0;for(let H=0;H<I;H++){const K=C[H],J=Mf(C[H+I]);for(let se=0;se<K;se++)G+=J,O[U++]=G}return O})(y,_.runs,_.numRleValues):((function(C){C[0]=C[0]>>>1^-(1&C[0]);const I=C.length/4*4;let D=1;if(I>=4)for(;D<I-4;D+=4){const O=C[D],U=C[D+1],G=C[D+2],H=C[D+3];C[D]=(O>>>1^-(1&O))+C[D-1],C[D+1]=(U>>>1^-(1&U))+C[D],C[D+2]=(G>>>1^-(1&G))+C[D+1],C[D+3]=(H>>>1^-(1&H))+C[D+2]}for(;D!=C.length;++D)C[D]=(C[D]>>>1^-(1&C[D]))+C[D-1]})(y),y);case Dr.RLE:return(function(C,I,D){return D?(function(O,U,G){const H=new Int32Array(G);let K=0;for(let J=0;J<U;J++){const se=O[J];let ye=O[J+U];ye=ye>>>1^-(1&ye),H.fill(ye,K,K+se),K+=se}return H})(C,I.runs,I.numRleValues):v3(C,I.runs,I.numRleValues)})(y,_,T);case Dr.MORTON:return Q_(y),y;case Dr.COMPONENTWISE_DELTA:return w3(y),y;case Dr.NONE:return T&&(function(C){for(let I=0;I<C.length;I++){const D=C[I];C[I]=D>>>1^-(1&D)}})(y),y;default:throw new Error(`The specified Logical level technique is not supported: ${_.logicalLevelTechnique1}`)}})(Uy(o,e,i),i,c)}function md(o,e,i){return(function(c,f){if(f.logicalLevelTechnique1===Dr.DELTA&&f.logicalLevelTechnique2===Dr.NONE)return(function(_){const T=new Int32Array(_.length+1);T[0]=0,T[1]=Mf(_[0]);let C=T[1],I=2;for(;I!=T.length;++I){const D=_[I-1];C+=D>>>1^-(1&D),T[I]=T[I-1]+C}return T})(c);if(f.logicalLevelTechnique1===Dr.RLE&&f.logicalLevelTechnique2===Dr.NONE)return(function(_,T,C){const I=new Int32Array(C+1);I[0]=0;let D=1,O=I[0];for(let U=0;U<T;U++){const G=_[U],H=_[U+T];for(let K=D;K<D+G;K++)I[K]=H+O,O=I[K];D+=G}return I})(c,f.runs,f.numRleValues);if(f.logicalLevelTechnique1===Dr.NONE&&f.logicalLevelTechnique2===Dr.NONE){(function(_){let T=0;for(let C=0;C<_.length;C++)_[C]+=T,T=_[C]})(c);const y=new Int32Array(f.numValues+1);return y[0]=0,y.set(c,1),y}if(f.logicalLevelTechnique1===Dr.DELTA&&f.logicalLevelTechnique2===Dr.RLE){const y=(function(_,T,C){const I=new Int32Array(C+1);I[0]=0;let D=1,O=I[0];for(let U=0;U<T;U++){const G=_[U];let H=_[U+T];H=H>>>1^-(1&H);for(let K=D;K<D+G;K++)I[K]=H+O,O=I[K];D+=G}return I})(c,f.runs,f.numRleValues);return Q_(y),y}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")})(Uy(o,e,i),i)}function Uy(o,e,i){const c=i.physicalLevelTechnique;if(c===Wu.FAST_PFOR)return _3();if(c===Wu.VARINT)return us(o,e,i.numValues);if(c===Wu.NONE){const f=e.get();e.add(i.byteLength);const y=o.subarray(f,e.get());return new Int32Array(y)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function ev(o,e,i,c){const f=Uy(o,e,i);if(f.length===1){const y=f[0];return c?Mf(y):y}return c?(function(y){return Mf(y[1])})(f):(function(y){return y[1]})(f)}function T3(o,e,i){return(function(c){if(c.length==2){const f=Mf(c[1]);return[f,f]}return[Mf(c[2]),Mf(c[3])]})(Uy(o,e,i))}function S3(o,e,i){return(function(c){if(c.length==2){const f=Lp(c[1]);return[f,f]}return[Lp(c[2]),Lp(c[3])]})(Vy(o,e,i.numValues))}function P3(o,e,i,c){return(function(f,y,_){switch(y.logicalLevelTechnique1){case Dr.DELTA:return y.logicalLevelTechnique2===Dr.RLE?(function(T,C,I){const D=new BigInt64Array(I);let O=0,U=0n;for(let G=0;G<C;G++){const H=Number(T[G]),K=Lp(T[G+C]);for(let J=0;J<H;J++)U+=K,D[O++]=U}return D})(f,y.runs,y.numRleValues):((function(T){T[0]=T[0]>>1n^-(1n&T[0]);const C=T.length/4*4;let I=1;if(C>=4)for(;I<C-4;I+=4){const D=T[I],O=T[I+1],U=T[I+2],G=T[I+3];T[I]=(D>>1n^-(1n&D))+T[I-1],T[I+1]=(O>>1n^-(1n&O))+T[I],T[I+2]=(U>>1n^-(1n&U))+T[I+1],T[I+3]=(G>>1n^-(1n&G))+T[I+2]}for(;I!=T.length;++I)T[I]=(T[I]>>1n^-(1n&T[I]))+T[I-1]})(f),f);case Dr.RLE:return(function(T,C,I){return I?(function(D,O,U){const G=new BigInt64Array(U);let H=0;for(let K=0;K<O;K++){const J=Number(D[K]);let se=D[K+O];se=se>>1n^-(1n&se),G.fill(se,H,H+J),H+=J}return G})(T,C.runs,C.numRleValues):x3(T,C.runs,C.numRleValues)})(f,y,_);case Dr.NONE:return _&&(function(T){for(let C=0;C<T.length;C++){const I=T[C];T[C]=I>>1n^-(1n&I)}})(f),f;default:throw new Error(`The specified Logical level technique is not supported: ${y.logicalLevelTechnique1}`)}})(Vy(o,e,i.numValues),i,c)}function C3(o,e,i,c){const f=Vy(o,e,i.numValues);if(f.length===1){const y=f[0];return c?Lp(y):y}return c?(function(y){return Lp(y[1])})(f):(function(y){return y[1]})(f)}function tv(o,e,i,c,f){return(function(y,_,T,C){switch(_.logicalLevelTechnique1){case Dr.DELTA:return _.logicalLevelTechnique2===Dr.RLE&&(y=v3(y,_.runs,_.numRleValues)),(function(I,D){const O=new Int32Array(I.size());let U=0;I.get(0)?(O[0]=I.get(0)?D[0]>>>1^-(1&D[0]):0,U=1):O[0]=0;let G=1;for(;G!=O.length;++G)O[G]=I.get(G)?O[G-1]+(D[U]>>>1^-(1&D[U++])):O[G-1];return O})(C,y);case Dr.RLE:return(function(I,D,O,U){const G=D;return O?(function(H,K,J){const se=new Int32Array(H.size());let ye=0;for(let ae=0;ae<J;ae++){const ue=K[ae];let ve=K[ae+J];ve=ve>>>1^-(1&ve);for(let Ce=ye;Ce<ye+ue;Ce++)H.get(Ce)?se[Ce]=ve:(se[Ce]=0,ye++);ye+=ue}return se})(U,I,G.runs):(function(H,K,J){const se=new Int32Array(H.size());let ye=0;for(let ae=0;ae<J;ae++){const ue=K[ae],ve=K[ae+J];for(let Ce=ye;Ce<ye+ue;Ce++)H.get(Ce)?se[Ce]=ve:(se[Ce]=0,ye++);ye+=ue}return se})(U,I,G.runs)})(y,_,T,C);case Dr.MORTON:return Q_(y),y;case Dr.COMPONENTWISE_DELTA:return w3(y),y;case Dr.NONE:return y=T?(function(I,D){const O=new Int32Array(I.size());let U=0,G=0;for(;G!=O.length;++G)if(I.get(G)){const H=D[U++];O[G]=H>>>1^-(1&H)}else O[G]=0;return O})(C,y):(function(I,D){const O=new Int32Array(I.size());let U=0,G=0;for(;G!=O.length;++G)O[G]=I.get(G)?D[U++]:0;return O})(C,y),y;default:throw new Error("The specified Logical level technique is not supported")}})(i.physicalLevelTechnique===Wu.FAST_PFOR?_3():us(o,e,i.numValues),i,c,f)}function $y(o,e,i,c){const f=o.logicalLevelTechnique1;if(f===Dr.RLE)return o.runs===1?Hi.CONST:Hi.FLAT;const y=e instanceof Xl?e.size():e;if(f===Dr.DELTA&&o.logicalLevelTechnique2===Dr.RLE){const _=o.runs,T=2;if(o.numRleValues!==y)return Hi.FLAT;if(_===1)return Hi.SEQUENCE;if(_===2){const C=c.get();let I;if(o.physicalLevelTechnique===Wu.VARINT)I=us(i,c,4);else{const D=c.get();I=new Int32Array(i.buffer,i.byteOffset+D,4)}if(c.set(C),I[2]===T&&I[3]===T)return Hi.SEQUENCE}}return o.numValues===1?Hi.CONST:Hi.FLAT}class E3 extends By{getValueFromBuffer(e){return this.dataBuffer[e]}}class M3 extends g3{constructor(e,i,c,f){super(e,BigInt64Array.of(i),c,f)}getValueFromBuffer(e){return this.dataBuffer[0]+BigInt(e)*this.delta}}class zp{_geometryOffsets;_partOffsets;_ringOffsets;constructor(e,i,c){this._geometryOffsets=e,this._partOffsets=i,this._ringOffsets=c}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function rv(o,e,i){return{x:I3(o,e)-i,y:I3(o>>1,e)-i}}function I3(o,e){let i=0;for(let c=0;c<e;c++)i|=(o&1<<2*c)>>c;return i}(function(o){o[o.POINT=0]="POINT",o[o.LINESTRING=1]="LINESTRING",o[o.POLYGON=2]="POLYGON",o[o.MULTIPOINT=3]="MULTIPOINT",o[o.MULTILINESTRING=4]="MULTILINESTRING",o[o.MULTIPOLYGON=5]="MULTIPOLYGON"})(Xi||(Xi={})),(function(o){o[o.POINT=0]="POINT",o[o.LINESTRING=1]="LINESTRING",o[o.POLYGON=2]="POLYGON"})(y3||(y3={})),(function(o){o[o.MORTON=0]="MORTON",o[o.VEC_2=1]="VEC_2",o[o.VEC_3=2]="VEC_3"})(xa||(xa={}));class RP{createPoint(e){return[[e]]}createMultiPoint(e){return e.map((i=>[i]))}createLineString(e){return[e]}createMultiLineString(e){return e}createPolygon(e,i){return[e].concat(i)}createMultiPolygon(e){return e.flat()}}function A3(o){const e=new Array(o.numGeometries);let i=1,c=1,f=1,y=0;const _=new RP;let T=0,C=0;const I=o.mortonSettings,D=o.topologyVector,O=D.geometryOffsets,U=D.partOffsets,G=D.ringOffsets,H=o.vertexOffsets,K=o.containsPolygonGeometry(),J=o.vertexBuffer;for(let se=0;se<o.numGeometries;se++){const ye=o.geometryType(se);if(ye===Xi.POINT){if(H&&H.length!==0)if(o.vertexBufferType===xa.VEC_2){const ae=2*H[C++],ue=new A(J[ae],J[ae+1]);e[y++]=_.createPoint(ue)}else{const ae=rv(J[H[C++]],I.numBits,I.coordinateShift),ue=new A(ae.x,ae.y);e[y++]=_.createPoint(ue)}else{const ae=new A(J[T++],J[T++]);e[y++]=_.createPoint(ae)}O&&f++,U&&i++,G&&c++}else if(ye===Xi.MULTIPOINT){const ae=O[f]-O[f-1];f++;const ue=new Array(ae);if(H&&H.length!==0){for(let ve=0;ve<ae;ve++){const Ce=2*H[C++];ue[ve]=new A(J[Ce],J[Ce+1])}e[y++]=_.createMultiPoint(ue)}else{for(let ve=0;ve<ae;ve++){const Ce=J[T++],je=J[T++];ue[ve]=new A(Ce,je)}e[y++]=_.createMultiPoint(ue)}}else if(ye===Xi.LINESTRING){let ae,ue=0;K?(ue=G[c]-G[c-1],c++):ue=U[i]-U[i-1],i++,H&&H.length!==0?(ae=o.vertexBufferType===xa.VEC_2?iv(J,H,C,ue,!1):sv(J,H,C,ue,!1,I),C+=ue):(ae=nv(J,T,ue,!1),T+=2*ue),e[y++]=_.createLineString(ae),O&&f++}else if(ye===Xi.POLYGON){const ae=U[i]-U[i-1];i++;const ue=new Array(ae-1);let ve=G[c]-G[c-1];if(c++,H&&H.length!==0){const Ce=o.vertexBufferType===xa.VEC_2?qy(J,H,C,ve):Zy(J,H,C,ve,0,I);C+=ve;for(let je=0;je<ue.length;je++)ve=G[c]-G[c-1],c++,ue[je]=o.vertexBufferType===xa.VEC_2?qy(J,H,C,ve):Zy(J,H,C,ve,0,I),C+=ve;e[y++]=_.createPolygon(Ce,ue)}else{const Ce=Gy(J,T,ve);T+=2*ve;for(let je=0;je<ue.length;je++)ve=G[c]-G[c-1],c++,ue[je]=Gy(J,T,ve),T+=2*ve;e[y++]=_.createPolygon(Ce,ue)}O&&f++}else if(ye===Xi.MULTILINESTRING){const ae=O[f]-O[f-1];f++;const ue=new Array(ae);if(H&&H.length!==0){for(let ve=0;ve<ae;ve++){let Ce=0;K?(Ce=G[c]-G[c-1],c++):Ce=U[i]-U[i-1],i++;const je=o.vertexBufferType===xa.VEC_2?iv(J,H,C,Ce,!1):sv(J,H,C,Ce,!1,I);ue[ve]=je,C+=Ce}e[y++]=_.createMultiLineString(ue)}else{for(let ve=0;ve<ae;ve++){let Ce=0;K?(Ce=G[c]-G[c-1],c++):Ce=U[i]-U[i-1],i++,ue[ve]=nv(J,T,Ce,!1),T+=2*Ce}e[y++]=_.createMultiLineString(ue)}}else{if(ye!==Xi.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const ae=O[f]-O[f-1];f++;const ue=new Array(ae);let ve=0;if(H&&H.length!==0){for(let Ce=0;Ce<ae;Ce++){const je=U[i]-U[i-1];i++;const ot=new Array(je-1);ve=G[c]-G[c-1],c++;const tt=o.vertexBufferType===xa.VEC_2?qy(J,H,C,ve):Zy(J,H,C,ve,0,I);C+=ve;for(let ht=0;ht<ot.length;ht++)ve=G[c]-G[c-1],c++,ot[ht]=o.vertexBufferType===xa.VEC_2?qy(J,H,C,ve):Zy(J,H,C,ve,0,I),C+=ve;ue[Ce]=_.createPolygon(tt,ot)}e[y++]=_.createMultiPolygon(ue)}else{for(let Ce=0;Ce<ae;Ce++){const je=U[i]-U[i-1];i++;const ot=new Array(je-1);ve=G[c]-G[c-1],c++;const tt=Gy(J,T,ve);T+=2*ve;for(let ht=0;ht<ot.length;ht++){const At=G[c]-G[c-1];c++,ot[ht]=Gy(J,T,At),T+=2*At}ue[Ce]=_.createPolygon(tt,ot)}e[y++]=_.createMultiPolygon(ue)}}}}return e}function Gy(o,e,i){return nv(o,e,i,!0)}function qy(o,e,i,c){return iv(o,e,i,c,!0)}function Zy(o,e,i,c,f,y){return sv(o,e,i,c,!0,y)}function nv(o,e,i,c){const f=new Array(c?i+1:i);for(let y=0;y<2*i;y+=2)f[y/2]=new A(o[e+y],o[e+y+1]);return c&&(f[f.length-1]=f[0]),f}function iv(o,e,i,c,f){const y=new Array(f?c+1:c);for(let _=0;_<2*c;_+=2){const T=2*e[i+_/2];y[_/2]=new A(o[T],o[T+1])}return f&&(y[y.length-1]=y[0]),y}function sv(o,e,i,c,f,y){const _=new Array(f?c+1:c);for(let T=0;T<c;T++){const C=rv(o[e[i+T]],y.numBits,y.coordinateShift);_[T]=new A(C.x,C.y)}return f&&(_[_.length-1]=_[0]),_}class k3{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(e,i,c,f,y){this._vertexBufferType=e,this._topologyVector=i,this._vertexOffsets=c,this._vertexBuffer=f,this._mortonSettings=y}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const e=A3(this);let i=0;for(;i<this.numGeometries;)yield{coordinates:e[i],type:this.geometryType(i)},i++}getSimpleEncodedVertex(e){const i=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[i],this.vertexBuffer[i+1]]}getVertex(e){if(this.vertexOffsets&&this.mortonSettings){const c=rv(this.vertexBuffer[this.vertexOffsets[e]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[c.x,c.y]}const i=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[i],this.vertexBuffer[i+1]]}getGeometries(){return A3(this)}get mortonSettings(){return this._mortonSettings}}class D3 extends k3{_numGeometries;_geometryType;constructor(e,i,c,f,y,_,T){super(c,f,y,_,T),this._numGeometries=e,this._geometryType=i}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===Xi.POLYGON||this._geometryType===Xi.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class R3 extends k3{_geometryTypes;constructor(e,i,c,f,y,_){super(e,c,f,y,_),this._geometryTypes=i}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let e=0;e<this.numGeometries;e++)if(this.geometryType(e)===Xi.POLYGON||this.geometryType(e)===Xi.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class L3{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(e,i,c,f){this._triangleOffsets=e,this._indexBuffer=i,this._vertexBuffer=c,this._topologyVector=f}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const e=new Array(this.numGeometries),i=this._topologyVector,c=i.partOffsets,f=i.ringOffsets,y=i.geometryOffsets;let _=0,T=1,C=1,I=1;for(let D=0;D<this.numGeometries;D++)switch(this.geometryType(D)){case Xi.POLYGON:{const O=c[T]-c[T-1];T++;const U=[];for(let G=0;G<O;G++){const H=f[C]-f[C-1];C++;const K=[];for(let J=0;J<H;J++){const se=this._vertexBuffer[_++],ye=this._vertexBuffer[_++];K.push(new A(se,ye))}K.length>0&&K.push(K[0]),U.push(K)}e[D]=U,y&&I++}break;case Xi.MULTIPOLYGON:{const O=y[I]-y[I-1];I++;const U=[];for(let G=0;G<O;G++){const H=c[T]-c[T-1];T++;for(let K=0;K<H;K++){const J=f[C]-f[C-1];C++;const se=[];for(let ye=0;ye<J;ye++){const ae=this._vertexBuffer[_++],ue=this._vertexBuffer[_++];se.push(new A(ae,ue))}se.length>0&&se.push(se[0]),U.push(se)}}e[D]=U}}return e}[Symbol.iterator](){return null}}function z3(o,e,i,c,f,y){return new LP(o,e,i,c,f,y)}class LP extends L3{_numGeometries;_geometryType;constructor(e,i,c,f,y,_){super(c,f,y,_),this._numGeometries=e,this._geometryType=i}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function F3(o,e,i,c,f){return new zP(o,e,i,c,f)}class zP extends L3{_geometryTypes;constructor(e,i,c,f,y){super(i,c,f,y),this._geometryTypes=e}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function FP(o,e,i,c,f){const y=Xs(o,i);let _=null,T=null,C=null,I=null,D=null,O=null,U=null,G=null;if($y(y,c,o,i)===Hi.CONST){const K=ev(o,i,y,!1);for(let J=0;J<e-1;J++){const se=Xs(o,i);switch(se.physicalStreamType){case Ts.LENGTH:switch(se.logicalStreamType.lengthType){case Ho.GEOMETRIES:_=md(o,i,se);break;case Ho.PARTS:T=md(o,i,se);break;case Ho.RINGS:C=md(o,i,se);break;case Ho.TRIANGLES:U=md(o,i,se)}break;case Ts.OFFSET:switch(se.logicalStreamType.offsetType){case Ef.VERTEX:I=Ks(o,i,se,!1);break;case Ef.INDEX:G=Ks(o,i,se,!1)}break;case Ts.DATA:Hl.VERTEX===se.logicalStreamType.dictionaryType?D=Ks(o,i,se,!0):(O={numBits:se.numBits,coordinateShift:se.coordinateShift},D=Ks(o,i,se,!1))}}return G!==null?_!=null||T!=null?z3(c,K,U,G,D,new zp(_,T,C)):z3(c,K,U,G,D):O===null?(function(J,se,ye,ae,ue){return new D3(J,se,xa.VEC_2,ye,ae,ue)})(c,K,new zp(_,T,C),I,D):(function(J,se,ye,ae,ue,ve){return new D3(J,se,xa.MORTON,ye,ae,ue,ve)})(c,K,new zp(_,T,C),I,D,O)}const H=Ks(o,i,y,!1);for(let K=0;K<e-1;K++){const J=Xs(o,i);switch(J.physicalStreamType){case Ts.LENGTH:switch(J.logicalStreamType.lengthType){case Ho.GEOMETRIES:_=Ks(o,i,J,!1);break;case Ho.PARTS:T=Ks(o,i,J,!1);break;case Ho.RINGS:C=Ks(o,i,J,!1);break;case Ho.TRIANGLES:U=md(o,i,J)}break;case Ts.OFFSET:switch(J.logicalStreamType.offsetType){case Ef.VERTEX:I=Ks(o,i,J,!1);break;case Ef.INDEX:G=Ks(o,i,J,!1)}break;case Ts.DATA:Hl.VERTEX===J.logicalStreamType.dictionaryType?D=Ks(o,i,J,!0):(O={numBits:J.numBits,coordinateShift:J.coordinateShift},D=Ks(o,i,J,!1))}}return G!==null&&T===null?F3(H,U,G,D):(_!==null?(_=ov(H,_,2),T!==null&&C!==null?(T=O3(H,_,T,!1),C=(function(K,J,se,ye){const ae=new Int32Array(se[se.length-1]+1);let ue=0;ae[0]=ue;let ve=1,Ce=1,je=0;for(let ot=0;ot<K.length;ot++){const tt=K[ot],ht=J[ot+1]-J[ot];if(tt!==0&&tt!==3)for(let At=0;At<ht;At++){const pt=se[ve]-se[ve-1];ve++;for(let rt=0;rt<pt;rt++)ue=ae[Ce++]=ue+ye[je++]}else for(let At=0;At<ht;At++)ae[Ce++]=++ue,ve++}return ae})(H,_,T,C)):T!==null&&(T=(function(K,J,se){const ye=new Int32Array(J[J.length-1]+1);let ae=0;ye[0]=ae;let ue=1,ve=0;for(let Ce=0;Ce<K.length;Ce++){const je=K[Ce],ot=J[Ce+1]-J[Ce];if(je===4||je===1)for(let tt=0;tt<ot;tt++)ae=ye[ue++]=ae+se[ve++];else for(let tt=0;tt<ot;tt++)ye[ue++]=++ae}return ye})(H,_,T))):T!==null&&C!==null?(T=ov(H,T,1),C=O3(H,T,C,!0)):T!==null&&(T=ov(H,T,0)),G!==null?F3(H,U,G,D,new zp(_,T,C)):O===null?(function(K,J,se,ye){return new R3(xa.VEC_2,K,J,se,ye)})(H,new zp(_,T,C),I,D):(function(K,J,se,ye,ae){return new R3(xa.MORTON,K,J,se,ye,ae)})(H,new zp(_,T,C),I,D,O))}function ov(o,e,i){const c=new Int32Array(o.length+1);let f=0;c[0]=f;let y=0;for(let _=0;_<o.length;_++)f=c[_+1]=f+(o[_]>i?e[y++]:1);return c}function O3(o,e,i,c){const f=new Int32Array(e[e.length-1]+1);let y=0;f[0]=y;let _=1,T=0;for(let C=0;C<o.length;C++){const I=o[C],D=e[C+1]-e[C];if(I===5||I===2||c&&(I===4||I===1))for(let O=0;O<D;O++)y=f[_++]=y+i[T++];else for(let O=0;O<D;O++)f[_++]=++y}return f}class OP extends Rp{dataVector;constructor(e,i,c){super(e,i.getBuffer(),c),this.dataVector=i}getValueFromBuffer(e){return this.dataVector.get(e)}}class NP extends By{getValueFromBuffer(e){return this.dataBuffer[e]}}class N3 extends Rp{constructor(e,i,c){super(e,BigInt64Array.of(i),c)}getValueFromBuffer(e){return this.dataBuffer[0]}}function ng(o,e,i){return j3(o,Math.ceil(e/8),i)}function j3(o,e,i){const c=new Uint8Array(e);let f=0;for(;f<e;){const y=o[i.increment()];if(y<=127){const _=y+3,T=o[i.increment()],C=f+_;c.fill(T,f,C),f=C}else{const _=256-y;for(let T=0;T<_;T++)c[f++]=o[i.increment()]}}return c}const jP=new TextDecoder;function av(o,e,i){return i-e>=12?jP.decode(o.subarray(e,i)):(function(c,f,y){let _="",T=f;for(;T<y;){const C=c[T];let I,D,O,U=null,G=C>239?4:C>223?3:C>191?2:1;if(T+G>y)break;G===1?C<128&&(U=C):G===2?(I=c[T+1],(192&I)==128&&(U=(31&C)<<6|63&I,U<=127&&(U=null))):G===3?(I=c[T+1],D=c[T+2],(192&I)==128&&(192&D)==128&&(U=(15&C)<<12|(63&I)<<6|63&D,(U<=2047||U>=55296&&U<=57343)&&(U=null))):G===4&&(I=c[T+1],D=c[T+2],O=c[T+3],(192&I)==128&&(192&D)==128&&(192&O)==128&&(U=(15&C)<<18|(63&I)<<12|(63&D)<<6|63&O,(U<=65535||U>=1114112)&&(U=null))),U===null?(U=65533,G=1):U>65535&&(U-=65536,_+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),_+=String.fromCharCode(U),T+=G}return _})(o,e,i)}class lv extends Rp{offsetBuffer;constructor(e,i,c,f){super(e,c,f),this.offsetBuffer=i}}class B3 extends lv{textEncoder;constructor(e,i,c,f){super(e,i,c,f??i.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(e){return av(this.dataBuffer,this.offsetBuffer[e],this.offsetBuffer[e+1])}}class Fp extends lv{indexBuffer;textEncoder;constructor(e,i,c,f,y){super(e,c,f,y??i.length),this.indexBuffer=i,this.indexBuffer=i,this.textEncoder=new TextEncoder}getValueFromBuffer(e){const i=this.indexBuffer[e];return av(this.dataBuffer,this.offsetBuffer[i],this.offsetBuffer[i+1])}}class V3 extends lv{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(e,i,c,f,y,_,T){super(e,c,f,T),this.indexBuffer=i,this.symbolOffsetBuffer=y,this.symbolTableBuffer=_,this.textEncoder=new TextEncoder}getValueFromBuffer(e){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(c,f,y){const _=[],T=new Array(f.length).fill(0);for(let C=1;C<f.length;C++)T[C]=T[C-1]+f[C-1];for(let C=0;C<y.length;C++)if(y[C]===255)_.push(y[++C]);else{const I=f[y[C]],D=T[y[C]];for(let O=0;O<I;O++)_.push(c[D+O])}return new Uint8Array(_)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const i=this.indexBuffer[e];return av(this.decodedDictionary,this.offsetBuffer[i],this.offsetBuffer[i+1])}offsetToLengthBuffer(e){const i=new Uint32Array(e.length-1);let c=e[0];for(let f=1;f<e.length;f++){const y=e[f];i[f-1]=y-c,c=y}return i}}function BP(o,e,i,c,f,y){return i.type==="scalarType"?(function(_,T,C,I,D,O){let U=null,G=0;if(_===0)return null;if(O.nullable){const K=Xs(T,C);G=K.numValues;const J=C.get(),se=ng(T,G,C);C.set(J+K.byteLength),U=new Xl(se,K.numValues)}const H=U??I;switch(D.physicalType){case 4:case 3:return(function(K,J,se,ye,ae){const ue=Xs(K,J),ve=$y(ue,ae,K,J),Ce=ye.physicalType===3;if(ve===Hi.FLAT){const je=ig(ae)?tv(K,J,ue,Ce,ae):Ks(K,J,ue,Ce);return new H_(se.name,je,ae)}if(ve===Hi.SEQUENCE){const je=T3(K,J,ue);return new K_(se.name,je[0],je[1],ue.numRleValues)}{const je=ev(K,J,ue,Ce);return new Y_(se.name,je,ae)}})(T,C,O,D,H);case 9:return(function(K,J,se,ye,ae){let ue=null,ve=null,Ce=null,je=null,ot=null,tt=null,ht=null,At=null;for(let pt=0;pt<ye;pt++){const rt=Xs(J,se);if(rt.byteLength!==0)switch(rt.physicalStreamType){case Ts.PRESENT:{const Ye=ng(J,rt.numValues,se);tt=new Xl(Ye,rt.numValues);break}case Ts.OFFSET:ve=ae!=null||tt!=null?tv(J,se,rt,!1,ae??tt):Ks(J,se,rt,!1);break;case Ts.LENGTH:{const Ye=md(J,se,rt);Ho.DICTIONARY===rt.logicalStreamType.lengthType?ue=Ye:Ho.SYMBOL===rt.logicalStreamType.lengthType?je=Ye:ht=Ye;break}case Ts.DATA:{const Ye=J.subarray(se.get(),se.get()+rt.byteLength);se.add(rt.byteLength);const Bt=rt.logicalStreamType.dictionaryType;Hl.FSST===Bt?ot=Ye:Hl.SINGLE===Bt||Hl.SHARED===Bt?Ce=Ye:Hl.NONE===Bt&&(At=Ye);break}}}return(function(pt,rt,Ye,Bt,Nt,Ut,Ft){return rt?new V3(pt,Ye,Bt,Nt,Ut,rt,Ft):null})(K,ot,ve,ue,Ce,je,ae??tt)??(function(pt,rt,Ye,Bt,Nt){return rt?Nt?new Fp(pt,Ye,Bt,rt,Nt):new Fp(pt,Ye,Bt,rt):null})(K,Ce,ve,ue,ae??tt)??(function(pt,rt,Ye,Bt,Nt){if(!rt||!Ye)return null;if(Bt)return Nt?new Fp(pt,Bt,rt,Ye,Nt):new Fp(pt,Bt,rt,Ye);if(Nt&&Nt.size()!==rt.length-1){const Ut=new Int32Array(Nt.size());let Ft=0;for(let Jt=0;Jt<Nt.size();Jt++)Ut[Jt]=Nt.get(Jt)?Ft++:0;return new Fp(pt,Ut,rt,Ye,Nt)}return Nt?new B3(pt,rt,Ye,Nt):new B3(pt,rt,Ye)})(K,ht,At,ve,ae??tt)})(O.name,T,C,O.nullable?_-1:_,U);case 0:return(function(K,J,se,ye,ae){const ue=Xs(K,J),ve=ue.numValues,Ce=J.get(),je=ig(ae)?(function(tt,ht,At,pt){const rt=j3(tt,Math.ceil(ht/8),At),Ye=new Xl(rt,ht),Bt=pt.size(),Nt=new Xl(new Uint8Array(Bt),Bt);let Ut=0;for(let Ft=0;Ft<pt.size();Ft++){const Jt=!!pt.get(Ft)&&Ye.get(Ut++);Nt.set(Ft,Jt)}return Nt.getBuffer()})(K,ve,J,ae):ng(K,ve,J);J.set(Ce+ue.byteLength);const ot=new Xl(je,ve);return new OP(se.name,ot,ae)})(T,C,O,0,H);case 6:case 5:return(function(K,J,se,ye,ae){const ue=Xs(K,J),ve=$y(ue,ye,K,J),Ce=ae.physicalType===5;if(ve===Hi.FLAT){const je=ig(ye)?(function(ot,tt,ht,At,pt){return(function(rt,Ye,Bt,Nt){switch(Ye.logicalLevelTechnique1){case Dr.DELTA:return Ye.logicalLevelTechnique2===Dr.RLE&&(rt=x3(rt,Ye.runs,Ye.numRleValues)),(function(Ut,Ft){const Jt=new BigInt64Array(Ut.size());let $r=0;Ut.get(0)?(Jt[0]=Ut.get(0)?Ft[0]>>1n^-(1n&Ft[0]):0n,$r=1):Jt[0]=0n;let Ar=1;for(;Ar!=Jt.length;++Ar)Jt[Ar]=Ut.get(Ar)?Jt[Ar-1]+(Ft[$r]>>1n^-(1n&Ft[$r++])):Jt[Ar-1];return Jt})(Nt,rt);case Dr.RLE:return(function(Ut,Ft,Jt,$r){const Ar=Ft;return Jt?(function(qn,Ps,Ai){const Zn=new BigInt64Array(qn.size());let jn=0;for(let sn=0;sn<Ai;sn++){const Jn=Number(Ps[sn]);let ci=Ps[sn+Ai];ci=ci>>1n^-(1n&ci);for(let Ln=jn;Ln<jn+Jn;Ln++)qn.get(Ln)?Zn[Ln]=ci:(Zn[Ln]=0n,jn++);jn+=Jn}return Zn})($r,Ut,Ar.runs):(function(qn,Ps,Ai){const Zn=new BigInt64Array(qn.size());let jn=0;for(let sn=0;sn<Ai;sn++){const Jn=Number(Ps[sn]),ci=Ps[sn+Ai];for(let Ln=jn;Ln<jn+Jn;Ln++)qn.get(Ln)?Zn[Ln]=ci:(Zn[Ln]=0n,jn++);jn+=Jn}return Zn})($r,Ut,Ar.runs)})(rt,Ye,Bt,Nt);case Dr.NONE:return rt=Bt?(function(Ut,Ft){const Jt=new BigInt64Array(Ut.size());let $r=0,Ar=0;for(;Ar!=Jt.length;++Ar)if(Ut.get(Ar)){const qn=Ft[$r++];Jt[Ar]=qn>>1n^-(1n&qn)}else Jt[Ar]=0n;return Jt})(Nt,rt):(function(Ut,Ft){const Jt=new BigInt64Array(Ut.size());let $r=0,Ar=0;for(;Ar!=Jt.length;++Ar)Jt[Ar]=Ut.get(Ar)?Ft[$r++]:0n;return Jt})(Nt,rt),rt;default:throw new Error("The specified Logical level technique is not supported")}})(Vy(ot,tt,ht.numValues),ht,At,pt)})(K,J,ue,Ce,ye):P3(K,J,ue,Ce);return new E3(se.name,je,ye)}if(ve===Hi.SEQUENCE){const je=S3(K,J,ue);return new M3(se.name,je[0],je[1],ue.numRleValues)}{const je=C3(K,J,ue,Ce);return new N3(se.name,je,ye)}})(T,C,O,H,D);case 7:return(function(K,J,se,ye){const ae=Xs(K,J),ue=ig(ye)?(function(ve,Ce,je,ot){const tt=Ce.get(),ht=tt+ot*Float32Array.BYTES_PER_ELEMENT,At=new Uint8Array(ve.subarray(tt,ht)).buffer,pt=new Float32Array(At);Ce.set(ht);const rt=je.size(),Ye=new Float32Array(rt);let Bt=0;for(let Nt=0;Nt<rt;Nt++)Ye[Nt]=je.get(Nt)?pt[Bt++]:0;return Ye})(K,J,ye,ae.numValues):(function(ve,Ce,je){const ot=Ce.get(),tt=ot+je*Float32Array.BYTES_PER_ELEMENT,ht=new Uint8Array(ve.subarray(ot,tt)).buffer,At=new Float32Array(ht);return Ce.set(tt),At})(K,J,ae.numValues);return new NP(se.name,ue,ye)})(T,C,O,H);case 8:return(function(K,J,se,ye){const ae=Xs(K,J),ue=ig(ye)?(function(ve,Ce,je,ot){const tt=Ce.get(),ht=tt+ot*Float64Array.BYTES_PER_ELEMENT,At=new Uint8Array(ve.subarray(tt,ht)).buffer,pt=new Float64Array(At);Ce.set(ht);const rt=je.size(),Ye=new Float64Array(rt);let Bt=0;for(let Nt=0;Nt<rt;Nt++)Ye[Nt]=je.get(Nt)?pt[Bt++]:0;return Ye})(K,J,ye,ae.numValues):(function(ve,Ce,je){const ot=Ce.get(),tt=ot+je*Float64Array.BYTES_PER_ELEMENT,ht=new Uint8Array(ve.subarray(ot,tt)).buffer,At=new Float64Array(ht);return Ce.set(tt),At})(K,J,ae.numValues);return new X_(se.name,ue,ye)})(T,C,O,H);default:throw new Error(`The specified data type for the field is currently not supported: ${D}`)}})(c,o,e,f,i.scalarType,i):c!=1?null:(function(_,T,C,I){let D=null,O=null,U=null,G=null,H=!1;for(;!H;){const ye=Xs(_,T);switch(ye.physicalStreamType){case Ts.LENGTH:Ho.DICTIONARY===ye.logicalStreamType.lengthType?D=md(_,T,ye):U=md(_,T,ye);break;case Ts.DATA:Hl.SINGLE===ye.logicalStreamType.dictionaryType||Hl.SHARED===ye.logicalStreamType.dictionaryType?(O=_.subarray(T.get(),T.get()+ye.byteLength),H=!0):G=_.subarray(T.get(),T.get()+ye.byteLength),T.add(ye.byteLength)}}const K=C.complexType.children,J=[];let se=0;for(const ye of K){const ae=us(_,T,1)[0];if(ae==0)continue;const ue=`${C.name}${ye.name==="default"?"":":"+ye.name}`;if(ae!==2||ye.type!=="scalarField"||ye.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const ve=Xs(_,T),Ce=ng(_,ve.numValues,T),je=Xs(_,T),ot=je.decompressedCount!==I?tv(_,T,je,!1,new Xl(Ce,ve.numValues)):Ks(_,T,je,!1);J[se++]=G?new V3(ue,ot,D,O,U,G,new Xl(Ce,ve.numValues)):new Fp(ue,ot,D,O,new Xl(Ce,ve.numValues))}return J})(o,e,i,f)}function ig(o){return o instanceof Xl}function VP(o){if(o.name==="id")return!1;if(o.type==="scalarType"){const e=o.scalarType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(e.type==="logicalType")return!1}else if(o.type==="complexType"){const e=o.complexType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",o),!1}const UP=new TextDecoder;function U3(o,e){const i=us(o,e,1)[0];if(i===0)return"";const c=e.get(),f=o.subarray(c,c+i);return e.add(i),UP.decode(f)}function $3(o,e){const i=us(o,e,1)[0]>>>0,c=!!(4&i),f=!!(2&i),y=us(o,e,1)[0]>>>0,_={};if(1&i&&(_.nullable=!0),f){const T={};if(c?(T.type="logicalType",T.logicalType=y):(T.type="physicalType",T.physicalType=y),8&i){const C=us(o,e,1)[0]>>>0;T.children=new Array(C);for(let I=0;I<C;I++)T.children[I]=$3(o,e)}_.type="complexField",_.complexField=T}else{const T={};c?(T.type="logicalType",T.logicalType=y):(T.type="physicalType",T.physicalType=y),_.type="scalarField",_.scalarField=T}return _}function $P(o,e){const i=us(o,e,1)[0]>>>0,c=(function(f){switch(f){case 0:case 1:case 2:case 3:{const y={};y.nullable=!!(1&f),y.columnScope=0;const _={};return _.physicalType=f>1?6:4,_.type="physicalType",y.scalarType=_,y.type="scalarType",y}case 4:{const y={nullable:!1,columnScope:0},_={type:"physicalType",physicalType:0};return y.type="complexType",y.complexType=_,y}case 30:{const y={nullable:!1,columnScope:0},_={type:"physicalType",physicalType:1};return y.type="complexType",y.complexType=_,y}default:return(function(y){let _=null;switch(y){case 10:case 11:_=0;break;case 12:case 13:_=1;break;case 14:case 15:_=2;break;case 16:case 17:_=3;break;case 18:case 19:_=4;break;case 20:case 21:_=5;break;case 22:case 23:_=6;break;case 24:case 25:_=7;break;case 26:case 27:_=8;break;case 28:case 29:_=9;break;default:return null}const T={};T.nullable=!!(1&y),T.columnScope=0;const C={type:"physicalType"};return C.physicalType=_,T.type="scalarType",T.scalarType=C,T})(f)}})(i);if(!c)throw new Error(`Unsupported column type code: ${i}`);if((function(f){return f>=10})(i)?c.name=U3(o,e):i>=0&&i<=3?c.name="id":i===4&&(c.name="geometry"),(function(f){return f===30})(i)){const f=us(o,e,1)[0]>>>0,y=c.complexType;y.children=new Array(f);for(let _=0;_<f;_++)y.children[_]=$3(o,e)}return c}function GP(o,e){const i={featureTables:[]},c={};c.name=U3(o,e);const f=us(o,e,1)[0]>>>0,y=us(o,e,1)[0]>>>0;c.columns=new Array(y);for(let _=0;_<y;_++)c.columns[_]=$P(o,e);return i.featureTables.push(c),[i,f]}function qP(o,e,i,c,f,y,_=!1){const T=e.scalarType.physicalType,C=$y(f,y,o,i);if(T===4)switch(C){case Hi.FLAT:{const I=Ks(o,i,f,!1);return new H_(c,I,y)}case Hi.SEQUENCE:{const I=T3(o,i,f);return new K_(c,I[0],I[1],f.numRleValues)}case Hi.CONST:{const I=ev(o,i,f,!1);return new Y_(c,I,y)}}else switch(C){case Hi.FLAT:{if(_){const D=(function(O,U,G,H){const K=(function(J,se,ye){const ae=new Float64Array(se);for(let ue=0;ue<se;ue++)ae[ue]=kP(J,ye);return ae})(O,G.numValues,U);return(function(J,se,ye){switch(se.logicalLevelTechnique1){case Dr.DELTA:return se.logicalLevelTechnique2===Dr.RLE&&(J=b3(J,se.runs,se.numRleValues)),(function(ae){ae[0]=ae[0]%2==1?(ae[0]+1)/-2:ae[0]/2;const ue=ae.length/4*4;let ve=1;if(ue>=4)for(;ve<ue-4;ve+=4){const Ce=ae[ve],je=ae[ve+1],ot=ae[ve+2],tt=ae[ve+3];ae[ve]=(Ce%2==1?(Ce+1)/-2:Ce/2)+ae[ve-1],ae[ve+1]=(je%2==1?(je+1)/-2:je/2)+ae[ve],ae[ve+2]=(ot%2==1?(ot+1)/-2:ot/2)+ae[ve+1],ae[ve+3]=(tt%2==1?(tt+1)/-2:tt/2)+ae[ve+2]}for(;ve!=ae.length;++ve)ae[ve]=(ae[ve]%2==1?(ae[ve]+1)/-2:ae[ve]/2)+ae[ve-1]})(J),J;case Dr.RLE:return(function(ae,ue,ve){return b3(ae,ue.runs,ue.numRleValues)})(J,se);case Dr.NONE:return J;default:throw new Error(`The specified Logical level technique is not supported: ${se.logicalLevelTechnique1}`)}})(K,G)})(o,i,f);return new X_(c,D,y)}const I=P3(o,i,f,!1);return new E3(c,I,y)}case Hi.SEQUENCE:{const I=S3(o,i,f);return new M3(c,I[0],I[1],f.numRleValues)}case Hi.CONST:{const I=C3(o,i,f,!1);return new N3(c,I,y)}}throw new Error("Vector type not supported for id column.")}class ZP{constructor(e,i){var c;switch(this._featureData=e,this.properties=this._featureData.properties||{},(c=this._featureData.geometry)===null||c===void 0?void 0:c.type){case Xi.POINT:case Xi.MULTIPOINT:this.type=1;break;case Xi.LINESTRING:case Xi.MULTILINESTRING:this.type=2;break;case Xi.POLYGON:case Xi.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=i,this.id=Number(this._featureData.id)}loadGeometry(){const e=[];for(const i of this._featureData.geometry.coordinates){const c=[];for(const f of i)c.push(new A(f.x,f.y));e.push(c)}return e}}class WP{constructor(e){this.features=[],this.featureTable=e,this.name=e.name,this.extent=e.extent,this.version=2,this.features=e.getFeatures(),this.length=this.features.length}feature(e){return new ZP(this.features[e],this.extent)}}class G3{constructor(e){this.layers={};const i=(function(c,f,y=!0){const _=new AP(0),T=[];for(;_.get()<c.length;){const C=us(c,_,1)[0]>>>0,I=_.get()+C;if(I>c.length)throw new Error(`Block overruns tile: ${I} > ${c.length}`);if(us(c,_,1)[0]>>>0!=1){_.set(I);continue}const D=GP(c,_),O=D[1],U=D[0].featureTables[0];let G=null,H=null;const K=[];let J=0;for(const ye of U.columns){const ae=ye.name;if(ae==="id"){let ue=null;if(ye.nullable){const Ce=Xs(c,_),je=_.get(),ot=ng(c,Ce.numValues,_);_.set(je+Ce.byteLength),ue=new Xl(ot,Ce.numValues)}const ve=Xs(c,_);J=ve.decompressedCount,G=qP(c,ye,_,ae,ve,ue??J,y)}else if(ae==="geometry"){const ue=us(c,_,1)[0];if(J===0){const ve=_.get();J=Xs(c,_).decompressedCount,_.set(ve)}H=FP(c,ue,_,J)}else{const ue=VP(ye)?us(c,_,1)[0]:1;if(ue===0&&ye.type==="scalarType")continue;const ve=BP(c,_,ye,ue,J);if(ve)if(Array.isArray(ve))for(const Ce of ve)K.push(Ce);else K.push(ve)}}const se=new IP(U.name,H,G,K,O);T.push(se),_.set(I)}return T})(new Uint8Array(e));this.layers=i.reduce(((c,f)=>Object.assign(Object.assign({},c),{[f.name]:new WP(f)})),{})}}class HP{constructor(e,i){this.feature=e,this.type=e.type,this.properties=e.tags?e.tags:{},this.extent=i,"id"in e&&(typeof e.id=="string"?this.id=parseInt(e.id,10):typeof e.id!="number"||isNaN(e.id)||(this.id=e.id))}loadGeometry(){const e=[],i=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const c of i){const f=[];for(const y of c)f.push(new A(y[0],y[1]));e.push(f)}return e}}const sg="_geojsonTileLayer";function XP(o,e){e.writeVarintField(15,o.version||1),e.writeStringField(1,o.name||""),e.writeVarintField(5,o.extent||4096);const i={keys:[],values:[],keycache:{},valuecache:{}};for(let y=0;y<o.length;y++)i.feature=o.feature(y),e.writeMessage(2,KP,i);const c=i.keys;for(const y of c)e.writeStringField(3,y);const f=i.values;for(const y of f)e.writeMessage(4,JP,y)}function KP(o,e){if(!o.feature)return;const i=o.feature;i.id!==void 0&&e.writeVarintField(1,i.id),e.writeMessage(2,YP,o),e.writeVarintField(3,i.type),e.writeMessage(4,QP,i)}function YP(o,e){for(const i in o.feature?.properties){let c=o.feature.properties[i],f=o.keycache[i];if(c==null)continue;f===void 0&&(o.keys.push(i),f=o.keys.length-1,o.keycache[i]=f),e.writeVarint(f),typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"&&(c=JSON.stringify(c));const y=typeof c+":"+c;let _=o.valuecache[y];_===void 0&&(o.values.push(c),_=o.values.length-1,o.valuecache[y]=_),e.writeVarint(_)}}function cv(o,e){return(e<<3)+(7&o)}function q3(o){return o<<1^o>>31}function QP(o,e){const i=o.loadGeometry(),c=o.type;let f=0,y=0;for(const _ of i){let T=1;c===1&&(T=_.length),e.writeVarint(cv(1,T));const C=c===3?_.length-1:_.length;for(let I=0;I<C;I++){I===1&&c!==1&&e.writeVarint(cv(2,C-1));const D=_[I].x-f,O=_[I].y-y;e.writeVarint(q3(D)),e.writeVarint(q3(O)),f+=D,y+=O}o.type===3&&e.writeVarint(cv(7,1))}}function JP(o,e){const i=typeof o;i==="string"?e.writeStringField(1,o):i==="boolean"?e.writeBooleanField(7,o):i==="number"&&(o%1!=0?e.writeDoubleField(3,o):o<0?e.writeSVarintField(6,o):e.writeVarintField(5,o))}class Z3{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new gs(Be,16,0),this.grid3D=new gs(Be,16,0),this.featureIndexArray=new ne,this.promoteId=i}insert(e,i,c,f,y,_){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,y);const C=_?this.grid3D:this.grid;for(let I=0;I<i.length;I++){const D=i[I],O=[1/0,1/0,-1/0,-1/0];for(let U=0;U<D.length;U++){const G=D[U];O[0]=Math.min(O[0],G.x),O[1]=Math.min(O[1],G.y),O[2]=Math.max(O[2],G.x),O[3]=Math.max(O[3],G.y)}O[0]<Be&&O[1]<Be&&O[2]>=0&&O[3]>=0&&C.insert(T,O[0],O[1],O[2],O[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new Ty(new h(this.rawTileData)).layers:new G3(this.rawTileData).layers,this.sourceLayerCoder=new p3(this.vtLayers?Object.keys(this.vtLayers).sort():[sg])),this.vtLayers}query(e,i,c,f){this.loadVTLayers();const y=e.params,_=Be/e.tileSize/e.scale,T=Ml(y.filter,y.globalState),C=e.queryGeometry,I=e.queryPadding*_,D=Cf.fromPoints(C),O=this.grid.query(D.minX-I,D.minY-I,D.maxX+I,D.maxY+I),U=Cf.fromPoints(e.cameraQueryGeometry).expandBy(I),G=this.grid3D.query(U.minX,U.minY,U.maxX,U.maxY,((J,se,ye,ae)=>(function(ue,ve,Ce,je,ot){for(const ht of ue)if(ve<=ht.x&&Ce<=ht.y&&je>=ht.x&&ot>=ht.y)return!0;const tt=[new A(ve,Ce),new A(ve,ot),new A(je,ot),new A(je,Ce)];if(ue.length>2){for(const ht of tt)if(Ul(ue,ht))return!0}for(let ht=0;ht<ue.length-1;ht++)if($l(ue[ht],ue[ht+1],tt))return!0;return!1})(e.cameraQueryGeometry,J-I,se-I,ye+I,ae+I)));for(const J of G)O.push(J);O.sort(eC);const H={};let K;for(let J=0;J<O.length;J++){const se=O[J];if(se===K)continue;K=se;const ye=this.featureIndexArray.get(se);let ae=null;this.loadMatchingFeature(H,ye.bucketIndex,ye.sourceLayerIndex,ye.featureIndex,T,y.layers,y.availableImages,i,c,f,((ue,ve,Ce)=>(ae||(ae=Go(ue)),ve.queryIntersectsFeature({queryGeometry:C,feature:ue,featureState:Ce,geometry:ae,zoom:this.z,transform:e.transform,pixelsToTileUnits:_,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation}))))}return H}loadMatchingFeature(e,i,c,f,y,_,T,C,I,D,O){const U=this.bucketLayerIDs[i];if(_&&!U.some((J=>_.has(J))))return;const G=this.sourceLayerCoder.decode(c),H=this.vtLayers[G].feature(f);if(y.needGeometry){const J=fa(H,!0);if(!y.filter(new rn(this.tileID.overscaledZ),J,this.tileID.canonical))return}else if(!y.filter(new rn(this.tileID.overscaledZ),H))return;const K=this.getId(H,G);for(let J=0;J<U.length;J++){const se=U[J];if(_&&!_.has(se))continue;const ye=C[se];if(!ye)continue;let ae={};K&&D&&(ae=D.getState(ye.sourceLayer||sg,K));const ue=Gt({},I[se]);ue.paint=W3(ue.paint,ye.paint,H,ae,T),ue.layout=W3(ue.layout,ye.layout,H,ae,T);const ve=!O||O(H,ye,ae);if(!ve)continue;const Ce=new m3(H,this.z,this.x,this.y,K);Ce.layer=ue;let je=e[se];je===void 0&&(je=e[se]=[]),je.push({featureIndex:f,feature:Ce,intersectionZ:ve})}}lookupSymbolFeatures(e,i,c,f,y,_,T,C){const I={};this.loadVTLayers();const D=Ml(y.filterSpec,y.globalState);for(const O of e)this.loadMatchingFeature(I,c,f,O,D,_,T,C,i);return I}hasLayer(e){for(const i of this.bucketLayerIDs)for(const c of i)if(e===c)return!0;return!1}getId(e,i){var c;let f=e.id;return this.promoteId&&(f=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof f=="boolean"&&(f=Number(f)),f===void 0&&(!((c=e.properties)===null||c===void 0)&&c.cluster)&&this.promoteId&&(f=Number(e.properties.cluster_id))),f}}function W3(o,e,i,c,f){return cr(o,((y,_)=>{const T=e instanceof Fo?e.get(_):null;return T&&T.evaluate?T.evaluate(i,c,f):T}))}function eC(o,e){return e-o}function H3(o,e,i,c,f){const y=[];for(let _=0;_<o.length;_++){const T=o[_];let C;for(let I=0;I<T.length-1;I++){let D=T[I],O=T[I+1];D.x<e&&O.x<e||(D.x<e?D=new A(e,D.y+(e-D.x)/(O.x-D.x)*(O.y-D.y))._round():O.x<e&&(O=new A(e,D.y+(e-D.x)/(O.x-D.x)*(O.y-D.y))._round()),D.y<i&&O.y<i||(D.y<i?D=new A(D.x+(i-D.y)/(O.y-D.y)*(O.x-D.x),i)._round():O.y<i&&(O=new A(D.x+(i-D.y)/(O.y-D.y)*(O.x-D.x),i)._round()),D.x>=c&&O.x>=c||(D.x>=c?D=new A(c,D.y+(c-D.x)/(O.x-D.x)*(O.y-D.y))._round():O.x>=c&&(O=new A(c,D.y+(c-D.x)/(O.x-D.x)*(O.y-D.y))._round()),D.y>=f&&O.y>=f||(D.y>=f?D=new A(D.x+(f-D.y)/(O.y-D.y)*(O.x-D.x),f)._round():O.y>=f&&(O=new A(D.x+(f-D.y)/(O.y-D.y)*(O.x-D.x),f)._round()),C&&D.equals(C[C.length-1])||(C=[D],y.push(C)),C.push(O)))))}}return y}function X3(o,e,i,c,f){switch(e){case 1:return(function(y,_,T,C){const I=[];for(const D of y)for(const O of D){const U=C===0?O.x:O.y;U>=_&&U<=T&&I.push([O])}return I})(o,i,c,f);case 2:return K3(o,i,c,f,!1);case 3:return K3(o,i,c,f,!0)}return[]}function tC(o,e,i,c,f){const y=c===0?rC:nC;let _=[];const T=[];for(let D=0;D<o.length-1;D++){const O=o[D],U=o[D+1],G=c===0?O.x:O.y,H=c===0?U.x:U.y;let K=!1;G<e?H>e&&_.push(y(O,U,e)):G>i?H<i&&_.push(y(O,U,i)):_.push(O),H<e&&G>=e&&(_.push(y(O,U,e)),K=!0),H>i&&G<=i&&(_.push(y(O,U,i)),K=!0),!f&&K&&(T.push(_),_=[])}const C=o.length-1,I=c===0?o[C].x:o[C].y;return I>=e&&I<=i&&_.push(o[C]),f&&_.length>0&&!_[0].equals(_[_.length-1])&&_.push(new A(_[0].x,_[0].y)),_.length>0&&T.push(_),T}function K3(o,e,i,c,f){const y=[];for(const _ of o){const T=tC(_,e,i,c,f);T.length>0&&y.push(...T)}return y}function rC(o,e,i){return new A(i,o.y+(i-o.x)/(e.x-o.x)*(e.y-o.y))}function nC(o,e,i){return new A(o.x+(i-o.y)/(e.y-o.y)*(e.x-o.x),i)}zt("FeatureIndex",Z3,{omit:["rawTileData","sourceLayerCoder"]});class gd extends A{constructor(e,i,c,f){super(e,i),this.angle=c,f!==void 0&&(this.segment=f)}clone(){return new gd(this.x,this.y,this.angle,this.segment)}}function Y3(o,e,i,c,f){if(e.segment===void 0||i===0)return!0;let y=e,_=e.segment+1,T=0;for(;T>-i/2;){if(_--,_<0)return!1;T-=o[_].dist(y),y=o[_]}T+=o[_].dist(o[_+1]),_++;const C=[];let I=0;for(;T<i/2;){const D=o[_],O=o[_+1];if(!O)return!1;let U=o[_-1].angleTo(D)-D.angleTo(O);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:T,angleDelta:U}),I+=U;T-C[0].distance>c;)I-=C.shift().angleDelta;if(I>f)return!1;_++,T+=D.dist(O)}return!0}function Q3(o){let e=0;for(let i=0;i<o.length-1;i++)e+=o[i].dist(o[i+1]);return e}function J3(o,e,i){return o?.6*e*i:0}function eb(o,e){return Math.max(o?o.right-o.left:0,e?e.right-e.left:0)}function iC(o,e,i,c,f,y){const _=J3(i,f,y),T=eb(i,c)*y;let C=0;const I=Q3(o)/2;for(let D=0;D<o.length-1;D++){const O=o[D],U=o[D+1],G=O.dist(U);if(C+G>I){const H=(I-C)/G,K=In.number(O.x,U.x,H),J=In.number(O.y,U.y,H),se=new gd(K,J,U.angleTo(O),D);return se._round(),!_||Y3(o,se,T,_,e)?se:void 0}C+=G}}function sC(o,e,i,c,f,y,_,T,C){const I=J3(c,y,_),D=eb(c,f),O=D*_,U=o[0].x===0||o[0].x===C||o[0].y===0||o[0].y===C;return e-O<e/4&&(e=O+e/4),tb(o,U?e/2*T%e:(D/2+2*y)*_*T%e,e,I,i,O,U,!1,C)}function tb(o,e,i,c,f,y,_,T,C){const I=y/2,D=Q3(o);let O=0,U=e-i,G=[];for(let H=0;H<o.length-1;H++){const K=o[H],J=o[H+1],se=K.dist(J),ye=J.angleTo(K);for(;U+i<O+se;){U+=i;const ae=(U-O)/se,ue=In.number(K.x,J.x,ae),ve=In.number(K.y,J.y,ae);if(ue>=0&&ue<C&&ve>=0&&ve<C&&U-I>=0&&U+I<=D){const Ce=new gd(ue,ve,ye,H);Ce._round(),c&&!Y3(o,Ce,y,c,f)||G.push(Ce)}}O+=se}return T||G.length||_||(G=tb(o,O/2,i,c,f,y,_,!0,C)),G}function rb(o,e,i,c){const f=[],y=o.image,_=y.pixelRatio,T=y.paddedRect.w-2,C=y.paddedRect.h-2;let I={x1:o.left,y1:o.top,x2:o.right,y2:o.bottom};const D=y.stretchX||[[0,T]],O=y.stretchY||[[0,C]],U=(Ye,Bt)=>Ye+Bt[1]-Bt[0],G=D.reduce(U,0),H=O.reduce(U,0),K=T-G,J=C-H;let se=0,ye=G,ae=0,ue=H,ve=0,Ce=K,je=0,ot=J;if(y.content&&c){const Ye=y.content,Bt=Ye[2]-Ye[0],Nt=Ye[3]-Ye[1];(y.textFitWidth||y.textFitHeight)&&(I=Fy(o)),se=Wy(D,0,Ye[0]),ae=Wy(O,0,Ye[1]),ye=Wy(D,Ye[0],Ye[2]),ue=Wy(O,Ye[1],Ye[3]),ve=Ye[0]-se,je=Ye[1]-ae,Ce=Bt-ye,ot=Nt-ue}const tt=I.x1,ht=I.y1,At=I.x2-tt,pt=I.y2-ht,rt=(Ye,Bt,Nt,Ut)=>{const Ft=Hy(Ye.stretch-se,ye,At,tt),Jt=Xy(Ye.fixed-ve,Ce,Ye.stretch,G),$r=Hy(Bt.stretch-ae,ue,pt,ht),Ar=Xy(Bt.fixed-je,ot,Bt.stretch,H),qn=Hy(Nt.stretch-se,ye,At,tt),Ps=Xy(Nt.fixed-ve,Ce,Nt.stretch,G),Ai=Hy(Ut.stretch-ae,ue,pt,ht),Zn=Xy(Ut.fixed-je,ot,Ut.stretch,H),jn=new A(Ft,$r),sn=new A(qn,$r),Jn=new A(qn,Ai),ci=new A(Ft,Ai),Ln=new A(Jt/_,Ar/_),wo=new A(Ps/_,Zn/_),Cs=e*Math.PI/180;if(Cs){const Ki=Math.sin(Cs),Xn=Math.cos(Cs),ki=[Xn,-Ki,Ki,Xn];jn._matMult(ki),sn._matMult(ki),ci._matMult(ki),Jn._matMult(ki)}const To=Ye.stretch+Ye.fixed,nl=Bt.stretch+Bt.fixed;return{tl:jn,tr:sn,bl:ci,br:Jn,tex:{x:y.paddedRect.x+1+To,y:y.paddedRect.y+1+nl,w:Nt.stretch+Nt.fixed-To,h:Ut.stretch+Ut.fixed-nl},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ln,pixelOffsetBR:wo,minFontScaleX:Ce/_/At,minFontScaleY:ot/_/pt,isSDF:i}};if(c&&(y.stretchX||y.stretchY)){const Ye=nb(D,K,G),Bt=nb(O,J,H);for(let Nt=0;Nt<Ye.length-1;Nt++){const Ut=Ye[Nt],Ft=Ye[Nt+1];for(let Jt=0;Jt<Bt.length-1;Jt++)f.push(rt(Ut,Bt[Jt],Ft,Bt[Jt+1]))}}else f.push(rt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:C+1}));return f}function Wy(o,e,i){let c=0;for(const f of o)c+=Math.max(e,Math.min(i,f[1]))-Math.max(e,Math.min(i,f[0]));return c}function nb(o,e,i){const c=[{fixed:-1,stretch:0}];for(const[f,y]of o){const _=c[c.length-1];c.push({fixed:f-_.stretch,stretch:_.stretch}),c.push({fixed:f-_.stretch,stretch:_.stretch+(y-f)})}return c.push({fixed:e+1,stretch:i}),c}function Hy(o,e,i,c){return o/e*i+c}function Xy(o,e,i,c){return o-e*i/c}zt("Anchor",gd);class Ky{constructor(e,i,c,f,y,_,T,C,I,D){var O;if(this.boxStartIndex=e.length,I){let U=_.top,G=_.bottom;const H=_.collisionPadding;H&&(U-=H[1],G+=H[3]);let K=G-U;K>0&&(K=Math.max(10,K),this.circleDiameter=K)}else{const U=!((O=_.image)===null||O===void 0)&&O.content&&(_.image.textFitWidth||_.image.textFitHeight)?Fy(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};U.y1=U.y1*T-C[0],U.y2=U.y2*T+C[2],U.x1=U.x1*T-C[3],U.x2=U.x2*T+C[1];const G=_.collisionPadding;if(G&&(U.x1-=G[0]*T,U.y1-=G[1]*T,U.x2+=G[2]*T,U.y2+=G[3]*T),D){const H=new A(U.x1,U.y1),K=new A(U.x2,U.y1),J=new A(U.x1,U.y2),se=new A(U.x2,U.y2),ye=D*Math.PI/180;H._rotate(ye),K._rotate(ye),J._rotate(ye),se._rotate(ye),U.x1=Math.min(H.x,K.x,J.x,se.x),U.x2=Math.max(H.x,K.x,J.x,se.x),U.y1=Math.min(H.y,K.y,J.y,se.y),U.y2=Math.max(H.y,K.y,J.y,se.y)}e.emplaceBack(i.x,i.y,U.x1,U.y1,U.x2,U.y2,c,f,y)}this.boxEndIndex=e.length}}class oC{constructor(e=[],i=(c,f)=>c<f?-1:c>f?1:0){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:c}=this,f=i[e];for(;e>0;){const y=e-1>>1,_=i[y];if(c(f,_)>=0)break;i[e]=_,e=y}i[e]=f}_down(e){const{data:i,compare:c}=this,f=this.length>>1,y=i[e];for(;e<f;){let _=1+(e<<1);const T=_+1;if(T<this.length&&c(i[T],i[_])<0&&(_=T),c(i[_],y)>=0)break;i[e]=i[_],e=_}i[e]=y}}function aC(o,e=1,i=!1){const c=Cf.fromPoints(o[0]),f=Math.min(c.width(),c.height());let y=f/2;const _=new oC([],lC),{minX:T,minY:C,maxX:I,maxY:D}=c;if(f===0)return new A(T,C);for(let G=T;G<I;G+=f)for(let H=C;H<D;H+=f)_.push(new Op(G+y,H+y,y,o));let O=(function(G){let H=0,K=0,J=0;const se=G[0];for(let ye=0,ae=se.length,ue=ae-1;ye<ae;ue=ye++){const ve=se[ye],Ce=se[ue],je=ve.x*Ce.y-Ce.x*ve.y;K+=(ve.x+Ce.x)*je,J+=(ve.y+Ce.y)*je,H+=3*je}return new Op(K/H,J/H,0,G)})(o),U=_.length;for(;_.length;){const G=_.pop();(G.d>O.d||!O.d)&&(O=G,i&&console.log("found best %d after %d probes",Math.round(1e4*G.d)/1e4,U)),G.max-O.d<=e||(y=G.h/2,_.push(new Op(G.p.x-y,G.p.y-y,y,o)),_.push(new Op(G.p.x+y,G.p.y-y,y,o)),_.push(new Op(G.p.x-y,G.p.y+y,y,o)),_.push(new Op(G.p.x+y,G.p.y+y,y,o)),U+=4)}return i&&(console.log(`num probes: ${U}`),console.log(`best distance: ${O.d}`)),O.p}function lC(o,e){return e.max-o.max}function Op(o,e,i,c){this.p=new A(o,e),this.h=i,this.d=(function(f,y){let _=!1,T=1/0;for(let C=0;C<y.length;C++){const I=y[C];for(let D=0,O=I.length,U=O-1;D<O;U=D++){const G=I[D],H=I[U];G.y>f.y!=H.y>f.y&&f.x<(H.x-G.x)*(f.y-G.y)/(H.y-G.y)+G.x&&(_=!_),T=Math.min(T,yp(f,G,H))}}return(_?1:-1)*Math.sqrt(T)})(this.p,c),this.max=this.d+this.h*Math.SQRT2}var Ss;v.aP=void 0,(Ss=v.aP||(v.aP={}))[Ss.center=1]="center",Ss[Ss.left=2]="left",Ss[Ss.right=3]="right",Ss[Ss.top=4]="top",Ss[Ss.bottom=5]="bottom",Ss[Ss["top-left"]=6]="top-left",Ss[Ss["top-right"]=7]="top-right",Ss[Ss["bottom-left"]=8]="bottom-left",Ss[Ss["bottom-right"]=9]="bottom-right";const uv=Number.POSITIVE_INFINITY;function ib(o,e){return e[1]!==uv?(function(i,c,f){let y=0,_=0;switch(c=Math.abs(c),f=Math.abs(f),i){case"top-right":case"top-left":case"top":_=f-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-f}switch(i){case"top-right":case"bottom-right":case"right":y=-c;break;case"top-left":case"bottom-left":case"left":y=c}return[y,_]})(o,e[0],e[1]):(function(i,c){let f=0,y=0;c<0&&(c=0);const _=c/Math.SQRT2;switch(i){case"top-right":case"top-left":y=_-7;break;case"bottom-right":case"bottom-left":y=7-_;break;case"bottom":y=7-c;break;case"top":y=c-7}switch(i){case"top-right":case"bottom-right":f=-_;break;case"top-left":case"bottom-left":f=_;break;case"left":f=c;break;case"right":f=-c}return[f,y]})(o,e[0])}function sb(o,e,i){var c;const f=o.layout,y=(c=f.get("text-variable-anchor-offset"))===null||c===void 0?void 0:c.evaluate(e,{},i);if(y){const T=y.values,C=[];for(let I=0;I<T.length;I+=2){const D=C[I]=T[I],O=T[I+1].map((U=>U*Ii));D.startsWith("top")?O[1]-=7:D.startsWith("bottom")&&(O[1]+=7),C[I+1]=O}return new rs(C)}const _=f.get("text-variable-anchor");if(_){let T;T=o._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[f.get("text-radial-offset").evaluate(e,{},i)*Ii,uv]:f.get("text-offset").evaluate(e,{},i).map((I=>I*Ii));const C=[];for(const I of _)C.push(I,ib(I,T));return new rs(C)}return null}function hv(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function cC(o,e,i,c,f,y,_,T,C,I,D,O){let U=y.textMaxSize.evaluate(e,{});U===void 0&&(U=_);const G=o.layers[0].layout,H=G.get("icon-offset").evaluate(e,{},D),K=ab(i.horizontal),J=_/24,se=o.tilePixelRatio*J,ye=o.tilePixelRatio*U/24,ae=o.tilePixelRatio*T,ue=o.tilePixelRatio*G.get("symbol-spacing"),ve=G.get("text-padding")*o.tilePixelRatio,Ce=(function(Nt,Ut,Ft,Jt=1){const $r=Nt.get("icon-padding").evaluate(Ut,{},Ft),Ar=$r&&$r.values;return[Ar[0]*Jt,Ar[1]*Jt,Ar[2]*Jt,Ar[3]*Jt]})(G,e,D,o.tilePixelRatio),je=G.get("text-max-angle")/180*Math.PI,ot=G.get("text-rotation-alignment")!=="viewport"&&G.get("symbol-placement")!=="point",tt=G.get("icon-rotation-alignment")==="map"&&G.get("symbol-placement")!=="point",ht=G.get("symbol-placement"),At=ue/2,pt=G.get("icon-text-fit");let rt;c&&pt!=="none"&&(o.allowVerticalPlacement&&i.vertical&&(rt=Q2(c,i.vertical,pt,G.get("icon-text-fit-padding"),H,J)),K&&(c=Q2(c,K,pt,G.get("icon-text-fit-padding"),H,J)));const Ye=D?O.line.getGranularityForZoomLevel(D.z):1,Bt=(Nt,Ut)=>{Ut.x<0||Ut.x>=Be||Ut.y<0||Ut.y>=Be||(function(Ft,Jt,$r,Ar,qn,Ps,Ai,Zn,jn,sn,Jn,ci,Ln,wo,Cs,To,nl,Ki,Xn,ki,ei,Yi,Hu,Kl,lg){const yd=Ft.addToLineVertexArray(Jt,$r);let If,Np,jp,Bp,hb=0,db=0,fb=0,pb=0,vv=-1,xv=-1;const Xu={};let mb=Hr("");if(Ft.allowVerticalPlacement&&Ar.vertical){const Ds=Zn.layout.get("text-rotate").evaluate(ei,{},Kl)+90;jp=new Ky(jn,Jt,sn,Jn,ci,Ar.vertical,Ln,wo,Cs,Ds),Ai&&(Bp=new Ky(jn,Jt,sn,Jn,ci,Ai,nl,Ki,Cs,Ds))}if(qn){const Ds=Zn.layout.get("icon-rotate").evaluate(ei,{}),ba=Zn.layout.get("icon-text-fit")!=="none",Af=rb(qn,Ds,Hu,ba),Ql=Ai?rb(Ai,Ds,Hu,ba):void 0;Np=new Ky(jn,Jt,sn,Jn,ci,qn,nl,Ki,!1,Ds),hb=4*Af.length;const kf=Ft.iconSizeData;let Hc=null;kf.kind==="source"?(Hc=[Zu*Zn.layout.get("icon-size").evaluate(ei,{})],Hc[0]>fd&&en(`${Ft.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):kf.kind==="composite"&&(Hc=[Zu*Yi.compositeIconSizes[0].evaluate(ei,{},Kl),Zu*Yi.compositeIconSizes[1].evaluate(ei,{},Kl)],(Hc[0]>fd||Hc[1]>fd)&&en(`${Ft.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ft.addSymbols(Ft.icon,Af,Hc,ki,Xn,ei,v.az.none,Jt,yd.lineStartIndex,yd.lineLength,-1,Kl),vv=Ft.icon.placedSymbolArray.length-1,Ql&&(db=4*Ql.length,Ft.addSymbols(Ft.icon,Ql,Hc,ki,Xn,ei,v.az.vertical,Jt,yd.lineStartIndex,yd.lineLength,-1,Kl),xv=Ft.icon.placedSymbolArray.length-1)}const gb=Object.keys(Ar.horizontal);for(const Ds of gb){const ba=Ar.horizontal[Ds];if(!If){mb=Hr(ba.text);const Ql=Zn.layout.get("text-rotate").evaluate(ei,{},Kl);If=new Ky(jn,Jt,sn,Jn,ci,ba,Ln,wo,Cs,Ql)}const Af=ba.positionedLines.length===1;if(fb+=ob(Ft,Jt,ba,Ps,Zn,Cs,ei,To,yd,Ar.vertical?v.az.horizontal:v.az.horizontalOnly,Af?gb:[Ds],Xu,vv,Yi,Kl),Af)break}Ar.vertical&&(pb+=ob(Ft,Jt,Ar.vertical,Ps,Zn,Cs,ei,To,yd,v.az.vertical,["vertical"],Xu,xv,Yi,Kl));const dC=If?If.boxStartIndex:Ft.collisionBoxArray.length,fC=If?If.boxEndIndex:Ft.collisionBoxArray.length,pC=jp?jp.boxStartIndex:Ft.collisionBoxArray.length,mC=jp?jp.boxEndIndex:Ft.collisionBoxArray.length,gC=Np?Np.boxStartIndex:Ft.collisionBoxArray.length,yC=Np?Np.boxEndIndex:Ft.collisionBoxArray.length,_C=Bp?Bp.boxStartIndex:Ft.collisionBoxArray.length,vC=Bp?Bp.boxEndIndex:Ft.collisionBoxArray.length;let Yl=-1;const Qy=(Ds,ba)=>Ds&&Ds.circleDiameter?Math.max(Ds.circleDiameter,ba):ba;Yl=Qy(If,Yl),Yl=Qy(jp,Yl),Yl=Qy(Np,Yl),Yl=Qy(Bp,Yl);const yb=Yl>-1?1:0;yb&&(Yl*=lg/Ii),Ft.glyphOffsetArray.length>=kp.MAX_GLYPHS&&en("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ei.sortKey!==void 0&&Ft.addToSortKeyRanges(Ft.symbolInstances.length,ei.sortKey);const xC=sb(Zn,ei,Kl),[bC,wC]=(function(Ds,ba){const Af=Ds.length,Ql=ba?.values;if(Ql?.length>0)for(let kf=0;kf<Ql.length;kf+=2){const Hc=Ql[kf+1];Ds.emplaceBack(v.aP[Ql[kf]],Hc[0],Hc[1])}return[Af,Ds.length]})(Ft.textAnchorOffsets,xC);Ft.symbolInstances.emplaceBack(Jt.x,Jt.y,Xu.right>=0?Xu.right:-1,Xu.center>=0?Xu.center:-1,Xu.left>=0?Xu.left:-1,Xu.vertical||-1,vv,xv,mb,dC,fC,pC,mC,gC,yC,_C,vC,sn,fb,pb,hb,db,yb,0,Ln,Yl,bC,wC)})(o,Ut,Nt,i,c,f,rt,o.layers[0],o.collisionBoxArray,e.index,e.sourceLayerIndex,o.index,se,[ve,ve,ve,ve],ot,C,ae,Ce,tt,H,e,y,I,D,_)};if(ht==="line")for(const Nt of H3(e.geometry,0,0,Be,Be)){const Ut=Hs(Nt,Ye),Ft=sC(Ut,ue,je,i.vertical||K,c,24,ye,o.overscaling,Be);for(const Jt of Ft)K&&uC(o,K.text,At,Jt)||Bt(Ut,Jt)}else if(ht==="line-center"){for(const Nt of e.geometry)if(Nt.length>1){const Ut=Hs(Nt,Ye),Ft=iC(Ut,je,i.vertical||K,c,24,ye);Ft&&Bt(Ut,Ft)}}else if(e.type==="Polygon")for(const Nt of _u(e.geometry,0)){const Ut=aC(Nt,16);Bt(Hs(Nt[0],Ye,!0),new gd(Ut.x,Ut.y,0))}else if(e.type==="LineString")for(const Nt of e.geometry){const Ut=Hs(Nt,Ye);Bt(Ut,new gd(Ut[0].x,Ut[0].y,0))}else if(e.type==="Point")for(const Nt of e.geometry)for(const Ut of Nt)Bt([Ut],new gd(Ut.x,Ut.y,0))}function ob(o,e,i,c,f,y,_,T,C,I,D,O,U,G,H){const K=(function(ye,ae,ue,ve,Ce,je,ot,tt){const ht=ve.layout.get("text-rotate").evaluate(je,{})*Math.PI/180,At=[];for(const pt of ae.positionedLines)for(const rt of pt.positionedGlyphs){if(!rt.rect)continue;const Ye=rt.rect||{};let Bt=4,Nt=!0,Ut=1,Ft=0;const Jt=(Ce||tt)&&rt.vertical,$r=rt.metrics.advance*rt.scale/2;if(tt&&ae.verticalizable&&(Ft=pt.lineOffset/2-(rt.imageName?-(Ii-rt.metrics.width*rt.scale)/2:(rt.scale-1)*Ii)),rt.imageName){const Ki=ot[rt.imageName];Nt=Ki.sdf,Ut=Ki.pixelRatio,Bt=1/Ut}const Ar=Ce?[rt.x+$r,rt.y]:[0,0];let qn=Ce?[0,0]:[rt.x+$r+ue[0],rt.y+ue[1]-Ft],Ps=[0,0];Jt&&(Ps=qn,qn=[0,0]);const Ai=rt.metrics.isDoubleResolution?2:1,Zn=(rt.metrics.left-Bt)*rt.scale-$r+qn[0],jn=(-rt.metrics.top-Bt)*rt.scale+qn[1],sn=Zn+Ye.w/Ai*rt.scale/Ut,Jn=jn+Ye.h/Ai*rt.scale/Ut,ci=new A(Zn,jn),Ln=new A(sn,jn),wo=new A(Zn,Jn),Cs=new A(sn,Jn);if(Jt){const Ki=new A(-$r,$r- -17),Xn=-Math.PI/2,ki=12-$r,ei=new A(22-ki,-(rt.imageName?ki:0)),Yi=new A(...Ps);ci._rotateAround(Xn,Ki)._add(ei)._add(Yi),Ln._rotateAround(Xn,Ki)._add(ei)._add(Yi),wo._rotateAround(Xn,Ki)._add(ei)._add(Yi),Cs._rotateAround(Xn,Ki)._add(ei)._add(Yi)}if(ht){const Ki=Math.sin(ht),Xn=Math.cos(ht),ki=[Xn,-Ki,Ki,Xn];ci._matMult(ki),Ln._matMult(ki),wo._matMult(ki),Cs._matMult(ki)}const To=new A(0,0),nl=new A(0,0);At.push({tl:ci,tr:Ln,bl:wo,br:Cs,tex:Ye,writingMode:ae.writingMode,glyphOffset:Ar,sectionIndex:rt.sectionIndex,isSDF:Nt,pixelOffsetTL:To,pixelOffsetBR:nl,minFontScaleX:0,minFontScaleY:0})}return At})(0,i,T,f,y,_,c,o.allowVerticalPlacement),J=o.textSizeData;let se=null;J.kind==="source"?(se=[Zu*f.layout.get("text-size").evaluate(_,{})],se[0]>fd&&en(`${o.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):J.kind==="composite"&&(se=[Zu*G.compositeTextSizes[0].evaluate(_,{},H),Zu*G.compositeTextSizes[1].evaluate(_,{},H)],(se[0]>fd||se[1]>fd)&&en(`${o.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),o.addSymbols(o.text,K,se,T,y,_,I,e,C.lineStartIndex,C.lineLength,U,H);for(const ye of D)O[ye]=o.text.placedSymbolArray.length-1;return 4*K.length}function ab(o){for(const e in o)return o[e];return null}function uC(o,e,i,c){const f=o.compareText;if(e in f){const y=f[e];for(let _=y.length-1;_>=0;_--)if(c.dist(y[_])<i)return!0}else f[e]=[];return f[e].push(c),!1}const lb=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class dv{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,c]=new Uint8Array(e,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=c>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const y=lb[15&c];if(!y)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(e,2,1),[T]=new Uint32Array(e,4,1);return new dv(T,_,y,e)}constructor(e,i=64,c=Float64Array,f){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=c,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const y=lb.indexOf(this.ArrayType),_=2*e*this.ArrayType.BYTES_PER_ELEMENT,T=e*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-T%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+T+C,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+_+T+C),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+T+C,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=e)}add(e,i){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=e,this.coords[this._pos++]=i,c}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return fv(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,i,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:_,nodeSize:T}=this,C=[0,y.length-1,0],I=[];for(;C.length;){const D=C.pop()||0,O=C.pop()||0,U=C.pop()||0;if(O-U<=T){for(let J=U;J<=O;J++){const se=_[2*J],ye=_[2*J+1];se>=e&&se<=c&&ye>=i&&ye<=f&&I.push(y[J])}continue}const G=U+O>>1,H=_[2*G],K=_[2*G+1];H>=e&&H<=c&&K>=i&&K<=f&&I.push(y[G]),(D===0?e<=H:i<=K)&&(C.push(U),C.push(G-1),C.push(1-D)),(D===0?c>=H:f>=K)&&(C.push(G+1),C.push(O),C.push(1-D))}return I}within(e,i,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:y,nodeSize:_}=this,T=[0,f.length-1,0],C=[],I=c*c;for(;T.length;){const D=T.pop()||0,O=T.pop()||0,U=T.pop()||0;if(O-U<=_){for(let J=U;J<=O;J++)ub(y[2*J],y[2*J+1],e,i)<=I&&C.push(f[J]);continue}const G=U+O>>1,H=y[2*G],K=y[2*G+1];ub(H,K,e,i)<=I&&C.push(f[G]),(D===0?e-c<=H:i-c<=K)&&(T.push(U),T.push(G-1),T.push(1-D)),(D===0?e+c>=H:i+c>=K)&&(T.push(G+1),T.push(O),T.push(1-D))}return C}}function fv(o,e,i,c,f,y){if(f-c<=i)return;const _=c+f>>1;cb(o,e,_,c,f,y),fv(o,e,i,c,_-1,1-y),fv(o,e,i,_+1,f,1-y)}function cb(o,e,i,c,f,y){for(;f>c;){if(f-c>600){const I=f-c+1,D=i-c+1,O=Math.log(I),U=.5*Math.exp(2*O/3),G=.5*Math.sqrt(O*U*(I-U)/I)*(D-I/2<0?-1:1);cb(o,e,i,Math.max(c,Math.floor(i-D*U/I+G)),Math.min(f,Math.floor(i+(I-D)*U/I+G)),y)}const _=e[2*i+y];let T=c,C=f;for(og(o,e,c,i),e[2*f+y]>_&&og(o,e,c,f);T<C;){for(og(o,e,T,C),T++,C--;e[2*T+y]<_;)T++;for(;e[2*C+y]>_;)C--}e[2*c+y]===_?og(o,e,c,C):(C++,og(o,e,C,f)),C<=i&&(c=C+1),i<=C&&(f=C-1)}}function og(o,e,i,c){pv(o,i,c),pv(e,2*i,2*c),pv(e,2*i+1,2*c+1)}function pv(o,e,i){const c=o[e];o[e]=o[i],o[i]=c}function ub(o,e,i,c){const f=o-i,y=e-c;return f*f+y*y}var mv;v.cH=void 0,(mv=v.cH||(v.cH={})).create="create",mv.load="load",mv.fullLoad="fullLoad";let Yy=null,ag=[];const gv=1e3/60,yv="loadTime",_v="fullLoadTime",hC={mark(o){performance.mark(o)},frame(o){const e=o;Yy!=null&&ag.push(e-Yy),Yy=e},clearMetrics(){Yy=null,ag=[],performance.clearMeasures(yv),performance.clearMeasures(_v);for(const o in v.cH)performance.clearMarks(v.cH[o])},getPerformanceMetrics(){performance.measure(yv,v.cH.create,v.cH.load),performance.measure(_v,v.cH.create,v.cH.fullLoad);const o=performance.getEntriesByName(yv)[0].duration,e=performance.getEntriesByName(_v)[0].duration,i=ag.length,c=1/(ag.reduce(((y,_)=>y+_),0)/i/1e3),f=ag.filter((y=>y>gv)).reduce(((y,_)=>y+(_-gv)/gv),0);return{loadTime:o,fullLoadTime:e,fps:c,percentDroppedFrames:f/(i+f)*100,totalFrames:i}}};v.$=X,v.A=_e,v.B=Gs,v.C=$n,v.D=jt,v.E=kr,v.F=function([o,e,i]){return e+=90,e*=Math.PI/180,i*=Math.PI/180,{x:o*Math.cos(e)*Math.sin(i),y:o*Math.sin(e)*Math.sin(i),z:o*Math.cos(i)}},v.G=In,v.H=rn,v.I=Qn,v.J=Du,v.K=function(o){if(Xr==null){const e=o.navigator?o.navigator.userAgent:null;Xr=!!o.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Xr},v.L=class{constructor(o,e){this.target=o,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new CP((()=>this.process())),this.subscription=it(this.target,"message",(i=>this.receive(i)),!1),this.globalScope=vi(self)?o:window}registerMessageHandler(o,e){this.messageHandlers[o]=e}unregisterMessageHandler(o){delete this.messageHandlers[o]}sendAsync(o,e){return new Promise(((i,c)=>{const f=Math.round(1e18*Math.random()).toString(36).substring(0,10),y=e?it(e.signal,"abort",(()=>{y?.unsubscribe(),delete this.resolveRejects[f];const C={id:f,type:"<cancel>",origin:location.origin,targetMapId:o.targetMapId,sourceMapId:this.mapId};this.target.postMessage(C)}),EP):null;this.resolveRejects[f]={resolve:C=>{y?.unsubscribe(),i(C)},reject:C=>{y?.unsubscribe(),c(C)}};const _=[],T=Object.assign(Object.assign({},o),{id:f,sourceMapId:this.mapId,origin:location.origin,data:zi(o.data,_)});this.target.postMessage(T,{transfer:_})}))}receive(o){const e=o.data,i=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!=="resource://android"&&location.origin!=="resource://android"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[i];const c=this.abortControllers[i];return delete this.abortControllers[i],void(c&&c.abort())}if(vi(self)||e.mustQueue)return this.tasks[i]=e,this.taskQueue.push(i),void this.invoker.trigger();this.processTask(i,e)}}process(){if(this.taskQueue.length===0)return;const o=this.taskQueue.shift(),e=this.tasks[o];delete this.tasks[o],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(o,e)}processTask(o,e){return l(this,void 0,void 0,(function*(){if(e.type==="<response>"){const f=this.resolveRejects[o];return delete this.resolveRejects[o],f?void(e.error?f.reject(Fi(e.error)):f.resolve(Fi(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(o,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const i=Fi(e.data),c=new AbortController;this.abortControllers[o]=c;try{const f=yield this.messageHandlers[e.type](e.sourceMapId,i,c);this.completeTask(o,null,f)}catch(f){this.completeTask(o,f)}}))}completeTask(o,e,i){const c=[];delete this.abortControllers[o];const f={id:o,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?zi(e):null,data:zi(i,c)};this.target.postMessage(f,{transfer:c})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},v.M=Oe,v.N=function(){var o=new _e(16);return _e!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},v.O=function(o,e,i){var c,f,y,_,T,C,I,D,O,U,G,H,K=i[0],J=i[1],se=i[2];return e===o?(o[12]=e[0]*K+e[4]*J+e[8]*se+e[12],o[13]=e[1]*K+e[5]*J+e[9]*se+e[13],o[14]=e[2]*K+e[6]*J+e[10]*se+e[14],o[15]=e[3]*K+e[7]*J+e[11]*se+e[15]):(f=e[1],y=e[2],_=e[3],T=e[4],C=e[5],I=e[6],D=e[7],O=e[8],U=e[9],G=e[10],H=e[11],o[0]=c=e[0],o[1]=f,o[2]=y,o[3]=_,o[4]=T,o[5]=C,o[6]=I,o[7]=D,o[8]=O,o[9]=U,o[10]=G,o[11]=H,o[12]=c*K+T*J+O*se+e[12],o[13]=f*K+C*J+U*se+e[13],o[14]=y*K+I*J+G*se+e[14],o[15]=_*K+D*J+H*se+e[15]),o},v.P=A,v.Q=function(o,e,i){var c=i[0],f=i[1],y=i[2];return o[0]=e[0]*c,o[1]=e[1]*c,o[2]=e[2]*c,o[3]=e[3]*c,o[4]=e[4]*f,o[5]=e[5]*f,o[6]=e[6]*f,o[7]=e[7]*f,o[8]=e[8]*y,o[9]=e[9]*y,o[10]=e[10]*y,o[11]=e[11]*y,o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15],o},v.R=bs,v.S=function(o,e,i){var c=e[0],f=e[1],y=e[2],_=e[3],T=e[4],C=e[5],I=e[6],D=e[7],O=e[8],U=e[9],G=e[10],H=e[11],K=e[12],J=e[13],se=e[14],ye=e[15],ae=i[0],ue=i[1],ve=i[2],Ce=i[3];return o[0]=ae*c+ue*T+ve*O+Ce*K,o[1]=ae*f+ue*C+ve*U+Ce*J,o[2]=ae*y+ue*I+ve*G+Ce*se,o[3]=ae*_+ue*D+ve*H+Ce*ye,o[4]=(ae=i[4])*c+(ue=i[5])*T+(ve=i[6])*O+(Ce=i[7])*K,o[5]=ae*f+ue*C+ve*U+Ce*J,o[6]=ae*y+ue*I+ve*G+Ce*se,o[7]=ae*_+ue*D+ve*H+Ce*ye,o[8]=(ae=i[8])*c+(ue=i[9])*T+(ve=i[10])*O+(Ce=i[11])*K,o[9]=ae*f+ue*C+ve*U+Ce*J,o[10]=ae*y+ue*I+ve*G+Ce*se,o[11]=ae*_+ue*D+ve*H+Ce*ye,o[12]=(ae=i[12])*c+(ue=i[13])*T+(ve=i[14])*O+(Ce=i[15])*K,o[13]=ae*f+ue*C+ve*U+Ce*J,o[14]=ae*y+ue*I+ve*G+Ce*se,o[15]=ae*_+ue*D+ve*H+Ce*ye,o},v.T=xo,v.U=function(o,e){const i={};for(let c=0;c<e.length;c++){const f=e[c];f in o&&(i[f]=o[f])}return i},v.V=pd,v.W=St,v.X=a3,v.Y=o3,v.Z=we,v._=l,v.a=oe,v.a$=Ct,v.a0=le,v.a1=Ms,v.a2=va,v.a3=c3,v.a4=jy,v.a5=Be,v.a6=function(o,e,i){if(!o)return e||{};if(!e)return o||{};const c=f3(o),f=f3(e);(function(_,T){T.removeAll&&(_.add.clear(),_.update.clear(),_.remove.clear(),T.remove.clear());for(const C of T.remove)_.add.delete(C),_.update.delete(C);for(const[C,I]of T.update){const D=_.update.get(C);D&&(T.update.set(C,MP(D,I)),_.update.delete(C))}})(c,f);const y={};if((c.removeAll||f.removeAll)&&(y.removeAll=!0),y.remove=new Set([...c.remove,...f.remove]),y.add=new Map([...c.add,...f.add]),y.update=new Map([...c.update,...f.update]),y.remove.size&&y.add.size)for(const _ of y.add.keys())y.remove.delete(_);return(function(_){const T={};return _.removeAll&&(T.removeAll=_.removeAll),_.remove&&(T.remove=Array.from(_.remove)),_.add&&(T.add=Array.from(_.add.values())),_.update&&(T.update=Array.from(_.update.values())),T})(y)},v.a7=function(o,e){const i=new Map;if(o==null||o.type==null)return i;if(o.type==="Feature"){const c=W_(o,e);return c==null?void 0:(i.set(c,o),i)}if(o.type==="FeatureCollection"){const c=new Set;for(const f of o.features){const y=W_(f,e);if(y==null||c.has(y))return;c.add(y),i.set(y,f)}return i}},v.a8=function(o,e,i){var c,f;const y=[];if(e.removeAll)o.clear();else if(e.remove)for(const _ of e.remove){const T=o.get(_);T&&(y.push(T.geometry),o.delete(_))}if(e.add)for(const _ of e.add){const T=W_(_,i);if(T==null)continue;const C=o.get(T);C&&y.push(C.geometry),y.push(_.geometry),o.set(T,_)}if(e.update)for(const _ of e.update){const T=o.get(_.id);if(!T)continue;const C=!!_.newGeometry,I=_.removeAllProperties||((c=_.removeProperties)===null||c===void 0?void 0:c.length)>0||((f=_.addOrUpdateProperties)===null||f===void 0?void 0:f.length)>0;if(!C&&!I)continue;y.push(T.geometry);const D=Object.assign({},T);if(o.set(_.id,D),C&&(y.push(_.newGeometry),D.geometry=_.newGeometry),I){if(D.properties=_.removeAllProperties?{}:Object.assign({},D.properties||{}),_.removeProperties)for(const O of _.removeProperties)delete D.properties[O];if(_.addOrUpdateProperties)for(const{key:O,value:U}of _.addOrUpdateProperties)D.properties[O]=U}}return y},v.a9=rg,v.aA=function(o,{uSize:e,uSizeT:i},{lowerSize:c,upperSize:f}){return o.kind==="source"?c/Zu:o.kind==="composite"?In.number(c/Zu,f/Zu,i):e},v.aB=function(o,e){var i=e[0],c=e[1],f=e[2],y=e[3],_=e[4],T=e[5],C=e[6],I=e[7],D=e[8],O=e[9],U=e[10],G=e[11],H=e[12],K=e[13],J=e[14],se=e[15],ye=i*T-c*_,ae=i*C-f*_,ue=i*I-y*_,ve=c*C-f*T,Ce=c*I-y*T,je=f*I-y*C,ot=D*K-O*H,tt=D*J-U*H,ht=D*se-G*H,At=O*J-U*K,pt=O*se-G*K,rt=U*se-G*J,Ye=ye*rt-ae*pt+ue*At+ve*ht-Ce*tt+je*ot;return Ye?(o[0]=(T*rt-C*pt+I*At)*(Ye=1/Ye),o[1]=(f*pt-c*rt-y*At)*Ye,o[2]=(K*je-J*Ce+se*ve)*Ye,o[3]=(U*Ce-O*je-G*ve)*Ye,o[4]=(C*ht-_*rt-I*tt)*Ye,o[5]=(i*rt-f*ht+y*tt)*Ye,o[6]=(J*ue-H*je-se*ae)*Ye,o[7]=(D*je-U*ue+G*ae)*Ye,o[8]=(_*pt-T*ht+I*ot)*Ye,o[9]=(c*ht-i*pt-y*ot)*Ye,o[10]=(H*Ce-K*ue+se*ye)*Ye,o[11]=(O*ue-D*Ce-G*ye)*Ye,o[12]=(T*tt-_*At-C*ot)*Ye,o[13]=(i*At-c*tt+f*ot)*Ye,o[14]=(K*ae-H*ve-J*ye)*Ye,o[15]=(D*ve-O*ae+U*ye)*Ye,o):null},v.aC=mt,v.aD=function(o){var e=o[0],i=o[1];return Math.sqrt(e*e+i*i)},v.aE=function(o){return o[0]=0,o[1]=0,o},v.aF=function(o,e,i){return o[0]=e[0]*i,o[1]=e[1]*i,o},v.aG=V_,v.aH=ft,v.aI=function(o,e,i,c){const f=e.y-o.y,y=e.x-o.x,_=c.y-i.y,T=c.x-i.x,C=_*y-T*f;if(C===0)return null;const I=(T*(o.y-i.y)-_*(o.x-i.x))/C;return new A(o.x+I*y,o.y+I*f)},v.aJ=H3,v.aK=Fc,v.aL=function(o){let e=1/0,i=1/0,c=-1/0,f=-1/0;for(const y of o)e=Math.min(e,y.x),i=Math.min(i,y.y),c=Math.max(c,y.x),f=Math.max(f,y.y);return[e,i,c,f]},v.aM=Ii,v.aN=_t,v.aO=function(o,e,i,c,f=!1){if(!i[0]&&!i[1])return[0,0];const y=f?c==="map"?-o.bearingInRadians:0:c==="viewport"?o.bearingInRadians:0;if(y){const _=Math.sin(y),T=Math.cos(y);i=[i[0]*T-i[1]*_,i[0]*_+i[1]*T]}return[f?i[0]:_t(e,i[0],o.zoom),f?i[1]:_t(e,i[1],o.zoom)]},v.aQ=B_,v.aR=hv,v.aS=Rt,v.aT=dv,v.aU=Gn,v.aV=Uc,v.aW=de,v.aX=kt,v.aY=qe,v.aZ=Mt,v.a_=u3,v.aa=Cf,v.ab=25,v.ac=Z_,v.ad=o=>{const e=window.document.createElement("video");return e.muted=!0,new Promise((i=>{e.onloadstart=()=>{i(e)};for(const c of o){const f=window.document.createElement("source");st(c)||(e.crossOrigin="Anonymous"),f.src=c,e.appendChild(f)}}))},v.ae=yt,v.af=function(){return yr++},v.ag=g,v.ah=kp,v.ai=sg,v.aj=Ml,v.ak=fa,v.al=m3,v.am=function(o){const e={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((i,c,f,y)=>{const _=f||y;return e[c]=!_||_.toLowerCase(),""})),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e},v.an=sr,v.ao=85.051129,v.ap=Vt,v.aq=function(o){return Math.pow(2,o)},v.ar=ke,v.as=l3,v.at=function(o){return Math.log(o)/Math.LN2},v.au=function(o){var e=o[0],i=o[1];return e*e+i*i},v.av=function(o){if(!o.length)return new Set;const e=Math.max(...o.map((C=>C.canonical.z)));let i=1/0,c=-1/0,f=1/0,y=-1/0;const _=[];for(const C of o){const{x:I,y:D,z:O}=C.canonical,U=Math.pow(2,e-O),G=I*U,H=D*U;_.push({id:C,x:G,y:H}),G<i&&(i=G),G>c&&(c=G),H<f&&(f=H),H>y&&(y=H)}const T=new Set;for(const C of _)C.x!==i&&C.x!==c&&C.y!==f&&C.y!==y||T.add(C.id);return T},v.aw=function(o,e){const i=Math.abs(2*o.wrap)-+(o.wrap<0),c=Math.abs(2*e.wrap)-+(e.wrap<0);return o.overscaledZ-e.overscaledZ||c-i||e.canonical.y-o.canonical.y||e.canonical.x-o.canonical.x},v.ax=class{constructor(o,e){this.max=o,this.onRemove=e,this.reset()}reset(){for(const o in this.data)for(const e of this.data[o])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(o,e,i){const c=o.wrapped().key;this.data[c]===void 0&&(this.data[c]=[]);const f={value:e,timeout:void 0};if(i!==void 0&&(f.timeout=setTimeout((()=>{this.remove(o,f)}),i)),this.data[c].push(f),this.order.push(c),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const e=this.data[o].shift();return e.timeout&&clearTimeout(e.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),e.value}getByKey(o){const e=this.data[o];return e?e[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,e){if(!this.has(o))return this;const i=o.wrapped().key,c=e===void 0?0:this.data[i].indexOf(e),f=this.data[i][c];return this.data[i].splice(c,1),f.timeout&&clearTimeout(f.timeout),this.data[i].length===0&&delete this.data[i],this.onRemove(f.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(o){const e=[];for(const i in this.data)for(const c of this.data[i])o(c.value)||e.push(c);for(const i of e)this.remove(i.value.tileID,i)}},v.ay=function(o,e){let i=0,c=0;if(o.kind==="constant")c=o.layoutSize;else if(o.kind!=="source"){const{interpolationType:f,minZoom:y,maxZoom:_}=o,T=f?sr(Si.interpolationFactor(f,e,y,_),0,1):0;o.kind==="camera"?c=In.number(o.minSize,o.maxSize,T):i=T}return{uSizeT:i,uSize:c}},v.b=io,v.b$=ha,v.b0=Pt,v.b1=function(o){var e=new _e(3);return e[0]=o[0],e[1]=o[1],e[2]=o[2],e},v.b2=function(o,e,i){return o[0]=e[0]-i[0],o[1]=e[1]-i[1],o[2]=e[2]-i[2],o},v.b3=function(o,e){var i=e[0],c=e[1],f=e[2],y=i*i+c*c+f*f;return y>0&&(y=1/Math.sqrt(y)),o[0]=e[0]*y,o[1]=e[1]*y,o[2]=e[2]*y,o},v.b4=Zt,v.b5=function(o,e){return o[0]*e[0]+o[1]*e[1]+o[2]*e[2]},v.b6=function(o,e,i){return o[0]=e[0]*i[0],o[1]=e[1]*i[1],o[2]=e[2]*i[2],o[3]=e[3]*i[3],o},v.b7=He,v.b8=function(o,e,i){const c=e[0]*i[0]+e[1]*i[1]+e[2]*i[2];return c===0?null:(-(o[0]*i[0]+o[1]*i[1]+o[2]*i[2])-i[3])/c},v.b9=Et,v.bA=function(o,e,i,c){return o[0]=e[0]+i[0]*c,o[1]=e[1]+i[1]*c,o[2]=e[2]+i[2]*c,o},v.bB=dt,v.bC=function(o,e,i){var c=i[0],f=i[1],y=i[2],_=i[3],T=e[0],C=e[1],I=e[2],D=f*I-y*C,O=y*T-c*I,U=c*C-f*T;return o[0]=T+_*(D+=D)+f*(U+=U)-y*(O+=O),o[1]=C+_*O+y*D-c*U,o[2]=I+_*U+c*O-f*D,o},v.bD=function(o,e,i){const c=(function(C){var I=C[3],D=C[4],O=C[5],U=C[6],G=C[7],H=C[8];return C[0]*(H*D-O*G)+C[1]*(-H*I+O*U)+C[2]*(G*I-D*U)})([o[0],o[1],o[2],e[0],e[1],e[2],i[0],i[1],i[2]]);if(c===0)return null;const f=Zt([],[e[0],e[1],e[2]],[i[0],i[1],i[2]]),y=Zt([],[i[0],i[1],i[2]],[o[0],o[1],o[2]]),_=Zt([],[o[0],o[1],o[2]],[e[0],e[1],e[2]]),T=Ct([],f,-o[3]);return Pt(T,T,Ct([],y,-e[3])),Pt(T,T,Ct([],_,-i[3])),Ct(T,T,1/c),T},v.bE=q_,v.bF=function(){return new Float64Array(4)},v.bG=function(o,e,i,c){var f=[],y=[];return f[0]=e[0]-i[0],f[1]=e[1]-i[1],f[2]=e[2]-i[2],y[0]=f[0]*Math.cos(c)-f[1]*Math.sin(c),y[1]=f[0]*Math.sin(c)+f[1]*Math.cos(c),y[2]=f[2],o[0]=y[0]+i[0],o[1]=y[1]+i[1],o[2]=y[2]+i[2],o},v.bH=function(o,e,i,c){var f=[],y=[];return f[0]=e[0]-i[0],f[1]=e[1]-i[1],f[2]=e[2]-i[2],y[0]=f[0],y[1]=f[1]*Math.cos(c)-f[2]*Math.sin(c),y[2]=f[1]*Math.sin(c)+f[2]*Math.cos(c),o[0]=y[0]+i[0],o[1]=y[1]+i[1],o[2]=y[2]+i[2],o},v.bI=function(o,e,i,c){var f=[],y=[];return f[0]=e[0]-i[0],f[1]=e[1]-i[1],f[2]=e[2]-i[2],y[0]=f[2]*Math.sin(c)+f[0]*Math.cos(c),y[1]=f[1],y[2]=f[2]*Math.cos(c)-f[0]*Math.sin(c),o[0]=y[0]+i[0],o[1]=y[1]+i[1],o[2]=y[2]+i[2],o},v.bJ=function(o,e,i){var c=Math.sin(i),f=Math.cos(i),y=e[0],_=e[1],T=e[2],C=e[3],I=e[8],D=e[9],O=e[10],U=e[11];return e!==o&&(o[4]=e[4],o[5]=e[5],o[6]=e[6],o[7]=e[7],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o[0]=y*f-I*c,o[1]=_*f-D*c,o[2]=T*f-O*c,o[3]=C*f-U*c,o[8]=y*c+I*f,o[9]=_*c+D*f,o[10]=T*c+O*f,o[11]=C*c+U*f,o},v.bK=function(o,e){const i=Re(o,360),c=Re(e,360),f=c-i,y=c>i?f-360:f+360;return Math.abs(f)<Math.abs(y)?f:y},v.bL=function(o){return o[0]=0,o[1]=0,o[2]=0,o},v.bM=function(o,e,i,c){const f=Math.sqrt(o*o+e*e),y=Math.sqrt(i*i+c*c);o/=f,e/=f,i/=y,c/=y;const _=Math.acos(o*i+e*c);return-e*i+o*c>0?_:-_},v.bN=function(o,e){const i=Re(o,2*Math.PI),c=Re(e,2*Math.PI);return Math.min(Math.abs(i-c),Math.abs(i-c+2*Math.PI),Math.abs(i-c-2*Math.PI))},v.bO=function(){const o={},e=$e.$version;for(const i in $e.$root){const c=$e.$root[i];if(c.required){let f=null;f=i==="version"?e:c.type==="array"?[]:{},f!=null&&(o[i]=f)}}return o},v.bP=Ze,v.bQ=Tn,v.bR=function o(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(let c=0;c<e.length;c++)if(!o(e[c],i[c]))return!1;return!0}if(typeof e=="object"&&e!==null&&i!==null){if(typeof i!="object"||Object.keys(e).length!==Object.keys(i).length)return!1;for(const c in e)if(!o(e[c],i[c]))return!1;return!0}return e===i},v.bS=function(o){o=o.slice();const e=Object.create(null);for(let i=0;i<o.length;i++)e[o[i].id]=o[i];for(let i=0;i<o.length;i++)"ref"in o[i]&&(o[i]=xi(o[i],e[o[i].ref]));return o},v.bT=function(o,e){if(o.type==="custom")return new PP(o,e);switch(o.type){case"background":return new SP(o,e);case"circle":return new sd(o,e);case"color-relief":return new z_(o,e);case"fill":return new by(o,e);case"fill-extrusion":return new O_(o,e);case"heatmap":return new Vm(o,e);case"hillshade":return new Oc(o,e);case"line":return new Jm(o,e);case"raster":return new Ya(o,e);case"symbol":return new Ny(o,e)}},v.bU=o=>o.type==="raster",v.bV=jr,v.bW=function(o,e){if(!o)return[{command:"setStyle",args:[e]}];let i=[];try{if(!fr(o.version,e.version))return[{command:"setStyle",args:[e]}];fr(o.center,e.center)||i.push({command:"setCenter",args:[e.center]}),fr(o.state,e.state)||i.push({command:"setGlobalState",args:[e.state]}),fr(o.centerAltitude,e.centerAltitude)||i.push({command:"setCenterAltitude",args:[e.centerAltitude]}),fr(o.zoom,e.zoom)||i.push({command:"setZoom",args:[e.zoom]}),fr(o.bearing,e.bearing)||i.push({command:"setBearing",args:[e.bearing]}),fr(o.pitch,e.pitch)||i.push({command:"setPitch",args:[e.pitch]}),fr(o.roll,e.roll)||i.push({command:"setRoll",args:[e.roll]}),fr(o.sprite,e.sprite)||i.push({command:"setSprite",args:[e.sprite]}),fr(o.glyphs,e.glyphs)||i.push({command:"setGlyphs",args:[e.glyphs]}),fr(o.transition,e.transition)||i.push({command:"setTransition",args:[e.transition]}),fr(o.light,e.light)||i.push({command:"setLight",args:[e.light]}),fr(o.terrain,e.terrain)||i.push({command:"setTerrain",args:[e.terrain]}),fr(o.sky,e.sky)||i.push({command:"setSky",args:[e.sky]}),fr(o.projection,e.projection)||i.push({command:"setProjection",args:[e.projection]});const c={},f=[];(function(_,T,C,I){let D;for(D in T=T||{},_=_||{})Object.prototype.hasOwnProperty.call(_,D)&&(Object.prototype.hasOwnProperty.call(T,D)||mn(D,C,I));for(D in T)Object.prototype.hasOwnProperty.call(T,D)&&(Object.prototype.hasOwnProperty.call(_,D)?fr(_[D],T[D])||(_[D].type==="geojson"&&T[D].type==="geojson"&&tn(_,T,D)?Kr(C,{command:"setGeoJSONSourceData",args:[D,T[D].data]}):gn(D,T,C,I)):hi(D,T,C))})(o.sources,e.sources,f,c);const y=[];o.layers&&o.layers.forEach((_=>{"source"in _&&c[_.source]?i.push({command:"removeLayer",args:[_.id]}):y.push(_)})),i=i.concat(f),(function(_,T,C){T=T||[];const I=(_=_||[]).map(ou),D=T.map(ou),O=_.reduce(Jo,{}),U=T.reduce(Jo,{}),G=I.slice(),H=Object.create(null);let K,J,se,ye,ae;for(let ue=0,ve=0;ue<I.length;ue++)K=I[ue],Object.prototype.hasOwnProperty.call(U,K)?ve++:(Kr(C,{command:"removeLayer",args:[K]}),G.splice(G.indexOf(K,ve),1));for(let ue=0,ve=0;ue<D.length;ue++)K=D[D.length-1-ue],G[G.length-1-ue]!==K&&(Object.prototype.hasOwnProperty.call(O,K)?(Kr(C,{command:"removeLayer",args:[K]}),G.splice(G.lastIndexOf(K,G.length-ve),1)):ve++,ye=G[G.length-ue],Kr(C,{command:"addLayer",args:[U[K],ye]}),G.splice(G.length-ue,0,K),H[K]=!0);for(let ue=0;ue<D.length;ue++)if(K=D[ue],J=O[K],se=U[K],!H[K]&&!fr(J,se))if(fr(J.source,se.source)&&fr(J["source-layer"],se["source-layer"])&&fr(J.type,se.type)){for(ae in On(J.layout,se.layout,C,K,null,"setLayoutProperty"),On(J.paint,se.paint,C,K,null,"setPaintProperty"),fr(J.filter,se.filter)||Kr(C,{command:"setFilter",args:[K,se.filter]}),fr(J.minzoom,se.minzoom)&&fr(J.maxzoom,se.maxzoom)||Kr(C,{command:"setLayerZoomRange",args:[K,se.minzoom,se.maxzoom]}),J)Object.prototype.hasOwnProperty.call(J,ae)&&ae!=="layout"&&ae!=="paint"&&ae!=="filter"&&ae!=="metadata"&&ae!=="minzoom"&&ae!=="maxzoom"&&(ae.indexOf("paint.")===0?On(J[ae],se[ae],C,K,ae.slice(6),"setPaintProperty"):fr(J[ae],se[ae])||Kr(C,{command:"setLayerProperty",args:[K,ae,se[ae]]}));for(ae in se)Object.prototype.hasOwnProperty.call(se,ae)&&!Object.prototype.hasOwnProperty.call(J,ae)&&ae!=="layout"&&ae!=="paint"&&ae!=="filter"&&ae!=="metadata"&&ae!=="minzoom"&&ae!=="maxzoom"&&(ae.indexOf("paint.")===0?On(J[ae],se[ae],C,K,ae.slice(6),"setPaintProperty"):fr(J[ae],se[ae])||Kr(C,{command:"setLayerProperty",args:[K,ae,se[ae]]}))}else Kr(C,{command:"removeLayer",args:[K]}),ye=G[G.lastIndexOf(K)+1],Kr(C,{command:"addLayer",args:[se,ye]})})(y,e.layers,i)}catch(c){console.warn("Unable to compute style diff:",c),i=[{command:"setStyle",args:[e]}]}return i},v.bX=function(o){const e=[],i=o.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),o.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},v.bY=cr,v.bZ=Lr,v.b_=class extends os{constructor(o,e){super(o,e),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},v.ba=function(o,e,i){return o[0]=e[0]*i,o[1]=e[1]*i,o[2]=e[2]*i,o[3]=e[3]*i,o},v.bb=function(o,e){return o[0]*e[0]+o[1]*e[1]+o[2]*e[2]+o[3]},v.bc=d3,v.bd=Dp,v.be=function(o,e,i,c,f){var y=1/Math.tan(e/2);if(o[0]=y/i,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=y,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,f!=null&&f!==1/0){var _=1/(c-f);o[10]=(f+c)*_,o[14]=2*f*c*_}else o[10]=-1,o[14]=-2*c;return o},v.bf=function(o){var e=new _e(16);return e[0]=o[0],e[1]=o[1],e[2]=o[2],e[3]=o[3],e[4]=o[4],e[5]=o[5],e[6]=o[6],e[7]=o[7],e[8]=o[8],e[9]=o[9],e[10]=o[10],e[11]=o[11],e[12]=o[12],e[13]=o[13],e[14]=o[14],e[15]=o[15],e},v.bg=function(o,e,i){var c=Math.sin(i),f=Math.cos(i),y=e[0],_=e[1],T=e[2],C=e[3],I=e[4],D=e[5],O=e[6],U=e[7];return e!==o&&(o[8]=e[8],o[9]=e[9],o[10]=e[10],o[11]=e[11],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o[0]=y*f+I*c,o[1]=_*f+D*c,o[2]=T*f+O*c,o[3]=C*f+U*c,o[4]=I*f-y*c,o[5]=D*f-_*c,o[6]=O*f-T*c,o[7]=U*f-C*c,o},v.bh=function(o,e,i){var c=Math.sin(i),f=Math.cos(i),y=e[4],_=e[5],T=e[6],C=e[7],I=e[8],D=e[9],O=e[10],U=e[11];return e!==o&&(o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o[4]=y*f+I*c,o[5]=_*f+D*c,o[6]=T*f+O*c,o[7]=C*f+U*c,o[8]=I*f-y*c,o[9]=D*f-_*c,o[10]=O*f-T*c,o[11]=U*f-C*c,o},v.bi=function(){const o=new Float32Array(16);return ke(o),o},v.bj=function(){const o=new Float64Array(16);return ke(o),o},v.bk=function(){return new Float64Array(16)},v.bl=function(o,e,i){const c=new Float64Array(4);return dt(c,o,e-90,i),c},v.bm=function(o,e,i,c){var f,y,_,T,C,I=e[0],D=e[1],O=e[2],U=e[3],G=i[0],H=i[1],K=i[2],J=i[3];return(y=I*G+D*H+O*K+U*J)<0&&(y=-y,G=-G,H=-H,K=-K,J=-J),1-y>he?(f=Math.acos(y),_=Math.sin(f),T=Math.sin((1-c)*f)/_,C=Math.sin(c*f)/_):(T=1-c,C=c),o[0]=T*I+C*G,o[1]=T*D+C*H,o[2]=T*O+C*K,o[3]=T*U+C*J,o},v.bn=function(o){const e=new Float64Array(9);(function(y,_){var T=_[0],C=_[1],I=_[2],D=_[3],O=T+T,U=C+C,G=I+I,H=T*O,K=C*O,J=C*U,se=I*O,ye=I*U,ae=I*G,ue=D*O,ve=D*U,Ce=D*G;y[0]=1-J-ae,y[3]=K-Ce,y[6]=se+ve,y[1]=K+Ce,y[4]=1-H-ae,y[7]=ye-ue,y[2]=se-ve,y[5]=ye+ue,y[8]=1-H-J})(e,o);const i=Mt(-Math.asin(sr(e[2],-1,1)));let c,f;return Math.hypot(e[5],e[8])<.001?(c=0,f=-Mt(Math.atan2(e[3],e[4]))):(c=Mt(e[5]===0&&e[8]===0?0:Math.atan2(e[5],e[8])),f=Mt(e[1]===0&&e[0]===0?0:Math.atan2(e[1],e[0]))),{roll:c,pitch:i+90,bearing:f}},v.bo=function(o,e){return o.roll==e.roll&&o.pitch==e.pitch&&o.bearing==e.bearing},v.bp=xr,v.bq=ua,v.br=$c,v.bs=Gc,v.bt=Zl,v.bu=at,v.bv=nr,v.bw=Ti,v.bx=function(o,e,i,c,f){return at(c,f,sr((o-e)/(i-e),0,1))},v.by=Re,v.bz=function(){return new Float64Array(3)},v.c=Ee,v.c$=function(o,e,i,c,f){return l(this,void 0,void 0,(function*(){if(le())try{return yield Ms(o,e,i,c,f)}catch{}return(function(y,_,T,C,I){const D=y.width,O=y.height;Ae&&Ue||(Ae=new OffscreenCanvas(D,O),Ue=Ae.getContext("2d",{willReadFrequently:!0})),Ae.width=D,Ae.height=O,Ue.drawImage(y,0,0,D,O);const U=Ue.getImageData(_,T,C,I);return Ue.clearRect(0,0,D,O),U.data})(o,e,i,c,f)}))},v.c0=class extends os{constructor(o,e){super(o,e),this.current=vs}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let e=1;e<16;e++)if(o[e]!==this.current[e]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},v.c1=Uo,v.c2=class extends os{constructor(o,e){super(o,e),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},v.c3=class extends os{constructor(o,e){super(o,e),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},v.c4=Ie,v.c5=function(o,e){var i=Math.sin(e),c=Math.cos(e);return o[0]=c,o[1]=i,o[2]=0,o[3]=-i,o[4]=c,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},v.c6=function(o,e,i){var c=e[0],f=e[1],y=e[2];return o[0]=c*i[0]+f*i[3]+y*i[6],o[1]=c*i[1]+f*i[4]+y*i[7],o[2]=c*i[2]+f*i[5]+y*i[8],o},v.c7=function(o,e,i,c,f,y,_){var T=1/(e-i),C=1/(c-f),I=1/(y-_);return o[0]=-2*T,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*C,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*I,o[11]=0,o[12]=(e+i)*T,o[13]=(f+c)*C,o[14]=(_+y)*I,o[15]=1,o},v.c8=class extends os{constructor(o,e){super(o,e),this.current=new Array}set(o){if(o!=this.current){this.current=o;const e=new Float32Array(4*o.length);for(let i=0;i<o.length;i++)e[4*i]=o[i].r,e[4*i+1]=o[i].g,e[4*i+2]=o[i].b,e[4*i+3]=o[i].a;this.gl.uniform4fv(this.location,e)}}},v.c9=class extends os{constructor(o,e){super(o,e),this.current=new Array}set(o){if(o!=this.current){this.current=o;const e=new Float32Array(o);this.gl.uniform1fv(this.location,e)}}},v.cA=function(o,e){return xe[e]&&"touches"in o},v.cB=function(o){return xe[o]||ee[o]},v.cC=function(o,e,i){var c=e[0],f=e[1];return o[0]=i[0]*c+i[4]*f+i[12],o[1]=i[1]*c+i[5]*f+i[13],o},v.cD=function(o,e){const{x:i,y:c}=rg.fromLngLat(e);return!(o<0||o>25||c<0||c>=1||i<0||i>=1)},v.cE=function(o,e){return o[0]=e[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=e[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=e[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},v.cF=class extends Qa{},v.cG=hC,v.cI=De,v.cJ=function(o,e){Ee.REGISTERED_PROTOCOLS[o]=e},v.cK=function(o){delete Ee.REGISTERED_PROTOCOLS[o]},v.cL=function(o,e){const i={};for(let f=0;f<o.length;f++){const y=e&&e[o[f].id]||ia(o[f]);e&&(e[o[f].id]=y);let _=i[y];_||(_=i[y]=[]),_.push(o[f])}const c=[];for(const f in i)c.push(i[f]);return c},v.cM=zt,v.cN=p3,v.cO=Z3,v.cP=We,v.cQ=function(o){o.bucket.createArrays(),o.bucket.tilePixelRatio=Be/(512*o.bucket.overscaling),o.bucket.compareText={},o.bucket.iconsNeedLinear=!1;const e=o.bucket.layers[0],i=e.layout,c=e._unevaluatedLayout._values,f={layoutIconSize:c["icon-size"].possiblyEvaluate(new rn(o.bucket.zoom+1),o.canonical),layoutTextSize:c["text-size"].possiblyEvaluate(new rn(o.bucket.zoom+1),o.canonical),textMaxSize:c["text-size"].possiblyEvaluate(new rn(18))};if(o.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:D}=o.bucket.textSizeData;f.compositeTextSizes=[c["text-size"].possiblyEvaluate(new rn(I),o.canonical),c["text-size"].possiblyEvaluate(new rn(D),o.canonical)]}if(o.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:D}=o.bucket.iconSizeData;f.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new rn(I),o.canonical),c["icon-size"].possiblyEvaluate(new rn(D),o.canonical)]}const y=i.get("text-line-height")*Ii,_=i.get("text-rotation-alignment")!=="viewport"&&i.get("symbol-placement")!=="point",T=i.get("text-keep-upright"),C=i.get("text-size");for(const I of o.bucket.features){const D=i.get("text-font").evaluate(I,{},o.canonical).join(","),O=C.evaluate(I,{},o.canonical),U=f.layoutTextSize.evaluate(I,{},o.canonical),G=f.layoutIconSize.evaluate(I,{},o.canonical),H={horizontal:{},vertical:void 0},K=I.text;let J,se=[0,0];if(K){const ue=K.toString(),ve=i.get("text-letter-spacing").evaluate(I,{},o.canonical)*Ii,Ce=lf(ue)?ve:0,je=i.get("text-anchor").evaluate(I,{},o.canonical),ot=sb(e,I,o.canonical);if(!ot){const pt=i.get("text-radial-offset").evaluate(I,{},o.canonical);se=pt?ib(je,[pt*Ii,uv]):i.get("text-offset").evaluate(I,{},o.canonical).map((rt=>rt*Ii))}let tt=_?"center":i.get("text-justify").evaluate(I,{},o.canonical);const ht=i.get("symbol-placement")==="point"?i.get("text-max-width").evaluate(I,{},o.canonical)*Ii:1/0,At=()=>{o.bucket.allowVerticalPlacement&&Ha(ue)&&(H.vertical=Qe(K,o.glyphMap,o.glyphPositions,o.imagePositions,D,ht,y,je,"left",Ce,se,v.az.vertical,!0,U,O))};if(!_&&ot){const pt=new Set;if(tt==="auto")for(let Ye=0;Ye<ot.values.length;Ye+=2)pt.add(hv(ot.values[Ye]));else pt.add(tt);let rt=!1;for(const Ye of pt)if(!H.horizontal[Ye])if(rt)H.horizontal[Ye]=H.horizontal[0];else{const Bt=Qe(K,o.glyphMap,o.glyphPositions,o.imagePositions,D,ht,y,"center",Ye,Ce,se,v.az.horizontal,!1,U,O);Bt&&(H.horizontal[Ye]=Bt,rt=Bt.positionedLines.length===1)}At()}else{tt==="auto"&&(tt=hv(je));const pt=Qe(K,o.glyphMap,o.glyphPositions,o.imagePositions,D,ht,y,je,tt,Ce,se,v.az.horizontal,!1,U,O);pt&&(H.horizontal[tt]=pt),At(),Ha(ue)&&_&&T&&(H.vertical=Qe(K,o.glyphMap,o.glyphPositions,o.imagePositions,D,ht,y,je,tt,Ce,se,v.az.vertical,!1,U,O))}}let ye=!1;if(I.icon&&I.icon.name){const ue=o.imageMap[I.icon.name];ue&&(J=Wc(o.imagePositions[I.icon.name],i.get("icon-offset").evaluate(I,{},o.canonical),i.get("icon-anchor").evaluate(I,{},o.canonical)),ye=!!ue.sdf,o.bucket.sdfIcons===void 0?o.bucket.sdfIcons=ye:o.bucket.sdfIcons!==ye&&en("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ue.pixelRatio!==o.bucket.pixelRatio||i.get("icon-rotate").constantOr(1)!==0)&&(o.bucket.iconsNeedLinear=!0))}const ae=ab(H.horizontal)||H.vertical;o.bucket.iconsInText=!!ae&&ae.iconsInText,(ae||J)&&cC(o.bucket,I,H,J,o.imageMap,f,U,G,se,ye,o.canonical,o.subdivisionGranularity)}o.showCollisionBoxes&&o.bucket.generateCollisionDebugBuffers()},v.cR=vf,v.cS=Xm,v.cT=ud,v.cU=function(o){const e=new h;return(function(i,c){for(const f in i.layers)c.writeMessage(3,XP,i.layers[f])})(o,e),e.finish()},v.cV=function(o,e,i,c,f,y){let _=X3(o,e,i,f,0);return _=X3(_,e,c,y,1),_},v.cW=class{constructor(o){this.maxEntries=o,this.map=new Map}get(o){const e=this.map.get(o);return e!==void 0&&(this.map.delete(o),this.map.set(o,e)),e}set(o,e){if(this.map.has(o))this.map.delete(o);else if(this.map.size>=this.maxEntries){const i=this.map.keys().next().value;this.map.delete(i)}this.map.set(o,e)}clear(){this.map.clear()}},v.cX=Ty,v.cY=h,v.cZ=G3,v.c_=class{constructor(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let o=performance.getEntriesByName(this._marks.measure);return o.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),o=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),o}},v.ca=class extends la{},v.cb=Dy,v.cc=class extends xn{},v.cd=gf,v.ce=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},v.cf=Bm,v.cg=function(o,e,i){var c=e[0],f=e[1],y=e[2],_=i[3]*c+i[7]*f+i[11]*y+i[15];return o[0]=(i[0]*c+i[4]*f+i[8]*y+i[12])/(_=_||1),o[1]=(i[1]*c+i[5]*f+i[9]*y+i[13])/_,o[2]=(i[2]*c+i[6]*f+i[10]*y+i[14])/_,o},v.ch=class extends Ol{},v.ci=class extends t{},v.cj=function(o,e){return o[0]===e[0]&&o[1]===e[1]&&o[2]===e[2]&&o[3]===e[3]&&o[4]===e[4]&&o[5]===e[5]&&o[6]===e[6]&&o[7]===e[7]&&o[8]===e[8]&&o[9]===e[9]&&o[10]===e[10]&&o[11]===e[11]&&o[12]===e[12]&&o[13]===e[13]&&o[14]===e[14]&&o[15]===e[15]},v.ck=function(o,e){var i=o[0],c=o[1],f=o[2],y=o[3],_=o[4],T=o[5],C=o[6],I=o[7],D=o[8],O=o[9],U=o[10],G=o[11],H=o[12],K=o[13],J=o[14],se=o[15],ye=e[0],ae=e[1],ue=e[2],ve=e[3],Ce=e[4],je=e[5],ot=e[6],tt=e[7],ht=e[8],At=e[9],pt=e[10],rt=e[11],Ye=e[12],Bt=e[13],Nt=e[14],Ut=e[15];return Math.abs(i-ye)<=he*Math.max(1,Math.abs(i),Math.abs(ye))&&Math.abs(c-ae)<=he*Math.max(1,Math.abs(c),Math.abs(ae))&&Math.abs(f-ue)<=he*Math.max(1,Math.abs(f),Math.abs(ue))&&Math.abs(y-ve)<=he*Math.max(1,Math.abs(y),Math.abs(ve))&&Math.abs(_-Ce)<=he*Math.max(1,Math.abs(_),Math.abs(Ce))&&Math.abs(T-je)<=he*Math.max(1,Math.abs(T),Math.abs(je))&&Math.abs(C-ot)<=he*Math.max(1,Math.abs(C),Math.abs(ot))&&Math.abs(I-tt)<=he*Math.max(1,Math.abs(I),Math.abs(tt))&&Math.abs(D-ht)<=he*Math.max(1,Math.abs(D),Math.abs(ht))&&Math.abs(O-At)<=he*Math.max(1,Math.abs(O),Math.abs(At))&&Math.abs(U-pt)<=he*Math.max(1,Math.abs(U),Math.abs(pt))&&Math.abs(G-rt)<=he*Math.max(1,Math.abs(G),Math.abs(rt))&&Math.abs(H-Ye)<=he*Math.max(1,Math.abs(H),Math.abs(Ye))&&Math.abs(K-Bt)<=he*Math.max(1,Math.abs(K),Math.abs(Bt))&&Math.abs(J-Nt)<=he*Math.max(1,Math.abs(J),Math.abs(Nt))&&Math.abs(se-Ut)<=he*Math.max(1,Math.abs(se),Math.abs(Ut))},v.cl=function(o,e){return o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[4]=e[4],o[5]=e[5],o[6]=e[6],o[7]=e[7],o[8]=e[8],o[9]=e[9],o[10]=e[10],o[11]=e[11],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15],o},v.cm=o=>o.type==="symbol",v.cn=o=>o.type==="circle",v.co=o=>o.type==="heatmap",v.cp=o=>o.type==="line",v.cq=o=>o.type==="fill",v.cr=o=>o.type==="fill-extrusion",v.cs=o=>o.type==="hillshade",v.ct=o=>o.type==="color-relief",v.cu=o=>o.type==="background",v.cv=o=>o.type==="custom",v.cw=er,v.cx=function(o,e,i){const c=Xe(e.x-i.x,e.y-i.y),f=Xe(o.x-i.x,o.y-i.y),y=Math.atan2(c[0]*f[1]-c[1]*f[0],(function(_,T){return _[0]*T[0]+_[1]*T[1]})(c,f));return Mt(y)},v.cy=ir,v.cz=function(o,e){return ee[e]&&(o instanceof MouseEvent||o instanceof WheelEvent)},v.d=st,v.d0=$m,v.d1=R,v.d2=class{constructor(o,e){this.layers={[sg]:this},this.name=sg,this.version=e?e.version:1,this.extent=e?e.extent:4096,this.length=o.length,this.features=o}feature(o){return new HP(this.features[o],this.extent)}},v.d3=El,v.d4=oa,v.e=Gt,v.f=o=>l(void 0,void 0,void 0,(function*(){if(o.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(o)],{type:"image/png"});try{return createImageBitmap(e)}catch(i){throw new Error(`Could not load image because of ${i.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),v.g=Ne,v.h=o=>new Promise(((e,i)=>{const c=new Image;c.onload=()=>{e(c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame((()=>{c.src=Mo}))},c.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(o)],{type:"image/png"});c.src=o.byteLength?URL.createObjectURL(f):Mo})),v.i=vi,v.j=(o,e)=>ut(Gt(o,{type:"json"}),e),v.k=Ur,v.l=hr,v.m=ut,v.n=(o,e)=>ut(Gt(o,{type:"arrayBuffer"}),e),v.o=function(o){return new h(o).readFields(wt,[])},v.p=rr,v.q=function(o){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(o))},v.r=od,v.s=it,v.t=Hn,v.u=$e,v.v=zo,v.w=en,v.x=Ka,v.y=Za,v.z=Rc})),m("worker",["./shared"],(function(v){class l{constructor(ee,te){this.keyCache={},ee&&this.replace(ee,te)}replace(ee,te){this._layerConfigs={},this._layers={},this.update(ee,[],te)}update(ee,te,oe){for(const Ee of ee){this._layerConfigs[Ee.id]=Ee;const Ne=this._layers[Ee.id]=v.bT(Ee,oe);Ne._featureFilter=v.aj(Ne.filter,oe),this.keyCache[Ee.id]&&delete this.keyCache[Ee.id]}for(const Ee of te)delete this.keyCache[Ee],delete this._layerConfigs[Ee],delete this._layers[Ee];this.familiesBySource={};const we=v.cL(Object.values(this._layerConfigs),this.keyCache);for(const Ee of we){const Ne=Ee.map((Ot=>this._layers[Ot.id])),Oe=Ne[0];if(Oe.isHidden())continue;const De=Oe.source||"";let Ze=this.familiesBySource[De];Ze||(Ze=this.familiesBySource[De]={});const ut=Oe.sourceLayer||v.ai;let st=Ze[ut];st||(st=Ze[ut]=[]),st.push(Ne)}}}class A{constructor(ee){const te={},oe=[];for(const Oe in ee){const De=ee[Oe],Ze=te[Oe]={};for(const ut in De){const st=De[+ut];if(!st||st.bitmap.width===0||st.bitmap.height===0)continue;const Ot={x:0,y:0,w:st.bitmap.width+2,h:st.bitmap.height+2};oe.push(Ot),Ze[ut]={rect:Ot,metrics:st.metrics}}}const{w:we,h:Ee}=v.p(oe),Ne=new v.r({width:we||1,height:Ee||1});for(const Oe in ee){const De=ee[Oe];for(const Ze in De){const ut=De[+Ze];if(!ut||ut.bitmap.width===0||ut.bitmap.height===0)continue;const st=te[Oe][Ze].rect;v.r.copy(ut.bitmap,Ne,{x:0,y:0},{x:st.x+1,y:st.y+1},ut.bitmap)}}this.image=Ne,this.positions=te}}v.cM("GlyphAtlas",A);class R{constructor(ee){this.tileID=new v.a2(ee.tileID.overscaledZ,ee.tileID.wrap,ee.tileID.canonical.z,ee.tileID.canonical.x,ee.tileID.canonical.y),this.uid=ee.uid,this.zoom=ee.zoom,this.pixelRatio=ee.pixelRatio,this.tileSize=ee.tileSize,this.source=ee.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ee.showCollisionBoxes,this.collectResourceTiming=!!ee.collectResourceTiming,this.returnDependencies=!!ee.returnDependencies,this.promoteId=ee.promoteId,this.inFlightDependencies=[]}parse(ee,te,oe,we,Ee){return v._(this,void 0,void 0,(function*(){this.status="parsing",this.data=ee,this.collisionBoxArray=new v.ag;const Ne=new v.cN(Object.keys(ee.layers).sort()),Oe=new v.cO(this.tileID,this.promoteId);Oe.bucketLayerIDs=[];const De={},Ze={featureIndex:Oe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:oe,subdivisionGranularity:Ee},ut=te.familiesBySource[this.source];for(const tn in ut){const On=ee.layers[tn];if(!On)continue;On.version===1&&v.w(`Vector tile source "${this.source}" layer "${tn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ou=Ne.encode(tn),Jo=[];for(let yt=0;yt<On.length;yt++){const bi=On.feature(yt),Ri=Oe.getId(bi,tn);Jo.push({feature:bi,id:Ri,index:yt,sourceLayerIndex:ou})}for(const yt of ut[tn]){const bi=yt[0];bi.source!==this.source&&v.w(`layer.source = ${bi.source} does not equal this.source = ${this.source}`),bi.isHidden(this.zoom,!0)||(L(yt,this.zoom,oe),(De[bi.id]=bi.createBucket({index:Oe.bucketLayerIDs.length,layers:yt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ou,sourceID:this.source})).populate(Jo,Ze,this.tileID.canonical),Oe.bucketLayerIDs.push(yt.map((Ri=>Ri.id))))}}const st=v.bY(Ze.glyphDependencies,(tn=>Object.keys(tn).map(Number)));this.inFlightDependencies.forEach((tn=>tn?.abort())),this.inFlightDependencies=[];let Ot=Promise.resolve({});if(Object.keys(st).length){const tn=new AbortController;this.inFlightDependencies.push(tn),Ot=we.sendAsync({type:"GG",data:{stacks:st,source:this.source,tileID:this.tileID,type:"glyphs"}},tn)}const $t=Object.keys(Ze.iconDependencies);let hr=Promise.resolve({});if($t.length){const tn=new AbortController;this.inFlightDependencies.push(tn),hr=we.sendAsync({type:"GI",data:{icons:$t,source:this.source,tileID:this.tileID,type:"icons"}},tn)}const Ur=Object.keys(Ze.patternDependencies);let kr=Promise.resolve({});if(Ur.length){const tn=new AbortController;this.inFlightDependencies.push(tn),kr=we.sendAsync({type:"GI",data:{icons:Ur,source:this.source,tileID:this.tileID,type:"patterns"}},tn)}const $e=Ze.dashDependencies;let an=Promise.resolve({});if(Object.keys($e).length){const tn=new AbortController;this.inFlightDependencies.push(tn),an=we.sendAsync({type:"GDA",data:{dashes:$e}},tn)}const[xi,fr,Kr,hi]=yield Promise.all([Ot,hr,kr,an]),mn=new A(xi),gn=new v.cP(fr,Kr);for(const tn in De){const On=De[tn];On instanceof v.ah?(L(On.layers,this.zoom,oe),v.cQ({bucket:On,glyphMap:xi,glyphPositions:mn.positions,imageMap:fr,imagePositions:gn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ze.subdivisionGranularity})):On.hasDependencies&&(On instanceof v.cR||On instanceof v.cS||On instanceof v.cT)&&(L(On.layers,this.zoom,oe),On.addFeatures(Ze,this.tileID.canonical,gn.patternPositions,hi))}return this.status="done",{buckets:Object.values(De).filter((tn=>!tn.isEmpty())),featureIndex:Oe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:mn.image,imageAtlas:gn,dashPositions:hi,glyphMap:this.returnDependencies?xi:null,iconMap:this.returnDependencies?fr:null,glyphPositions:this.returnDependencies?mn.positions:null}}))}}function L(xe,ee,te){const oe=new v.H(ee);for(const we of xe)we.recalculate(oe,te)}class B{constructor(ee,te,oe,we,Ee){this.type=ee,this.properties=oe||{},this.extent=Ee,this.pointsArray=te,this.id=we}loadGeometry(){return this.pointsArray.map((ee=>ee.map((te=>new v.P(te.x,te.y)))))}}class W{constructor(ee,te,oe){this.version=2,this._myFeatures=ee,this.name=te,this.length=ee.length,this.extent=oe}feature(ee){return this._myFeatures[ee]}}class re{constructor(){this.layers={}}addLayer(ee){this.layers[ee.name]=ee}}function ce(xe){let ee=v.cU(xe);return ee.byteOffset===0&&ee.byteLength===ee.buffer.byteLength||(ee=new Uint8Array(ee)),{vectorTile:xe,rawData:ee.buffer}}function Q(xe,ee,te){const{extent:oe}=xe,we=Math.pow(2,te.z-ee.z),Ee=(te.x-ee.x*we)*oe,Ne=(te.y-ee.y*we)*oe,Oe=[];for(let De=0;De<xe.length;De++){const Ze=xe.feature(De);let ut=Ze.loadGeometry();for(const Ot of ut)for(const $t of Ot)$t.x=$t.x*we-Ee,$t.y=$t.y*we-Ne;const st=128;ut=v.cV(ut,Ze.type,-st,-st,oe+st,oe+st),ut.length!==0&&Oe.push(new B(Ze.type,ut,Ze.properties,Ze.id,oe))}return new W(Oe,xe.name,oe)}class X{constructor(ee,te,oe){this.actor=ee,this.layerIndex=te,this.availableImages=oe,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new v.cW(1e3)}loadVectorTile(ee,te){return v._(this,void 0,void 0,(function*(){const oe=yield v.n(ee.request,te);try{return{vectorTile:ee.encoding!=="mlt"?new v.cX(new v.cY(oe.data)):new v.cZ(oe.data),rawData:oe.data,cacheControl:oe.cacheControl,expires:oe.expires}}catch(we){const Ee=new Uint8Array(oe.data);let Ne=`Unable to parse the tile at ${ee.request.url}, `;throw Ne+=Ee[0]===31&&Ee[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${we.message}`,new Error(Ne)}}))}loadTile(ee){return v._(this,void 0,void 0,(function*(){const{uid:te,overzoomParameters:oe}=ee;oe&&(ee.request=oe.overzoomRequest);const we=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new v.c_(ee.request),Ee=new R(ee);this.loading[te]=Ee;const Ne=new AbortController;Ee.abort=Ne;try{const Oe=yield this.loadVectorTile(ee,Ne);if(delete this.loading[te],!Oe)return null;if(oe){const Ot=this._getOverzoomTile(ee,Oe.vectorTile);Oe.rawData=Ot.rawData,Oe.vectorTile=Ot.vectorTile}const De=Oe.rawData,Ze={};Oe.expires&&(Ze.expires=Oe.expires),Oe.cacheControl&&(Ze.cacheControl=Oe.cacheControl);const ut={};if(we){const Ot=we.finish();Ot&&(ut.resourceTiming=JSON.parse(JSON.stringify(Ot)))}Ee.vectorTile=Oe.vectorTile;const st=Ee.parse(Oe.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);this.loaded[te]=Ee,this.fetching[te]={rawTileData:De,cacheControl:Ze,resourceTiming:ut};try{const Ot=yield st;return v.e({rawTileData:De.slice(0),encoding:ee.encoding},Ot,Ze,ut)}finally{delete this.fetching[te]}}catch(Oe){throw delete this.loading[te],Ee.status="done",this.loaded[te]=Ee,Oe}}))}_getOverzoomTile(ee,te){const{tileID:oe,source:we,overzoomParameters:Ee}=ee,{maxZoomTileID:Ne}=Ee,Oe=`${Ne.key}_${oe.key}`,De=this.overzoomedTileResultCache.get(Oe);if(De)return De;const Ze=new re,ut=this.layerIndex.familiesBySource[we];for(const Ot in ut){const $t=te.layers[Ot];if(!$t)continue;const hr=Q($t,Ne,oe.canonical);hr.length>0&&Ze.addLayer(hr)}const st=ce(Ze);return this.overzoomedTileResultCache.set(Oe,st),st}reloadTile(ee){return v._(this,void 0,void 0,(function*(){const te=ee.uid;if(!this.loaded||!this.loaded[te])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const oe=this.loaded[te];if(oe.showCollisionBoxes=ee.showCollisionBoxes,oe.status==="parsing"){const we=yield oe.parse(oe.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);let Ee;if(this.fetching[te]){const{rawTileData:Ne,cacheControl:Oe,resourceTiming:De}=this.fetching[te];delete this.fetching[te],Ee=v.e({rawTileData:Ne.slice(0),encoding:ee.encoding},we,Oe,De)}else Ee=we;return Ee}if(oe.status==="done"&&oe.vectorTile)return oe.parse(oe.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity)}))}abortTile(ee){return v._(this,void 0,void 0,(function*(){const te=this.loading,oe=ee.uid;te&&te[oe]&&te[oe].abort&&(te[oe].abort.abort(),delete te[oe])}))}removeTile(ee){return v._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[ee.uid]&&delete this.loaded[ee.uid]}))}}class le{constructor(){this.loaded={}}loadTile(ee){return v._(this,void 0,void 0,(function*(){const{uid:te,encoding:oe,rawImageData:we,redFactor:Ee,greenFactor:Ne,blueFactor:Oe,baseShift:De}=ee,Ze=we.width+2,ut=we.height+2,st=v.b(we)?new v.R({width:Ze,height:ut},yield v.c$(we,-1,-1,Ze,ut)):we,Ot=new v.d0(te,st,oe,Ee,Ne,Oe,De);return this.loaded=this.loaded||{},this.loaded[te]=Ot,Ot}))}removeTile(ee){const te=this.loaded,oe=ee.uid;te&&te[oe]&&delete te[oe]}}var he,_e,Ie=(function(){if(_e)return he;function xe(te,oe){if(te.length!==0){ee(te[0],oe);for(var we=1;we<te.length;we++)ee(te[we],!oe)}}function ee(te,oe){for(var we=0,Ee=0,Ne=0,Oe=te.length,De=Oe-1;Ne<Oe;De=Ne++){var Ze=(te[Ne][0]-te[De][0])*(te[De][1]+te[Ne][1]),ut=we+Ze;Ee+=Math.abs(we)>=Math.abs(Ze)?we-ut+Ze:Ze-ut+we,we=ut}we+Ee>=0!=!!oe&&te.reverse()}return _e=1,he=function te(oe,we){var Ee,Ne=oe&&oe.type;if(Ne==="FeatureCollection")for(Ee=0;Ee<oe.features.length;Ee++)te(oe.features[Ee],we);else if(Ne==="GeometryCollection")for(Ee=0;Ee<oe.geometries.length;Ee++)te(oe.geometries[Ee],we);else if(Ne==="Feature")te(oe.geometry,we);else if(Ne==="Polygon")xe(oe.coordinates,we);else if(Ne==="MultiPolygon")for(Ee=0;Ee<oe.coordinates.length;Ee++)xe(oe.coordinates[Ee],we);return oe}})(),ke=v.d1(Ie);const Je={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:xe=>xe},He=Math.fround||(nt=new Float32Array(1),xe=>(nt[0]=+xe,nt[0]));var nt;class Pt{constructor(ee){this.options=Object.assign(Object.create(Je),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:te,minZoom:oe,maxZoom:we}=this.options;te&&console.time("total time");const Ee=`prepare ${ee.length} points`;te&&console.time(Ee),this.points=ee;const Ne=[];for(let De=0;De<ee.length;De++){const Ze=ee[De];if(!Ze.geometry)continue;const[ut,st]=Ze.geometry.coordinates,Ot=He(lt(ut)),$t=He(Et(st));Ne.push(Ot,$t,1/0,De,-1,1),this.options.reduce&&Ne.push(0)}let Oe=this.trees[we+1]=this._createTree(Ne);te&&console.timeEnd(Ee);for(let De=we;De>=oe;De--){const Ze=+Date.now();Oe=this.trees[De]=this._createTree(this._cluster(Oe,De)),te&&console.log("z%d: %d clusters in %dms",De,Oe.numItems,+Date.now()-Ze)}return te&&console.timeEnd("total time"),this}getClusters(ee,te){let oe=((ee[0]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,ee[1]));let Ee=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const Ne=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)oe=-180,Ee=180;else if(oe>Ee){const st=this.getClusters([oe,we,180,Ne],te),Ot=this.getClusters([-180,we,Ee,Ne],te);return st.concat(Ot)}const Oe=this.trees[this._limitZoom(te)],De=Oe.range(lt(oe),Et(Ne),lt(Ee),Et(we)),Ze=Oe.data,ut=[];for(const st of De){const Ot=this.stride*st;ut.push(Ze[Ot+5]>1?Ct(Ze,Ot,this.clusterProps):this.points[Ze[Ot+3]])}return ut}getChildren(ee){const te=this._getOriginId(ee),oe=this._getOriginZoom(ee),we="No cluster with the specified id.",Ee=this.trees[oe];if(!Ee)throw new Error(we);const Ne=Ee.data;if(te*this.stride>=Ne.length)throw new Error(we);const Oe=this.options.radius/(this.options.extent*Math.pow(2,oe-1)),De=Ee.within(Ne[te*this.stride],Ne[te*this.stride+1],Oe),Ze=[];for(const ut of De){const st=ut*this.stride;Ne[st+4]===ee&&Ze.push(Ne[st+5]>1?Ct(Ne,st,this.clusterProps):this.points[Ne[st+3]])}if(Ze.length===0)throw new Error(we);return Ze}getLeaves(ee,te,oe){const we=[];return this._appendLeaves(we,ee,te=te||10,oe=oe||0,0),we}getTile(ee,te,oe){const we=this.trees[this._limitZoom(ee)],Ee=Math.pow(2,ee),{extent:Ne,radius:Oe}=this.options,De=Oe/Ne,Ze=(oe-De)/Ee,ut=(oe+1+De)/Ee,st={features:[]};return this._addTileFeatures(we.range((te-De)/Ee,Ze,(te+1+De)/Ee,ut),we.data,te,oe,Ee,st),te===0&&this._addTileFeatures(we.range(1-De/Ee,Ze,1,ut),we.data,Ee,oe,Ee,st),te===Ee-1&&this._addTileFeatures(we.range(0,Ze,De/Ee,ut),we.data,-1,oe,Ee,st),st.features.length?st:null}getClusterExpansionZoom(ee){let te=this._getOriginZoom(ee)-1;for(;te<=this.options.maxZoom;){const oe=this.getChildren(ee);if(te++,oe.length!==1)break;ee=oe[0].properties.cluster_id}return te}_appendLeaves(ee,te,oe,we,Ee){const Ne=this.getChildren(te);for(const Oe of Ne){const De=Oe.properties;if(De&&De.cluster?Ee+De.point_count<=we?Ee+=De.point_count:Ee=this._appendLeaves(ee,De.cluster_id,oe,we,Ee):Ee<we?Ee++:ee.push(Oe),ee.length===oe)break}return Ee}_createTree(ee){const te=new v.aT(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let oe=0;oe<ee.length;oe+=this.stride)te.add(ee[oe],ee[oe+1]);return te.finish(),te.data=ee,te}_addTileFeatures(ee,te,oe,we,Ee,Ne){for(const Oe of ee){const De=Oe*this.stride,Ze=te[De+5]>1;let ut,st,Ot;if(Ze)ut=Zt(te,De,this.clusterProps),st=te[De],Ot=te[De+1];else{const Ur=this.points[te[De+3]];ut=Ur.properties;const[kr,$e]=Ur.geometry.coordinates;st=lt(kr),Ot=Et($e)}const $t={type:1,geometry:[[Math.round(this.options.extent*(st*Ee-oe)),Math.round(this.options.extent*(Ot*Ee-we))]],tags:ut};let hr;hr=Ze||this.options.generateId?te[De+3]:this.points[te[De+3]].id,hr!==void 0&&($t.id=hr),Ne.features.push($t)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,te){const{radius:oe,extent:we,reduce:Ee,minPoints:Ne}=this.options,Oe=oe/(we*Math.pow(2,te)),De=ee.data,Ze=[],ut=this.stride;for(let st=0;st<De.length;st+=ut){if(De[st+2]<=te)continue;De[st+2]=te;const Ot=De[st],$t=De[st+1],hr=ee.within(De[st],De[st+1],Oe),Ur=De[st+5];let kr=Ur;for(const $e of hr){const an=$e*ut;De[an+2]>te&&(kr+=De[an+5])}if(kr>Ur&&kr>=Ne){let $e,an=Ot*Ur,xi=$t*Ur,fr=-1;const Kr=(st/ut<<5)+(te+1)+this.points.length;for(const hi of hr){const mn=hi*ut;if(De[mn+2]<=te)continue;De[mn+2]=te;const gn=De[mn+5];an+=De[mn]*gn,xi+=De[mn+1]*gn,De[mn+4]=Kr,Ee&&($e||($e=this._map(De,st,!0),fr=this.clusterProps.length,this.clusterProps.push($e)),Ee($e,this._map(De,mn)))}De[st+4]=Kr,Ze.push(an/kr,xi/kr,1/0,Kr,-1,kr),Ee&&Ze.push(fr)}else{for(let $e=0;$e<ut;$e++)Ze.push(De[st+$e]);if(kr>1)for(const $e of hr){const an=$e*ut;if(!(De[an+2]<=te)){De[an+2]=te;for(let xi=0;xi<ut;xi++)Ze.push(De[an+xi])}}}}return Ze}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,te,oe){if(ee[te+5]>1){const Ne=this.clusterProps[ee[te+6]];return oe?Object.assign({},Ne):Ne}const we=this.points[ee[te+3]].properties,Ee=this.options.map(we);return oe&&Ee===we?Object.assign({},Ee):Ee}}function Ct(xe,ee,te){return{type:"Feature",id:xe[ee+3],properties:Zt(xe,ee,te),geometry:{type:"Point",coordinates:[(oe=xe[ee],360*(oe-.5)),ft(xe[ee+1])]}};var oe}function Zt(xe,ee,te){const oe=xe[ee+5],we=oe>=1e4?`${Math.round(oe/1e3)}k`:oe>=1e3?Math.round(oe/100)/10+"k":oe,Ee=xe[ee+6],Ne=Ee===-1?{}:Object.assign({},te[Ee]);return Object.assign(Ne,{cluster:!0,cluster_id:xe[ee+3],point_count:oe,point_count_abbreviated:we})}function lt(xe){return xe/360+.5}function Et(xe){const ee=Math.sin(xe*Math.PI/180),te=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return te<0?0:te>1?1:te}function ft(xe){const ee=(180-360*xe)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function gt(xe,ee,te,oe){let we=oe;const Ee=ee+(te-ee>>1);let Ne,Oe=te-ee;const De=xe[ee],Ze=xe[ee+1],ut=xe[te],st=xe[te+1];for(let Ot=ee+3;Ot<te;Ot+=3){const $t=dt(xe[Ot],xe[Ot+1],De,Ze,ut,st);if($t>we)Ne=Ot,we=$t;else if($t===we){const hr=Math.abs(Ot-Ee);hr<Oe&&(Ne=Ot,Oe=hr)}}we>oe&&(Ne-ee>3&&gt(xe,ee,Ne,oe),xe[Ne+2]=we,te-Ne>3&&gt(xe,Ne,te,oe))}function dt(xe,ee,te,oe,we,Ee){let Ne=we-te,Oe=Ee-oe;if(Ne!==0||Oe!==0){const De=((xe-te)*Ne+(ee-oe)*Oe)/(Ne*Ne+Oe*Oe);De>1?(te=we,oe=Ee):De>0&&(te+=Ne*De,oe+=Oe*De)}return Ne=xe-te,Oe=ee-oe,Ne*Ne+Oe*Oe}function mt(xe,ee,te,oe){const we={id:xe??null,type:ee,geometry:te,tags:oe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ee==="Point"||ee==="MultiPoint"||ee==="LineString")Xe(we,te);else if(ee==="Polygon")Xe(we,te[0]);else if(ee==="MultiLineString")for(const Ee of te)Xe(we,Ee);else if(ee==="MultiPolygon")for(const Ee of te)Xe(we,Ee[0]);return we}function Xe(xe,ee){for(let te=0;te<ee.length;te+=3)xe.minX=Math.min(xe.minX,ee[te]),xe.minY=Math.min(xe.minY,ee[te+1]),xe.maxX=Math.max(xe.maxX,ee[te]),xe.maxY=Math.max(xe.maxY,ee[te+1])}function Be(xe,ee,te,oe){if(!ee.geometry)return;const we=ee.geometry.coordinates;if(we&&we.length===0)return;const Ee=ee.geometry.type,Ne=Math.pow(te.tolerance/((1<<te.maxZoom)*te.extent),2);let Oe=[],De=ee.id;if(te.promoteId?De=ee.properties[te.promoteId]:te.generateId&&(De=oe||0),Ee==="Point")_t(we,Oe);else if(Ee==="MultiPoint")for(const Ze of we)_t(Ze,Oe);else if(Ee==="LineString")Re(we,Oe,Ne,!1);else if(Ee==="MultiLineString"){if(te.lineMetrics){for(const Ze of we)Oe=[],Re(Ze,Oe,Ne,!1),xe.push(mt(De,"LineString",Oe,ee.properties));return}at(we,Oe,Ne,!1)}else if(Ee==="Polygon")at(we,Oe,Ne,!0);else{if(Ee!=="MultiPolygon"){if(Ee==="GeometryCollection"){for(const Ze of ee.geometry.geometries)Be(xe,{id:De,geometry:Ze,properties:ee.properties},te,oe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ze of we){const ut=[];at(Ze,ut,Ne,!0),Oe.push(ut)}}xe.push(mt(De,Ee,Oe,ee.properties))}function _t(xe,ee){ee.push(nr(xe[0]),er(xe[1]),0)}function Re(xe,ee,te,oe){let we,Ee,Ne=0;for(let De=0;De<xe.length;De++){const Ze=nr(xe[De][0]),ut=er(xe[De][1]);ee.push(Ze,ut,0),De>0&&(Ne+=oe?(we*ut-Ze*Ee)/2:Math.sqrt(Math.pow(Ze-we,2)+Math.pow(ut-Ee,2))),we=Ze,Ee=ut}const Oe=ee.length-3;ee[2]=1,gt(ee,0,Oe,te),ee[Oe+2]=1,ee.size=Math.abs(Ne),ee.start=0,ee.end=ee.size}function at(xe,ee,te,oe){for(let we=0;we<xe.length;we++){const Ee=[];Re(xe[we],Ee,te,oe),ee.push(Ee)}}function nr(xe){return xe/360+.5}function er(xe){const ee=Math.sin(xe*Math.PI/180),te=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return te<0?0:te>1?1:te}function ir(xe,ee,te,oe,we,Ee,Ne,Oe){if(oe/=ee,Ee>=(te/=ee)&&Ne<oe)return xe;if(Ne<te||Ee>=oe)return null;const De=[];for(const Ze of xe){const ut=Ze.geometry;let st=Ze.type;const Ot=we===0?Ze.minX:Ze.minY,$t=we===0?Ze.maxX:Ze.maxY;if(Ot>=te&&$t<oe){De.push(Ze);continue}if($t<te||Ot>=oe)continue;let hr=[];if(st==="Point"||st==="MultiPoint")sr(ut,hr,te,oe,we);else if(st==="LineString")St(ut,hr,te,oe,we,!1,Oe.lineMetrics);else if(st==="MultiLineString")yr(ut,hr,te,oe,we,!1);else if(st==="Polygon")yr(ut,hr,te,oe,we,!0);else if(st==="MultiPolygon")for(const Ur of ut){const kr=[];yr(Ur,kr,te,oe,we,!0),kr.length&&hr.push(kr)}if(hr.length){if(Oe.lineMetrics&&st==="LineString"){for(const Ur of hr)De.push(mt(Ze.id,st,Ur,Ze.tags));continue}st!=="LineString"&&st!=="MultiLineString"||(hr.length===1?(st="LineString",hr=hr[0]):st="MultiLineString"),st!=="Point"&&st!=="MultiPoint"||(st=hr.length===3?"Point":"MultiPoint"),De.push(mt(Ze.id,st,hr,Ze.tags))}}return De.length?De:null}function sr(xe,ee,te,oe,we){for(let Ee=0;Ee<xe.length;Ee+=3){const Ne=xe[Ee+we];Ne>=te&&Ne<=oe&&cr(ee,xe[Ee],xe[Ee+1],xe[Ee+2])}}function St(xe,ee,te,oe,we,Ee,Ne){let Oe=Gt(xe);const De=we===0?Lr:jr;let Ze,ut,st=xe.start;for(let kr=0;kr<xe.length-3;kr+=3){const $e=xe[kr],an=xe[kr+1],xi=xe[kr+2],fr=xe[kr+3],Kr=xe[kr+4],hi=we===0?$e:an,mn=we===0?fr:Kr;let gn=!1;Ne&&(Ze=Math.sqrt(Math.pow($e-fr,2)+Math.pow(an-Kr,2))),hi<te?mn>te&&(ut=De(Oe,$e,an,fr,Kr,te),Ne&&(Oe.start=st+Ze*ut)):hi>oe?mn<oe&&(ut=De(Oe,$e,an,fr,Kr,oe),Ne&&(Oe.start=st+Ze*ut)):cr(Oe,$e,an,xi),mn<te&&hi>=te&&(ut=De(Oe,$e,an,fr,Kr,te),gn=!0),mn>oe&&hi<=oe&&(ut=De(Oe,$e,an,fr,Kr,oe),gn=!0),!Ee&&gn&&(Ne&&(Oe.end=st+Ze*ut),ee.push(Oe),Oe=Gt(xe)),Ne&&(st+=Ze)}let Ot=xe.length-3;const $t=xe[Ot],hr=xe[Ot+1],Ur=we===0?$t:hr;Ur>=te&&Ur<=oe&&cr(Oe,$t,hr,xe[Ot+2]),Ot=Oe.length-3,Ee&&Ot>=3&&(Oe[Ot]!==Oe[0]||Oe[Ot+1]!==Oe[1])&&cr(Oe,Oe[0],Oe[1],Oe[2]),Oe.length&&ee.push(Oe)}function Gt(xe){const ee=[];return ee.size=xe.size,ee.start=xe.start,ee.end=xe.end,ee}function yr(xe,ee,te,oe,we,Ee){for(const Ne of xe)St(Ne,ee,te,oe,we,Ee,!1)}function cr(xe,ee,te,oe){xe.push(ee,te,oe)}function Lr(xe,ee,te,oe,we,Ee){const Ne=(Ee-ee)/(oe-ee);return cr(xe,Ee,te+(we-te)*Ne,1),Ne}function jr(xe,ee,te,oe,we,Ee){const Ne=(Ee-te)/(we-te);return cr(xe,ee+(oe-ee)*Ne,Ee,1),Ne}function Fn(xe,ee){const te=[];for(let oe=0;oe<xe.length;oe++){const we=xe[oe],Ee=we.type;let Ne;if(Ee==="Point"||Ee==="MultiPoint"||Ee==="LineString")Ne=en(we.geometry,ee);else if(Ee==="MultiLineString"||Ee==="Polygon"){Ne=[];for(const Oe of we.geometry)Ne.push(en(Oe,ee))}else if(Ee==="MultiPolygon"){Ne=[];for(const Oe of we.geometry){const De=[];for(const Ze of Oe)De.push(en(Ze,ee));Ne.push(De)}}te.push(mt(we.id,Ee,Ne,we.tags))}return te}function en(xe,ee){const te=[];te.size=xe.size,xe.start!==void 0&&(te.start=xe.start,te.end=xe.end);for(let oe=0;oe<xe.length;oe+=3)te.push(xe[oe]+ee,xe[oe+1],xe[oe+2]);return te}function ni(xe,ee){if(xe.transformed)return xe;const te=1<<xe.z,oe=xe.x,we=xe.y;for(const Ee of xe.features){const Ne=Ee.geometry,Oe=Ee.type;if(Ee.geometry=[],Oe===1)for(let De=0;De<Ne.length;De+=2)Ee.geometry.push(vi(Ne[De],Ne[De+1],ee,te,oe,we));else for(let De=0;De<Ne.length;De++){const Ze=[];for(let ut=0;ut<Ne[De].length;ut+=2)Ze.push(vi(Ne[De][ut],Ne[De][ut+1],ee,te,oe,we));Ee.geometry.push(Ze)}}return xe.transformed=!0,xe}function vi(xe,ee,te,oe,we,Ee){return[Math.round(te*(xe*oe-we)),Math.round(te*(ee*oe-Ee))]}function Xr(xe,ee,te,oe,we){const Ee=ee===we.maxZoom?0:we.tolerance/((1<<ee)*we.extent),Ne={features:[],numPoints:0,numSimplified:0,numFeatures:xe.length,source:null,x:te,y:oe,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Oe of xe)io(Ne,Oe,Ee,we);return Ne}function io(xe,ee,te,oe){const we=ee.geometry,Ee=ee.type,Ne=[];if(xe.minX=Math.min(xe.minX,ee.minX),xe.minY=Math.min(xe.minY,ee.minY),xe.maxX=Math.max(xe.maxX,ee.maxX),xe.maxY=Math.max(xe.maxY,ee.maxY),Ee==="Point"||Ee==="MultiPoint")for(let Oe=0;Oe<we.length;Oe+=3)Ne.push(we[Oe],we[Oe+1]),xe.numPoints++,xe.numSimplified++;else if(Ee==="LineString")Mo(Ne,we,xe,te,!1,!1);else if(Ee==="MultiLineString"||Ee==="Polygon")for(let Oe=0;Oe<we.length;Oe++)Mo(Ne,we[Oe],xe,te,Ee==="Polygon",Oe===0);else if(Ee==="MultiPolygon")for(let Oe=0;Oe<we.length;Oe++){const De=we[Oe];for(let Ze=0;Ze<De.length;Ze++)Mo(Ne,De[Ze],xe,te,!0,Ze===0)}if(Ne.length){let Oe=ee.tags||null;if(Ee==="LineString"&&oe.lineMetrics){Oe={};for(const Ze in ee.tags)Oe[Ze]=ee.tags[Ze];Oe.mapbox_clip_start=we.start/we.size,Oe.mapbox_clip_end=we.end/we.size}const De={geometry:Ne,type:Ee==="Polygon"||Ee==="MultiPolygon"?3:Ee==="LineString"||Ee==="MultiLineString"?2:1,tags:Oe};ee.id!==null&&(De.id=ee.id),xe.features.push(De)}}function Mo(xe,ee,te,oe,we,Ee){const Ne=oe*oe;if(oe>0&&ee.size<(we?Ne:oe))return void(te.numPoints+=ee.length/3);const Oe=[];for(let De=0;De<ee.length;De+=3)(oe===0||ee[De+2]>Ne)&&(te.numSimplified++,Oe.push(ee[De],ee[De+1])),te.numPoints++;we&&(function(De,Ze){let ut=0;for(let st=0,Ot=De.length,$t=Ot-2;st<Ot;$t=st,st+=2)ut+=(De[st]-De[$t])*(De[st+1]+De[$t+1]);if(ut>0===Ze)for(let st=0,Ot=De.length;st<Ot/2;st+=2){const $t=De[st],hr=De[st+1];De[st]=De[Ot-2-st],De[st+1]=De[Ot-1-st],De[Ot-2-st]=$t,De[Ot-1-st]=hr}})(Oe,Ee),xe.push(Oe)}const Ms={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ae{constructor(ee,te){const oe=(te=this.options=(function(Ee,Ne){for(const Oe in Ne)Ee[Oe]=Ne[Oe];return Ee})(Object.create(Ms),te)).debug;if(oe&&console.time("preprocess data"),te.maxZoom<0||te.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(te.promoteId&&te.generateId)throw new Error("promoteId and generateId cannot be used together.");let we=(function(Ee,Ne){const Oe=[];if(Ee.type==="FeatureCollection")for(let De=0;De<Ee.features.length;De++)Be(Oe,Ee.features[De],Ne,De);else Be(Oe,Ee.type==="Feature"?Ee:{geometry:Ee},Ne);return Oe})(ee,te);this.tiles={},this.tileCoords=[],oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",te.indexMaxZoom,te.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),we=(function(Ee,Ne){const Oe=Ne.buffer/Ne.extent;let De=Ee;const Ze=ir(Ee,1,-1-Oe,Oe,0,-1,2,Ne),ut=ir(Ee,1,1-Oe,2+Oe,0,-1,2,Ne);return(Ze||ut)&&(De=ir(Ee,1,-Oe,1+Oe,0,-1,2,Ne)||[],Ze&&(De=Fn(Ze,1).concat(De)),ut&&(De=De.concat(Fn(ut,-1)))),De})(we,te),we.length&&this.splitTile(we,0,0,0),oe&&(we.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ee,te,oe,we,Ee,Ne,Oe){const De=[ee,te,oe,we],Ze=this.options,ut=Ze.debug;for(;De.length;){we=De.pop(),oe=De.pop(),te=De.pop(),ee=De.pop();const st=1<<te,Ot=Ue(te,oe,we);let $t=this.tiles[Ot];if(!$t&&(ut>1&&console.time("creation"),$t=this.tiles[Ot]=Xr(ee,te,oe,we,Ze),this.tileCoords.push({z:te,x:oe,y:we}),ut)){ut>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",te,oe,we,$t.numFeatures,$t.numPoints,$t.numSimplified),console.timeEnd("creation"));const gn=`z${te}`;this.stats[gn]=(this.stats[gn]||0)+1,this.total++}if($t.source=ee,Ee==null){if(te===Ze.indexMaxZoom||$t.numPoints<=Ze.indexMaxPoints)continue}else{if(te===Ze.maxZoom||te===Ee)continue;if(Ee!=null){const gn=Ee-te;if(oe!==Ne>>gn||we!==Oe>>gn)continue}}if($t.source=null,ee.length===0)continue;ut>1&&console.time("clipping");const hr=.5*Ze.buffer/Ze.extent,Ur=.5-hr,kr=.5+hr,$e=1+hr;let an=null,xi=null,fr=null,Kr=null,hi=ir(ee,st,oe-hr,oe+kr,0,$t.minX,$t.maxX,Ze),mn=ir(ee,st,oe+Ur,oe+$e,0,$t.minX,$t.maxX,Ze);ee=null,hi&&(an=ir(hi,st,we-hr,we+kr,1,$t.minY,$t.maxY,Ze),xi=ir(hi,st,we+Ur,we+$e,1,$t.minY,$t.maxY,Ze),hi=null),mn&&(fr=ir(mn,st,we-hr,we+kr,1,$t.minY,$t.maxY,Ze),Kr=ir(mn,st,we+Ur,we+$e,1,$t.minY,$t.maxY,Ze),mn=null),ut>1&&console.timeEnd("clipping"),De.push(an||[],te+1,2*oe,2*we),De.push(xi||[],te+1,2*oe,2*we+1),De.push(fr||[],te+1,2*oe+1,2*we),De.push(Kr||[],te+1,2*oe+1,2*we+1)}}getTile(ee,te,oe){ee=+ee,te=+te,oe=+oe;const we=this.options,{extent:Ee,debug:Ne}=we;if(ee<0||ee>24)return null;const Oe=1<<ee,De=Ue(ee,te=te+Oe&Oe-1,oe);if(this.tiles[De])return ni(this.tiles[De],Ee);Ne>1&&console.log("drilling down to z%d-%d-%d",ee,te,oe);let Ze,ut=ee,st=te,Ot=oe;for(;!Ze&&ut>0;)ut--,st>>=1,Ot>>=1,Ze=this.tiles[Ue(ut,st,Ot)];return Ze&&Ze.source?(Ne>1&&(console.log("found parent tile z%d-%d-%d",ut,st,Ot),console.time("drilling down")),this.splitTile(Ze.source,ut,st,Ot,ee,te,oe),Ne>1&&console.timeEnd("drilling down"),this.tiles[De]?ni(this.tiles[De],Ee):null):null}}function Ue(xe,ee,te){return 32*((1<<xe)*te+ee)+xe}class it extends X{constructor(ee,te,oe,we=Vt){super(ee,te,oe),this._dataUpdateable=new Map,this._createGeoJSONIndex=we}loadVectorTile(ee,te){return v._(this,void 0,void 0,(function*(){const oe=ee.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const we=this._geoJSONIndex.getTile(oe.z,oe.x,oe.y);return we?ce(new v.d2(we.features,{version:2,extent:v.a5})):null}))}loadData(ee){return v._(this,void 0,void 0,(function*(){var te;(te=this._pendingRequest)===null||te===void 0||te.abort();const oe=this._startPerformance(ee);this._pendingRequest=new AbortController;try{(!this._pendingData||ee.request||ee.data||ee.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(ee,this._pendingRequest));const we=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(we,ee),this.loaded={};const Ee={};return ee.request&&(Ee.data=we),this._finishPerformance(oe,ee,Ee),Ee}catch(we){if(delete this._pendingRequest,v.Z(we))return{abandoned:!0};throw we}}))}_startPerformance(ee){var te;if(!((te=ee?.request)===null||te===void 0)&&te.collectResourceTiming)return new v.c_(ee.request)}_finishPerformance(ee,te,oe){if(!ee)return;const we=ee.finish();we&&(oe.resourceTiming={},oe.resourceTiming[te.source]=JSON.parse(JSON.stringify(we)))}getData(){return v._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(ee){const te=this.loaded;return te&&te[ee.uid]?super.reloadTile(ee):this.loadTile(ee)}loadAndProcessGeoJSON(ee,te){return v._(this,void 0,void 0,(function*(){let oe;if(ee.request?oe=yield this.loadGeoJSONFromUrl(ee.request,ee.promoteId,te):ee.data?oe=this._loadGeoJSONFromObject(ee.data,ee.promoteId):ee.dataDiff&&(oe=this._loadGeoJSONFromDiff(ee.dataDiff,ee.promoteId,ee.source)),delete this._pendingRequest,typeof oe!="object")throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);return ke(oe,!0),ee.filter&&(oe=this._filterGeoJSON(oe,ee.filter)),oe}))}loadGeoJSONFromUrl(ee,te,oe){return v._(this,void 0,void 0,(function*(){const we=yield v.j(ee,oe);return this._dataUpdateable=v.a7(we.data,te),we.data}))}_loadGeoJSONFromObject(ee,te){return this._dataUpdateable=v.a7(ee,te),ee}_loadGeoJSONFromDiff(ee,te,oe){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${oe}`);v.a8(this._dataUpdateable,ee,te);const we=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(we)}_filterGeoJSON(ee,te){const oe=v.d3(te,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(oe.result==="error")throw new Error(oe.value.map((Ee=>`${Ee.key}: ${Ee.message}`)).join(", "));const we=ee.features.filter((Ee=>oe.value.evaluate({zoom:0},Ee)));return this._toFeatureCollection(we)}_toFeatureCollection(ee){return{type:"FeatureCollection",features:ee}}removeSource(ee){return v._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(ee){return this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId)}getClusterChildren(ee){return this._geoJSONIndex.getChildren(ee.clusterId)}getClusterLeaves(ee){return this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset)}}function Vt(xe,ee){return ee.cluster?new Pt((function({superclusterOptions:te,clusterProperties:oe}){if(!oe||!te)return te;const we={},Ee={},Ne={accumulated:null,zoom:0},Oe={properties:null},De=Object.keys(oe);for(const Ze of De){const[ut,st]=oe[Ze],Ot=v.d3(st),$t=v.d3(typeof ut=="string"?[ut,["accumulated"],["get",Ze]]:ut);we[Ze]=Ot.value,Ee[Ze]=$t.value}return te.map=Ze=>{Oe.properties=Ze;const ut={};for(const st of De)ut[st]=we[st].evaluate(Ne,Oe);return ut},te.reduce=(Ze,ut)=>{Oe.properties=ut;for(const st of De)Ne.accumulated=Ze[st],Ze[st]=Ee[st].evaluate(Ne,Oe)},te})(ee)).load(xe.features):(function(te,oe){return new Ae(te,oe)})(xe,ee.geojsonVtOptions)}class Mt{constructor(ee){this.self=ee,this.actor=new v.L(ee),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(te,oe)=>{if(this.externalWorkerSourceTypes[te])throw new Error(`Worker source with name "${te}" already registered.`);this.externalWorkerSourceTypes[te]=oe},this.self.addProtocol=v.cJ,this.self.removeProtocol=v.cK,this.self.registerRTLTextPlugin=te=>{v.d4.setMethods(te)},this.actor.registerMessageHandler("LDT",((te,oe)=>this._getDEMWorkerSource(te,oe.source).loadTile(oe))),this.actor.registerMessageHandler("RDT",((te,oe)=>v._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(te,oe.source).removeTile(oe)})))),this.actor.registerMessageHandler("GCEZ",((te,oe)=>v._(this,void 0,void 0,(function*(){return this._getWorkerSource(te,oe.type,oe.source).getClusterExpansionZoom(oe)})))),this.actor.registerMessageHandler("GCC",((te,oe)=>v._(this,void 0,void 0,(function*(){return this._getWorkerSource(te,oe.type,oe.source).getClusterChildren(oe)})))),this.actor.registerMessageHandler("GCL",((te,oe)=>v._(this,void 0,void 0,(function*(){return this._getWorkerSource(te,oe.type,oe.source).getClusterLeaves(oe)})))),this.actor.registerMessageHandler("LD",((te,oe)=>this._getWorkerSource(te,oe.type,oe.source).loadData(oe))),this.actor.registerMessageHandler("GD",((te,oe)=>this._getWorkerSource(te,oe.type,oe.source).getData())),this.actor.registerMessageHandler("LT",((te,oe)=>this._getWorkerSource(te,oe.type,oe.source).loadTile(oe))),this.actor.registerMessageHandler("RT",((te,oe)=>this._getWorkerSource(te,oe.type,oe.source).reloadTile(oe))),this.actor.registerMessageHandler("AT",((te,oe)=>this._getWorkerSource(te,oe.type,oe.source).abortTile(oe))),this.actor.registerMessageHandler("RMT",((te,oe)=>this._getWorkerSource(te,oe.type,oe.source).removeTile(oe))),this.actor.registerMessageHandler("RS",((te,oe)=>v._(this,void 0,void 0,(function*(){if(!this.workerSources[te]||!this.workerSources[te][oe.type]||!this.workerSources[te][oe.type][oe.source])return;const we=this.workerSources[te][oe.type][oe.source];delete this.workerSources[te][oe.type][oe.source],we.removeSource!==void 0&&we.removeSource(oe)})))),this.actor.registerMessageHandler("RM",(te=>v._(this,void 0,void 0,(function*(){delete this.layerIndexes[te],delete this.availableImages[te],delete this.workerSources[te],delete this.demWorkerSources[te],this.globalStates.delete(te)})))),this.actor.registerMessageHandler("SR",((te,oe)=>v._(this,void 0,void 0,(function*(){this.referrer=oe})))),this.actor.registerMessageHandler("SRPS",((te,oe)=>this._syncRTLPluginState(te,oe))),this.actor.registerMessageHandler("IS",((te,oe)=>v._(this,void 0,void 0,(function*(){this.self.importScripts(oe)})))),this.actor.registerMessageHandler("SI",((te,oe)=>this._setImages(te,oe))),this.actor.registerMessageHandler("UL",((te,oe)=>v._(this,void 0,void 0,(function*(){this._getLayerIndex(te).update(oe.layers,oe.removedIds,this._getGlobalState(te))})))),this.actor.registerMessageHandler("UGS",((te,oe)=>v._(this,void 0,void 0,(function*(){const we=this._getGlobalState(te);for(const Ee in oe)we[Ee]=oe[Ee]})))),this.actor.registerMessageHandler("SL",((te,oe)=>v._(this,void 0,void 0,(function*(){this._getLayerIndex(te).replace(oe,this._getGlobalState(te))}))))}_getGlobalState(ee){let te=this.globalStates.get(ee);return te||(te={},this.globalStates.set(ee,te)),te}_setImages(ee,te){return v._(this,void 0,void 0,(function*(){this.availableImages[ee]=te;for(const oe in this.workerSources[ee]){const we=this.workerSources[ee][oe];for(const Ee in we)we[Ee].availableImages=te}}))}_syncRTLPluginState(ee,te){return v._(this,void 0,void 0,(function*(){return yield v.d4.syncState(te,this.self.importScripts)}))}_getAvailableImages(ee){let te=this.availableImages[ee];return te||(te=[]),te}_getLayerIndex(ee){let te=this.layerIndexes[ee];return te||(te=this.layerIndexes[ee]=new l),te}_getWorkerSource(ee,te,oe){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][te]||(this.workerSources[ee][te]={}),!this.workerSources[ee][te][oe]){const we={sendAsync:(Ee,Ne)=>(Ee.targetMapId=ee,this.actor.sendAsync(Ee,Ne))};switch(te){case"vector":this.workerSources[ee][te][oe]=new X(we,this._getLayerIndex(ee),this._getAvailableImages(ee));break;case"geojson":this.workerSources[ee][te][oe]=new it(we,this._getLayerIndex(ee),this._getAvailableImages(ee));break;default:this.workerSources[ee][te][oe]=new this.externalWorkerSourceTypes[te](we,this._getLayerIndex(ee),this._getAvailableImages(ee))}}return this.workerSources[ee][te][oe]}_getDEMWorkerSource(ee,te){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][te]||(this.demWorkerSources[ee][te]=new le),this.demWorkerSources[ee][te]}}return v.i(self)&&(self.worker=new Mt(self)),Mt})),m("index",["exports","./shared"],(function(v,l){var A="5.16.0";function R(){var b=new l.A(4);return l.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}let L,B,W;const re={frame(b,t,a){const d=requestAnimationFrame((w=>{g(),t(w)})),{unsubscribe:g}=l.s(b.signal,"abort",(()=>{g(),cancelAnimationFrame(d),a(new l.a(b.signal.reason))}),!1)},frameAsync(b){return new Promise(((t,a)=>{this.frame(b,t,a)}))},getImageData(b,t=0){return this.getImageCanvasContext(b).getImageData(-t,-t,b.width+2*t,b.height+2*t)},getImageCanvasContext(b){const t=window.document.createElement("canvas"),a=t.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return t.width=b.width,t.height=b.height,a.drawImage(b,0,0,b.width,b.height),a},resolveURL:b=>(L||(L=document.createElement("a")),L.href=b,L.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return W!==void 0?W:!!matchMedia&&(B==null&&(B=matchMedia("(prefers-reduced-motion: reduce)")),B.matches)},set prefersReducedMotion(b){W=b}},ce=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(b){this._frozenAt=b}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function Q(){return ce.getCurrentTime()}class X{static testProp(t){if(!X.docStyle)return t[0];for(let a=0;a<t.length;a++)if(t[a]in X.docStyle)return t[a];return t[0]}static create(t,a,d){const g=window.document.createElement(t);return a!==void 0&&(g.className=a),d&&d.appendChild(g),g}static createNS(t,a){return window.document.createElementNS(t,a)}static disableDrag(){X.docStyle&&X.selectProp&&(X.userSelect=X.docStyle[X.selectProp],X.docStyle[X.selectProp]="none")}static enableDrag(){X.docStyle&&X.selectProp&&(X.docStyle[X.selectProp]=X.userSelect)}static setTransform(t,a){t.style[X.transformProp]=a}static addEventListener(t,a,d,g={}){t.addEventListener(a,d,"passive"in g?g:g.capture)}static removeEventListener(t,a,d,g={}){t.removeEventListener(a,d,"passive"in g?g:g.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",X.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",X.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",X.suppressClickInternal,!0)}),0)}static getScale(t){const a=t.getBoundingClientRect();return{x:a.width/t.offsetWidth||1,y:a.height/t.offsetHeight||1,boundingClientRect:a}}static getPoint(t,a,d){const g=a.boundingClientRect;return new l.P((d.clientX-g.left)/a.x-t.clientLeft,(d.clientY-g.top)/a.y-t.clientTop)}static mousePos(t,a){const d=X.getScale(t);return X.getPoint(t,d,a)}static touchPos(t,a){const d=[],g=X.getScale(t);for(let w=0;w<a.length;w++)d.push(X.getPoint(t,g,a[w]));return d}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const a=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),d=a.querySelectorAll("script");for(const g of d)g.remove();return X.clean(a),a.innerHTML}static isPossiblyDangerous(t,a){const d=a.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!d.includes("javascript:")&&!d.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const a=t.children;for(const d of a)X.removeAttributes(d),X.clean(d)}static removeAttributes(t){for(const{name:a,value:d}of t.attributes)X.isPossiblyDangerous(a,d)&&t.removeAttribute(a)}}X.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,X.selectProp=X.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),X.transformProp=X.testProp(["transform","WebkitTransform"]);const le={supported:!1,testSupport:function(b){!Ie&&_e&&(ke?Je(b):he=b)}};let he,_e,Ie=!1,ke=!1;function Je(b){const t=b.createTexture();b.bindTexture(b.TEXTURE_2D,t);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,_e),b.isContextLost())return;le.supported=!0}catch{}b.deleteTexture(t),Ie=!0}var He;typeof document<"u"&&(_e=document.createElement("img"),_e.onload=()=>{he&&Je(he),he=null,ke=!0},_e.onerror=()=>{Ie=!0,he=null},_e.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(b){let t,a,d,g;b.resetRequestQueue=()=>{t=[],a=0,d=0,g={}},b.addThrottleControl=k=>{const z=d++;return g[z]=k,z},b.removeThrottleControl=k=>{delete g[k],P()},b.getImage=(k,z,N=!0)=>new Promise(((Z,q)=>{le.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*"),l.e(k,{type:"image"}),t.push({abortController:z,requestParameters:k,supportImageRefresh:N,state:"queued",onError:Y=>{q(Y)},onSuccess:Y=>{Z(Y)}}),P()}));const w=k=>l._(this,void 0,void 0,(function*(){k.state="running";const{requestParameters:z,supportImageRefresh:N,onError:Z,onSuccess:q,abortController:Y}=k,ne=N===!1&&!l.i(self)&&!l.g(z.url)&&(!z.headers||Object.keys(z.headers).reduce(((fe,me)=>fe&&me==="accept"),!0));a++;const de=ne?E(z,Y):l.m(z,Y);try{const fe=yield de;delete k.abortController,k.state="completed",fe.data instanceof HTMLImageElement||l.b(fe.data)?q(fe):fe.data&&q({data:yield(pe=fe.data,typeof createImageBitmap=="function"?l.f(pe):l.h(pe)),cacheControl:fe.cacheControl,expires:fe.expires})}catch(fe){delete k.abortController,Z(fe)}finally{a--,P()}var pe})),P=()=>{const k=(()=>{for(const z of Object.keys(g))if(g[z]())return!0;return!1})()?l.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=a;z<k&&t.length>0;z++){const N=t.shift();N.abortController.signal.aborted?z--:w(N)}},E=(k,z)=>new Promise(((N,Z)=>{const q=new Image,Y=k.url,ne=k.credentials;ne&&ne==="include"?q.crossOrigin="use-credentials":(ne&&ne==="same-origin"||!l.d(Y))&&(q.crossOrigin="anonymous"),z.signal.addEventListener("abort",(()=>{q.src="",Z(new l.a(z.signal.reason))})),q.fetchPriority="high",q.onload=()=>{q.onerror=q.onload=null,N({data:q})},q.onerror=()=>{q.onerror=q.onload=null,z.signal.aborted||Z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},q.src=Y}))})(He||(He={})),He.resetRequestQueue();class nt{constructor(t){this._transformRequestFn=t??null}transformRequest(t,a){return this._transformRequestFn&&this._transformRequestFn(t,a)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function Pt(b){const t=[];if(typeof b=="string")t.push({id:"default",url:b});else if(b&&b.length>0){const a=[];for(const{id:d,url:g}of b){const w=`${d}${g}`;a.indexOf(w)===-1&&(a.push(w),t.push({id:d,url:g}))}}return t}function Ct(b,t,a){try{const d=new URL(b);return d.pathname+=`${t}${a}`,d.toString()}catch{throw new Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Zt(b){const{userImage:t}=b;return!!(t&&t.render&&t.render())&&(b.data.replace(new Uint8Array(t.data.buffer)),!0)}class lt extends l.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const t of Object.keys(this.images))this.removeImage(t);this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:a,promiseResolve:d}of this.requestors)d(this._getImagesForIds(a));this.requestors=[]}}getImage(t){const a=this.images[t];if(a&&!a.data&&a.spriteData){const d=a.spriteData;a.data=new l.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),a.spriteData=null}return a}addImage(t,a){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,a)&&(this.images[t]=a)}_validate(t,a){let d=!0;const g=a.data||a.spriteData;return this._validateStretch(a.stretchX,g&&g.width)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "stretchX" value`))),d=!1),this._validateStretch(a.stretchY,g&&g.height)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "stretchY" value`))),d=!1),this._validateContent(a.content,a)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "content" value`))),d=!1),d}_validateStretch(t,a){if(!t)return!0;let d=0;for(const g of t){if(g[0]<d||g[1]<g[0]||a<g[1])return!1;d=g[1]}return!0}_validateContent(t,a){if(!t)return!0;if(t.length!==4)return!1;const d=a.spriteData,g=d&&d.width||a.data.width,w=d&&d.height||a.data.height;return!(t[0]<0||g<t[0]||t[1]<0||w<t[1]||t[2]<0||g<t[2]||t[3]<0||w<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,a,d=!0){const g=this.getImage(t);if(d&&(g.data.width!==a.data.width||g.data.height!==a.data.height))throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=g.version+1,this.images[t]=a,this.updatedImages[t]=!0}removeImage(t){const a=this.images[t];delete this.images[t],delete this.patterns[t],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((a,d)=>{let g=!0;if(!this.isLoaded())for(const w of t)this.images[w]||(g=!1);this.isLoaded()||g?a(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:a})}))}_getImagesForIds(t){const a={};for(const d of t){let g=this.getImage(d);g||(this.fire(new l.l("styleimagemissing",{id:d})),g=this.getImage(d)),g?a[d]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,textFitWidth:g.textFitWidth,textFitHeight:g.textFitHeight,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:l.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:t,height:a}=this.atlasImage;return{width:t,height:a}}getPattern(t){const a=this.patterns[t],d=this.getImage(t);if(!d)return null;if(a&&a.position.version===d.version)return a.position;if(a)a.position.version=d.version;else{const g={w:d.data.width+2,h:d.data.height+2,x:0,y:0},w=new l.I(g,d);this.patterns[t]={bin:g,position:w}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const a=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.T(t,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const w in this.patterns)t.push(this.patterns[w].bin);const{w:a,h:d}=l.p(t),g=this.atlasImage;g.resize({width:a||1,height:d||1});for(const w in this.patterns){const{bin:P}=this.patterns[w],E=P.x+1,k=P.y+1,z=this.getImage(w).data,N=z.width,Z=z.height;l.R.copy(z,g,{x:0,y:0},{x:E,y:k},{width:N,height:Z}),l.R.copy(z,g,{x:0,y:Z-1},{x:E,y:k-1},{width:N,height:1}),l.R.copy(z,g,{x:0,y:0},{x:E,y:k+Z},{width:N,height:1}),l.R.copy(z,g,{x:N-1,y:0},{x:E-1,y:k},{width:1,height:Z}),l.R.copy(z,g,{x:0,y:0},{x:E+N,y:k},{width:1,height:Z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const a of t){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const d=this.getImage(a);d||l.w(`Image with ID: "${a}" was not found`),Zt(d)&&this.updateImage(a,d)}}cloneImages(){const t={};for(const a in this.images){const d=this.images[a];t[a]=Object.assign(Object.assign({},d),{data:d.data?d.data.clone():null})}return t}}const Et=1e20;function ft(b,t,a,d,g,w,P,E,k){for(let z=t;z<t+d;z++)gt(b,a*w+z,w,g,P,E,k);for(let z=a;z<a+g;z++)gt(b,z*w+t,1,d,P,E,k)}function gt(b,t,a,d,g,w,P){w[0]=0,P[0]=-Et,P[1]=Et,g[0]=b[t];for(let E=1,k=0,z=0;E<d;E++){g[E]=b[t+E*a];const N=E*E;do{const Z=w[k];z=(g[E]-g[Z]+N-Z*Z)/(E-Z)/2}while(z<=P[k]&&--k>-1);k++,w[k]=E,P[k]=z,P[k+1]=Et}for(let E=0,k=0;E<d;E++){for(;P[k+1]<E;)k++;const z=w[k],N=E-z;b[t+E*a]=g[z]+N*N}}const dt=l.v.layout_symbol["text-font"].default.join(",");class mt{constructor(t,a,d){this.requestManager=t,this.localIdeographFontFamily=a,this.entries={},this.lang=d}setURL(t){this.url=t}getGlyphs(t){return l._(this,void 0,void 0,(function*(){const a=[];for(const w in t)for(const P of t[w])a.push(this._getAndCacheGlyphsPromise(w,P));const d=yield Promise.all(a),g={};for(const{stack:w,id:P,glyph:E}of d)g[w]||(g[w]={}),g[w][P]=E&&{id:E.id,bitmap:E.bitmap.clone(),metrics:E.metrics};return g}))}_getAndCacheGlyphsPromise(t,a){return l._(this,void 0,void 0,(function*(){let d=this.entries[t];d||(d=this.entries[t]={glyphs:{},requests:{},ranges:{}});let g=d.glyphs[a];return g!==void 0?{stack:t,id:a,glyph:g}:!this.url||this._charUsesLocalIdeographFontFamily(a)?(g=d.glyphs[a]=this._drawGlyph(d,t,a),{stack:t,id:a,glyph:g}):yield this._downloadAndCacheRangePromise(t,a)}))}_downloadAndCacheRangePromise(t,a){return l._(this,void 0,void 0,(function*(){const d=this.entries[t],g=Math.floor(a/256);if(d.ranges[g])return{stack:t,id:a,glyph:null};if(!d.requests[g]){const w=mt.loadGlyphRange(t,g,this.url,this.requestManager);d.requests[g]=w}try{const w=yield d.requests[g];for(const P in w)d.glyphs[+P]=w[+P];return d.ranges[g]=!0,{stack:t,id:a,glyph:w[a]||null}}catch(w){const P=d.glyphs[a]=this._drawGlyph(d,t,a);return this._warnOnMissingGlyphRange(P,g,a,w),{stack:t,id:a,glyph:P}}}))}_warnOnMissingGlyphRange(t,a,d,g){const w=256*a,P=w+255,E=d.toString(16).padStart(4,"0").toUpperCase();l.w(`Unable to load glyph range ${a}, ${w}-${P}. Rendering codepoint U+${E} locally instead. ${g}`)}_charUsesLocalIdeographFontFamily(t){return!!this.localIdeographFontFamily&&l.q(t)}_drawGlyph(t,a,d){const g=a===dt&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(d),w=g?"ideographTinySDF":"tinySDF";t[w]||(t[w]=this._createTinySDF(g?this.localIdeographFontFamily:a));const P=t[w].draw(String.fromCodePoint(d)),E=new RegExp("^\\p{gc=Cf}+$","u").test(String.fromCodePoint(d));return{id:d,bitmap:new l.r({width:P.width||60,height:P.height||60},P.data),metrics:{width:E?0:P.glyphWidth/2||24,height:P.glyphHeight/2||24,left:P.glyphLeft/2+.5||0,top:P.glyphTop/2-27.5||-8,advance:E?0:P.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(t){const a=t?t.split(","):[];a.push("sans-serif");const d=a.map((g=>/[-\w]+/.test(g)?g:`'${CSS.escape(g)}'`)).join(",");return new mt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:this._fontWeight(a[0]),fontStyle:this._fontStyle(a[0]),lang:this.lang})}_fontStyle(t){return/italic/i.test(t)?"italic":/oblique/i.test(t)?"oblique":"normal"}_fontWeight(t){const a={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let d;for(const[g,w]of Object.entries(a))new RegExp(`\\b${g}\\b`,"i").test(t)&&(d=`${w}`);return d}destroy(){for(const t in this.entries){const a=this.entries[t];a.tinySDF&&(a.tinySDF=null),a.ideographTinySDF&&(a.ideographTinySDF=null),a.glyphs={},a.requests={},a.ranges={}}this.entries={}}}mt.loadGlyphRange=function(b,t,a,d){return l._(this,void 0,void 0,(function*(){const g=256*t,w=g+255,P=d.transformRequest(a.replace("{fontstack}",b).replace("{range}",`${g}-${w}`),"Glyphs"),E=yield l.n(P,new AbortController);if(!E||!E.data)throw new Error(`Could not load glyph range. range: ${t}, ${g}-${w}`);const k={};for(const z of l.o(E.data))k[z.id]=z;return k}))},mt.TinySDF=class{constructor({fontSize:b=24,buffer:t=3,radius:a=8,cutoff:d=.25,fontFamily:g="sans-serif",fontWeight:w="normal",fontStyle:P="normal",lang:E=null}={}){this.buffer=t,this.cutoff=d,this.radius=a,this.lang=E;const k=this.size=b+4*t,z=this._createCanvas(k),N=this.ctx=z.getContext("2d",{willReadFrequently:!0});N.font=`${P} ${w} ${b}px ${g}`,N.textBaseline="alphabetic",N.textAlign="left",N.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Uint16Array(k)}_createCanvas(b){const t=document.createElement("canvas");return t.width=t.height=b,t}draw(b){const{width:t,actualBoundingBoxAscent:a,actualBoundingBoxDescent:d,actualBoundingBoxLeft:g,actualBoundingBoxRight:w}=this.ctx.measureText(b),P=Math.ceil(a),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-g))),k=Math.min(this.size-this.buffer,P+Math.ceil(d)),z=E+2*this.buffer,N=k+2*this.buffer,Z=Math.max(z*N,0),q=new Uint8ClampedArray(Z),Y={data:q,width:z,height:N,glyphWidth:E,glyphHeight:k,glyphTop:P,glyphLeft:0,glyphAdvance:t};if(E===0||k===0)return Y;const{ctx:ne,buffer:de,gridInner:pe,gridOuter:fe}=this;this.lang&&(ne.lang=this.lang),ne.clearRect(de,de,E,k),ne.fillText(b,de,de+P);const me=ne.getImageData(de,de,E,k);fe.fill(Et,0,Z),pe.fill(0,0,Z);for(let Se=0;Se<k;Se++)for(let ge=0;ge<E;ge++){const Te=me.data[4*(Se*E+ge)+3]/255;if(Te===0)continue;const Me=(Se+de)*z+ge+de;if(Te===1)fe[Me]=0,pe[Me]=Et;else{const be=.5-Te;fe[Me]=be>0?be*be:0,pe[Me]=be<0?be*be:0}}ft(fe,0,0,z,N,z,this.f,this.v,this.z),ft(pe,de,de,E,k,z,this.f,this.v,this.z);for(let Se=0;Se<Z;Se++){const ge=Math.sqrt(fe[Se])-Math.sqrt(pe[Se]);q[Se]=Math.round(255-255*(ge/this.radius+this.cutoff))}return Y}};class Xe{constructor(){this.specification=l.u.light.position}possiblyEvaluate(t,a){return l.F(t.expression.evaluate(a))}interpolate(t,a,d){return{x:l.G.number(t.x,a.x,d),y:l.G.number(t.y,a.y,d),z:l.G.number(t.z,a.z,d)}}}let Be;class _t extends l.E{constructor(t){super(),Be=Be||new l.t({anchor:new l.D(l.u.light.anchor),position:new Xe,color:new l.D(l.u.light.color),intensity:new l.D(l.u.light.intensity)}),this._transitionable=new l.x(Be,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,a={}){if(!this._validate(l.y,t,a))for(const d in t){const g=t[d];d.endsWith(l.z)?this._transitionable.setTransition(d.slice(0,-l.z.length),g):this._transitionable.setValue(d,g)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,d){return(!d||d.validate!==!1)&&l.B(this,t.call(l.C,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:l.u}))}}const Re=new l.t({"sky-color":new l.D(l.u.sky["sky-color"]),"horizon-color":new l.D(l.u.sky["horizon-color"]),"fog-color":new l.D(l.u.sky["fog-color"]),"fog-ground-blend":new l.D(l.u.sky["fog-ground-blend"]),"horizon-fog-blend":new l.D(l.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new l.D(l.u.sky["sky-horizon-blend"]),"atmosphere-blend":new l.D(l.u.sky["atmosphere-blend"])});class at extends l.E{constructor(t){super(),this._transitionable=new l.x(Re,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.H(0))}setSky(t,a={}){if(!this._validate(l.J,t,a)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const d in t){const g=t[d];d.endsWith(l.z)?this._transitionable.setTransition(d.slice(0,-l.z.length),g):this._transitionable.setValue(d,g)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,d={}){return d?.validate!==!1&&l.B(this,t.call(l.C,l.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:l.u})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class nr{constructor(t,a){this.width=t,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,a){const d=t.join(",")+String(a);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(t,a)),this.dashEntry[d]}getDashRanges(t,a,d){const g=[];let w=t.length%2==1?-t[t.length-1]*d:0,P=t[0]*d,E=!0;g.push({left:w,right:P,isDash:E,zeroLength:t[0]===0});let k=t[0];for(let z=1;z<t.length;z++){E=!E;const N=t[z];w=k*d,k+=N,P=k*d,g.push({left:w,right:P,isDash:E,zeroLength:N===0})}return g}addRoundDash(t,a,d){const g=a/2;for(let w=-d;w<=d;w++){const P=this.width*(this.nextRow+d+w);let E=0,k=t[E];for(let z=0;z<this.width;z++){z/k.right>1&&(k=t[++E]);const N=Math.abs(z-k.left),Z=Math.abs(z-k.right),q=Math.min(N,Z);let Y;const ne=w/d*(g+1);if(k.isDash){const de=g-Math.abs(ne);Y=Math.sqrt(q*q+de*de)}else Y=g-Math.sqrt(q*q+ne*ne);this.data[P+z]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(t){for(let E=t.length-1;E>=0;--E){const k=t[E],z=t[E+1];k.zeroLength?t.splice(E,1):z&&z.isDash===k.isDash&&(z.left=k.left,t.splice(E,1))}const a=t[0],d=t[t.length-1];a.isDash===d.isDash&&(a.left=d.left-this.width,d.right=a.right+this.width);const g=this.width*this.nextRow;let w=0,P=t[w];for(let E=0;E<this.width;E++){E/P.right>1&&(P=t[++w]);const k=Math.abs(E-P.left),z=Math.abs(E-P.right),N=Math.min(k,z);this.data[g+E]=Math.max(0,Math.min(255,(P.isDash?N:-N)+128))}}addDash(t,a){const d=a?7:0,g=2*d+1;if(this.nextRow+g>this.height)return l.w("LineAtlas out of space"),null;let w=0;for(let E=0;E<t.length;E++)w+=t[E];if(w!==0){const E=this.width/w,k=this.getDashRanges(t,this.width,E);a?this.addRoundDash(k,E,d):this.addRegularDash(k)}const P={y:this.nextRow+d,height:2*d,width:w};return this.nextRow+=g,this.dirty=!0,P}bind(t){const a=t.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const er="maplibre_preloaded_worker_pool";class ir{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<ir.workerCount;)this.workers.push(new Worker(l.c.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach((a=>{a.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[er]}numActive(){return Object.keys(this.active).length}}const sr=Math.floor(re.hardwareConcurrency/2);let St,Gt;function yr(){return St||(St=new ir),St}ir.workerCount=l.K(globalThis)?Math.max(Math.min(sr,3),1):1;class cr{constructor(t,a){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=a;const d=this.workerPool.acquire(a);for(let g=0;g<d.length;g++){const w=new l.L(d[g],a);w.name=`Worker ${g}`,this.actors.push(w)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,a){const d=[];for(const g of this.actors)d.push(g.sendAsync({type:t,data:a}));return Promise.all(d)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((a=>{a.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,a){for(const d of this.actors)d.registerMessageHandler(t,a)}unregisterMessageHandler(t){for(const a of this.actors)a.unregisterMessageHandler(t)}}function Lr(){return Gt||(Gt=new cr(yr(),l.M),Gt.registerMessageHandler("GR",((b,t,a)=>l.m(t,a)))),Gt}function jr(b,t){const a=l.N();return l.O(a,a,[1,1,0]),l.Q(a,a,[.5*b.width,.5*b.height,1]),b.calculatePosMatrix?l.S(a,a,b.calculatePosMatrix(t.toUnwrapped())):a}function Fn(b,t,a,d,g,w,P){var E;const k=(function(q,Y,ne){if(q)for(const de of q){const pe=Y[de];if(pe&&pe.source===ne&&pe.type==="fill-extrusion")return!0}else for(const de in Y){const pe=Y[de];if(pe.source===ne&&pe.type==="fill-extrusion")return!0}return!1})((E=g?.layers)!==null&&E!==void 0?E:null,t,b.id),z=w.maxPitchScaleFactor(),N=b.tilesIn(d,z,k);N.sort(en);const Z=[];for(const q of N)Z.push({wrappedTileID:q.tileID.wrapped().key,queryResults:q.tile.queryRenderedFeatures(t,a,b.getState(),q.queryGeometry,q.cameraQueryGeometry,q.scale,g,w,z,jr(w,q.tileID),P?(Y,ne)=>P(q.tileID,Y,ne):void 0)});return(function(q,Y){for(const ne in q)for(const de of q[ne])ni(de,Y);return q})((function(q){const Y={},ne={};for(const de of q){const pe=de.queryResults,fe=de.wrappedTileID,me=ne[fe]=ne[fe]||{};for(const Se in pe){const ge=pe[Se],Te=me[Se]=me[Se]||{},Me=Y[Se]=Y[Se]||[];for(const be of ge)Te[be.featureIndex]||(Te[be.featureIndex]=!0,Me.push(be))}}return Y})(Z),b)}function en(b,t){const a=b.tileID,d=t.tileID;return a.overscaledZ-d.overscaledZ||a.canonical.y-d.canonical.y||a.wrap-d.wrap||a.canonical.x-d.canonical.x}function ni(b,t){const a=b.feature,d=t.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=d}function vi(b,t,a){return l._(this,void 0,void 0,(function*(){let d=b;if(b.url?d=(yield l.j(t.transformRequest(b.url,"Source"),a)).data:yield re.frameAsync(a),!d)return null;const g=l.U(l.e(d,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in d&&d.vector_layers&&(g.vectorLayerIds=d.vector_layers.map((w=>w.id))),g}))}class Xr{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof l.V?new l.V(t.lng,t.lat):l.V.convert(t),this}setSouthWest(t){return this._sw=t instanceof l.V?new l.V(t.lng,t.lat):l.V.convert(t),this}extend(t){const a=this._sw,d=this._ne;let g,w;if(t instanceof l.V)g=t,w=t;else{if(!(t instanceof Xr))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Xr.convert(t)):this.extend(l.V.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(l.V.convert(t)):this;if(g=t._sw,w=t._ne,!g||!w)return this}return a||d?(a.lng=Math.min(g.lng,a.lng),a.lat=Math.min(g.lat,a.lat),d.lng=Math.max(w.lng,d.lng),d.lat=Math.max(w.lat,d.lat)):(this._sw=new l.V(g.lng,g.lat),this._ne=new l.V(w.lng,w.lat)),this}getCenter(){return new l.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.V(this.getWest(),this.getNorth())}getSouthEast(){return new l.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:d}=l.V.convert(t);let g=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&g}intersects(t){if(!((t=Xr.convert(t)).getNorth()>=this.getSouth()&&t.getSouth()<=this.getNorth()))return!1;const a=Math.abs(this.getEast()-this.getWest()),d=Math.abs(t.getEast()-t.getWest());if(a>=360||d>=360)return!0;const g=l.W(this.getWest(),-180,180),w=l.W(this.getEast(),-180,180),P=l.W(t.getWest(),-180,180),E=l.W(t.getEast(),-180,180),k=g>=w,z=P>=E;return!(!k||!z)||(k?E>=g||P<=w:z?w>=P||g<=E:P<=w&&E>=g)}static convert(t){return t instanceof Xr?t:t&&new Xr(t)}static fromLngLat(t,a=0){const d=360*a/40075017,g=d/Math.cos(Math.PI/180*t.lat);return new Xr(new l.V(t.lng-g,t.lat-d),new l.V(t.lng+g,t.lat+d))}adjustAntiMeridian(){const t=new l.V(this._sw.lng,this._sw.lat),a=new l.V(this._ne.lng,this._ne.lat);return new Xr(t,t.lng>a.lng?new l.V(a.lng+360,a.lat):a)}}class io{constructor(t,a,d){this.bounds=Xr.convert(this.validateBounds(t)),this.minzoom=a||0,this.maxzoom=d||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const a=Math.pow(2,t.z),d=Math.floor(l.Y(this.bounds.getWest())*a),g=Math.floor(l.X(this.bounds.getNorth())*a),w=Math.ceil(l.Y(this.bounds.getEast())*a),P=Math.ceil(l.X(this.bounds.getSouth())*a);return t.x>=d&&t.x<w&&t.y>=g&&t.y<P}}class Mo extends l.E{constructor(t,a,d,g){if(super(),this.id=t,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.e(this,l.U(a,["url","scheme","tileSize","promoteId","encoding"])),this._options=l.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g)}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield vi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),t&&(l.e(this,t),t.bounds&&(this.tileBounds=new io(t.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,l.Z(t)||this.fire(new l.k(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return l.e({},this._options)}loadTile(t){return l._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(a,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(t)};d.request.collectResourceTiming=this._collectResourceTiming;let g="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise(((w,P)=>{t.reloadPromise={resolve:w,reject:P}}))}else t.actor=this.dispatcher.getActor(),g="LT";t.abortController=new AbortController;try{const w=yield t.actor.sendAsync({type:g,data:d},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,w)}catch(w){if(delete t.abortController,t.aborted)return;if(w&&w.status!==404)throw w;this._afterTileLoadWorkerResponse(t,null)}}))}_getOverzoomParameters(t){if(t.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const a=t.tileID.scaledTo(this.maxzoom).canonical,d=a.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:a,overzoomRequest:this.map._requestManager.transformRequest(d,"Tile")}}_afterTileLoadWorkerResponse(t,a){if(a&&a.resourceTiming&&(t.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&t.setExpiryData(a),t.loadVectorData(a,this.map.painter),t.reloadPromise){const d=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(d.resolve).catch(d.reject)}}abortTile(t){return l._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return l._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Ms extends l.E{constructor(t,a,d,g){super(),this.id=t,this.dispatcher=d,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.e({type:"raster"},a),l.e(this,l.U(a,["url","scheme","tileSize"]))}load(){return l._(this,arguments,void 0,(function*(t=!1){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield vi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,a&&(l.e(this,a),a.bounds&&(this.tileBounds=new io(a.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(a){this._tileJSONRequest=null,this._loaded=!0,l.Z(a)||this.fire(new l.k(a))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return l.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return l._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const d=yield He.getImage(this.map._requestManager.transformRequest(a,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(d&&d.data){this.map._refreshExpiredTiles&&(d.cacheControl||d.expires)&&t.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const g=this.map.painter.context,w=g.gl,P=d.data;t.texture=this.map.painter.getTileTexture(P.width),t.texture?t.texture.update(P,{useMipmap:!0}):(t.texture=new l.T(g,P,w.RGBA,{useMipmap:!0}),t.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(d){if(delete t.abortController,t.aborted)t.state="unloaded";else if(d)throw t.state="errored",d}}))}abortTile(t){return l._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return l._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class Ae extends Ms{constructor(t,a,d,g){super(t,a,d,g),this.type="raster-dem",this.maxzoom=22,this._options=l.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(t){return l._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(a,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const g=yield He.getImage(d,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(g&&g.data){const w=g.data;this.map._refreshExpiredTiles&&(g.cacheControl||g.expires)&&t.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const P=l.b(w)&&l.$()?w:yield this.readImageNow(w),E={type:this.type,uid:t.uid,source:this.id,rawImageData:P,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const k=yield t.actor.sendAsync({type:"LDT",data:E});t.dem=k,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(g){if(delete t.abortController,t.aborted)t.state="unloaded";else if(g)throw t.state="errored",g}}))}readImageNow(t){return l._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&l.a0()){const a=t.width+2,d=t.height+2;try{return new l.R({width:a,height:d},yield l.a1(t,-1,-1,a,d))}catch{}}return re.getImageData(t,1)}))}_getNeighboringTiles(t){const a=t.canonical,d=Math.pow(2,a.z),g=(a.x-1+d)%d,w=a.x===0?t.wrap-1:t.wrap,P=(a.x+1+d)%d,E=a.x+1===d?t.wrap+1:t.wrap,k={};return k[new l.a2(t.overscaledZ,w,a.z,g,a.y).key]={backfilled:!1},k[new l.a2(t.overscaledZ,E,a.z,P,a.y).key]={backfilled:!1},a.y>0&&(k[new l.a2(t.overscaledZ,w,a.z,g,a.y-1).key]={backfilled:!1},k[new l.a2(t.overscaledZ,t.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},k[new l.a2(t.overscaledZ,E,a.z,P,a.y-1).key]={backfilled:!1}),a.y+1<d&&(k[new l.a2(t.overscaledZ,w,a.z,g,a.y+1).key]={backfilled:!1},k[new l.a2(t.overscaledZ,t.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},k[new l.a2(t.overscaledZ,E,a.z,P,a.y+1).key]={backfilled:!1}),k}unloadTile(t){return l._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}function Ue(b){return b.type==="GeometryCollection"?b.geometries.map((t=>t.coordinates)).flat(1/0):b.coordinates.flat(1/0)}function it(b){const t=new Xr;let a;switch(b.type){case"FeatureCollection":a=b.features.map((d=>Ue(d.geometry))).flat(1/0);break;case"Feature":a=Ue(b.geometry);break;default:a=Ue(b)}if(a.length==0)return t;for(let d=0;d<a.length-1;d+=2)t.extend([a[d],a[d+1]]);return t}class Vt extends l.E{constructor(t,a,d,g){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:a.data},this.actor=d.getActor(),this.setEventedParent(g),this._data=typeof a.data=="string"?{url:a.data}:{geojson:a.data},this._options=l.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId,a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&l.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=l.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(a.buffer!==void 0?a.buffer:128),tolerance:this._pixelsToTileUnits(a.tolerance!==void 0?a.tolerance:.375),extent:l.a5,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(a.clusterMaxZoom),minPoints:Math.max(2,a.clusterMinPoints||2),extent:l.a5,radius:this._pixelsToTileUnits(a.clusterRadius||50),log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(t){return t*(l.a5/this.tileSize)}_getClusterMaxZoom(t){const a=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||l.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${a}"`),a}load(){return l._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t,a){this._data=typeof t=="string"?{url:t}:{geojson:t},this._pendingWorkerUpdate={data:t};const d=this._updateWorkerData();return a?d:this}updateData(t,a){this._pendingWorkerUpdate.diff=l.a6(this._pendingWorkerUpdate.diff,t);const d=this._updateWorkerData();return a?d:this}getData(){return l._(this,void 0,void 0,(function*(){const t=l.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}getBounds(){return l._(this,void 0,void 0,(function*(){return it(yield this.getData())}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,a,d){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:a,offset:d}})}_updateWorkerData(){return l._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void l.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:t,diff:a}=this._pendingWorkerUpdate,d=l.e({type:this.type},this.workerOptions);t!==void 0?(typeof t=="string"?(d.request=this.map._requestManager.transformRequest(re.resolveURL(t),"Source"),d.request.collectResourceTiming=this._collectResourceTiming):d.data=t,this._pendingWorkerUpdate.data=void 0):a&&(d.dataDiff=a,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new l.l("dataloading",{dataType:"source"}));try{const g=yield this.actor.sendAsync({type:"LD",data:d});if(this._isUpdatingWorker=!1,this._removed||g.abandoned)return void this.fire(new l.l("dataabort",{dataType:"source"}));g.data&&(this._data={geojson:g.data});const w=this._applyDiffToSource(a),P=this._getShouldReloadTileOptions(w);let E=null;g.resourceTiming&&g.resourceTiming[this.id]&&(E=g.resourceTiming[this.id].slice(0));const k={dataType:"source"};this._collectResourceTiming&&E&&E.length>0&&l.e(k,{resourceTiming:E}),this.fire(new l.l("data",Object.assign(Object.assign({},k),{sourceDataType:"metadata"}))),this.fire(new l.l("data",Object.assign(Object.assign({},k),{sourceDataType:"content",shouldReloadTileOptions:P})))}catch(g){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new l.l("dataabort",{dataType:"source"}));this.fire(new l.k(g))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyDiffToSource(t){if(!t)return;const a=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const g=l.a7(this._data.geojson,a);if(!g)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:g}}if(!this._data.updateable)return;const d=l.a8(this._data.updateable,t,a);return t.removeAll||this._options.cluster?void 0:d}_getShouldReloadTileOptions(t){if(t)return{affectedBounds:t.filter(Boolean).map((a=>it(a)))}}shouldReloadTile(t,{affectedBounds:a}){if(t.state==="loading")return!0;if(t.state==="unloaded")return!1;const{buffer:d,extent:g}=this.workerOptions.geojsonVtOptions,w=(function({x:P,y:E,z:k},z=0){const N=l.a3((P-z)/Math.pow(2,k)),Z=l.a4((E+1+z)/Math.pow(2,k)),q=l.a3((P+1+z)/Math.pow(2,k)),Y=l.a4((E-z)/Math.pow(2,k));return new Xr([N,Z],[q,Y])})(t.tileID.canonical,d/g);for(const P of a)if(w.intersects(P))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(t){return l._(this,void 0,void 0,(function*(){const a=t.actor?"RT":"LT";t.actor=this.actor;const d={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const g=yield this.actor.sendAsync({type:a,data:d},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(g,this.map.painter,a==="RT")}))}abortTile(t){return l._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return l._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return l.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class Mt extends l.E{constructor(t,a,d,g){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=d,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=a}load(t){return l._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield He.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,t&&(this.coordinates=t),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,l.Z(a)||this.fire(new l.k(a))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const a=t.map(l.a9.fromLngLat);var d;return this.tileID=(function(g){const w=l.aa.fromPoints(g),P=w.width(),E=w.height(),k=Math.max(P,E),z=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),N=Math.pow(2,z);return new l.ac(z,Math.floor((w.minX+w.maxX)/2*N),Math.floor((w.minY+w.maxY)/2*N))})(a),this.terrainTileRanges=this._getOverlappingTileRanges(a),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=a.map((g=>this.tileID.getTilePoint(g)._round())),this.flippedWindingOrder=((d=this.tileCoords)[1].x-d[0].x)*(d[2].y-d[0].y)-(d[1].y-d[0].y)*(d[2].x-d[0].x)<0,this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,a=t.gl;this.texture||(this.texture=new l.T(t,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let d=!1;for(const g in this.tiles){const w=this.tiles[g];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,d=!0)}d&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return l._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:a,minY:d,maxX:g,maxY:w}=l.aa.fromPoints(t),P={};for(let E=0;E<=l.ab;E++){const k=Math.pow(2,E),z=Math.floor(a*k),N=Math.floor(d*k),Z=Math.floor(g*k),q=Math.floor(w*k),Y=(z%k+k)%k,ne=Z%k,de=Math.floor(z/k),pe=Math.floor(Z/k);P[E]={minWrap:de,maxWrap:pe,minTileXWrapped:Y,maxTileXWrapped:ne,minTileY:N,maxTileY:q}}return P}}class xe extends Mt{constructor(t,a,d,g){super(t,a,d,g),this.roundZoom=!0,this.type="video",this.options=a}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const a of t.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield l.ad(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new l.k(a))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const a=this.video.seekable;t<a.start(0)||t>a.end(0)?this.fire(new l.k(new l.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,a=t.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new l.T(t,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let d=!1;for(const g in this.tiles){const w=this.tiles[g];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,d=!0)}d&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ee extends Mt{constructor(t,a,d,g){super(t,a,d,g),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some((w=>!Array.isArray(w)||w.length!==2||w.some((P=>typeof P!="number"))))||this.fire(new l.k(new l.ae(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.k(new l.ae(`sources.${t}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new l.k(new l.ae(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new l.k(new l.ae(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.k(new l.ae(`sources.${t}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,d=a.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new l.T(a,this.canvas,d.RGBA,{premultiply:!0}),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let g=!1;for(const w in this.tiles){const P=this.tiles[w];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture,g=!0)}g&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const te={},oe=b=>{switch(b){case"geojson":return Vt;case"image":return Mt;case"raster":return Ms;case"raster-dem":return Ae;case"vector":return Mo;case"video":return xe;case"canvas":return ee}return te[b]},we="RTLPluginLoaded";class Ee extends l.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Lr()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((a=>{throw this.status="error",a}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return l._(this,arguments,void 0,(function*(a,d=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=re.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!d)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return l._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new l.l(we))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ne=null;function Oe(){return Ne||(Ne=new Ee),Ne}var De,Ze;(function(b){b[b.Base=0]="Base",b[b.Parent=1]="Parent"})(De||(De={})),(function(b){b[b.Departing=0]="Departing",b[b.Incoming=1]="Incoming"})(Ze||(Ze={}));class ut{constructor(t,a){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=t,this.uid=l.af(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(t){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(t||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:t,fadingDirection:a,fadingParentID:d,fadeEndTime:g}){this.resetFadeLogic(),this.fadingRole=t,this.fadingDirection=a,this.fadingParentID=d,this.fadeEndTime=g}setSelfFadeLogic(t){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=t}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=Q(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,a,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData,this.latestFeatureIndex.encoding=t.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=(function(g,w){const P={};if(!w)return P;for(const E of g){const k=E.layerIds.map((z=>w.getLayer(z))).filter(Boolean);if(k.length!==0){E.layers=k,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map((z=>k.filter((N=>N.id===z))[0])));for(const z of k)P[z.id]=E}}return P})(t.buckets,a?.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const w=this.buckets[g];if(w instanceof l.ah){if(this.hasSymbolBuckets=!0,!d)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const w=this.buckets[g];if(w instanceof l.ah&&w.hasRTLText){this.hasRTLText=!0,Oe().lazyLoad();break}}this.queryPadding=0;for(const g in this.buckets){const w=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(g).queryRadius(w))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),this.dashPositions=t.dashPositions}else this.collisionBoxArray=new l.ag}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const d in this.buckets){const g=this.buckets[d];g.uploadPending()&&g.upload(t)}const a=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new l.T(t,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new l.T(t,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,a,d,g,w,P,E,k,z,N,Z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:w,scale:P,tileSize:this.tileSize,pixelPosMatrix:N,transform:k,params:E,queryPadding:this.queryPadding*z,getElevation:Z},t,a,d):{}}querySourceFeatures(t,a){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const g=d.loadVTLayers(),w=a&&a.sourceLayer?a.sourceLayer:"",P=g[l.ai]||g[w];if(!P)return;const E=l.aj(a?.filter,a?.globalState),{z:k,x:z,y:N}=this.tileID.canonical,Z={z:k,x:z,y:N};for(let q=0;q<P.length;q++){const Y=P.feature(q);if(E.needGeometry){const pe=l.ak(Y,!0);if(!E.filter(new l.H(this.tileID.overscaledZ),pe,this.tileID.canonical))continue}else if(!E.filter(new l.H(this.tileID.overscaledZ),Y))continue;const ne=d.getId(Y,w),de=new l.al(Y,k,z,N,ne);de.tile=Z,t.push(de)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const a=this.expirationTime;if(t.cacheControl){const d=l.am(t.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const d=Date.now();let g=!1;if(this.expirationTime>d)g=!1;else if(a)if(this.expirationTime<a)g=!0;else{const w=this.expirationTime-a;w?this.expirationTime=d+Math.max(w,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const g in this.buckets){if(!a.style.hasLayer(g))continue;const w=this.buckets[g],P=w.layers[0].sourceLayer||l.ai,E=d[P],k=t[P];if(!E||!k||Object.keys(k).length===0)continue;w.update(k,E,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const z=a&&a.style&&a.style.getLayer(g);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(w)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Q()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(t){this.symbolFadeHoldUntil=Q()+t}setDependencies(t,a){const d={};for(const g of a)d[g]=!0;this.dependencies[t]=d}hasDependency(t,a){for(const d of t){const g=this.dependencies[d];if(g){for(const w of a)if(g[w])return!0}}return!1}}class st{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,a,d){const g=String(a);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][g]=this.stateChanges[t][g]||{},l.e(this.stateChanges[t][g],d),this.deletedStates[t]===null){this.deletedStates[t]={};for(const w in this.state[t])w!==g&&(this.deletedStates[t][w]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][g]===null){this.deletedStates[t][g]={};for(const w in this.state[t][g])d[w]||(this.deletedStates[t][g][w]=null)}else for(const w in d)this.deletedStates[t]&&this.deletedStates[t][g]&&this.deletedStates[t][g][w]===null&&delete this.deletedStates[t][g][w]}removeFeatureState(t,a,d){if(this.deletedStates[t]===null)return;const g=String(a);if(this.deletedStates[t]=this.deletedStates[t]||{},d&&a!==void 0)this.deletedStates[t][g]!==null&&(this.deletedStates[t][g]=this.deletedStates[t][g]||{},this.deletedStates[t][g][d]=null);else if(a!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][g])for(d in this.deletedStates[t][g]={},this.stateChanges[t][g])this.deletedStates[t][g][d]=null;else this.deletedStates[t][g]=null;else this.deletedStates[t]=null}getState(t,a){const d=String(a),g=l.e({},(this.state[t]||{})[d],(this.stateChanges[t]||{})[d]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const w=this.deletedStates[t][a];if(w===null)return{};for(const P in w)delete g[P]}return g}initializeTileState(t,a){t.setFeatureState(this.state,a)}coalesceChanges(t,a){const d={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const w={};for(const P in this.stateChanges[g])this.state[g][P]||(this.state[g][P]={}),l.e(this.state[g][P],this.stateChanges[g][P]),w[P]=this.state[g][P];d[g]=w}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const w={};if(this.deletedStates[g]===null)for(const P in this.state[g])w[P]={},this.state[g][P]={};else for(const P in this.deletedStates[g]){if(this.deletedStates[g][P]===null)this.state[g][P]={};else for(const E of Object.keys(this.deletedStates[g][P]))delete this.state[g][P][E];w[P]=this.state[g][P]}d[g]=d[g]||{},l.e(d[g],w)}this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0&&t.setFeatureState(d,a)}}const Ot=89.25;function $t(b,t){const a=l.an(t.lat,-l.ao,l.ao);return new l.P(l.Y(t.lng)*b,l.X(a)*b)}function hr(b,t){return new l.a9(t.x/b,t.y/b).toLngLat()}function Ur(b){return b.cameraToCenterDistance*Math.min(.85*Math.tan(l.ap(90-b.pitch)),Math.tan(l.ap(Ot-b.pitch)))}function kr(b,t){const a=b.canonical,d=t/l.aq(a.z),g=a.x+Math.pow(2,a.z)*b.wrap,w=l.ar(new Float64Array(16));return l.O(w,w,[g*d,a.y*d,0]),l.Q(w,w,[d/l.a5,d/l.a5,1]),w}function $e(b,t,a,d,g){const w=l.a9.fromLngLat(b,t),P=g*l.as(1,b.lat),{x:E,y:k,z}=an(a,d);return new l.a9(w.x+P*-E,w.y+P*-k,w.z+P*-z)}function an(b,t){const a=l.ap(b),d=l.ap(t),g=Math.cos(-a),w=Math.sin(a);return{x:w*Math.sin(d),y:-w*Math.cos(d),z:g}}function xi(b,t,a){const d=t.intersectsFrustum(b);if(!a||d===0)return d;const g=t.intersectsPlane(a);return g===0?0:d===2&&g===2?2:1}function fr(b,t,a){let d=0;const g=(a-t)/10;for(let w=0;w<10;w++)d+=g*Math.pow(Math.cos(t+(w+.5)/10*(a-t)),b);return d}function Kr(b,t){return function(a,d,g,w,P){const E=2*((b-1)/l.at(Math.cos(l.ap(Ot-P))/Math.cos(l.ap(Ot)))-1),k=Math.acos(g/w),z=2*fr(E-1,0,l.ap(P/2)),N=Math.min(l.ap(Ot),k+l.ap(P/2)),Z=fr(E-1,Math.min(N,k-l.ap(P/2)),N),q=Math.atan(d/g),Y=Math.hypot(d,g);let ne=a;return ne+=l.at(w/Y/Math.max(.5,Math.cos(l.ap(P/2)))),ne+=E*l.at(Math.cos(q))/2,ne-=l.at(Math.max(1,Z/z/t))/2,ne}}const hi=Kr(9.314,3);function mn(b,t){const a=(t.roundZoom?Math.round:Math.floor)(b.zoom+l.at(b.tileSize/t.tileSize));return Math.max(0,a)}function gn(b,t){const a=b.getCameraFrustum(),d=b.getClippingPlane(),g=b.screenPointToMercatorCoordinate(b.getCameraPoint()),w=l.a9.fromLngLat(b.center,b.elevation);g.z=w.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;const P=b.getCoveringTilesDetailsProvider(),E=P.allowVariableZoom(b,t),k=mn(b,t),z=t.minzoom||0,N=t.maxzoom!==void 0?t.maxzoom:b.maxZoom,Z=Math.min(Math.max(0,k),N),q=Math.pow(2,Z),Y=[q*g.x,q*g.y,0],ne=[q*w.x,q*w.y,0],de=Math.hypot(w.x-g.x,w.y-g.y),pe=Math.abs(w.z-g.z),fe=Math.hypot(de,pe),me=Te=>({zoom:0,x:0,y:0,wrap:Te,fullyVisible:!1}),Se=[],ge=[];if(b.renderWorldCopies&&P.allowWorldCopies())for(let Te=1;Te<=3;Te++)Se.push(me(-Te)),Se.push(me(Te));for(Se.push(me(0));Se.length>0;){const Te=Se.pop(),Me=Te.x,be=Te.y;let ze=Te.fullyVisible;const Ke={x:Me,y:be,z:Te.zoom},Ve=P.getTileBoundingVolume(Ke,Te.wrap,b.elevation,t);if(!ze){const bt=xi(a,Ve,d);if(bt===0)continue;ze=bt===2}const Ge=P.distanceToTile2d(g.x,g.y,Ke,Ve);let qe=k;E&&(qe=(t.calculateTileZoom||hi)(b.zoom+l.at(b.tileSize/t.tileSize),Ge,pe,fe,b.fov)),qe=(t.roundZoom?Math.round:Math.floor)(qe),qe=Math.max(0,qe);const vt=Math.min(qe,N);if(Te.wrap=P.getWrap(w,Ke,Te.wrap),Te.zoom>=vt){if(Te.zoom<z)continue;const bt=Z-Te.zoom,ct=Y[0]-.5-(Me<<bt),kt=Y[1]-.5-(be<<bt),pr=t.reparseOverscaled?Math.max(Te.zoom,qe):Te.zoom;ge.push({tileID:new l.a2(Te.zoom===N?pr:Te.zoom,Te.wrap,Te.zoom,Me,be),distanceSq:l.au([ne[0]-.5-Me,ne[1]-.5-be]),tileDistanceToCamera:Math.sqrt(ct*ct+kt*kt)})}else for(let bt=0;bt<4;bt++)Se.push({zoom:Te.zoom+1,x:(Me<<1)+bt%2,y:(be<<1)+(bt>>1),wrap:Te.wrap,fullyVisible:ze})}return ge.sort(((Te,Me)=>Te.distanceSq-Me.distanceSq)).map((Te=>Te.tileID))}const tn=l.aa.fromPoints([new l.P(0,0),new l.P(l.a5,l.a5)]);function On(b){return b==="raster"||b==="image"||b==="video"}function ou(b,t,a,d,g,w,P){if(!t.hasData())return!1;const{tileID:E,fadingRole:k,fadingDirection:z,fadingParentID:N}=t;if(k===De.Base&&z===Ze.Incoming&&N)return a[N.key]=N,!0;const Z=Math.max(E.overscaledZ-g,w);for(let q=E.overscaledZ-1;q>=Z;q--){const Y=E.scaledTo(q),ne=b.getLoadedTile(Y);if(ne)return t.setCrossFadeLogic({fadingRole:De.Base,fadingDirection:Ze.Incoming,fadingParentID:ne.tileID,fadeEndTime:d+P}),ne.setCrossFadeLogic({fadingRole:De.Parent,fadingDirection:Ze.Departing,fadeEndTime:d+P}),a[Y.key]=Y,!0}return!1}function Jo(b,t,a,d,g,w){if(!t.hasData())return!1;const P=t.tileID.children(g);let E=yt(b,t,P,a,d,g,w);if(E)return!0;for(const k of P)yt(b,t,k.children(g),a,d,g,w)&&(E=!0);return E}function yt(b,t,a,d,g,w,P){if(a[0].overscaledZ>=w)return!1;let E=!1;for(const k of a){const z=b.getLoadedTile(k);if(!z)continue;const{fadingRole:N,fadingDirection:Z,fadingParentID:q}=z;N===De.Base&&Z===Ze.Departing&&q||(z.setCrossFadeLogic({fadingRole:De.Base,fadingDirection:Ze.Departing,fadingParentID:t.tileID,fadeEndTime:g+P}),t.setCrossFadeLogic({fadingRole:De.Parent,fadingDirection:Ze.Incoming,fadeEndTime:g+P})),d[k.key]=k,E=!0}return E}function bi(b,t,a,d){const g=b.tileID;return!!b.selfFading||!b.hasData()&&!!t.has(g)&&(b.setSelfFadeLogic(a+d),!0)}function Ri(b,t){var a;b.needsHillshadePrepare=!0,b.needsTerrainPrepare=!0;let d=t.tileID.canonical.x-b.tileID.canonical.x;const g=t.tileID.canonical.y-b.tileID.canonical.y,w=Math.pow(2,b.tileID.canonical.z),P=t.tileID.key;d===0&&g===0||Math.abs(g)>1||(Math.abs(d)>1&&(Math.abs(d+w)===1?d+=w:Math.abs(d-w)===1&&(d-=w)),t.dem&&b.dem&&(b.dem.backfillBorder(t.dem,d,g),!((a=b.neighboringTiles)===null||a===void 0)&&a[P]&&(b.neighboringTiles[P].backfilled=!0)))}class hh{constructor(){this._tiles={}}handleWrapJump(t){const a={};for(const d in this._tiles){const g=this._tiles[d];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+t),a[g.tileID.key]=g}this._tiles=a}setFeatureState(t,a){for(const d in this._tiles)this._tiles[d].setFeatureState(t,a)}getAllTiles(){return Object.values(this._tiles)}getAllIds(t=!1){return t?Object.values(this._tiles).map((a=>a.tileID)).sort(l.aw).map((a=>a.key)):Object.keys(this._tiles)}getTileById(t){return this._tiles[t]}setTile(t,a){this._tiles[t]=a}deleteTileById(t){delete this._tiles[t]}getLoadedTile(t){const a=this.getTileById(t.key);return a?.hasData()?a:null}isIdRenderable(t,a=!1){var d;return(d=this.getTileById(t))===null||d===void 0?void 0:d.isRenderable(a)}getRenderableIds(t=0,a){const d=[];for(const g of this.getAllIds())this.isIdRenderable(g,a)&&d.push(this.getTileById(g));return a?d.sort(((g,w)=>{const P=g.tileID,E=w.tileID,k=new l.P(P.canonical.x,P.canonical.y)._rotate(-t),z=new l.P(E.canonical.x,E.canonical.y)._rotate(-t);return P.overscaledZ-E.overscaledZ||z.y-k.y||z.x-k.x})).map((g=>g.tileID.key)):d.map((g=>g.tileID)).sort(l.aw).map((g=>g.key))}}class Ls extends l.E{constructor(t,a,d){super(),this.id=t,this.dispatcher=d,this.on("data",(g=>this._dataHandler(g))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((g,w,P,E)=>{const k=new(oe(w.type))(g,w,P,E);if(k.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${k.id}`);return k})(t,a,d,this),this._inViewTiles=new hh,this._outOfViewCache=new l.ax(0,(g=>this._unloadTile(g))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new st,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){for(const a of this._inViewTiles.getAllTiles())a.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t),this._inViewTiles=new hh}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,a,d){return l._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,a,d)}catch(g){t.state="errored",g.status!==404?this._source.fire(new l.k(g,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new l.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const a of this._inViewTiles.getAllTiles())a.upload(t),a.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(t){var a;return this._inViewTiles.getRenderableIds((a=this.transform)===null||a===void 0?void 0:a.bearingInRadians,t)}hasRenderableParent(t){const a=t.overscaledZ-1;if(a>=this._source.minzoom){const d=this.getLoadedTile(t.scaledTo(a));if(d)return this._inViewTiles.isIdRenderable(d.tileID.key)}return!1}reload(t,a=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const d of this._inViewTiles.getAllIds()){const g=this._inViewTiles.getTileById(d);a&&!this._source.shouldReloadTile(g,a)||(t?this._reloadTile(d,"expired"):g.state!=="errored"&&this._reloadTile(d,"reloading"))}}}_reloadTile(t,a){return l._(this,void 0,void 0,(function*(){const d=this._inViewTiles.getTileById(t);d&&(d.state!=="loading"&&(d.state=a),yield this._loadTile(d,t,a))}))}_tileLoaded(t,a,d){t.timeAdded=Q(),t.selfFading&&(t.fadeEndTime=t.timeAdded+this._rasterFadeDuration),d==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(a,t),this.getSource().type==="raster-dem"&&t.dem&&(function(g,w){var P,E;const k=w.getRenderableIds();for(const z of k){if(!g.neighboringTiles||!g.neighboringTiles[z])continue;const N=w.getTileById(z);g.neighboringTiles[z].backfilled||Ri(g,N),!((E=(P=N.neighboringTiles)===null||P===void 0?void 0:P[g.tileID.key])===null||E===void 0)&&E.backfilled||Ri(N,g)}})(t,this._inViewTiles),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new l.l("data",{dataType:"source",tile:t,coord:t.tileID}))}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._inViewTiles.getTileById(t)}_retainLoadedChildren(t,a){const d=this._getLoadedDescendents(a),g=new Set;for(const w of a){const P=d[w.key];if(!P?.length){g.add(w);continue}const E=w.overscaledZ+Ls.maxOverzooming,k=P.filter((Z=>Z.tileID.overscaledZ<=E));if(!k.length){g.add(w);continue}const z=Math.min(...k.map((Z=>Z.tileID.overscaledZ))),N=k.filter((Z=>Z.tileID.overscaledZ===z)).map((Z=>Z.tileID));for(const Z of N)t[Z.key]=Z;this._areDescendentsComplete(N,z,w.overscaledZ)||g.add(w)}return g}_getLoadedDescendents(t){var a;const d={};for(const g of this._inViewTiles.getAllTiles().filter((w=>w.hasData())))for(const w of t)g.tileID.isChildOf(w)&&(d[a=w.key]||(d[a]=[])).push(g);return d}_areDescendentsComplete(t,a,d){return t.length===1&&t[0].isOverscaled()?t[0].overscaledZ===a:Math.pow(4,a-d)===t.length}getLoadedTile(t){return this._inViewTiles.getLoadedTile(t)}updateCacheSize(t){const a=Math.ceil(t.width/this._source.tileSize)+1,d=Math.ceil(t.height/this._source.tileSize)+1,g=Math.floor(a*d*(this._maxTileCacheZoomLevels===null?l.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._outOfViewCache.setMaxSize(w)}handleWrapJump(t){const a=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);this._prevLng=t,a&&(this._inViewTiles.handleWrapJump(a),this._resetTileReloadTimers())}update(t,a){if(!this._sourceLoaded||this._paused)return;let d;this.transform=t,this.terrain=a,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?d=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((k=>new l.a2(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y))):(d=gn(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?t.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(d=d.filter((k=>this._source.hasTile(k))))):d=[],this.usedForTerrain&&(d=this._addTerrainIdealTiles(d));const g=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,g&&this.fire(new l.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const w=mn(t,this._source),P=this._updateRetainedTiles(d,w),E=On(this._source.type);E&&this._rasterFadeDuration>0&&!a&&(function(k,z,N,Z,q,Y,ne){const de=Q(),pe=l.av(z);for(const fe of z){const me=k.getTileById(fe.key);me.fadingDirection!==Ze.Departing&&me.fadeOpacity!==0||me.resetFadeLogic(),ou(k,me,N,de,Z,q,ne)||Jo(k,me,N,de,Y,ne)||bi(me,pe,de,ne)||me.resetFadeLogic()}})(this._inViewTiles,d,P,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),E?this._cleanUpRasterTiles(P):this._cleanUpVectorTiles(P)}_cleanUpRasterTiles(t){for(const a of this._inViewTiles.getAllIds())t[a]||this._removeTile(a)}_cleanUpVectorTiles(t){for(const a of this._inViewTiles.getAllIds()){const d=this._inViewTiles.getTileById(a);t[a]?d.clearSymbolFadeHold():d.hasSymbolBuckets?d.holdingForSymbolFade()?d.symbolFadeFinished()&&this._removeTile(a):d.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(a)}}_addTerrainIdealTiles(t){const a=[];for(const d of t)if(d.canonical.z>this._source.minzoom){const g=d.scaledTo(d.canonical.z-1);a.push(g);const w=d.scaledTo(Math.max(this._source.minzoom,Math.min(d.canonical.z,5)));a.push(w)}return t.concat(a)}releaseSymbolFadeTiles(){for(const t of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(t).holdingForSymbolFade()&&this._removeTile(t)}_updateRetainedTiles(t,a){var d;const g=new Set;for(const z of t)this._addTile(z).hasData()||g.add(z);const w=t.reduce(((z,N)=>(z[N.key]=N,z)),{}),P=this._retainLoadedChildren(w,g),E={},k=Math.max(a-Ls.maxUnderzooming,this._source.minzoom);for(const z of P){let N=this._inViewTiles.getTileById(z.key),Z=N?.wasRequested();for(let q=z.overscaledZ-1;q>=k;--q){const Y=z.scaledTo(q);if(E[Y.key])break;if(E[Y.key]=!0,N=this.getTile(Y),!N&&Z&&(N=this._addTile(Y)),N){const ne=N.hasData();if((ne||!(!((d=this.map)===null||d===void 0)&&d.cancelPendingTileRequestsWhileZooming)||Z)&&(w[Y.key]=Y),Z=N.wasRequested(),ne)break}}}return w}_addTile(t){let a=this._inViewTiles.getTileById(t.key);if(a)return a;a=this._outOfViewCache.getAndRemove(t),a&&(a.resetFadeLogic(),this._setTileReloadTimer(t.key,a),a.tileID=t,this._state.initializeTileState(a,this.map?this.map.painter:null));const d=a;return a||(a=new ut(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(a,t.key,a.state)),a.uses++,this._inViewTiles.setTile(t.key,a),d||this._source.fire(new l.l("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(t,a){this._clearTileReloadTimer(t);const d=a.getExpiryTimeout();d&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),d))}_clearTileReloadTimer(t){const a=this._timers[t];a&&(clearTimeout(a),delete this._timers[t])}_resetTileReloadTimers(){for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t of this._inViewTiles.getAllIds()){const a=this._inViewTiles.getTileById(t);this._setTileReloadTimer(t,a)}}refreshTiles(t){for(const a of this._inViewTiles.getAllIds()){const d=this._inViewTiles.getTileById(a);(this._inViewTiles.isIdRenderable(a)||d.state=="errored")&&t.some((g=>g.equals(d.tileID.canonical)))&&this._reloadTile(a,"expired")}}_removeTile(t){const a=this._inViewTiles.getTileById(t);a&&(a.uses--,this._inViewTiles.deleteTileById(t),this._clearTileReloadTimer(t),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._outOfViewCache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(t){t.dataType==="source"&&(t.sourceDataType!=="metadata"?t.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(t.sourceDataChanged,t.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t of this._inViewTiles.getAllIds())this._removeTile(t);this._outOfViewCache.reset()}tilesIn(t,a,d){const g=[],w=this.transform;if(!w)return g;const P=w.getCoveringTilesDetailsProvider().allowWorldCopies(),E=d?w.getCameraQueryGeometry(t):t,k=Y=>w.screenPointToMercatorCoordinate(Y,this.terrain),z=this.transformBbox(t,k,!P),N=this.transformBbox(E,k,!P),Z=this.getIds(),q=l.aa.fromPoints(N);for(let Y=0;Y<Z.length;Y++){const ne=this._inViewTiles.getTileById(Z[Y]);if(ne.holdingForSymbolFade())continue;const de=P?[ne.tileID]:[ne.tileID.unwrapTo(-1),ne.tileID.unwrapTo(0)],pe=Math.pow(2,w.zoom-ne.tileID.overscaledZ),fe=a*ne.queryPadding*l.a5/ne.tileSize/pe;for(const me of de){const Se=q.map((ge=>me.getTilePoint(new l.a9(ge.x,ge.y))));if(Se.expandBy(fe),Se.intersects(tn)){const ge=z.map((Me=>me.getTilePoint(Me))),Te=N.map((Me=>me.getTilePoint(Me)));g.push({tile:ne,tileID:P?me:me.unwrapTo(0),queryGeometry:ge,cameraQueryGeometry:Te,scale:pe})}}}return g}transformBbox(t,a,d){let g=t.map(a);if(d){const w=l.aa.fromPoints(t);w.shrinkBy(.001*Math.min(w.width(),w.height()));const P=w.map(a);l.aa.fromPoints(g).covers(P)||(g=g.map((E=>E.x>.5?new l.a9(E.x-1,E.y,E.z):E)))}return g}getVisibleCoordinates(t){const a=this.getRenderableIds(t).map((d=>this._inViewTiles.getTileById(d).tileID));return this.transform&&this.transform.populateCache(a),a}hasTransition(){return!!this._source.hasTransition()||!(!On(this._source.type)||!(function(t,a){if(a<=0)return!1;const d=Q();for(const g of t.getAllTiles())if(g.fadeEndTime>=d)return!0;return!1})(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(t){this._rasterFadeDuration=t}setFeatureState(t,a,d){this._state.updateState(t=t||l.ai,a,d)}removeFeatureState(t,a,d){this._state.removeFeatureState(t=t||l.ai,a,d)}getFeatureState(t,a){return this._state.getState(t=t||l.ai,a)}setDependencies(t,a,d){const g=this._inViewTiles.getTileById(t);g&&g.setDependencies(a,d)}reloadTilesForDependencies(t,a){for(const d of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(d).hasDependency(t,a)&&this._reloadTile(d,"reloading");this._outOfViewCache.filter((d=>!d.hasDependency(t,a)))}areTilesLoaded(){for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}}Ls.maxUnderzooming=10,Ls.maxOverzooming=3;class Lt{constructor(t,a){this.reset(t,a)}reset(t,a){this.points=t||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=l.an(t,0,1);let a=1,d=this._distances[a];const g=t*this.paddedLength+this.padding;for(;d<g&&a<this._distances.length;)d=this._distances[++a];const w=a-1,P=this._distances[w],E=d-P,k=E>0?(g-P)/E:0;return this.points[w].mult(1-k).add(this.points[a].mult(k))}}function _r(b,t){let a=!0;return b==="always"||b!=="never"&&t!=="never"||(a=!1),a}class Pr{constructor(t,a,d){const g=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(t/d),this.yCellCount=Math.ceil(a/d);for(let P=0;P<this.xCellCount*this.yCellCount;P++)g.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=a,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,a,d,g,w){this._forEachCell(a,d,g,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(a),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(w)}insertCircle(t,a,d,g){this._forEachCell(a-g,d-g,a+g,d+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(a),this.circles.push(d),this.circles.push(g)}_insertBoxCell(t,a,d,g,w,P){this.boxCells[w].push(P)}_insertCircleCell(t,a,d,g,w,P){this.circleCells[w].push(P)}_query(t,a,d,g,w,P,E){if(d<0||t>this.width||g<0||a>this.height)return[];const k=[];if(t<=0&&a<=0&&this.width<=d&&this.height<=g){if(w)return[{key:null,x1:t,y1:a,x2:d,y2:g}];for(let z=0;z<this.boxKeys.length;z++)k.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const N=this.circles[3*z],Z=this.circles[3*z+1],q=this.circles[3*z+2];k.push({key:this.circleKeys[z],x1:N-q,y1:Z-q,x2:N+q,y2:Z+q})}}else this._forEachCell(t,a,d,g,this._queryCell,k,{hitTest:w,overlapMode:P,seenUids:{box:{},circle:{}}},E);return k}query(t,a,d,g){return this._query(t,a,d,g,!1,null)}hitTest(t,a,d,g,w,P){return this._query(t,a,d,g,!0,w,P).length>0}hitTestCircle(t,a,d,g,w){const P=t-d,E=t+d,k=a-d,z=a+d;if(E<0||P>this.width||z<0||k>this.height)return!1;const N=[];return this._forEachCell(P,k,E,z,this._queryCellCircle,N,{hitTest:!0,overlapMode:g,circle:{x:t,y:a,radius:d},seenUids:{box:{},circle:{}}},w),N.length>0}_queryCell(t,a,d,g,w,P,E,k){const{seenUids:z,hitTest:N,overlapMode:Z}=E,q=this.boxCells[w];if(q!==null){const ne=this.bboxes;for(const de of q)if(!z.box[de]){z.box[de]=!0;const pe=4*de,fe=this.boxKeys[de];if(t<=ne[pe+2]&&a<=ne[pe+3]&&d>=ne[pe+0]&&g>=ne[pe+1]&&(!k||k(fe))&&(!N||!_r(Z,fe.overlapMode))&&(P.push({key:fe,x1:ne[pe],y1:ne[pe+1],x2:ne[pe+2],y2:ne[pe+3]}),N))return!0}}const Y=this.circleCells[w];if(Y!==null){const ne=this.circles;for(const de of Y)if(!z.circle[de]){z.circle[de]=!0;const pe=3*de,fe=this.circleKeys[de];if(this._circleAndRectCollide(ne[pe],ne[pe+1],ne[pe+2],t,a,d,g)&&(!k||k(fe))&&(!N||!_r(Z,fe.overlapMode))){const me=ne[pe],Se=ne[pe+1],ge=ne[pe+2];if(P.push({key:fe,x1:me-ge,y1:Se-ge,x2:me+ge,y2:Se+ge}),N)return!0}}}return!1}_queryCellCircle(t,a,d,g,w,P,E,k){const{circle:z,seenUids:N,overlapMode:Z}=E,q=this.boxCells[w];if(q!==null){const ne=this.bboxes;for(const de of q)if(!N.box[de]){N.box[de]=!0;const pe=4*de,fe=this.boxKeys[de];if(this._circleAndRectCollide(z.x,z.y,z.radius,ne[pe+0],ne[pe+1],ne[pe+2],ne[pe+3])&&(!k||k(fe))&&!_r(Z,fe.overlapMode))return P.push(!0),!0}}const Y=this.circleCells[w];if(Y!==null){const ne=this.circles;for(const de of Y)if(!N.circle[de]){N.circle[de]=!0;const pe=3*de,fe=this.circleKeys[de];if(this._circlesCollide(ne[pe],ne[pe+1],ne[pe+2],z.x,z.y,z.radius)&&(!k||k(fe))&&!_r(Z,fe.overlapMode))return P.push(!0),!0}}}_forEachCell(t,a,d,g,w,P,E,k){const z=this._convertToXCellCoord(t),N=this._convertToYCellCoord(a),Z=this._convertToXCellCoord(d),q=this._convertToYCellCoord(g);for(let Y=z;Y<=Z;Y++)for(let ne=N;ne<=q;ne++)if(w.call(this,t,a,d,g,this.xCellCount*ne+Y,P,E,k))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,a,d,g,w,P){const E=g-t,k=w-a,z=d+P;return z*z>E*E+k*k}_circleAndRectCollide(t,a,d,g,w,P,E){const k=(P-g)/2,z=Math.abs(t-(g+k));if(z>k+d)return!1;const N=(E-w)/2,Z=Math.abs(a-(w+N));if(Z>N+d)return!1;if(z<=k||Z<=N)return!0;const q=z-k,Y=Z-N;return q*q+Y*Y<=d*d}}function ds(b,t,a){const d=l.N();if(!b){const{vecSouth:Z,vecEast:q}=Io(t),Y=R();Y[0]=q[0],Y[1]=q[1],Y[2]=Z[0],Y[3]=Z[1],g=Y,(N=(P=(w=Y)[0])*(z=w[3])-(k=w[2])*(E=w[1]))&&(g[0]=z*(N=1/N),g[1]=-E*N,g[2]=-k*N,g[3]=P*N),d[0]=Y[0],d[1]=Y[1],d[4]=Y[2],d[5]=Y[3]}var g,w,P,E,k,z,N;return l.Q(d,d,[1/a,1/a,1]),d}function dh(b,t,a,d){if(b){const g=l.N();if(!t){const{vecSouth:w,vecEast:P}=Io(a);g[0]=P[0],g[1]=P[1],g[4]=w[0],g[5]=w[1]}return l.Q(g,g,[d,d,1]),g}return a.pixelsToClipSpaceMatrix}function Io(b){const t=Math.cos(b.rollInRadians),a=Math.sin(b.rollInRadians),d=Math.cos(b.pitchInRadians),g=Math.cos(b.bearingInRadians),w=Math.sin(b.bearingInRadians),P=l.aC();P[0]=-g*d*a-w*t,P[1]=-w*d*a+g*t;const E=l.aD(P);E<1e-9?l.aE(P):l.aF(P,P,1/E);const k=l.aC();k[0]=g*d*t-w*a,k[1]=w*d*t+g*a;const z=l.aD(k);return z<1e-9?l.aE(k):l.aF(k,k,1/z),{vecEast:k,vecSouth:P}}function vr(b,t,a,d){let g;d?(g=[b,t,d(b,t),1],l.aH(g,g,a)):(g=[b,t,0,1],mh(g,g,a));const w=g[3];return{point:new l.P(g[0]/w,g[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}function hc(b,t){return .5+b/t*.5}function dc(b,t){return b.x>=-t[0]&&b.x<=t[0]&&b.y>=-t[1]&&b.y<=t[1]}function fh(b,t,a,d,g,w,P,E,k,z,N,Z,q){const Y=a?b.textSizeData:b.iconSizeData,ne=l.ay(Y,t.transform.zoom),de=[256/t.width*2+1,256/t.height*2+1],pe=a?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;pe.clear();const fe=b.lineVertexArray,me=a?b.text.placedSymbolArray:b.icon.placedSymbolArray,Se=t.transform.width/t.transform.height;let ge=!1;for(let Te=0;Te<me.length;Te++){const Me=me.get(Te);if(Me.hidden||Me.writingMode===l.az.vertical&&!ge){ul(Me.numGlyphs,pe);continue}ge=!1;const be=new l.P(Me.anchorX,Me.anchorY),ze={getElevation:q,pitchedLabelPlaneMatrix:d,lineVertexArray:fe,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:be,unwrappedTileID:k,width:z,height:N,translation:Z},Ke=cl(Me.anchorX,Me.anchorY,ze);if(!dc(Ke.point,de)){ul(Me.numGlyphs,pe);continue}const Ve=hc(t.transform.cameraToCenterDistance,Ke.signedDistanceFromCamera),Ge=l.aA(Y,ne,Me),qe=w?Ge*t.transform.getPitchedTextCorrection(Me.anchorX,Me.anchorY,k)/Ve:Ge*Ve,vt=pc({projectionContext:ze,pitchedLabelPlaneMatrixInverse:g,symbol:Me,fontSize:qe,flip:!1,keepUpright:P,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:pe,aspectRatio:Se,rotateToLine:E});ge=vt.useVertical,(vt.notEnoughRoom||ge||vt.needsFlipping&&pc({projectionContext:ze,pitchedLabelPlaneMatrixInverse:g,symbol:Me,fontSize:qe,flip:!0,keepUpright:P,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:pe,aspectRatio:Se,rotateToLine:E}).notEnoughRoom)&&ul(Me.numGlyphs,pe)}a?b.text.dynamicLayoutVertexBuffer.updateData(pe):b.icon.dynamicLayoutVertexBuffer.updateData(pe)}function fc(b,t,a,d,g,w,P,E){const k=w.glyphStartIndex+w.numGlyphs,z=w.lineStartIndex,N=w.lineStartIndex+w.lineLength,Z=t.getoffsetX(w.glyphStartIndex),q=t.getoffsetX(k-1),Y=so(b*Z,a,d,g,w.segment,z,N,E,P);if(!Y)return null;const ne=so(b*q,a,d,g,w.segment,z,N,E,P);return ne?E.projectionCache.anyProjectionOccluded?null:{first:Y,last:ne}:null}function Mn(b,t,a,d){return b===l.az.horizontal&&Math.abs(a.y-t.y)>Math.abs(a.x-t.x)*d?{useVertical:!0}:(b===l.az.vertical?t.y<a.y:t.x>a.x)?{needsFlipping:!0}:null}function pc(b){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:a,symbol:d,fontSize:g,flip:w,keepUpright:P,glyphOffsetArray:E,dynamicLayoutVertexArray:k,aspectRatio:z,rotateToLine:N}=b,Z=g/24,q=d.lineOffsetX*Z,Y=d.lineOffsetY*Z;let ne;if(d.numGlyphs>1){const de=d.glyphStartIndex+d.numGlyphs,pe=d.lineStartIndex,fe=d.lineStartIndex+d.lineLength,me=fc(Z,E,q,Y,w,d,N,t);if(!me)return{notEnoughRoom:!0};const Se=ph(me.first.point.x,me.first.point.y,t,a),ge=ph(me.last.point.x,me.last.point.y,t,a);if(P&&!w){const Te=Mn(d.writingMode,Se,ge,z);if(Te)return Te}ne=[me.first];for(let Te=d.glyphStartIndex+1;Te<de-1;Te++){const Me=so(Z*E.getoffsetX(Te),q,Y,w,d.segment,pe,fe,t,N);if(!Me)return{notEnoughRoom:!0};ne.push(Me)}ne.push(me.last)}else{if(P&&!w){const pe=qr(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,fe=d.lineStartIndex+d.segment+1,me=new l.P(t.lineVertexArray.getx(fe),t.lineVertexArray.gety(fe)),Se=qr(me.x,me.y,t),ge=Se.signedDistanceFromCamera>0?Se.point:ll(t.tileAnchorPoint,me,pe,1,t),Te=ph(pe.x,pe.y,t,a),Me=ph(ge.x,ge.y,t,a),be=Mn(d.writingMode,Te,Me,z);if(be)return be}const de=so(Z*E.getoffsetX(d.glyphStartIndex),q,Y,w,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,t,N);if(!de||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ne=[de]}for(const de of ne)l.aG(k,de.point,de.angle);return{}}function ll(b,t,a,d,g){const w=b.add(b.sub(t)._unit()),P=qr(w.x,w.y,g).point,E=a.sub(P);return a.add(E._mult(d/E.mag()))}function Bi(b,t,a){const d=t.projectionCache;if(d.projections[b])return d.projections[b];const g=new l.P(t.lineVertexArray.getx(b),t.lineVertexArray.gety(b)),w=qr(g.x,g.y,t);if(w.signedDistanceFromCamera>0)return d.projections[b]=w.point,d.anyProjectionOccluded=d.anyProjectionOccluded||w.isOccluded,w.point;const P=b-a.direction;return ll(a.distanceFromAnchor===0?t.tileAnchorPoint:new l.P(t.lineVertexArray.getx(P),t.lineVertexArray.gety(P)),g,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,t)}function qr(b,t,a){const d=b+a.translation[0],g=t+a.translation[1];let w;return a.pitchWithMap?(w=vr(d,g,a.pitchedLabelPlaneMatrix,a.getElevation),w.isOccluded=!1):(w=a.transform.projectTileCoordinates(d,g,a.unwrappedTileID,a.getElevation),w.point.x=(.5*w.point.x+.5)*a.width,w.point.y=(.5*-w.point.y+.5)*a.height),w}function ph(b,t,a,d){if(a.pitchWithMap){const g=[b,t,0,1];return l.aH(g,g,d),a.transform.projectTileCoordinates(g[0]/g[3],g[1]/g[3],a.unwrappedTileID,a.getElevation).point}return{x:b/a.width*2-1,y:1-t/a.height*2}}function cl(b,t,a){return a.transform.projectTileCoordinates(b,t,a.unwrappedTileID,a.getElevation)}function Aa(b,t,a){return b._unit()._perp()._mult(t*a)}function Vi(b,t,a,d,g,w,P,E,k){if(E.projectionCache.offsets[b])return E.projectionCache.offsets[b];const z=a.add(t);if(b+k.direction<d||b+k.direction>=g)return E.projectionCache.offsets[b]=z,z;const N=Bi(b+k.direction,E,k),Z=Aa(N.sub(a),P,k.direction),q=a.add(Z),Y=N.add(Z);return E.projectionCache.offsets[b]=l.aI(w,z,q,Y)||z,E.projectionCache.offsets[b]}function so(b,t,a,d,g,w,P,E,k){const z=d?b-t:b+t;let N=z>0?1:-1,Z=0;d&&(N*=-1,Z=Math.PI),N<0&&(Z+=Math.PI);let q,Y=N>0?w+g:w+g+1;E.projectionCache.cachedAnchorPoint?q=E.projectionCache.cachedAnchorPoint:(q=qr(E.tileAnchorPoint.x,E.tileAnchorPoint.y,E).point,E.projectionCache.cachedAnchorPoint=q);let ne,de,pe=q,fe=q,me=0,Se=0;const ge=Math.abs(z),Te=[];let Me;for(;me+Se<=ge;){if(Y+=N,Y<w||Y>=P)return null;me+=Se,fe=pe,de=ne;const Ke={absOffsetX:ge,direction:N,distanceFromAnchor:me,previousVertex:fe};if(pe=Bi(Y,E,Ke),a===0)Te.push(fe),Me=pe.sub(fe);else{let Ve;const Ge=pe.sub(fe);Ve=Ge.mag()===0?Aa(Bi(Y+N,E,Ke).sub(pe),a,N):Aa(Ge,a,N),de||(de=fe.add(Ve)),ne=Vi(Y,Ve,pe,w,P,de,a,E,Ke),Te.push(de),Me=ne.sub(de)}Se=Me.mag()}const be=Me._mult((ge-me)/Se)._add(de||fe),ze=Z+Math.atan2(pe.y-fe.y,pe.x-fe.x);return Te.push(be),{point:be,angle:k?ze:0,path:Te}}const zs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ul(b,t){for(let a=0;a<b;a++){const d=t.length;t.resize(d+4),t.float32.set(zs,3*d)}}function mh(b,t,a){const d=t[0],g=t[1];return b[0]=a[0]*d+a[4]*g+a[12],b[1]=a[1]*d+a[5]*g+a[13],b[3]=a[3]*d+a[7]*g+a[15],b}const Vn=100;class au{constructor(t,a=new Pr(t.width+200,t.height+200,25),d=new Pr(t.width+200,t.height+200,25)){this.transform=t,this.grid=a,this.ignoredGrid=d,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Vn,this.screenBottomBoundary=t.height+Vn,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,a,d,g,w,P,E,k,z,N,Z,q){const Y=this.projectAndGetPerspectiveRatio(t.anchorPointX+k[0],t.anchorPointY+k[1],w,N,q),ne=d*Y.perspectiveRatio;let de;if(P||E)de=this._projectCollisionBox(t,ne,g,w,P,E,k,Y,N,Z,q);else{const Me=Y.x+(Z?Z.x*ne:0),be=Y.y+(Z?Z.y*ne:0);de={allPointsOccluded:!1,box:[Me+t.x1*ne,be+t.y1*ne,Me+t.x2*ne,be+t.y2*ne]}}const[pe,fe,me,Se]=de.box,ge=P?de.allPointsOccluded:Y.isOccluded;let Te=ge;return Te||(Te=Y.perspectiveRatio<this.perspectiveRatioCutoff),Te||(Te=!this.isInsideGrid(pe,fe,me,Se)),Te||a!=="always"&&this.grid.hitTest(pe,fe,me,Se,a,z)?{box:[pe,fe,me,Se],placeable:!1,offscreen:!1,occluded:ge}:{box:[pe,fe,me,Se],placeable:!0,offscreen:this.isOffscreen(pe,fe,me,Se),occluded:ge}}placeCollisionCircles(t,a,d,g,w,P,E,k,z,N,Z,q,Y,ne){const de=[],pe=new l.P(a.anchorX,a.anchorY),fe=this.getPerspectiveRatio(pe.x,pe.y,P,ne),me=(z?w*this.transform.getPitchedTextCorrection(a.anchorX,a.anchorY,P)/fe:w*fe)/l.aM,Se={getElevation:ne,pitchedLabelPlaneMatrix:E,lineVertexArray:d,pitchWithMap:z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:pe,unwrappedTileID:P,width:this.transform.width,height:this.transform.height,translation:Y},ge=fc(me,g,a.lineOffsetX*me,a.lineOffsetY*me,!1,a,!1,Se);let Te=!1,Me=!1,be=!0;if(ge){const ze=.5*Z*fe+q,Ke=new l.P(-100,-100),Ve=new l.P(this.screenRightBoundary,this.screenBottomBoundary),Ge=new Lt,qe=ge.first,vt=ge.last;let bt=[];for(let pr=qe.path.length-1;pr>=1;pr--)bt.push(qe.path[pr]);for(let pr=1;pr<vt.path.length;pr++)bt.push(vt.path[pr]);const ct=2.5*ze;if(z){const pr=this.projectPathToScreenSpace(bt,Se);bt=pr.some((Qr=>Qr.signedDistanceFromCamera<=0))?[]:pr.map((Qr=>Qr.point))}let kt=[];if(bt.length>0){const pr=bt[0].clone(),Qr=bt[0].clone();for(let Sn=1;Sn<bt.length;Sn++)pr.x=Math.min(pr.x,bt[Sn].x),pr.y=Math.min(pr.y,bt[Sn].y),Qr.x=Math.max(Qr.x,bt[Sn].x),Qr.y=Math.max(Qr.y,bt[Sn].y);kt=pr.x>=Ke.x&&Qr.x<=Ve.x&&pr.y>=Ke.y&&Qr.y<=Ve.y?[bt]:Qr.x<Ke.x||pr.x>Ve.x||Qr.y<Ke.y||pr.y>Ve.y?[]:l.aJ([bt],Ke.x,Ke.y,Ve.x,Ve.y)}for(const pr of kt){Ge.reset(pr,.25*ze);let Qr=0;Qr=Ge.length<=.5*ze?1:Math.ceil(Ge.paddedLength/ct)+1;for(let Sn=0;Sn<Qr;Sn++){const cn=Sn/Math.max(Qr-1,1),Pn=Ge.lerp(cn),un=Pn.x+Vn,Cn=Pn.y+Vn;de.push(un,Cn,ze,0);const Dn=un-ze,Ei=Cn-ze,Kn=un+ze,Hr=Cn+ze;if(be=be&&this.isOffscreen(Dn,Ei,Kn,Hr),Me=Me||this.isInsideGrid(Dn,Ei,Kn,Hr),t!=="always"&&this.grid.hitTestCircle(un,Cn,ze,t,N)&&(Te=!0,!k))return{circles:[],offscreen:!1,collisionDetected:Te}}}}return{circles:!k&&Te||!Me||fe<this.perspectiveRatioCutoff?[]:de,offscreen:be,collisionDetected:Te}}projectPathToScreenSpace(t,a){const d=(function(g,w){const P=l.N();return l.aB(P,w.pitchedLabelPlaneMatrix),g.map((E=>{const k=vr(E.x,E.y,P,w.getElevation),z=w.transform.projectTileCoordinates(k.point.x,k.point.y,w.unwrappedTileID,w.getElevation);return z.point.x=(.5*z.point.x+.5)*w.width,z.point.y=(.5*-z.point.y+.5)*w.height,z}))})(t,a);return(function(g){let w=0,P=0,E=0,k=0;for(let z=0;z<g.length;z++)g[z].isOccluded?(E=z+1,k=0):(k++,k>P&&(P=k,w=E));return g.slice(w,w+P)})(d)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[],d=new l.aa;for(const Z of t){const q=new l.P(Z.x+Vn,Z.y+Vn);d.extend(q),a.push(q)}const{minX:g,minY:w,maxX:P,maxY:E}=d,k=this.grid.query(g,w,P,E).concat(this.ignoredGrid.query(g,w,P,E)),z={},N={};for(const Z of k){const q=Z.key;if(z[q.bucketInstanceId]===void 0&&(z[q.bucketInstanceId]={}),z[q.bucketInstanceId][q.featureIndex])continue;const Y=[new l.P(Z.x1,Z.y1),new l.P(Z.x2,Z.y1),new l.P(Z.x2,Z.y2),new l.P(Z.x1,Z.y2)];l.aK(a,Y)&&(z[q.bucketInstanceId][q.featureIndex]=!0,N[q.bucketInstanceId]===void 0&&(N[q.bucketInstanceId]=[]),N[q.bucketInstanceId].push(q.featureIndex))}return N}insertCollisionBox(t,a,d,g,w,P){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:w,collisionGroupID:P,overlapMode:a},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,a,d,g,w,P){const E=d?this.ignoredGrid:this.grid,k={bucketInstanceId:g,featureIndex:w,collisionGroupID:P,overlapMode:a};for(let z=0;z<t.length;z+=4)E.insertCircle(k,t[z],t[z+1],t[z+2])}projectAndGetPerspectiveRatio(t,a,d,g,w){if(w){let P;g?(P=[t,a,g(t,a),1],l.aH(P,P,w)):(P=[t,a,0,1],mh(P,P,w));const E=P[3];return{x:(P[0]/E+1)/2*this.transform.width+Vn,y:(-P[1]/E+1)/2*this.transform.height+Vn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E*.5,isOccluded:!1,signedDistanceFromCamera:E}}{const P=this.transform.projectTileCoordinates(t,a,d,g);return{x:(P.point.x+1)/2*this.transform.width+Vn,y:(1-P.point.y)/2*this.transform.height+Vn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/P.signedDistanceFromCamera*.5,isOccluded:P.isOccluded,signedDistanceFromCamera:P.signedDistanceFromCamera}}}getPerspectiveRatio(t,a,d,g){const w=this.transform.projectTileCoordinates(t,a,d,g);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(t,a,d,g){return d<Vn||t>=this.screenRightBoundary||g<Vn||a>this.screenBottomBoundary}isInsideGrid(t,a,d,g){return d>=0&&t<this.gridRightBoundary&&g>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const t=l.ar([]);return l.O(t,t,[-100,-100,0]),t}_projectCollisionBox(t,a,d,g,w,P,E,k,z,N,Z){let q=1,Y=0,ne=0,de=1;const pe=t.anchorPointX+E[0],fe=t.anchorPointY+E[1];if(P&&!w){const bt=this.projectAndGetPerspectiveRatio(pe+1,fe,g,z,Z),ct=bt.x-k.x,kt=Math.atan((bt.y-k.y)/ct)+(ct<0?Math.PI:0),pr=Math.sin(kt),Qr=Math.cos(kt);q=Qr,Y=pr,ne=-pr,de=Qr}else if(!P&&w){const bt=Io(this.transform);q=bt.vecEast[0],Y=bt.vecEast[1],ne=bt.vecSouth[0],de=bt.vecSouth[1]}let me=k.x,Se=k.y,ge=a;w&&(me=pe,Se=fe,ge=Math.pow(2,-(this.transform.zoom-d.overscaledZ)),ge*=this.transform.getPitchedTextCorrection(pe,fe,g),N||(ge*=l.an(.5+k.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),N&&(me+=q*N.x*ge+ne*N.y*ge,Se+=Y*N.x*ge+de*N.y*ge);const Te=t.x1*ge,Me=t.x2*ge,be=(Te+Me)/2,ze=t.y1*ge,Ke=t.y2*ge,Ve=(ze+Ke)/2,Ge=[{offsetX:Te,offsetY:ze},{offsetX:be,offsetY:ze},{offsetX:Me,offsetY:ze},{offsetX:Me,offsetY:Ve},{offsetX:Me,offsetY:Ke},{offsetX:be,offsetY:Ke},{offsetX:Te,offsetY:Ke},{offsetX:Te,offsetY:Ve}];let qe=[];for(const{offsetX:bt,offsetY:ct}of Ge)qe.push(new l.P(me+q*bt+ne*ct,Se+Y*bt+de*ct));let vt=!1;if(w){const bt=qe.map((ct=>this.projectAndGetPerspectiveRatio(ct.x,ct.y,g,z,Z)));vt=bt.some((ct=>!ct.isOccluded)),qe=bt.map((ct=>new l.P(ct.x,ct.y)))}else vt=!0;return{box:l.aL(qe),allPointsOccluded:!vt}}}class lu{constructor(t,a,d,g){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?a:-a))):g&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class ea{constructor(t,a,d,g,w){this.text=new lu(t?t.text:null,a,d,w),this.icon=new lu(t?t.icon:null,a,g,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class cu{constructor(t,a,d){this.text=t,this.icon=a,this.skipFade=d}}class tp{constructor(t,a,d,g,w){this.bucketInstanceId=t,this.featureIndex=a,this.sourceLayerIndex=d,this.bucketIndex=g,this.tileID=w}}class rp{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const a=++this.maxGroupID;this.collisionGroups[t]={ID:a,predicate:d=>d.collisionGroupID===a}}return this.collisionGroups[t]}}function mc(b,t,a,d,g){const{horizontalAlign:w,verticalAlign:P}=l.aS(b);return new l.P(-(w-.5)*t+d[0]*g,-(P-.5)*a+d[1]*g)}class gh{constructor(t,a,d,g,w){this.transform=t.clone(),this.terrain=a,this.collisionIndex=new au(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new rp(g),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const a=this.terrain;return a?(d,g)=>a.getElevation(t,d,g):null}getBucketParts(t,a,d,g){const w=d.getBucket(a),P=d.latestFeatureIndex;if(!w||!P||a.id!==w.layerIds[0])return;const E=d.collisionBoxArray,k=w.layers[0].layout,z=w.layers[0].paint,N=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),Z=d.tileSize/l.a5,q=d.tileID.toUnwrapped(),Y=k.get("text-rotation-alignment")==="map",ne=l.aN(d,1,this.transform.zoom),de=l.aO(this.collisionIndex.transform,d,z.get("text-translate"),z.get("text-translate-anchor")),pe=l.aO(this.collisionIndex.transform,d,z.get("icon-translate"),z.get("icon-translate-anchor")),fe=ds(Y,this.transform,ne);this.retainedQueryData[w.bucketInstanceId]=new tp(w.bucketInstanceId,P,w.sourceLayerIndex,w.index,d.tileID);const me={bucket:w,layout:k,translationText:de,translationIcon:pe,unwrappedTileID:q,pitchedLabelPlaneMatrix:fe,scale:N,textPixelRatio:Z,holdingForFade:d.holdingForSymbolFade(),collisionBoxArray:E,partiallyEvaluatedTextSize:l.ay(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(g)for(const Se of w.sortKeyRanges){const{sortKey:ge,symbolInstanceStart:Te,symbolInstanceEnd:Me}=Se;t.push({sortKey:ge,symbolInstanceStart:Te,symbolInstanceEnd:Me,parameters:me})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:me})}attemptAnchorPlacement(t,a,d,g,w,P,E,k,z,N,Z,q,Y,ne,de,pe,fe,me,Se,ge){const Te=l.aP[t.textAnchor],Me=[t.textOffset0,t.textOffset1],be=mc(Te,d,g,Me,w),ze=this.collisionIndex.placeCollisionBox(a,q,k,z,N,E,P,pe,Z.predicate,Se,be,ge);if((!me||this.collisionIndex.placeCollisionBox(me,q,k,z,N,E,P,fe,Z.predicate,Se,be,ge).placeable)&&ze.placeable){let Ke;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID].text&&(Ke=this.prevPlacement.variableOffsets[Y.crossTileID].anchor),Y.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Y.crossTileID]={textOffset:Me,width:d,height:g,anchor:Te,textBoxScale:w,prevAnchor:Ke},this.markUsedJustification(ne,Te,Y,de),ne.allowVerticalPlacement&&(this.markUsedOrientation(ne,de,Y),this.placedOrientations[Y.crossTileID]=de),{shift:be,placedGlyphBoxes:ze}}}placeLayerBucketPart(t,a,d){const{bucket:g,layout:w,translationText:P,translationIcon:E,unwrappedTileID:k,pitchedLabelPlaneMatrix:z,textPixelRatio:N,holdingForFade:Z,collisionBoxArray:q,partiallyEvaluatedTextSize:Y,collisionGroup:ne}=t.parameters,de=w.get("text-optional"),pe=w.get("icon-optional"),fe=l.aQ(w,"text-overlap","text-allow-overlap"),me=fe==="always",Se=l.aQ(w,"icon-overlap","icon-allow-overlap"),ge=Se==="always",Te=w.get("text-rotation-alignment")==="map",Me=w.get("text-pitch-alignment")==="map",be=w.get("icon-text-fit")!=="none",ze=w.get("symbol-z-order")==="viewport-y",Ke=me&&(ge||!g.hasIconData()||pe),Ve=ge&&(me||!g.hasTextData()||de);!g.collisionArrays&&q&&g.deserializeCollisionBoxes(q);const Ge=this.retainedQueryData[g.bucketInstanceId].tileID,qe=this._getTerrainElevationFunc(Ge),vt=this.transform.getFastPathSimpleProjectionMatrix(Ge),bt=(ct,kt,pr)=>{var Qr,Sn;if(a[ct.crossTileID])return;if(Z)return void(this.placements[ct.crossTileID]=new cu(!1,!1,!1));let cn=!1,Pn=!1,un=!0,Cn=null,Dn={box:null,placeable:!1,offscreen:null,occluded:!1},Ei={placeable:!1},Kn=null,Hr=null,fi=null,_o=0,Vo=0,vo=0;kt.textFeatureIndex?_o=kt.textFeatureIndex:ct.useRuntimeCollisionCircles&&(_o=ct.featureIndex),kt.verticalTextFeatureIndex&&(Vo=kt.verticalTextFeatureIndex);const os=kt.textBox;if(os){const vs=pn=>{let hn=l.az.horizontal;if(g.allowVerticalPlacement&&!pn&&this.prevPlacement){const li=this.prevPlacement.placedOrientations[ct.crossTileID];li&&(this.placedOrientations[ct.crossTileID]=li,hn=li,this.markUsedOrientation(g,hn,ct))}return hn},$o=(pn,hn)=>{if(g.allowVerticalPlacement&&ct.numVerticalGlyphVertices>0&&kt.verticalTextBox){for(const li of g.writingModes)if(li===l.az.vertical?(Dn=hn(),Ei=Dn):Dn=pn(),Dn&&Dn.placeable)break}else Dn=pn()},Zs=ct.textAnchorOffsetStartIndex,Ws=ct.textAnchorOffsetEndIndex;if(Ws===Zs){const pn=(hn,li)=>{const pi=this.collisionIndex.placeCollisionBox(hn,fe,N,Ge,k,Me,Te,P,ne.predicate,qe,void 0,vt);return pi&&pi.placeable&&(this.markUsedOrientation(g,li,ct),this.placedOrientations[ct.crossTileID]=li),pi};$o((()=>pn(os,l.az.horizontal)),(()=>{const hn=kt.verticalTextBox;return g.allowVerticalPlacement&&ct.numVerticalGlyphVertices>0&&hn?pn(hn,l.az.vertical):{box:null,offscreen:null}})),vs(Dn&&Dn.placeable)}else{let pn=l.aP[(Sn=(Qr=this.prevPlacement)===null||Qr===void 0?void 0:Qr.variableOffsets[ct.crossTileID])===null||Sn===void 0?void 0:Sn.anchor];const hn=(pi,as,Gi)=>{const el=pi.x2-pi.x1,mp=pi.y2-pi.y1,hf=ct.textBoxScale,Qh=be&&Se==="never"?as:null;let da=null,Go=fe==="never"?1:2,fa="never";pn&&Go++;for(let Bu=0;Bu<Go;Bu++){for(let Jh=Zs;Jh<Ws;Jh++){const Vu=g.textAnchorOffsets.get(Jh);if(pn&&Vu.textAnchor!==pn)continue;const Fc=this.attemptAnchorPlacement(Vu,pi,el,mp,hf,Te,Me,N,Ge,k,ne,fa,ct,g,Gi,P,E,Qh,qe);if(Fc&&(da=Fc.placedGlyphBoxes,da&&da.placeable))return cn=!0,Cn=Fc.shift,da}pn?pn=null:fa=fe}return d&&!da&&(da={box:this.collisionIndex.placeCollisionBox(os,"always",N,Ge,k,Me,Te,P,ne.predicate,qe,void 0,vt).box,offscreen:!1,placeable:!1,occluded:!1}),da};$o((()=>hn(os,kt.iconBox,l.az.horizontal)),(()=>{const pi=kt.verticalTextBox;return g.allowVerticalPlacement&&(!Dn||!Dn.placeable)&&ct.numVerticalGlyphVertices>0&&pi?hn(pi,kt.verticalIconBox,l.az.vertical):{box:null,occluded:!0,offscreen:null}})),Dn&&(cn=Dn.placeable,un=Dn.offscreen);const li=vs(Dn&&Dn.placeable);if(!cn&&this.prevPlacement){const pi=this.prevPlacement.variableOffsets[ct.crossTileID];pi&&(this.variableOffsets[ct.crossTileID]=pi,this.markUsedJustification(g,pi.anchor,ct,li))}}}if(Kn=Dn,cn=Kn&&Kn.placeable,un=Kn&&Kn.offscreen,ct.useRuntimeCollisionCircles&&ct.centerJustifiedTextSymbolIndex>=0){const vs=g.text.placedSymbolArray.get(ct.centerJustifiedTextSymbolIndex),$o=l.aA(g.textSizeData,Y,vs),Zs=w.get("text-padding");Hr=this.collisionIndex.placeCollisionCircles(fe,vs,g.lineVertexArray,g.glyphOffsetArray,$o,k,z,d,Me,ne.predicate,ct.collisionCircleDiameter,Zs,P,qe),Hr.circles.length&&Hr.collisionDetected&&!d&&l.w("Collisions detected, but collision boxes are not shown"),cn=me||Hr.circles.length>0&&!Hr.collisionDetected,un=un&&Hr.offscreen}if(kt.iconFeatureIndex&&(vo=kt.iconFeatureIndex),kt.iconBox){const vs=$o=>this.collisionIndex.placeCollisionBox($o,Se,N,Ge,k,Me,Te,E,ne.predicate,qe,be&&Cn?Cn:void 0,vt);Ei&&Ei.placeable&&kt.verticalIconBox?(fi=vs(kt.verticalIconBox),Pn=fi.placeable):(fi=vs(kt.iconBox),Pn=fi.placeable),un=un&&fi.offscreen}const ua=de||ct.numHorizontalGlyphVertices===0&&ct.numVerticalGlyphVertices===0,Uo=pe||ct.numIconVertices===0;ua||Uo?Uo?ua||(Pn=Pn&&cn):cn=Pn&&cn:Pn=cn=Pn&&cn;const ha=Pn&&fi.placeable;if(cn&&Kn.placeable&&this.collisionIndex.insertCollisionBox(Kn.box,fe,w.get("text-ignore-placement"),g.bucketInstanceId,Ei&&Ei.placeable&&Vo?Vo:_o,ne.ID),ha&&this.collisionIndex.insertCollisionBox(fi.box,Se,w.get("icon-ignore-placement"),g.bucketInstanceId,vo,ne.ID),Hr&&cn&&this.collisionIndex.insertCollisionCircles(Hr.circles,fe,w.get("text-ignore-placement"),g.bucketInstanceId,_o,ne.ID),d&&this.storeCollisionData(g.bucketInstanceId,pr,kt,Kn,fi,Hr),ct.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(g.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ct.crossTileID]=new cu((cn||Ke)&&!Kn?.occluded,(Pn||Ve)&&!fi?.occluded,un||g.justReloaded),a[ct.crossTileID]=!0};if(ze){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ct=g.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let kt=ct.length-1;kt>=0;--kt){const pr=ct[kt];bt(g.symbolInstances.get(pr),g.collisionArrays[pr],pr)}}else for(let ct=t.symbolInstanceStart;ct<t.symbolInstanceEnd;ct++)bt(g.symbolInstances.get(ct),g.collisionArrays[ct],ct);g.justReloaded=!1}storeCollisionData(t,a,d,g,w,P){if(d.textBox||d.iconBox){let E,k;this.collisionBoxArrays.has(t)?E=this.collisionBoxArrays.get(t):(E=new Map,this.collisionBoxArrays.set(t,E)),E.has(a)?k=E.get(a):(k={text:null,icon:null},E.set(a,k)),d.textBox&&(k.text=g.box),d.iconBox&&(k.icon=w.box)}if(P){let E=this.collisionCircleArrays[t];E===void 0&&(E=this.collisionCircleArrays[t]=[]);for(let k=0;k<P.circles.length;k+=4)E.push(P.circles[k+0]-Vn),E.push(P.circles[k+1]-Vn),E.push(P.circles[k+2]),E.push(P.collisionDetected?1:0)}}markUsedJustification(t,a,d,g){let w;w=g===l.az.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[l.aR(a)];const P=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const E of P)E>=0&&(t.text.placedSymbolArray.get(E).crossTileID=w>=0&&E!==w?0:d.crossTileID)}markUsedOrientation(t,a,d){const g=a===l.az.horizontal||a===l.az.horizontalOnly?a:0,w=a===l.az.vertical?a:0,P=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const E of P)t.text.placedSymbolArray.get(E).placedOrientation=g;d.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let d=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const g=a?a.symbolFadeChange(t):1,w=a?a.opacities:{},P=a?a.variableOffsets:{},E=a?a.placedOrientations:{};for(const k in this.placements){const z=this.placements[k],N=w[k];N?(this.opacities[k]=new ea(N,g,z.text,z.icon),d=d||z.text!==N.text.placed||z.icon!==N.icon.placed):(this.opacities[k]=new ea(null,g,z.text,z.icon,z.skipFade),d=d||z.text||z.icon)}for(const k in w){const z=w[k];if(!this.opacities[k]){const N=new ea(z,g,!1,!1);N.isHidden()||(this.opacities[k]=N,d=d||z.text.placed||z.icon.placed)}}for(const k in P)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=P[k]);for(const k in E)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=E[k]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:t)}updateLayerOpacities(t,a){const d={};for(const g of a){const w=g.getBucket(t);w&&g.latestFeatureIndex&&t.id===w.layerIds[0]&&this.updateBucketOpacities(w,g.tileID,d,g.collisionBoxArray)}}updateBucketOpacities(t,a,d,g){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const w=t.layers[0],P=w.layout,E=new ea(null,0,!1,!1,!0),k=P.get("text-allow-overlap"),z=P.get("icon-allow-overlap"),N=w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Z=P.get("text-rotation-alignment")==="map",q=P.get("text-pitch-alignment")==="map",Y=P.get("icon-text-fit")!=="none",ne=new ea(null,0,k&&(z||!t.hasIconData()||P.get("icon-optional")),z&&(k||!t.hasTextData()||P.get("text-optional")),!0);!t.collisionArrays&&g&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(g);const de=(fe,me,Se)=>{for(let ge=0;ge<me/4;ge++)fe.opacityVertexArray.emplaceBack(Se);fe.hasVisibleVertices=fe.hasVisibleVertices||Se!==gc},pe=this.collisionBoxArrays.get(t.bucketInstanceId);for(let fe=0;fe<t.symbolInstances.length;fe++){const me=t.symbolInstances.get(fe),{numHorizontalGlyphVertices:Se,numVerticalGlyphVertices:ge,crossTileID:Te}=me;let Me=this.opacities[Te];d[Te]?Me=E:Me||(Me=ne,this.opacities[Te]=Me),d[Te]=!0;const be=me.numIconVertices>0,ze=this.placedOrientations[me.crossTileID],Ke=ze===l.az.vertical,Ve=ze===l.az.horizontal||ze===l.az.horizontalOnly;if(Se>0||ge>0){const qe=yh(Me.text);de(t.text,Se,Ke?gc:qe),de(t.text,ge,Ve?gc:qe);const vt=Me.text.isHidden();[me.rightJustifiedTextSymbolIndex,me.centerJustifiedTextSymbolIndex,me.leftJustifiedTextSymbolIndex].forEach((kt=>{kt>=0&&(t.text.placedSymbolArray.get(kt).hidden=vt||Ke?1:0)})),me.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(me.verticalPlacedTextSymbolIndex).hidden=vt||Ve?1:0);const bt=this.variableOffsets[me.crossTileID];bt&&this.markUsedJustification(t,bt.anchor,me,ze);const ct=this.placedOrientations[me.crossTileID];ct&&(this.markUsedJustification(t,"left",me,ct),this.markUsedOrientation(t,ct,me))}if(be){const qe=yh(Me.icon),vt=!(Y&&me.verticalPlacedIconSymbolIndex&&Ke);me.placedIconSymbolIndex>=0&&(de(t.icon,me.numIconVertices,vt?qe:gc),t.icon.placedSymbolArray.get(me.placedIconSymbolIndex).hidden=Me.icon.isHidden()),me.verticalPlacedIconSymbolIndex>=0&&(de(t.icon,me.numVerticalIconVertices,vt?gc:qe),t.icon.placedSymbolArray.get(me.verticalPlacedIconSymbolIndex).hidden=Me.icon.isHidden())}const Ge=pe&&pe.has(fe)?pe.get(fe):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const qe=t.collisionArrays[fe];if(qe){let vt=new l.P(0,0);if(qe.textBox||qe.verticalTextBox){let bt=!0;if(N){const ct=this.variableOffsets[Te];ct?(vt=mc(ct.anchor,ct.width,ct.height,ct.textOffset,ct.textBoxScale),Z&&vt._rotate(q?-this.transform.bearingInRadians:this.transform.bearingInRadians)):bt=!1}if(qe.textBox||qe.verticalTextBox){let ct;qe.textBox&&(ct=Ke),qe.verticalTextBox&&(ct=Ve),uu(t.textCollisionBox.collisionVertexArray,Me.text.placed,!bt||ct,Ge.text,vt.x,vt.y)}}if(qe.iconBox||qe.verticalIconBox){const bt=!!(!Ve&&qe.verticalIconBox);let ct;qe.iconBox&&(ct=bt),qe.verticalIconBox&&(ct=!bt),uu(t.iconCollisionBox.collisionVertexArray,Me.icon.placed,ct,Ge.icon,Y?vt.x:0,Y?vt.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,a){const d=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*d>t}setStale(){this.stale=!0}}function uu(b,t,a,d,g,w){d&&d.length!==0||(d=[0,0,0,0]);const P=d[0]-Vn,E=d[1]-Vn,k=d[2]-Vn,z=d[3]-Vn;b.emplaceBack(t?1:0,a?1:0,g||0,w||0,P,E),b.emplaceBack(t?1:0,a?1:0,g||0,w||0,k,E),b.emplaceBack(t?1:0,a?1:0,g||0,w||0,k,z),b.emplaceBack(t?1:0,a?1:0,g||0,w||0,P,z)}const hl=Math.pow(2,25),Nd=Math.pow(2,24),jd=Math.pow(2,17),Zr=Math.pow(2,16),hu=Math.pow(2,9),Bd=Math.pow(2,8),ka=Math.pow(2,1);function yh(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const t=b.placed?1:0,a=Math.floor(127*b.opacity);return a*hl+t*Nd+a*jd+t*Zr+a*hu+t*Bd+a*ka+t}const gc=0;class ta{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,a,d,g,w){const P=this._bucketParts;for(;this._currentTileIndex<t.length;)if(a.getBucketParts(P,g,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort(((E,k)=>E.sortKey-k.sortKey)));this._currentPartIndex<P.length;)if(a.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,w())return!0;return!1}}class Da{constructor(t,a,d,g,w,P,E,k){this.placement=new gh(t,a,P,E,k),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(t,a,d){const g=Q(),w=()=>!this._forceFullPlacement&&Q()-g>2;for(;this._currentPlacementIndex>=0;){const P=a[t[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=E)&&(!P.maxzoom||P.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new ta(P)),this._inProgressLayer.continuePlacement(d[P.source],this.placement,this._showCollisionBoxes,P,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const xr=512/l.a5/2;class Ao{constructor(t,a,d){this.tileID=t,this.bucketInstanceId=d,this._symbolsByKey={};const g=new Map;for(let w=0;w<a.length;w++){const P=a.get(w),E=P.key,k=g.get(E);k?k.push(P):g.set(E,[P])}for(const[w,P]of g){const E={positions:P.map((k=>({x:Math.floor(k.anchorX*xr),y:Math.floor(k.anchorY*xr)}))),crossTileIDs:P.map((k=>k.crossTileID))};if(E.positions.length>128){const k=new l.aT(E.positions.length,16,Uint16Array);for(const{x:z,y:N}of E.positions)k.add(z,N);k.finish(),delete E.positions,E.index=k}this._symbolsByKey[w]=E}}getScaledCoordinates(t,a){const{x:d,y:g,z:w}=this.tileID.canonical,{x:P,y:E,z:k}=a.canonical,z=xr/Math.pow(2,k-w),N=(E*l.a5+t.anchorY)*z,Z=g*l.a5*xr;return{x:Math.floor((P*l.a5+t.anchorX)*z-d*l.a5*xr),y:Math.floor(N-Z)}}findMatches(t,a,d){const g=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let w=0;w<t.length;w++){const P=t.get(w);if(P.crossTileID)continue;const E=this._symbolsByKey[P.key];if(!E)continue;const k=this.getScaledCoordinates(P,a);if(E.index){const z=E.index.range(k.x-g,k.y-g,k.x+g,k.y+g).sort();for(const N of z){const Z=E.crossTileIDs[N];if(!d[Z]){d[Z]=!0,P.crossTileID=Z;break}}}else if(E.positions)for(let z=0;z<E.positions.length;z++){const N=E.positions[z],Z=E.crossTileIDs[z];if(Math.abs(N.x-k.x)<=g&&Math.abs(N.y-k.y)<=g&&!d[Z]){d[Z]=!0,P.crossTileID=Z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class Ra{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ko{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const a=Math.round((t-this.lng)/360);if(a!==0)for(const d in this.indexes){const g=this.indexes[d],w={};for(const P in g){const E=g[P];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+a),w[E.tileID.key]=E}this.indexes[d]=w}this.lng=t}addBucket(t,a,d){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let w=0;w<a.symbolInstances.length;w++)a.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const g=this.usedCrossTileIDs[t.overscaledZ];for(const w in this.indexes){const P=this.indexes[w];if(Number(w)>t.overscaledZ)for(const E in P){const k=P[E];k.tileID.isChildOf(t)&&k.findMatches(a.symbolInstances,t,g)}else{const E=P[t.scaledTo(Number(w)).key];E&&E.findMatches(a.symbolInstances,t,g)}}for(let w=0;w<a.symbolInstances.length;w++){const P=a.symbolInstances.get(w);P.crossTileID||(P.crossTileID=d.generate(),g[P.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Ao(t,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(t,a){for(const d of a.getCrossTileIDsLists())for(const g of d)delete this.usedCrossTileIDs[t][g]}removeStaleBuckets(t){let a=!1;for(const d in this.indexes){const g=this.indexes[d];for(const w in g)t[g[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,g[w]),delete g[w],a=!0)}return a}}class wi{constructor(){this.layerIndexes={},this.crossTileIDs=new Ra,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,a,d){let g=this.layerIndexes[t.id];g===void 0&&(g=this.layerIndexes[t.id]=new ko);let w=!1;const P={};g.handleWrapJump(d);for(const E of a){const k=E.getBucket(t);k&&t.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(E.tileID,k,this.crossTileIDs)&&(w=!0),P[k.bucketInstanceId]=!0)}return g.removeStaleBuckets(P)&&(w=!0),w}pruneUnusedLayers(t){const a={};t.forEach((d=>{a[d]=!0}));for(const d in this.layerIndexes)a[d]||delete this.layerIndexes[d]}}var ii="void main() {fragColor=vec4(1.0);}";const Yr={prelude:ur(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:ur("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:ur("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:ur(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:ur(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ur(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ur(ii,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:ur(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:ur(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ur("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ur("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:ur(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:ur("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:ur(ii,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:ur(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:ur(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:ur(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:ur(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ur(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ur(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ur(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ur(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:ur(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ur(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ur(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ur(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:ur(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:ur(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:ur(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ur(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ur(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ur("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:ur("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:ur("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:ur("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:ur(`#ifdef GL_ES
precision highp float;
#endif
in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:ur("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function ur(b,t){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=t.match(/in ([\w]+) ([\w]+)/g),g=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=w?w.concat(g):g,E={};return{fragmentSource:b=b.replace(a,((k,z,N,Z,q)=>(E[q]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${q}
in ${N} ${Z} ${q};
#else
uniform ${N} ${Z} u_${q};
#endif
`:`
#ifdef HAS_UNIFORM_u_${q}
    ${N} ${Z} ${q} = u_${q};
#endif
`))),vertexSource:t=t.replace(a,((k,z,N,Z,q)=>{const Y=Z==="float"?"vec2":"vec4",ne=q.match(/color/)?"color":Y;return E[q]?z==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${N} ${Y} a_${q};
out ${N} ${Z} ${q};
#else
uniform ${N} ${Z} u_${q};
#endif
`:ne==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = a_${q};
#else
    ${N} ${Z} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = unpack_mix_${ne}(a_${q}, u_${q}_t);
#else
    ${N} ${Z} ${q} = u_${q};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${N} ${Y} a_${q};
#else
uniform ${N} ${Z} u_${q};
#endif
`:ne==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${N} ${Z} ${q} = a_${q};
#else
    ${N} ${Z} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${N} ${Z} ${q} = unpack_mix_${ne}(a_${q}, u_${q}_t);
#else
    ${N} ${Z} ${q} = u_${q};
#endif
`})),staticAttributes:d,staticUniforms:P}}class ln{constructor(t,a,d){this.vertexBuffer=t,this.indexBuffer=a,this.segments=d}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Fs=l.aU([{name:"a_pos",type:"Int16",components:2}]);const rs="#define PROJECTION_MERCATOR",fs="mercator";class Ti{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return fs}get shaderDefine(){return rs}get shaderPreludeCode(){return Yr.projectionMercator}get vertexShaderPreludeCode(){return Yr.projectionMercator.vertexSource}get subdivisionGranularity(){return l.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,a,d,g,w){if(this._cachedMesh)return this._cachedMesh;const P=new l.aW;P.emplaceBack(0,0),P.emplaceBack(l.a5,0),P.emplaceBack(0,l.a5),P.emplaceBack(l.a5,l.a5);const E=t.createVertexBuffer(P,Fs.members),k=l.aX.simpleSegment(0,0,4,2),z=new l.aY;z.emplaceBack(1,0,2),z.emplaceBack(1,2,3);const N=t.createIndexBuffer(z);return this._cachedMesh=new ln(E,N,k),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class dl{constructor(t=0,a=0,d=0,g=0){if(isNaN(t)||t<0||isNaN(a)||a<0||isNaN(d)||d<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=a,this.left=d,this.right=g}interpolate(t,a,d){return a.top!=null&&t.top!=null&&(this.top=l.G.number(t.top,a.top,d)),a.bottom!=null&&t.bottom!=null&&(this.bottom=l.G.number(t.bottom,a.bottom,d)),a.left!=null&&t.left!=null&&(this.left=l.G.number(t.left,a.left,d)),a.right!=null&&t.right!=null&&(this.right=l.G.number(t.right,a.right,d)),this}getCenter(t,a){const d=l.an((this.left+t-this.right)/2,0,t),g=l.an((this.top+a-this.bottom)/2,0,a);return new l.P(d,g)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new dl(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function La(b,t){if(!b.renderWorldCopies||b.lngRange)return;const a=t.lng-b.center.lng;t.lng+=a>180?-360:a<-180?360:0}function bn(b){return Math.max(0,Math.floor(b))}class oo{constructor(t,a){var d;this.applyConstrain=(g,w)=>this._constrainOverride!==null?this._constrainOverride(g,w):this._callbacks.defaultConstrain(g,w),this._callbacks=t,this._tileSize=512,this._renderWorldCopies=a?.renderWorldCopies===void 0||!!a?.renderWorldCopies,this._minZoom=a?.minZoom||0,this._maxZoom=a?.maxZoom||22,this._minPitch=a?.minPitch==null?0:a?.minPitch,this._maxPitch=a?.maxPitch==null?60:a?.maxPitch,this._constrainOverride=(d=a?.constrainOverride)!==null&&d!==void 0?d:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new l.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=bn(this._zoom),this._scale=l.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new dl,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,a,d){this._constrainOverride=t.constrainOverride,this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=bn(this._zoom),this._scale=l.aq(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new dl(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!d&&t.autoCalculateNearFarZ,a&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get constrainOverride(){return this._constrainOverride}setConstrainOverride(t){t===void 0&&(t=null),this._constrainOverride!==t&&(this._constrainOverride=t,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const a=l.W(t,-180,180)*Math.PI/180;var d,g,w,P,E,k,z,N,Z;this._bearingInRadians!==a&&(this._unmodified=!1,this._bearingInRadians=a,this._calcMatrices(),this._rotationMatrix=R(),d=this._rotationMatrix,w=-this._bearingInRadians,P=(g=this._rotationMatrix)[0],E=g[1],k=g[2],z=g[3],N=Math.sin(w),Z=Math.cos(w),d[0]=P*Z+k*N,d[1]=E*Z+z*N,d[2]=P*-N+k*Z,d[3]=E*-N+z*Z)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const a=l.an(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==a&&(this._unmodified=!1,this._pitchInRadians=a,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const a=t/180*Math.PI;this._rollInRadians!==a&&(this._unmodified=!1,this._rollInRadians=a,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return l.aZ(this._fovInRadians)}setFov(t){t=l.an(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=l.ap(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const a=this.applyConstrain(this._center,t).zoom;this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this._tileZoom=Math.max(0,Math.floor(a)),this._scale=l.aq(a),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,a){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=a,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,a,d){this._unmodified=!1,this._edgeInsets.interpolate(t,a,d),this.constrainInternal(),this._calcMatrices()}resize(t,a,d=!0){this._width=t,this._height=a,d&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Xr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-l.ao,l.ao])}getCameraQueryGeometry(t,a){if(a.length===1)return[a[0],t];{const{minX:d,minY:g,maxX:w,maxY:P}=l.aa.fromPoints(a).extend(t);return[new l.P(d,g),new l.P(w,g),new l.P(w,P),new l.P(d,P),new l.P(d,g)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:a,zoom:d}=this.applyConstrain(this.center,this.zoom);this.setCenter(a),this.setZoom(d),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=l.ar(new Float64Array(16));l.Q(t,t,[this._width/2,-this._height/2,1]),l.O(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=l.ar(new Float64Array(16)),l.Q(t,t,[1,-1,1]),l.O(t,t,[-1,-1,0]),l.Q(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,a,d,g){const w=d!==void 0?d:this.bearing,P=g=g!==void 0?g:this.pitch,{distanceToCenter:E,clampedElevation:k}=this._distanceToCenterFromAltElevationPitch(a,this.elevation,P),{x:z,y:N}=an(P,w),Z=l.a9.fromLngLat(t,a);let q,Y,ne=l.a_(1,Z.y),de=0;do{if(de+=1,de>10)break;Y=E/ne,q=new l.a9(Z.x+z*Y,Z.y+N*Y),ne=1/q.meterInMercatorCoordinateUnits()}while(Math.abs(E-Y*ne)>1e-12);return{center:q.toLngLat(),elevation:k,zoom:l.at(this.height/2/Math.tan(this.fovInRadians/2)/Y/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const a=1/this.worldSize,d=l.as(1,this.center.lat)*this.worldSize,g=l.a9.fromLngLat(this.center,this.elevation),w=g.x/a,P=g.y/a,E=g.z/a,k=this.pitch,z=this.bearing,{x:N,y:Z,z:q}=an(k,z),Y=this.cameraToCenterDistance,ne=w+Y*-N,de=P+Y*-Z,pe=E+Y*q,{distanceToCenter:fe,clampedElevation:me}=this._distanceToCenterFromAltElevationPitch(pe/d,t,k),Se=fe*d,ge=new l.a9((ne+N*Se)*a,(de+Z*Se)*a,0).toLngLat(),Te=l.as(1,ge.lat),Me=l.at(this.height/2/Math.tan(this.fovInRadians/2)/fe/Te/this.tileSize);this._elevation=me,this._center=ge,this.setZoom(Me)}_distanceToCenterFromAltElevationPitch(t,a,d){const g=-Math.cos(l.ap(d)),w=t-a;let P,E=a;return g*w>=0||Math.abs(g)<.1?(P=1e4,E=t+P*g):P=-w/g,{distanceToCenter:P,clampedElevation:E}}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=l.as(1,this.center.lat)*this.worldSize;return $e(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const a=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/a,t.canonical.y/a,1/a/l.a5,1/a/l.a5]}}class ns{constructor(t,a){this.min=t,this.max=a,this.center=l.a$([],l.b0([],this.min,this.max),.5)}quadrant(t){const a=[t%2==0,t<2],d=l.b1(this.min),g=l.b1(this.max);for(let w=0;w<a.length;w++)d[w]=a[w]?this.min[w]:this.center[w],g[w]=a[w]?this.center[w]:this.max[w];return g[2]=this.max[2],new ns(d,g)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let a=!0;for(let d=0;d<t.planes.length;d++){const g=this.intersectsPlane(t.planes[d]);if(g===0)return 0;g===1&&(a=!1)}return a?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let a=t[3],d=t[3];for(let g=0;g<3;g++)t[g]>0?(a+=t[g]*this.min[g],d+=t[g]*this.max[g]):(d+=t[g]*this.min[g],a+=t[g]*this.max[g]);return a>=0?2:d<0?0:1}}class fl{distanceToTile2d(t,a,d,g){const w=g.distanceX([t,a]),P=g.distanceY([t,a]);return Math.hypot(w,P)}getWrap(t,a,d){return d}getTileBoundingVolume(t,a,d,g){var w,P;let E=0,k=0;if(g?.terrain){const N=new l.a2(t.z,a,t.z,t.x,t.y),Z=g.terrain.getMinMaxElevation(N);E=(w=Z.minElevation)!==null&&w!==void 0?w:Math.min(0,d),k=(P=Z.maxElevation)!==null&&P!==void 0?P:Math.max(0,d)}const z=1<<t.z;return new ns([a+t.x/z,t.y/z,E],[a+(t.x+1)/z,(t.y+1)/z,k])}allowVariableZoom(t,a){const d=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,g=l.an(78.5-d/2,0,60);return!!a.terrain||t.pitch>g}allowWorldCopies(){return!0}prepareNextFrame(){}}class ps{constructor(t,a,d){this.points=t,this.planes=a,this.aabb=d}static fromInvProjectionMatrix(t,a=1,d=0,g,w){const P=w?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],E=Math.pow(2,d),k=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((q=>(function(Y,ne,de,pe){const fe=l.aH([],Y,ne),me=1/fe[3]/de*pe;return l.b6(fe,fe,[me,me,1/fe[3],me])})(q,t,a,E)));g&&(function(q,Y,ne,de){const pe=de?4:0,fe=de?0:4;let me=0;const Se=[],ge=[];for(let be=0;be<4;be++){const ze=l.b2([],q[be+fe],q[be+pe]),Ke=l.b7(ze);l.a$(ze,ze,1/Ke),Se.push(Ke),ge.push(ze)}for(let be=0;be<4;be++){const ze=l.b8(q[be+pe],ge[be],ne);me=ze!==null&&ze>=0?Math.max(me,ze):Math.max(me,Se[be])}const Te=(function(be,ze){const Ke=l.b2([],be[ze[0]],be[ze[1]]),Ve=l.b2([],be[ze[2]],be[ze[1]]),Ge=[0,0,0,0];return l.b3(Ge,l.b4([],Ke,Ve)),Ge[3]=-l.b5(Ge,be[ze[0]]),Ge})(q,Y),Me=(function(be,ze){const Ke=l.b9(be),Ve=l.ba([],be,1/Ke),Ge=l.b2([],ze,l.a$([],Ve,l.b5(ze,Ve))),qe=l.b9(Ge);if(qe>0){const vt=Math.sqrt(1-Ve[3]*Ve[3]),bt=l.a$([],Ve,-Ve[3]),ct=l.b0([],bt,l.a$([],Ge,vt/qe));return l.bb(ze,ct)}return null})(ne,Te);if(Me!==null){const be=Me/l.b5(ge[0],Te);me=Math.min(me,be)}for(let be=0;be<4;be++){const ze=Math.min(me,Se[be]);q[be+fe]=[q[be+pe][0]+ge[be][0]*ze,q[be+pe][1]+ge[be][1]*ze,q[be+pe][2]+ge[be][2]*ze,1]}})(k,P[0],g,w);const z=P.map((q=>{const Y=l.b2([],k[q[0]],k[q[1]]),ne=l.b2([],k[q[2]],k[q[1]]),de=l.b3([],l.b4([],Y,ne)),pe=-l.b5(de,k[q[1]]);return de.concat(pe)})),N=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Z=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const q of k)for(let Y=0;Y<3;Y++)N[Y]=Math.min(N[Y],q[Y]),Z[Y]=Math.max(Z[Y],q[Y]);return new ps(k,z,new ns(N,Z))}}class pl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,d){return this._helper.interpolatePadding(t,a,d)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a,d=!0){this._helper.resize(t,a,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,a){}constructor(t){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(a,d)=>{d=l.an(+d,this.minZoom,this.maxZoom);const g={center:new l.V(a.lng,a.lat),zoom:d};let w=this._helper._lngRange;if(!this._helper._renderWorldCopies&&w===null){const ge=179.9999999999;w=[-ge,ge]}const P=this.tileSize*l.aq(g.zoom);let E=0,k=P,z=0,N=P,Z=0,q=0;const{x:Y,y:ne}=this.size;if(this._helper._latRange){const ge=this._helper._latRange;E=l.X(ge[1])*P,k=l.X(ge[0])*P,k-E<ne&&(Z=ne/(k-E))}w&&(z=l.W(l.Y(w[0])*P,0,P),N=l.W(l.Y(w[1])*P,0,P),N<z&&(N+=P),N-z<Y&&(q=Y/(N-z)));const{x:de,y:pe}=$t(P,a);let fe,me;const Se=Math.max(q||0,Z||0);if(Se){const ge=new l.P(q?(N+z)/2:de,Z?(k+E)/2:pe);return g.center=hr(P,ge).wrap(),g.zoom+=l.at(Se),g}if(this._helper._latRange){const ge=ne/2;pe-ge<E&&(me=E+ge),pe+ge>k&&(me=k-ge)}if(w){const ge=(z+N)/2;let Te=de;this._helper._renderWorldCopies&&(Te=l.W(de,ge-P/2,ge+P/2));const Me=Y/2;Te-Me<z&&(fe=z+Me),Te+Me>N&&(fe=N-Me)}if(fe!==void 0||me!==void 0){const ge=new l.P(fe??de,me??pe);g.center=hr(P,ge).wrap()}return g},this.applyConstrain=(a,d)=>this._helper.applyConstrain(a,d),this._helper=new oo({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,d)=>this.defaultConstrain(a,d)},t),this._coveringTilesDetailsProvider=new fl}clone(){const t=new pl;return t.apply(this,!1),t}apply(t,a,d){this._helper.apply(t,a,d)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const a=[new l.bc(0,t)];if(this._helper._renderWorldCopies){const d=this.screenPointToMercatorCoordinate(new l.P(0,0)),g=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,0)),w=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,this._helper._height)),P=this.screenPointToMercatorCoordinate(new l.P(0,this._helper._height)),E=Math.floor(Math.min(d.x,g.x,w.x,P.x)),k=Math.floor(Math.max(d.x,g.x,w.x,P.x)),z=1;for(let N=E-z;N<=k+z;N++)N!==0&&a.push(new l.bc(N,t))}return a}getCameraFrustum(){return ps.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const a=this.screenPointToLocation(this.centerPoint,t),d=t?t.getElevationForLngLatZoom(a,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(d)}setLocationAtPoint(t,a){const d=l.as(this.elevation,this.center.lat),g=this.screenPointToMercatorCoordinateAtZ(a,d),w=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,d),P=l.a9.fromLngLat(t),E=new l.a9(P.x-(g.x-w.x),P.y-(g.y-w.y));this.setCenter(E?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,a){return a?this.coordinatePoint(l.a9.fromLngLat(t),a.getElevationForLngLat(t,this),this._pixelMatrix3D):this.coordinatePoint(l.a9.fromLngLat(t))}screenPointToLocation(t,a){var d;return(d=this.screenPointToMercatorCoordinate(t,a))===null||d===void 0?void 0:d.toLngLat()}screenPointToMercatorCoordinate(t,a){if(a){const d=a.pointCoordinate(t);if(d!=null)return d}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,a){const d=a||0,g=[t.x,t.y,0,1],w=[t.x,t.y,1,1];l.aH(g,g,this._pixelMatrixInverse),l.aH(w,w,this._pixelMatrixInverse);const P=g[3],E=w[3],k=g[1]/P,z=w[1]/E,N=g[2]/P,Z=w[2]/E,q=N===Z?0:(d-N)/(Z-N);return new l.a9(l.G.number(g[0]/P,w[0]/E,q)/this.worldSize,l.G.number(k,z,q)/this.worldSize,d)}coordinatePoint(t,a=0,d=this._pixelMatrix){const g=[t.x*this.worldSize,t.y*this.worldSize,a,1];return l.aH(g,g,d),new l.P(g[0]/g[3],g[1]/g[3])}getBounds(){const t=Math.max(0,this._helper._height/2-Ur(this));return new Xr().extend(this.screenPointToLocation(new l.P(0,t))).extend(this.screenPointToLocation(new l.P(this._helper._width,t))).extend(this.screenPointToLocation(new l.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new l.P(0,this._helper._height)))}isPointOnMapSurface(t,a){return a?a.pointCoordinate(t)!=null:t.y>this.height/2-Ur(this)}calculatePosMatrix(t,a=!1,d){var g;const w=(g=t.key)!==null&&g!==void 0?g:l.bd(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),P=a?this._alignedPosMatrixCache:this._posMatrixCache;if(P.has(w)){const z=P.get(w);return d?z.f32:z.f64}const E=kr(t,this.worldSize);l.S(E,a?this._alignedProjMatrix:this._viewProjMatrix,E);const k={f64:E,f32:new Float32Array(E)};return P.set(w,k),d?k.f32:k.f64}calculateFogMatrix(t){const a=t.key,d=this._fogMatrixCacheF32;if(d.has(a))return d.get(a);const g=kr(t,this.worldSize);return l.S(g,this._fogMatrix,g),d.set(a,new Float32Array(g)),d.get(a)}calculateCenterFromCameraLngLatAlt(t,a,d,g){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,d,g)}_calculateNearFarZIfNeeded(t,a,d){if(!this._helper.autoCalculateNearFarZ)return;const g=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),w=t-g*this._helper._pixelPerMeter/Math.cos(a),P=g<0?w:t,E=Math.PI/2+this.pitchInRadians,k=l.ap(this.fov)*(Math.abs(Math.cos(l.ap(this.roll)))*this.height+Math.abs(Math.sin(l.ap(this.roll)))*this.width)/this.height*(.5+d.y/this.height),z=Math.sin(k)*P/Math.sin(l.an(Math.PI-E-k,.01,Math.PI-.01)),N=Ur(this),Z=Math.atan(N/this._helper.cameraToCenterDistance),q=l.ap(.75),Y=Z>q?2*Z*(.5+d.y/(2*N)):q,ne=Math.sin(Y)*P/Math.sin(l.an(Math.PI-E-Y,.01,Math.PI-.01)),de=Math.min(z,ne);this._helper._farZ=1.01*(Math.cos(Math.PI/2-a)*de+P),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,a=$t(this.worldSize,this.center),d=a.x,g=a.y;this._helper._pixelPerMeter=l.as(1,this.center.lat)*this.worldSize;const w=l.ap(Math.min(this.pitch,Ot)),P=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(w));let E;this._calculateNearFarZIfNeeded(P,w,t),E=new Float64Array(16),l.be(E,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),l.aB(this._invProjMatrix,E),E[8]=2*-t.x/this._helper._width,E[9]=2*t.y/this._helper._height,this._projectionMatrix=l.bf(E),l.Q(E,E,[1,-1,1]),l.O(E,E,[0,0,-this._helper.cameraToCenterDistance]),l.bg(E,E,-this.rollInRadians),l.bh(E,E,this.pitchInRadians),l.bg(E,E,-this.bearingInRadians),l.O(E,E,[-d,-g,0]),this._mercatorMatrix=l.Q([],E,[this.worldSize,this.worldSize,this.worldSize]),l.Q(E,E,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=l.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,E),l.O(E,E,[0,0,-this.elevation]),this._viewProjMatrix=E,this._invViewProjMatrix=l.aB([],E);const k=[0,0,-1,1];l.aH(k,k,this._invViewProjMatrix),this._cameraPosition=[k[0]/k[3],k[1]/k[3],k[2]/k[3]],this._fogMatrix=new Float64Array(16),l.be(this._fogMatrix,this.fovInRadians,this.width/this.height,P,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,l.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),l.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),l.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),l.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),l.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),l.O(this._fogMatrix,this._fogMatrix,[-d,-g,0]),l.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),l.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=l.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,E);const z=this._helper._width%2/2,N=this._helper._height%2/2,Z=Math.cos(this.bearingInRadians),q=Math.sin(-this.bearingInRadians),Y=d-Math.round(d)+Z*z+q*N,ne=g-Math.round(g)+Z*N+q*z,de=new Float64Array(E);if(l.O(de,de,[Y>.5?Y-1:Y,ne>.5?ne-1:ne,0]),this._alignedProjMatrix=de,E=l.aB(new Float64Array(16),this._pixelMatrix),!E)throw new Error("failed to invert matrix");this._pixelMatrixInverse=E,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new l.P(0,0)),a=[t.x*this.worldSize,t.y*this.worldSize,0,1];return l.aH(a,a,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=l.as(1,this.center.lat)*this.worldSize;return $e(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,a){const d=l.a9.fromLngLat(t),g=[d.x*this.worldSize,d.y*this.worldSize,a,1];return l.aH(g,g,this._viewProjMatrix),g[2]/g[3]}getProjectionData(t){const{overscaledTileID:a,aligned:d,applyTerrainMatrix:g}=t,w=this._helper.getMercatorTileCoordinates(a),P=a?this.calculatePosMatrix(a,d,!0):null;let E;return E=a&&a.terrainRttPosMatrix32f&&g?a.terrainRttPosMatrix32f:P||l.bi(),{mainMatrix:E,tileMercatorCoords:w,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:E}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,a,d){return 1}transformLightDirection(t){return l.b1(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,a,d,g){const w=this.calculatePosMatrix(d);let P;g?(P=[t,a,g(t,a),1],l.aH(P,P,w)):(P=[t,a,0,1],mh(P,P,w));const E=P[3];return{point:new l.P(P[0]/E,P[1]/E),signedDistanceFromCamera:E,isOccluded:!1}}populateCache(t){for(const a of t)this.calculatePosMatrix(a)}getMatrixForModel(t,a){const d=l.a9.fromLngLat(t,a),g=d.meterInMercatorCoordinateUnits(),w=l.bj();return l.O(w,w,[d.x,d.y,d.z]),l.bg(w,w,Math.PI),l.bh(w,w,Math.PI/2),l.Q(w,w,[-g,g,g]),w}getProjectionDataForCustomLayer(t=!0){const a=new l.a2(0,0,0,0,0),d=this.getProjectionData({overscaledTileID:a,applyGlobeMatrix:t}),g=kr(a,this.worldSize);l.S(g,this._viewProjMatrix,g),d.tileMercatorCoords=[0,0,1,1];const w=[l.a5,l.a5,this.worldSize/this._helper.pixelsPerMeter],P=l.bk();return l.Q(P,g,w),d.fallbackMatrix=P,d.mainMatrix=P,d}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function ao(){l.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function du(b){if(b.useSlerp)if(b.k<1){const t=l.bl(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing),a=l.bl(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),d=new Float64Array(4);l.bm(d,t,a,b.k);const g=l.bn(d);b.tr.setRoll(g.roll),b.tr.setPitch(g.pitch),b.tr.setBearing(g.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(l.G.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(l.G.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(l.G.number(b.startEulerAngles.bearing,b.endEulerAngles.bearing,b.k))}function fu(b,t,a,d,g){const w=g.padding,P=$t(g.worldSize,a.getNorthWest()),E=$t(g.worldSize,a.getNorthEast()),k=$t(g.worldSize,a.getSouthEast()),z=$t(g.worldSize,a.getSouthWest()),N=l.ap(-d),Z=P.rotate(N),q=E.rotate(N),Y=k.rotate(N),ne=z.rotate(N),de=new l.P(Math.max(Z.x,q.x,ne.x,Y.x),Math.max(Z.y,q.y,ne.y,Y.y)),pe=new l.P(Math.min(Z.x,q.x,ne.x,Y.x),Math.min(Z.y,q.y,ne.y,Y.y)),fe=de.sub(pe),me=(g.width-(w.left+w.right+t.left+t.right))/fe.x,Se=(g.height-(w.top+w.bottom+t.top+t.bottom))/fe.y;if(Se<0||me<0)return void ao();const ge=Math.min(l.at(g.scale*Math.min(me,Se)),b.maxZoom),Te=l.P.convert(b.offset),Me=new l.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(l.ap(d)),be=Te.add(Me).mult(g.scale/l.aq(ge));return{center:hr(g.worldSize,P.add(k).div(2).sub(be)),zoom:ge,bearing:d}}class za{get useGlobeControls(){return!1}handlePanInertia(t,a){const d=t.mag(),g=Math.abs(Ur(a));return{easingOffset:t.mult(Math.min(.75*g/d,1)),easingCenter:a.center}}handleMapControlsRollPitchBearingZoom(t,a){t.bearingDelta&&a.setBearing(a.bearing+t.bearingDelta),t.pitchDelta&&a.setPitch(a.pitch+t.pitchDelta),t.rollDelta&&a.setRoll(a.roll+t.rollDelta),t.zoomDelta&&a.setZoom(a.zoom+t.zoomDelta)}handleMapControlsPan(t,a,d){t.around.distSqr(a.centerPoint)<.01||a.setLocationAtPoint(d,t.around)}cameraForBoxAndBearing(t,a,d,g,w){return fu(t,a,d,g,w)}handleJumpToCenterZoom(t,a){t.zoom!==(a.zoom!==void 0?+a.zoom:t.zoom)&&t.setZoom(+a.zoom),a.center!==void 0&&t.setCenter(l.V.convert(a.center))}handleEaseTo(t,a){const d=t.zoom,g=t.padding,w={roll:t.roll,pitch:t.pitch,bearing:t.bearing},P={roll:a.roll===void 0?t.roll:a.roll,pitch:a.pitch===void 0?t.pitch:a.pitch,bearing:a.bearing===void 0?t.bearing:a.bearing},E=a.zoom!==void 0,k=!t.isPaddingEqual(a.padding);let z=!1;const N=E?+a.zoom:t.zoom;let Z=t.centerPoint.add(a.offsetAsPoint);const q=t.screenPointToLocation(Z),{center:Y,zoom:ne}=t.applyConstrain(l.V.convert(a.center||q),N??d);La(t,Y);const de=$t(t.worldSize,q),pe=$t(t.worldSize,Y).sub(de),fe=l.aq(ne-d);return z=ne!==d,{easeFunc:me=>{if(z&&t.setZoom(l.G.number(d,ne,me)),l.bo(w,P)||du({startEulerAngles:w,endEulerAngles:P,tr:t,k:me,useSlerp:w.roll!=P.roll}),k&&(t.interpolatePadding(g,a.padding,me),Z=t.centerPoint.add(a.offsetAsPoint)),a.around)t.setLocationAtPoint(a.around,a.aroundPoint);else{const Se=l.aq(t.zoom-d),ge=ne>d?Math.min(2,fe):Math.max(.5,fe),Te=Math.pow(ge,1-me),Me=hr(t.worldSize,de.add(pe.mult(me*Te)).mult(Se));t.setLocationAtPoint(t.renderWorldCopies?Me.wrap():Me,Z)}},isZooming:z,elevationCenter:Y}}handleFlyTo(t,a){const d=a.zoom!==void 0,g=t.zoom,w=t.applyConstrain(l.V.convert(a.center||a.locationAtOffset),d?+a.zoom:g),P=w.center,E=w.zoom;La(t,P);const k=$t(t.worldSize,a.locationAtOffset),z=$t(t.worldSize,P).sub(k),N=z.mag(),Z=l.aq(E-g);let q;if(a.minZoom!==void 0){const Y=Math.min(+a.minZoom,g,E),ne=t.applyConstrain(P,Y).zoom;q=l.aq(ne-g)}return{easeFunc:(Y,ne,de,pe)=>{t.setZoom(Y===1?E:g+l.at(ne));const fe=Y===1?P:hr(t.worldSize,k.add(z.mult(de)).mult(ne));t.setLocationAtPoint(t.renderWorldCopies?fe.wrap():fe,pe)},scaleOfZoom:Z,targetCenter:P,scaleOfMinZoom:q,pixelPathLength:N}}}class Br{constructor(t,a,d){this.blendFunction=t,this.blendColor=a,this.mask=d}}Br.Replace=[1,0],Br.disabled=new Br(Br.Replace,l.bp.transparent,[!1,!1,!1,!1]),Br.unblended=new Br(Br.Replace,l.bp.transparent,[!0,!0,!0,!0]),Br.alphaBlended=new Br([1,771],l.bp.transparent,[!0,!0,!0,!0]);const Fa=2305;class Mr{constructor(t,a,d){this.enable=t,this.mode=a,this.frontFace=d}}Mr.disabled=new Mr(!1,1029,Fa),Mr.backCCW=new Mr(!0,1029,Fa),Mr.frontCCW=new Mr(!0,1028,Fa);class br{constructor(t,a,d){this.func=t,this.mask=a,this.range=d}}br.ReadOnly=!1,br.ReadWrite=!0,br.disabled=new br(519,br.ReadOnly,[0,1]);const ra=7680;class Ir{constructor(t,a,d,g,w,P){this.test=t,this.ref=a,this.mask=d,this.fail=g,this.depthFail=w,this.pass=P}}Ir.disabled=new Ir({func:519,mask:0},0,0,ra,ra,ra);const yc=new WeakMap;function Nn(b){var t;if(yc.has(b))return yc.get(b);{const a=(t=b.getParameter(b.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return yc.set(b,a),a}}class lo{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const a=t.context,d=a.gl;this._texFormat=d.RGBA,this._texType=d.UNSIGNED_BYTE;const g=new l.aW;g.emplaceBack(-1,-1),g.emplaceBack(2,-1),g.emplaceBack(-1,2);const w=new l.aY;w.emplaceBack(0,1,2),this._fullscreenTriangle=new ln(a.createVertexBuffer(g,Fs.members),a.createIndexBuffer(w),l.aX.simpleSegment(0,0,g.length,w.length)),this._resultBuffer=new Uint8Array(4),a.activeTexture.set(d.TEXTURE1);const P=d.createTexture();d.bindTexture(d.TEXTURE_2D,P),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texImage2D(d.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=a.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(P),Nn(d)&&(this._pbo=d.createBuffer(),d.bindBuffer(d.PIXEL_PACK_BUFFER,this._pbo),d.bufferData(d.PIXEL_PACK_BUFFER,4,d.STREAM_READ),d.bindBuffer(d.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,a){const d=this._updateCount;return this._readbackQueue?d>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():d>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,a),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,a=t.gl;t.activeTexture.set(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,a){const d=this._cachedRenderContext.context,g=d.gl;if(this._bindFramebuffer(),d.viewport.set([0,0,this._texWidth,this._texHeight]),d.clear({color:l.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(d,g.TRIANGLES,br.disabled,Ir.disabled,Br.unblended,Mr.disabled,((w,P)=>({u_input:w,u_output_expected:P}))(t,a),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Nn(g)){g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.readBuffer(g.COLOR_ATTACHMENT0),g.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),g.bindBuffer(g.PIXEL_PACK_BUFFER,null);const w=g.fenceSync(g.SYNC_GPU_COMMANDS_COMPLETE,0);g.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:w}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Nn(t)){const a=t.clientWaitSync(this._readbackQueue.sync,0,0);if(a===t.WAIT_FAILED)return l.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(a===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=lo._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let a=0;return a+=t[0]/256,a+=t[1]/65536,a+=t[2]/16777216,t[3]<127&&(a=-a),a/128}}const Do=l.a5/128;function _c(b,t){const a=b.granularity!==void 0?Math.max(b.granularity,1):1,d=a+(b.generateBorders?2:0),g=a+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),w=d+1,P=g+1,E=b.generateBorders?-1:0,k=b.generateBorders||b.extendToNorthPole?-1:0,z=a+(b.generateBorders?1:0),N=a+(b.generateBorders||b.extendToSouthPole?1:0),Z=w*P,q=d*g*6,Y=w*P>65536;if(Y&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ne=Y||t==="32bit",de=new Int16Array(2*Z);let pe=0;for(let Se=k;Se<=N;Se++)for(let ge=E;ge<=z;ge++){let Te=ge/a*l.a5;ge===-1&&(Te=-Do),ge===a+1&&(Te=l.a5+Do);let Me=Se/a*l.a5;Se===-1&&(Me=b.extendToNorthPole?l.br:-Do),Se===a+1&&(Me=b.extendToSouthPole?l.bs:l.a5+Do),de[pe++]=Te,de[pe++]=Me}const fe=ne?new Uint32Array(q):new Uint16Array(q);let me=0;for(let Se=0;Se<g;Se++)for(let ge=0;ge<d;ge++){const Te=ge+1+Se*w,Me=ge+(Se+1)*w,be=ge+1+(Se+1)*w;fe[me++]=ge+Se*w,fe[me++]=Me,fe[me++]=Te,fe[me++]=Te,fe[me++]=Me,fe[me++]=be}return{vertices:de.buffer.slice(0),indices:fe.buffer.slice(0),uses32bitIndices:ne}}const pu=new l.aV({fill:new l.bt(128,2),line:new l.bt(512,0),tile:new l.bt(128,32),stencil:new l.bt(128,1),circle:3});class mu{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Yr.projectionGlobe}get vertexShaderPreludeCode(){return Yr.projectionMercator.vertexSource}get subdivisionGranularity(){return pu}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new lo(t));const a=l.X(this._errorQueryLatitudeDegrees),d=2*Math.atan(Math.exp(Math.PI-a*Math.PI*2))-.5*Math.PI,g=this._errorMeasurement.updateErrorLoop(a,d),w=Q();g!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=g,this._errorMeasurementLastChangeTime=w);const P=Math.min(Math.max((w-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=l.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,l.bv(P))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,a,d,g,w){const P=(w==="stencil"?pu.stencil:pu.tile).getGranularityForZoomLevel(a.z);return this._getMesh(t,{granularity:P,generateBorders:d,extendToNorthPole:a.y===0&&g,extendToSouthPole:a.y===(1<<a.z)-1&&g})}_getMesh(t,a){const d=this._getMeshKey(a);if(d in this._tileMeshCache)return this._tileMeshCache[d];const g=(function(w,P){const E=_c(P,"16bit"),k=l.aW.deserialize({arrayBuffer:E.vertices,length:E.vertices.byteLength/2/2}),z=l.aY.deserialize({arrayBuffer:E.indices,length:E.indices.byteLength/2/3});return new ln(w.createVertexBuffer(k,Fs.members),w.createIndexBuffer(z),l.aX.simpleSegment(0,0,k.length,z.length))})(t,a);return this._tileMeshCache[d]=g,g}recalculate(t){}hasTransition(){const t=Q();let a=!1;return a=a||(t-this._errorMeasurementLastChangeTime)/1e3<.7,a=a||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,a}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const Vd=new l.t({type:new l.D(l.u.projection.type)});class vc extends l.E{constructor(t){super(),this._transitionable=new l.x(Vd,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.H(0)),this._mercatorProjection=new Ti,this._verticalPerspectiveProjection=new mu}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof l.bw){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,a,d,g,w){return this.currentProjection.getMeshFromTileID(t,a,d,g,w)}setProjection(t){this._transitionable.setValue("type",t?.type||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function Si(b){const t=ml(b.worldSize,b.center.lat);return 2*Math.PI*t}function co(b,t,a,d,g){const w=1/(1<<g),P=t/l.a5*w+d*w,E=l.by((b/l.a5*w+a*w)*Math.PI*2+Math.PI,2*Math.PI),k=2*Math.atan(Math.exp(Math.PI-P*Math.PI*2))-.5*Math.PI,z=Math.cos(k),N=new Float64Array(3);return N[0]=Math.sin(E)*z,N[1]=Math.sin(k),N[2]=Math.cos(E)*z,N}function In(b){return(function(t,a){const d=Math.cos(a),g=new Float64Array(3);return g[0]=Math.sin(t)*d,g[1]=Math.sin(a),g[2]=Math.cos(t)*d,g})(b.lng*Math.PI/180,b.lat*Math.PI/180)}function ml(b,t){return b/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Ud(b){const t=Math.asin(b[1])/Math.PI*180,a=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(a>1e-6){const d=b[0]/a,g=Math.acos(b[2]/a),w=(d>0?g:-g)/Math.PI*180;return new l.V(l.W(w,-180,180),t)}return new l.V(0,t)}function gl(b){return Math.cos(b*Math.PI/180)}function Un(b,t){const a=gl(b),d=gl(t);return l.at(d/a)}function np(b,t){const a=b.rotate(t.bearingInRadians),d=t.zoom+Un(t.center.lat,0),g=l.bu(1/gl(t.center.lat),1/gl(Math.min(Math.abs(t.center.lat),60)),l.bx(d,7,3,0,1)),w=360/Si({worldSize:t.worldSize,center:{lat:t.center.lat}});return new l.V(t.center.lng-a.x*w*g,l.an(t.center.lat+a.y*w,-l.ao,l.ao))}function $d(b){const t=.5*b,a=Math.sin(t),d=Math.cos(t);return Math.log(a+d)-Math.log(d-a)}function ip(b,t,a,d){const g=b.lat+a*d;if(Math.abs(a)>1){const w=(Math.sign(b.lat+a)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180,P=Math.abs(b.lat+a)*Math.PI/180,E=$d(w+d*(P-w)),k=$d(w),z=$d(P);return new l.V(b.lng+t*((E-k)/(z-k)),g)}return new l.V(b.lng+t*d,g)}class Dm{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,a,d,g){const w=`${t.z}_${t.x}_${t.y}_${g?.terrain?"t":""}`,P=this._cache.get(w);if(P)return P;const E=this._cachePrevious.get(w);if(E)return this._cache.set(w,E),E;const k=this._boundingVolumeFactory(t,a,d,g);return this._cache.set(w,k),this._hadAnyChanges=!0,k}}class yl{constructor(t,a,d,g){this.min=d,this.max=g,this.points=t,this.planes=a}static fromAabb(t,a){const d=[];for(let g=0;g<8;g++)d.push([1&~g?t[0]:a[0],(g>>1&1)==1?a[1]:t[1],(g>>2&1)==1?a[2]:t[2]]);return new yl(d,[[-1,0,0,a[0]],[1,0,0,-t[0]],[0,-1,0,a[1]],[0,1,0,-t[1]],[0,0,-1,a[2]],[0,0,1,-t[2]]],t,a)}static fromCenterSizeAngles(t,a,d){const g=l.bB([],d[0],d[1],d[2]),w=l.bC([],[a[0],0,0],g),P=l.bC([],[0,a[1],0],g),E=l.bC([],[0,0,a[2]],g),k=[...t],z=[...t];for(let Z=0;Z<8;Z++)for(let q=0;q<3;q++){const Y=t[q]+w[q]*(1&~Z?-1:1)+P[q]*((Z>>1&1)==1?1:-1)+E[q]*((Z>>2&1)==1?1:-1);k[q]=Math.min(k[q],Y),z[q]=Math.max(z[q],Y)}const N=[];for(let Z=0;Z<8;Z++){const q=[...t];l.b0(q,q,l.a$([],w,1&~Z?-1:1)),l.b0(q,q,l.a$([],P,(Z>>1&1)==1?1:-1)),l.b0(q,q,l.a$([],E,(Z>>2&1)==1?1:-1)),N.push(q)}return new yl(N,[[...w,-l.b5(w,N[0])],[...P,-l.b5(P,N[0])],[...E,-l.b5(E,N[0])],[-w[0],-w[1],-w[2],-l.b5(w,N[7])],[-P[0],-P[1],-P[2],-l.b5(P,N[7])],[-E[0],-E[1],-E[2],-l.b5(E,N[7])]],k,z)}intersectsFrustum(t){let a=!0;const d=this.points.length,g=this.planes.length,w=t.planes.length,P=t.points.length;for(let E=0;E<w;E++){const k=t.planes[E];let z=0;for(let N=0;N<d;N++){const Z=this.points[N];k[0]*Z[0]+k[1]*Z[1]+k[2]*Z[2]+k[3]>=0&&z++}if(z===0)return 0;z<d&&(a=!1)}if(a)return 2;for(let E=0;E<g;E++){const k=this.planes[E];let z=0;for(let N=0;N<P;N++){const Z=t.points[N];k[0]*Z[0]+k[1]*Z[1]+k[2]*Z[2]+k[3]>=0&&z++}if(z===0)return 0}return 1}intersectsPlane(t){const a=this.points.length;let d=0;for(let g=0;g<a;g++){const w=this.points[g];t[0]*w[0]+t[1]*w[1]+t[2]*w[2]+t[3]>=0&&d++}return d===a?2:d===0?0:1}}function _h(b,t,a){const d=b-t;return d<0?-d:Math.max(0,d-a)}function xc(b,t,a,d,g){const w=b-a;let P;return P=w<0?Math.min(-w,1+w-g):w>1?Math.min(Math.max(w-g,0),1-w):0,Math.max(P,_h(t,d,g))}class Gd{constructor(){this._boundingVolumeCache=new Dm(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,a,d,g){const w=1<<d.z,P=1/w,E=d.x/w,k=d.y/w;let z=2;return z=Math.min(z,xc(t,a,E,k,P)),z=Math.min(z,xc(t,a,E+.5,-k-P,P)),z=Math.min(z,xc(t,a,E+.5,2-k-P,P)),z}getWrap(t,a,d){const g=1<<a.z,w=1/g,P=a.x/g,E=_h(t.x,P,w),k=_h(t.x,P-1,w),z=_h(t.x,P+1,w),N=Math.min(E,k,z);return N===z?1:N===k?-1:0}allowVariableZoom(t,a){return mn(t,a)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,a,d,g){return this._boundingVolumeCache.getTileBoundingVolume(t,a,d,g)}_computeTileBoundingVolume(t,a,d,g){var w,P;let E=0,k=0;if(g?.terrain){const z=new l.a2(t.z,a,t.z,t.x,t.y),N=g.terrain.getMinMaxElevation(z);E=(w=N.minElevation)!==null&&w!==void 0?w:Math.min(0,d),k=(P=N.maxElevation)!==null&&P!==void 0?P:Math.max(0,d)}if(E/=l.bE,k/=l.bE,E+=1,k+=1,t.z<=0)return yl.fromAabb([-k,-k,-k],[k,k,k]);if(t.z===1)return yl.fromAabb([t.x===0?-k:0,t.y===0?0:-k,-k],[t.x===0?0:k,t.y===0?k:0,k]);{const z=[co(0,0,t.x,t.y,t.z),co(l.a5,0,t.x,t.y,t.z),co(l.a5,l.a5,t.x,t.y,t.z),co(0,l.a5,t.x,t.y,t.z)],N=[];for(const Ge of z)N.push(l.a$([],Ge,k));if(k!==E)for(const Ge of z)N.push(l.a$([],Ge,E));t.y===0&&N.push([0,1,0]),t.y===(1<<t.z)-1&&N.push([0,-1,0]);const Z=[1,1,1],q=[-1,-1,-1];for(const Ge of N)for(let qe=0;qe<3;qe++)Z[qe]=Math.min(Z[qe],Ge[qe]),q[qe]=Math.max(q[qe],Ge[qe]);const Y=co(l.a5/2,l.a5/2,t.x,t.y,t.z),ne=l.b4([],[0,1,0],Y);l.b3(ne,ne);const de=l.b4([],Y,ne);l.b3(de,de);const pe=l.b4([],z[2],z[1]);l.b3(pe,pe);const fe=l.b4([],z[0],z[3]);l.b3(fe,fe),N.push(l.a$([],Y,k)),t.y>=(1<<t.z)/2&&N.push(l.a$([],co(l.a5/2,0,t.x,t.y,t.z),k)),t.y<(1<<t.z)/2&&N.push(l.a$([],co(l.a5/2,l.a5,t.x,t.y,t.z),k));const me=gu(Y,N),Se=gu(de,N),ge=[-Y[0],-Y[1],-Y[2],me.max],Te=[Y[0],Y[1],Y[2],-me.min],Me=[-de[0],-de[1],-de[2],Se.max],be=[de[0],de[1],de[2],-Se.min],ze=[...pe,0],Ke=[...fe,0],Ve=[];return t.y===0?Ve.push(l.bD(Ke,ze,ge),l.bD(Ke,ze,Te)):Ve.push(l.bD(Me,ze,ge),l.bD(Me,ze,Te),l.bD(Me,Ke,ge),l.bD(Me,Ke,Te)),t.y===(1<<t.z)-1?Ve.push(l.bD(Ke,ze,ge),l.bD(Ke,ze,Te)):Ve.push(l.bD(be,ze,ge),l.bD(be,ze,Te),l.bD(be,Ke,ge),l.bD(be,Ke,Te)),new yl(Ve,[ge,Te,Me,be,ze,Ke],Z,q)}}}function gu(b,t){let a=1/0,d=-1/0;for(const g of t){const w=l.b5(b,g);a=Math.min(a,w),d=Math.max(d,w)}return{min:a,max:d}}class Oa{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,d){return this._helper.interpolatePadding(t,a,d)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a){this._helper.resize(t,a)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(t){this._cachedClippingPlane=l.bF(),this._projectionMatrix=l.bj(),this._globeViewProjMatrix32f=l.bi(),this._globeViewProjMatrixNoCorrection=l.bj(),this._globeViewProjMatrixNoCorrectionInverted=l.bj(),this._globeProjMatrixInverted=l.bj(),this._cameraPosition=l.bz(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(a,d)=>{const g=l.an(a.lat,-l.ao,l.ao),w=l.an(+d,this.minZoom+Un(0,g),this.maxZoom);return{center:new l.V(a.lng,g),zoom:w}},this.applyConstrain=(a,d)=>this._helper.applyConstrain(a,d),this._helper=new oo({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,d)=>this.defaultConstrain(a,d)},t),this._coveringTilesDetailsProvider=new Gd}clone(){const t=new Oa;return t.apply(this,!1),t}apply(t,a,d){this._globeLatitudeErrorCorrectionRadians=d||0,this._helper.apply(t,a)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=l.bz();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:a,applyGlobeMatrix:d}=t,g=this._helper.getMercatorTileCoordinates(a);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:g,clippingPlane:this._cachedClippingPlane,projectionTransition:d?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const a=this.pitchInRadians,d=this.cameraToCenterDistance/t,g=Math.sin(a)*d,w=Math.cos(a)*d+1,P=1/Math.sqrt(g*g+w*w)*1;let E=-g,k=w;const z=Math.sqrt(E*E+k*k);E/=z,k/=z;const N=[0,E,k];l.bG(N,N,[0,0,0],-this.bearingInRadians),l.bH(N,N,[0,0,0],-1*this.center.lat*Math.PI/180),l.bI(N,N,[0,0,0],this.center.lng*Math.PI/180);const Z=1/l.b7(N);return l.a$(N,N,Z),[...N,-P*Z]}isLocationOccluded(t){return!this.isSurfacePointVisible(In(t))}transformLightDirection(t){const a=this._helper._center.lng*Math.PI/180,d=this._helper._center.lat*Math.PI/180,g=Math.cos(d),w=[Math.sin(a)*g,Math.sin(d),Math.cos(a)*g],P=[w[2],0,-w[0]],E=[0,0,0];l.b4(E,P,w),l.b3(P,P),l.b3(E,E);const k=[0,0,0];return l.b3(k,[P[0]*t[0]+E[0]*t[1]+w[0]*t[2],P[1]*t[0]+E[1]*t[1]+w[1]*t[2],P[2]*t[0]+E[2]*t[1]+w[2]*t[2]]),k}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,a,d){const g=(function(E,k,z){const N=1/(1<<z.z);return new l.a9(E/l.a5*N+z.x*N,k/l.a5*N+z.y*N)})(t,a,d.canonical),w=(P=g.y,[l.by(g.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-P*Math.PI*2))-.5*Math.PI]);var P;return this.getCircleRadiusCorrection()/Math.cos(w[1])}projectTileCoordinates(t,a,d,g){const w=d.canonical,P=co(t,a,w.x,w.y,w.z),E=1+(g?g(t,a):0)/l.bE,k=[P[0]*E,P[1]*E,P[2]*E,1];l.aH(k,k,this._globeViewProjMatrixNoCorrection);const z=this._cachedClippingPlane,N=z[0]*P[0]+z[1]*P[1]+z[2]*P[2]+z[3]<0;return{point:new l.P(k[0]/k[3],k[1]/k[3]),signedDistanceFromCamera:k[3],isOccluded:N}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=ml(this.worldSize,this.center.lat),a=l.bk(),d=l.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),l.be(a,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const g=this.centerOffset;a[8]=2*-g.x/this._helper._width,a[9]=2*g.y/this._helper._height,this._projectionMatrix=l.bf(a),this._globeProjMatrixInverted=l.bk(),l.aB(this._globeProjMatrixInverted,a),l.O(a,a,[0,0,-this.cameraToCenterDistance]),l.bg(a,a,this.rollInRadians),l.bh(a,a,-this.pitchInRadians),l.bg(a,a,this.bearingInRadians),l.O(a,a,[0,0,-t]);const w=l.bz();w[0]=t,w[1]=t,w[2]=t,l.bh(d,a,this.center.lat*Math.PI/180),l.bJ(d,d,-this.center.lng*Math.PI/180),l.Q(d,d,w),this._globeViewProjMatrixNoCorrection=d,l.bh(a,a,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),l.bJ(a,a,-this.center.lng*Math.PI/180),l.Q(a,a,w),this._globeViewProjMatrix32f=new Float32Array(a),this._globeViewProjMatrixNoCorrectionInverted=l.bk(),l.aB(this._globeViewProjMatrixNoCorrectionInverted,d);const P=l.bz();this._cameraPosition=l.bz(),this._cameraPosition[2]=this.cameraToCenterDistance/t,l.bG(this._cameraPosition,this._cameraPosition,P,-this.rollInRadians),l.bH(this._cameraPosition,this._cameraPosition,P,this.pitchInRadians),l.bG(this._cameraPosition,this._cameraPosition,P,-this.bearingInRadians),l.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),l.bH(this._cameraPosition,this._cameraPosition,P,-this.center.lat*Math.PI/180),l.bI(this._cameraPosition,this._cameraPosition,P,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const E=l.bf(this._globeViewProjMatrixNoCorrectionInverted);l.Q(E,E,[1,1,-1]),this._cachedFrustum=ps.fromInvProjectionMatrix(E,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){l.w("calculateFogMatrix is not supported on globe projection.");const a=l.bk();return l.ar(a),a}getVisibleUnwrappedCoordinates(t){return[new l.bc(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&l.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,a){if(!this._globeViewProjMatrixNoCorrection)return 1;const d=In(t);l.a$(d,d,1+a/l.bE);const g=l.bF();return l.aH(g,[d[0],d[1],d[2],1],this._globeViewProjMatrixNoCorrection),g[2]/g[3]}populateCache(t){}getBounds(){const t=.5*this.width,a=.5*this.height,d=[new l.P(0,0),new l.P(t,0),new l.P(this.width,0),new l.P(this.width,a),new l.P(this.width,this.height),new l.P(t,this.height),new l.P(0,this.height),new l.P(0,a)],g=[];for(const Z of d)g.push(this.unprojectScreenPoint(Z));let w=0,P=0,E=0,k=0;const z=this.center;for(const Z of g){const q=l.bK(z.lng,Z.lng),Y=l.bK(z.lat,Z.lat);q<P&&(P=q),q>w&&(w=q),Y<k&&(k=Y),Y>E&&(E=Y)}const N=[z.lng+P,z.lat+k,z.lng+w,z.lat+E];return this.isSurfacePointOnScreen([0,1,0])&&(N[3]=90,N[0]=-180,N[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(N[1]=-90,N[0]=-180,N[2]=180),new Xr(N)}calculateCenterFromCameraLngLatAlt(t,a,d,g){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,d,g)}setLocationAtPoint(t,a){const d=In(this.unprojectScreenPoint(a)),g=In(t),w=l.bz();l.bL(w);const P=l.bz();l.bI(P,d,w,-this.center.lng*Math.PI/180),l.bH(P,P,w,this.center.lat*Math.PI/180);const E=g[0]*g[0]+g[2]*g[2],k=P[0]*P[0];if(E<k)return;const z=Math.sqrt(E-k),N=-z,Z=l.bM(g[0],g[2],P[0],z),q=l.bM(g[0],g[2],P[0],N),Y=l.bz();l.bI(Y,g,w,-Z);const ne=l.bM(Y[1],Y[2],P[1],P[2]),de=l.bz();l.bI(de,g,w,-q);const pe=l.bM(de[1],de[2],P[1],P[2]),fe=.5*Math.PI,me=ne>=-fe&&ne<=fe,Se=pe>=-fe&&pe<=fe;let ge,Te;if(me&&Se){const Ke=this.center.lng*Math.PI/180,Ve=this.center.lat*Math.PI/180;l.bN(Z,Ke)+l.bN(ne,Ve)<l.bN(q,Ke)+l.bN(pe,Ve)?(ge=Z,Te=ne):(ge=q,Te=pe)}else if(me)ge=Z,Te=ne;else{if(!Se)return;ge=q,Te=pe}const Me=ge/Math.PI*180,be=Te/Math.PI*180,ze=this.center.lat;this.setCenter(new l.V(Me,l.an(be,-90,90))),this.setZoom(this.zoom+Un(ze,this.center.lat))}locationToScreenPoint(t,a){const d=In(t);if(a){const g=a.getElevationForLngLatZoom(t,this._helper._tileZoom);l.a$(d,d,1+g/l.bE)}return this._projectSurfacePointToScreen(d)}_projectSurfacePointToScreen(t){const a=l.bF();return l.aH(a,[...t,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],new l.P((.5*a[0]+.5)*this.width,(.5*-a[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,a){if(a){const d=a.pointCoordinate(t);if(d)return d}return l.a9.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,a){var d;return(d=this.screenPointToMercatorCoordinate(t,a))===null||d===void 0?void 0:d.toLngLat()}isPointOnMapSurface(t,a){const d=this._cameraPosition,g=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(d,g)}getRayDirectionFromPixel(t){const a=l.bF();a[0]=t.x/this.width*2-1,a[1]=-1*(t.y/this.height*2-1),a[2]=1,a[3]=1,l.aH(a,a,this._globeViewProjMatrixNoCorrectionInverted),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];const d=l.bz();d[0]=a[0]-this._cameraPosition[0],d[1]=a[1]-this._cameraPosition[1],d[2]=a[2]-this._cameraPosition[2];const g=l.bz();return l.b3(g,d),g}isSurfacePointVisible(t){const a=this._cachedClippingPlane;return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const a=l.bF();return l.aH(a,[...t,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],a[0]>-1&&a[0]<1&&a[1]>-1&&a[1]<1&&a[2]>-1&&a[2]<1}rayPlanetIntersection(t,a){const d=l.b5(t,a),g=l.bz(),w=l.bz();l.a$(w,a,d),l.b2(g,t,w);const P=1-l.b5(g,g);if(P<0)return null;const E=l.b5(t,t)-1,k=-d+(d<0?1:-1)*Math.sqrt(P),z=E/k,N=k;return{tMin:Math.min(z,N),tMax:Math.max(z,N)}}unprojectScreenPoint(t){const a=this._cameraPosition,d=this.getRayDirectionFromPixel(t),g=this.rayPlanetIntersection(a,d);if(g){const N=l.bz();l.b0(N,a,[d[0]*g.tMin,d[1]*g.tMin,d[2]*g.tMin]);const Z=l.bz();return l.b3(Z,N),Ud(Z)}const w=this._cachedClippingPlane,P=w[0]*d[0]+w[1]*d[1]+w[2]*d[2],E=-l.bb(w,a)/P,k=l.bz();if(E>0)l.b0(k,a,[d[0]*E,d[1]*E,d[2]*E]);else{const N=l.bz();l.b0(N,a,[2*d[0],2*d[1],2*d[2]]);const Z=l.bb(this._cachedClippingPlane,N);l.b2(k,N,[this._cachedClippingPlane[0]*Z,this._cachedClippingPlane[1]*Z,this._cachedClippingPlane[2]*Z])}const z=(function(N){const Z=l.bz();return Z[0]=N[0]*-N[3],Z[1]=N[1]*-N[3],Z[2]=N[2]*-N[3],{center:Z,radius:Math.sqrt(1-N[3]*N[3])}})(w);return Ud((function(N,Z,q){const Y=l.bz();l.b2(Y,q,N);const ne=l.bz();return l.bA(ne,N,Y,Z/l.b9(Y)),ne})(z.center,z.radius,k))}getMatrixForModel(t,a){const d=l.V.convert(t),g=1/l.bE,w=l.bj();return l.bJ(w,w,d.lng/180*Math.PI),l.bh(w,w,-d.lat/180*Math.PI),l.O(w,w,[0,0,1+a/l.bE]),l.bh(w,w,.5*Math.PI),l.Q(w,w,[g,g,g]),w}getProjectionDataForCustomLayer(t=!0){const a=this.getProjectionData({overscaledTileID:new l.a2(0,0,0,0,0),applyGlobeMatrix:t});return a.tileMercatorCoords=[0,0,1,1],a}getFastPathSimpleProjectionMatrix(t){}}class bc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,d){return this._helper.interpolatePadding(t,a,d)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a,d=!0){this._helper.resize(t,a,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,a){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=a,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(t){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(a,d)=>this.currentTransform.defaultConstrain(a,d),this.applyConstrain=(a,d)=>this._helper.applyConstrain(a,d),this._helper=new oo({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,d)=>this.defaultConstrain(a,d)},t),this._globeness=1,this._mercatorTransform=new pl,this._verticalPerspectiveTransform=new Oa}clone(){const t=new bc;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this,!1),t}apply(t,a){this._helper.apply(t,a),this._mercatorTransform.apply(this,!1),this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const a=this._mercatorTransform.getProjectionData(t),d=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?d.mainMatrix:a.mainMatrix,clippingPlane:d.clippingPlane,tileMercatorCoords:d.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:a.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return l.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return l.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,a,d){const g=this._mercatorTransform.getPitchedTextCorrection(t,a,d),w=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,a,d);return l.bu(g,w,this._globeness)}projectTileCoordinates(t,a,d,g){return this.currentTransform.projectTileCoordinates(t,a,d,g)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,a){return this.currentTransform.lngLatToCameraDepth(t,a)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(t,a,d,g){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,d,g)}setLocationAtPoint(t,a){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,a),void this.apply(this._mercatorTransform,!1);this._verticalPerspectiveTransform.setLocationAtPoint(t,a),this.apply(this._verticalPerspectiveTransform,!1)}locationToScreenPoint(t,a){return this.currentTransform.locationToScreenPoint(t,a)}screenPointToMercatorCoordinate(t,a){return this.currentTransform.screenPointToMercatorCoordinate(t,a)}screenPointToLocation(t,a){return this.currentTransform.screenPointToLocation(t,a)}isPointOnMapSurface(t,a){return this.currentTransform.isPointOnMapSurface(t,a)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,a){return this.currentTransform.getMatrixForModel(t,a)}getProjectionDataForCustomLayer(t=!0){const a=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return a;const d=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return d.fallbackMatrix=a.mainMatrix,d}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class si{get useGlobeControls(){return!0}handlePanInertia(t,a){const d=np(t,a);return Math.abs(d.lng-a.center.lng)>180&&(d.lng=a.center.lng+179.5*Math.sign(d.lng-a.center.lng)),{easingCenter:d,easingOffset:new l.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,a){const d=t.around,g=a.screenPointToLocation(d);t.bearingDelta&&a.setBearing(a.bearing+t.bearingDelta),t.pitchDelta&&a.setPitch(a.pitch+t.pitchDelta),t.rollDelta&&a.setRoll(a.roll+t.rollDelta);const w=a.zoom;t.zoomDelta&&a.setZoom(a.zoom+t.zoomDelta);const P=a.zoom-w;if(P===0)return;const E=l.bK(a.center.lng,g.lng),k=E/(Math.abs(E/180)+1),z=l.bK(a.center.lat,g.lat),N=a.getRayDirectionFromPixel(d),Z=a.cameraPosition,q=-1*l.b5(Z,N),Y=l.bz();l.b0(Y,Z,[N[0]*q,N[1]*q,N[2]*q]);const ne=l.b7(Y)-1,de=Math.exp(.5*-Math.max(ne-.3,0)),pe=ml(a.worldSize,a.center.lat)/Math.min(a.width,a.height),fe=l.bx(pe,.9,.5,1,.25),me=(1-l.aq(-P))*Math.min(de,fe),Se=a.center.lat,ge=a.zoom,Te=new l.V(a.center.lng+k*me,l.an(a.center.lat+z*me,-l.ao,l.ao));a.setLocationAtPoint(g,d);const Me=a.center,be=l.bx(Math.abs(E),45,85,0,1),ze=l.bx(pe,.75,.35,0,1),Ke=Math.pow(Math.max(be,ze),.25),Ve=l.bK(Me.lng,Te.lng),Ge=l.bK(Me.lat,Te.lat);a.setCenter(new l.V(Me.lng+Ve*Ke,Me.lat+Ge*Ke).wrap()),a.setZoom(ge+Un(Se,a.center.lat))}handleMapControlsPan(t,a,d){if(!t.panDelta)return;const g=a.center.lat,w=a.zoom;a.setCenter(np(t.panDelta,a).wrap()),a.setZoom(w+Un(g,a.center.lat))}cameraForBoxAndBearing(t,a,d,g,w){const P=fu(t,a,d,g,w),E=a.left/w.width*2-1,k=(w.width-a.right)/w.width*2-1,z=a.top/w.height*-2+1,N=(w.height-a.bottom)/w.height*-2+1,Z=l.bK(d.getWest(),d.getEast())<0,q=Z?d.getEast():d.getWest(),Y=Z?d.getWest():d.getEast(),ne=Math.max(d.getNorth(),d.getSouth()),de=Math.min(d.getNorth(),d.getSouth()),pe=q+.5*l.bK(q,Y),fe=ne+.5*l.bK(ne,de),me=w.clone();me.setCenter(P.center),me.setBearing(P.bearing),me.setPitch(0),me.setRoll(0),me.setZoom(P.zoom);const Se=me.modelViewProjectionMatrix,ge=[In(d.getNorthWest()),In(d.getNorthEast()),In(d.getSouthWest()),In(d.getSouthEast()),In(new l.V(Y,fe)),In(new l.V(q,fe)),In(new l.V(pe,ne)),In(new l.V(pe,de))],Te=In(P.center);let Me=Number.POSITIVE_INFINITY;for(const be of ge)E<0&&(Me=si.getLesserNonNegativeNonNull(Me,si.solveVectorScale(be,Te,Se,"x",E))),k>0&&(Me=si.getLesserNonNegativeNonNull(Me,si.solveVectorScale(be,Te,Se,"x",k))),z>0&&(Me=si.getLesserNonNegativeNonNull(Me,si.solveVectorScale(be,Te,Se,"y",z))),N<0&&(Me=si.getLesserNonNegativeNonNull(Me,si.solveVectorScale(be,Te,Se,"y",N)));if(Number.isFinite(Me)&&Me!==0)return P.zoom=me.zoom+l.at(Me),P;ao()}handleJumpToCenterZoom(t,a){const d=t.center.lat,g=t.applyConstrain(a.center?l.V.convert(a.center):t.center,t.zoom).center;t.setCenter(g.wrap());const w=a.zoom!==void 0?+a.zoom:t.zoom+Un(d,g.lat);t.zoom!==w&&t.setZoom(w)}handleEaseTo(t,a){const d=t.zoom,g=t.center,w=t.padding,P={roll:t.roll,pitch:t.pitch,bearing:t.bearing},E={roll:a.roll===void 0?t.roll:a.roll,pitch:a.pitch===void 0?t.pitch:a.pitch,bearing:a.bearing===void 0?t.bearing:a.bearing},k=a.zoom!==void 0,z=!t.isPaddingEqual(a.padding);let N=!1;const Z=a.center?l.V.convert(a.center):g,q=t.applyConstrain(Z,d).center;La(t,q);const Y=t.clone();Y.setCenter(q),Y.setZoom(k?+a.zoom:d+Un(g.lat,Z.lat)),Y.setBearing(a.bearing);const ne=new l.P(l.an(t.centerPoint.x+a.offsetAsPoint.x,0,t.width),l.an(t.centerPoint.y+a.offsetAsPoint.y,0,t.height));Y.setLocationAtPoint(q,ne);const de=(a.offset&&a.offsetAsPoint.mag())>0?Y.center:q,pe=k?+a.zoom:d+Un(g.lat,de.lat),fe=d+Un(g.lat,0),me=pe+Un(de.lat,0),Se=l.bK(g.lng,de.lng),ge=l.bK(g.lat,de.lat),Te=l.aq(me-fe);return N=pe!==d,{easeFunc:Me=>{if(l.bo(P,E)||du({startEulerAngles:P,endEulerAngles:E,tr:t,k:Me,useSlerp:P.roll!=E.roll}),z&&t.interpolatePadding(w,a.padding,Me),a.around)l.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(a.around,a.aroundPoint);else{const be=me>fe?Math.min(2,Te):Math.max(.5,Te),ze=Math.pow(be,1-Me),Ke=ip(g,Se,ge,Me*ze);t.setCenter(Ke.wrap())}if(N){const be=l.G.number(fe,me,Me)+Un(0,t.center.lat);t.setZoom(be)}},isZooming:N,elevationCenter:de}}handleFlyTo(t,a){const d=a.zoom!==void 0,g=t.center,w=t.zoom,P=t.padding,E=!t.isPaddingEqual(a.padding),k=t.applyConstrain(l.V.convert(a.center||a.locationAtOffset),w).center,z=d?+a.zoom:t.zoom+Un(t.center.lat,k.lat),N=t.clone();N.setCenter(k),N.setZoom(z),N.setBearing(a.bearing);const Z=new l.P(l.an(t.centerPoint.x+a.offsetAsPoint.x,0,t.width),l.an(t.centerPoint.y+a.offsetAsPoint.y,0,t.height));N.setLocationAtPoint(k,Z);const q=N.center;La(t,q);const Y=(function(ge,Te,Me){const be=In(Te),ze=In(Me),Ke=l.b5(be,ze),Ve=Math.acos(Ke),Ge=Si(ge);return Ve/(2*Math.PI)*Ge})(t,g,q),ne=w+Un(g.lat,0),de=z+Un(q.lat,0),pe=l.aq(de-ne);let fe;if(typeof a.minZoom=="number"){const ge=+a.minZoom+Un(q.lat,0),Te=Math.min(ge,ne,de)+Un(0,q.lat),Me=t.applyConstrain(q,Te).zoom+Un(q.lat,0);fe=l.aq(Me-ne)}const me=l.bK(g.lng,q.lng),Se=l.bK(g.lat,q.lat);return{easeFunc:(ge,Te,Me,be)=>{const ze=ip(g,me,Se,Me);E&&t.interpolatePadding(P,a.padding,ge);const Ke=ge===1?q:ze;t.setCenter(Ke.wrap());const Ve=ne+l.at(Te);t.setZoom(ge===1?z:Ve+Un(0,Ke.lat))},scaleOfZoom:pe,targetCenter:q,scaleOfMinZoom:fe,pixelPathLength:Y}}static solveVectorScale(t,a,d,g,w){const P=g==="x"?[d[0],d[4],d[8],d[12]]:[d[1],d[5],d[9],d[13]],E=[d[3],d[7],d[11],d[15]],k=t[0]*P[0]+t[1]*P[1]+t[2]*P[2],z=t[0]*E[0]+t[1]*E[1]+t[2]*E[2],N=a[0]*P[0]+a[1]*P[1]+a[2]*P[2],Z=a[0]*E[0]+a[1]*E[1]+a[2]*E[2];return N+w*z===k+w*Z||E[3]*(k-N)+P[3]*(Z-z)+k*Z==N*z?null:(N+P[3]-w*Z-w*E[3])/(N-k-w*Z+w*z)}static getLesserNonNegativeNonNull(t,a){return a!==null&&a>=0&&a<t?a:t}}class sp{constructor(t){this._globe=t,this._mercatorCameraHelper=new za,this._verticalPerspectiveCameraHelper=new si}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,a){return this.currentHelper.handlePanInertia(t,a)}handleMapControlsRollPitchBearingZoom(t,a){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,a)}handleMapControlsPan(t,a,d){this.currentHelper.handleMapControlsPan(t,a,d)}cameraForBoxAndBearing(t,a,d,g,w){return this.currentHelper.cameraForBoxAndBearing(t,a,d,g,w)}handleJumpToCenterZoom(t,a){this.currentHelper.handleJumpToCenterZoom(t,a)}handleEaseTo(t,a){return this.currentHelper.handleEaseTo(t,a)}handleFlyTo(t,a){return this.currentHelper.handleFlyTo(t,a)}}const _l=(b,t)=>l.B(b,t&&t.filter((a=>a.identifier!=="source.canvas"))),yu=l.bO();class vl extends l.E{constructor(t,a={}){var d,g;super(),this._rtlPluginLoaded=()=>{for(const P in this.tileManagers){const E=this.tileManagers[P].getSource().type;E!=="vector"&&E!=="geojson"||this.tileManagers[P].reload()}},this.map=t,this.dispatcher=new cr(yr(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((P,E)=>this.getGlyphs(P,E))),this.dispatcher.registerMessageHandler("GI",((P,E)=>this.getImages(P,E))),this.dispatcher.registerMessageHandler("GDA",((P,E)=>this.getDashes(P,E))),this.imageManager=new lt,this.imageManager.setEventedParent(this);const w=((d=t._container)===null||d===void 0?void 0:d.lang)||typeof document<"u"&&((g=document.documentElement)===null||g===void 0?void 0:g.lang)||void 0;this.glyphManager=new mt(t._requestManager,a.localIdeographFontFamily,w),this.lineAtlas=new nr(256,512),this.crossTileSymbolIndex=new wi,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",l.bP()),Oe().on(we,this._rtlPluginLoaded),this.on("data",(P=>{if(P.dataType!=="source"||P.sourceDataType!=="metadata")return;const E=this.tileManagers[P.sourceId];if(!E)return;const k=E.getSource();if(k&&k.vectorLayerIds)for(const z in this._layers){const N=this._layers[z];N.source===k.id&&this._validateLayer(N)}}))}_setInitialValues(){var t;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new l.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((t=this.crossTileSymbolIndex)===null||t===void 0?void 0:t.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(t,a){var d,g,w;this._checkLoaded();const P=a===null?(w=(g=(d=this.stylesheet.state)===null||d===void 0?void 0:d[t])===null||g===void 0?void 0:g.default)!==null&&w!==void 0?w:null:a;if(l.bR(P,this._globalState[t]))return this;this._globalState[t]=P,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const a=[];for(const d in t)!l.bR(this._globalState[d],t[d].default)&&(a.push(d),this._globalState[d]=t[d].default);this._applyGlobalStateChanges(a)}_applyGlobalStateChanges(t){if(t.length===0)return;const a=new Set,d={};for(const g of t){d[g]=this._globalState[g];for(const w in this._layers){const P=this._layers[w],E=P.getLayoutAffectingGlobalStateRefs(),k=P.getPaintAffectingGlobalStateRefs(),z=P.getVisibilityAffectingGlobalStateRefs();if(E.has(g)&&a.add(P.source),k.has(g))for(const{name:N,value:Z}of k.get(g))this._updatePaintProperty(P,N,Z);z?.has(g)&&(P.recalculateVisibility(),this._updateLayer(P))}}this.dispatcher.broadcast("UGS",d);for(const g in this.tileManagers)a.has(g)&&(this._reloadSource(g),this._changed=!0)}loadURL(t,a={},d){this.fire(new l.l("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const g=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const w=this._loadStyleRequest;l.j(g,this._loadStyleRequest).then((P=>{this._loadStyleRequest=null,this._load(P.data,a,d)})).catch((P=>{this._loadStyleRequest=null,P&&!w.signal.aborted&&this.fire(new l.k(P))}))}loadJSON(t,a={},d){this.fire(new l.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,re.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(t,a,d)})).catch((()=>{}))}loadEmpty(){this.fire(new l.l("dataloading",{dataType:"style"})),this._load(yu,{validate:!1})}_load(t,a,d){var g,w;let P=a.transformStyle?a.transformStyle(d,t):t;if(!a.validate||!_l(this,l.C(P))){P=Object.assign({},P),this._loaded=!0,this.stylesheet=P;for(const E in P.sources)this.addSource(E,P.sources[E],{validate:!1});P.sprite?this._loadSprite(P.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(P.glyphs),this._createLayers(),this.light=new _t(this.stylesheet.light),this._setProjectionInternal(((g=this.stylesheet.projection)===null||g===void 0?void 0:g.type)||"mercator"),this.sky=new at(this.stylesheet.sky),this.map.setTerrain((w=this.stylesheet.terrain)!==null&&w!==void 0?w:null),this.fire(new l.l("data",{dataType:"style"})),this.fire(new l.l("style.load"))}}_createLayers(){var t,a,d;const g=l.bS(this.stylesheet.layers);this.setGlobalState((t=this.stylesheet.state)!==null&&t!==void 0?t:null),this.dispatcher.broadcast("SL",g),this._order=g.map((w=>w.id)),this._layers={},this._serializedLayers=null;for(const w of g){const P=l.bT(w,this._globalState);if(P.setEventedParent(this,{layer:{id:w.id}}),this._layers[w.id]=P,l.bU(P)&&this.tileManagers[P.source]){const E=(d=(a=w.paint)===null||a===void 0?void 0:a["raster-fade-duration"])!==null&&d!==void 0?d:P.paint.get("raster-fade-duration");this.tileManagers[P.source].setRasterFadeDuration(E)}}}_loadSprite(t,a=!1,d=void 0){this.imageManager.setLoaded(!1);const g=new AbortController;let w;this._spriteRequest=g,(function(P,E,k,z){return l._(this,void 0,void 0,(function*(){const N=Pt(P),Z=k>1?"@2x":"",q={},Y={};for(const{id:ne,url:de}of N){const pe=E.transformRequest(Ct(de,Z,".json"),"SpriteJSON");q[ne]=l.j(pe,z);const fe=E.transformRequest(Ct(de,Z,".png"),"SpriteImage");Y[ne]=He.getImage(fe,z)}return yield Promise.all([...Object.values(q),...Object.values(Y)]),(function(ne,de){return l._(this,void 0,void 0,(function*(){const pe={};for(const fe in ne){pe[fe]={};const me=re.getImageCanvasContext((yield de[fe]).data),Se=(yield ne[fe]).data;for(const ge in Se){const{width:Te,height:Me,x:be,y:ze,sdf:Ke,pixelRatio:Ve,stretchX:Ge,stretchY:qe,content:vt,textFitWidth:bt,textFitHeight:ct}=Se[ge];pe[fe][ge]={data:null,pixelRatio:Ve,sdf:Ke,stretchX:Ge,stretchY:qe,content:vt,textFitWidth:bt,textFitHeight:ct,spriteData:{width:Te,height:Me,x:be,y:ze,context:me}}}}return pe}))})(q,Y)}))})(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((P=>{if(this._spriteRequest=null,P)for(const E in P){this._spritesImagesIds[E]=[];const k=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter((z=>!(z in P))):[];for(const z of k)this.imageManager.removeImage(z),this._changedImages[z]=!0;for(const z in P[E]){const N=E==="default"?z:`${E}:${z}`;this._spritesImagesIds[E].push(N),N in this.imageManager.images?this.imageManager.updateImage(N,P[E][z],!1):this.imageManager.addImage(N,P[E][z]),a&&(this._changedImages[N]=!0)}}})).catch((P=>{this._spriteRequest=null,w=P,g.signal.aborted||this.fire(new l.k(w))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"})),d&&d(w)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}_validateLayer(t){const a=this.tileManagers[t.source];if(!a)return;const d=t.sourceLayer;if(!d)return;const g=a.getSource();(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(d)===-1)&&this.fire(new l.k(new Error(`Source layer "${d}" does not exist on source "${g.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.tileManagers)if(!this.tileManagers[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,a=!1){const d=this._serializedAllLayers();if(!t||t.length===0)return Object.values(a?l.bV(d):d);const g=[];for(const w of t)if(d[w]){const P=a?l.bV(d[w]):d[w];g.push(P)}return g}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const a=Object.keys(this._layers);for(const d of a){const g=this._layers[d];g.type!=="custom"&&(t[d]=g.serialize())}return t}hasTransitions(){var t,a,d;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((a=this.sky)===null||a===void 0)&&a.hasTransition()||!((d=this.projection)===null||d===void 0)&&d.hasTransition())return!0;for(const g in this.tileManagers)if(this.tileManagers[g].hasTransition())return!0;for(const g in this._layers)if(this._layers[g].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const a=this._changed;if(a){const g=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(g.length||w.length)&&this._updateWorkerLayers(g,w);for(const P in this._updatedSources){const E=this._updatedSources[P];if(E==="reload")this._reloadSource(P);else{if(E!=="clear")throw new Error(`Invalid action ${E}`);this._clearSource(P)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const d={};for(const g in this.tileManagers){const w=this.tileManagers[g];d[g]=w.used,w.used=!1}for(const g of this._order){const w=this._layers[g];w.recalculate(t,this._availableImages),!w.isHidden(t.zoom)&&w.source&&(this.tileManagers[w.source].used=!0)}for(const g in d){const w=this.tileManagers[g];!!d[g]!=!!w.used&&w.fire(new l.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,a&&this.fire(new l.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const a in this.tileManagers)this.tileManagers[a].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.tileManagers)this.tileManagers[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,a={}){var d;this._checkLoaded();const g=this.serialize();if(t=a.transformStyle?a.transformStyle(g,t):t,((d=a.validate)===null||d===void 0||d)&&_l(this,l.C(t)))return!1;(t=l.bV(t)).layers=l.bS(t.layers);const w=l.bW(g,t),P=this._getOperationsToPerform(w);if(P.unimplemented.length>0)throw new Error(`Unimplemented: ${P.unimplemented.join(", ")}.`);if(P.operations.length===0)return!1;for(const E of P.operations)E();return this.stylesheet=t,this._serializedLayers=null,this.fire(new l.l("style.load",{style:this})),!0}_getOperationsToPerform(t){const a=[],d=[];for(const g of t)switch(g.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":a.push((()=>this.addLayer.apply(this,g.args)));break;case"removeLayer":a.push((()=>this.removeLayer.apply(this,g.args)));break;case"setPaintProperty":a.push((()=>this.setPaintProperty.apply(this,g.args)));break;case"setLayoutProperty":a.push((()=>this.setLayoutProperty.apply(this,g.args)));break;case"setFilter":a.push((()=>this.setFilter.apply(this,g.args)));break;case"addSource":a.push((()=>this.addSource.apply(this,g.args)));break;case"removeSource":a.push((()=>this.removeSource.apply(this,g.args)));break;case"setLayerZoomRange":a.push((()=>this.setLayerZoomRange.apply(this,g.args)));break;case"setLight":a.push((()=>this.setLight.apply(this,g.args)));break;case"setGeoJSONSourceData":a.push((()=>this.setGeoJSONSourceData.apply(this,g.args)));break;case"setGlyphs":a.push((()=>this.setGlyphs.apply(this,g.args)));break;case"setSprite":a.push((()=>this.setSprite.apply(this,g.args)));break;case"setTerrain":a.push((()=>this.map.setTerrain.apply(this,g.args)));break;case"setSky":a.push((()=>this.setSky.apply(this,g.args)));break;case"setProjection":this.setProjection.apply(this,g.args);break;case"setGlobalState":a.push((()=>this.setGlobalState.apply(this,g.args)));break;case"setTransition":a.push((()=>{}));break;default:d.push(g.command)}return{operations:a,unimplemented:d}}addImage(t,a){if(this.getImage(t))return this.fire(new l.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,a),this._afterImageUpdated(t)}updateImage(t,a){this.imageManager.updateImage(t,a)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new l.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,a,d={}){if(this._checkLoaded(),this.tileManagers[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(l.C.source,`sources.${t}`,a,null,d))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const g=this.tileManagers[t]=new Ls(t,a,this.dispatcher);g.style=this,g.setEventedParent(this,(()=>({isSourceLoaded:g.loaded(),source:g.serialize(),sourceId:t}))),g.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===t)return this.fire(new l.k(new Error(`Source "${t}" cannot be removed while layer "${d}" is using it.`)));const a=this.tileManagers[t];delete this.tileManagers[t],delete this._updatedSources[t],a.fire(new l.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,a){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const d=this.tileManagers[t].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(a),this._changed=!0}getSource(t){return this.tileManagers[t]&&this.tileManagers[t].getSource()}addLayer(t,a,d={}){this._checkLoaded();const g=t.id;if(this.getLayer(g))return void this.fire(new l.k(new Error(`Layer "${g}" already exists on this map.`)));let w;if(t.type==="custom"){if(_l(this,l.bX(t)))return;w=l.bT(t,this._globalState)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(g,t.source),t=l.bV(t),t=l.e(t,{source:g})),this._validate(l.C.layer,`layers.${g}`,t,{arrayIndex:-1},d))return;w=l.bT(t,this._globalState),this._validateLayer(w),w.setEventedParent(this,{layer:{id:g}})}const P=a?this._order.indexOf(a):this._order.length;if(a&&P===-1)this.fire(new l.k(new Error(`Cannot add layer "${g}" before non-existing layer "${a}".`)));else{if(this._order.splice(P,0,g),this._layerOrderChanged=!0,this._layers[g]=w,this._removedLayers[g]&&w.source&&w.type!=="custom"){const E=this._removedLayers[g];delete this._removedLayers[g],E.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.tileManagers[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}moveLayer(t,a){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new l.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===a)return;const d=this._order.indexOf(t);this._order.splice(d,1);const g=a?this._order.indexOf(a):this._order.length;a&&g===-1?this.fire(new l.k(new Error(`Cannot move layer "${t}" before non-existing layer "${a}".`))):(this._order.splice(g,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const a=this._layers[t];if(!a)return void this.fire(new l.k(new Error(`Cannot remove non-existing layer "${t}".`)));a.setEventedParent(null);const d=this._order.indexOf(t);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=a,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],a.onRemove&&a.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,a,d){this._checkLoaded();const g=this.getLayer(t);g?g.minzoom===a&&g.maxzoom===d||(a!=null&&(g.minzoom=a),d!=null&&(g.maxzoom=d),this._updateLayer(g)):this.fire(new l.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,a,d={}){this._checkLoaded();const g=this.getLayer(t);if(g){if(!l.bR(g.filter,a))return a==null?(g.setFilter(void 0),void this._updateLayer(g)):void(this._validate(l.C.filter,`layers.${g.id}.filter`,a,null,d)||(g.setFilter(l.bV(a)),this._updateLayer(g)))}else this.fire(new l.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return l.bV(this.getLayer(t).filter)}setLayoutProperty(t,a,d,g={}){this._checkLoaded();const w=this.getLayer(t);w?l.bR(w.getLayoutProperty(a),d)||(w.setLayoutProperty(a,d,g),this._updateLayer(w)):this.fire(new l.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,a){const d=this.getLayer(t);if(d)return d.getLayoutProperty(a);this.fire(new l.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,a,d,g={}){this._checkLoaded();const w=this.getLayer(t);w?l.bR(w.getPaintProperty(a),d)||this._updatePaintProperty(w,a,d,g):this.fire(new l.k(new Error(`Cannot style non-existing layer "${t}".`)))}_updatePaintProperty(t,a,d,g={}){t.setPaintProperty(a,d,g)&&this._updateLayer(t),l.bU(t)&&a==="raster-fade-duration"&&this.tileManagers[t.source].setRasterFadeDuration(d),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,a){return this.getLayer(t).getPaintProperty(a)}setFeatureState(t,a){this._checkLoaded();const d=t.source,g=t.sourceLayer,w=this.tileManagers[d];if(w===void 0)return void this.fire(new l.k(new Error(`The source '${d}' does not exist in the map's style.`)));const P=w.getSource().type;P==="geojson"&&g?this.fire(new l.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):P!=="vector"||g?(t.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),w.setFeatureState(g,t.id,a)):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,a){this._checkLoaded();const d=t.source,g=this.tileManagers[d];if(g===void 0)return void this.fire(new l.k(new Error(`The source '${d}' does not exist in the map's style.`)));const w=g.getSource().type,P=w==="vector"?t.sourceLayer:void 0;w!=="vector"||P?a&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new l.k(new Error("A feature id is required to remove its specific state property."))):g.removeFeatureState(P,t.id,a):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const a=t.source,d=t.sourceLayer,g=this.tileManagers[a];if(g!==void 0)return g.getSource().type!=="vector"||d?(t.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),g.getFeatureState(d,t.id)):void this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.k(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return l.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=l.bY(this.tileManagers,(w=>w.serialize())),a=this._serializeByIds(this._order,!0),d=this.map.getTerrain()||void 0,g=this.stylesheet;return l.bZ({version:g.version,name:g.name,metadata:g.metadata,light:g.light,sky:g.sky,center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,sprite:g.sprite,glyphs:g.glyphs,transition:g.transition,projection:g.projection,sources:t,layers:a,terrain:d},(w=>w!==void 0))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.tileManagers[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.tileManagers[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const a=P=>this._layers[P].type==="fill-extrusion",d={},g=[];for(let P=this._order.length-1;P>=0;P--){const E=this._order[P];if(a(E)){d[E]=P;for(const k of t){const z=k[E];if(z)for(const N of z)g.push(N)}}}g.sort(((P,E)=>E.intersectionZ-P.intersectionZ));const w=[];for(let P=this._order.length-1;P>=0;P--){const E=this._order[P];if(a(E))for(let k=g.length-1;k>=0;k--){const z=g[k].feature;if(d[z.layer.id]<P)break;w.push(z),g.pop()}else for(const k of t){const z=k[E];if(z)for(const N of z)w.push(N.feature)}}return w}queryRenderedFeatures(t,a,d){a&&a.filter&&this._validate(l.C.filter,"queryRenderedFeatures.filter",a.filter,null,a);const g={};if(a&&a.layers){if(!(Array.isArray(a.layers)||a.layers instanceof Set))return this.fire(new l.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const z of a.layers){const N=this._layers[z];if(!N)return this.fire(new l.k(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];g[N.source]=!0}}const w=[];a.availableImages=this._availableImages;const P=this._serializedAllLayers(),E=a.layers instanceof Set?a.layers:Array.isArray(a.layers)?new Set(a.layers):null,k=Object.assign(Object.assign({},a),{layers:E,globalState:this._globalState});for(const z in this.tileManagers)a.layers&&!g[z]||w.push(Fn(this.tileManagers[z],this._layers,P,t,k,d,this.map.terrain?(N,Z,q)=>this.map.terrain.getElevation(N,Z,q):void 0));return this.placement&&w.push((function(z,N,Z,q,Y,ne,de){const pe={},fe=ne.queryRenderedSymbols(q),me=[];for(const Se of Object.keys(fe).map(Number))me.push(de[Se]);me.sort(en);for(const Se of me){const ge=Se.featureIndex.lookupSymbolFeatures(fe[Se.bucketInstanceId],N,Se.bucketIndex,Se.sourceLayerIndex,{filterSpec:Y.filter,globalState:Y.globalState},Y.layers,Y.availableImages,z);for(const Te in ge){const Me=pe[Te]=pe[Te]||[],be=ge[Te];be.sort(((ze,Ke)=>{const Ve=Se.featureSortOrder;if(Ve){const Ge=Ve.indexOf(ze.featureIndex);return Ve.indexOf(Ke.featureIndex)-Ge}return Ke.featureIndex-ze.featureIndex}));for(const ze of be)Me.push(ze)}}return(function(Se,ge,Te){for(const Me in Se)for(const be of Se[Me])ni(be,Te[ge[Me].source]);return Se})(pe,z,Z)})(this._layers,P,this.tileManagers,t,k,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(t,a){a?.filter&&this._validate(l.C.filter,"querySourceFeatures.filter",a.filter,null,a);const d=this.tileManagers[t];return d?(function(g,w){const P=g.getRenderableIds().map((z=>g.getTileByID(z))),E=[],k={};for(let z=0;z<P.length;z++){const N=P[z],Z=N.tileID.canonical.key;k[Z]||(k[Z]=!0,N.querySourceFeatures(E,w))}return E})(d,a?Object.assign(Object.assign({},a),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t,a={}){this._checkLoaded();const d=this.light.getLight();let g=!1;for(const P in t)if(!l.bR(t[P],d[P])){g=!0;break}if(!g)return;const w={now:Q(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,a),this.light.updateTransitions(w)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,a={}){this._checkLoaded();const d=this.getSky();let g=!1;if(!t&&!d)return;if(t&&!d)g=!0;else if(!t&&d)g=!0;else for(const P in t)if(!l.bR(t[P],d[P])){g=!0;break}if(!g)return;const w={now:Q(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,a),this.sky.updateTransitions(w)}_setProjectionInternal(t){const a=(function(d,g){const w={constrainOverride:g};if(Array.isArray(d)){const P=new vc({type:d});return{projection:P,transform:new bc(w),cameraHelper:new sp(P)}}switch(d){case"mercator":return{projection:new Ti,transform:new pl(w),cameraHelper:new za};case"globe":{const P=new vc({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:P,transform:new bc(w),cameraHelper:new sp(P)}}case"vertical-perspective":return{projection:new mu,transform:new Oa(w),cameraHelper:new si};default:return l.w(`Unknown projection name: ${d}. Falling back to mercator projection.`),{projection:new Ti,transform:new pl(w),cameraHelper:new za}}})(t,this.map.transformConstrain);this.projection=a.projection,this.map.migrateProjection(a.transform,a.cameraHelper);for(const d in this.tileManagers)this.tileManagers[d].reload()}_validate(t,a,d,g,w={}){return(!w||w.validate!==!1)&&_l(this,t.call(l.C,l.e({key:a,style:this.serialize(),value:d,styleSpec:l.u},g)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Oe().off(we,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.tileManagers){const d=this.tileManagers[a];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.tileManagers[t].clearTiles()}_reloadSource(t){this.tileManagers[t].resume(),this.tileManagers[t].reload()}_updateSources(t){for(const a in this.tileManagers)this.tileManagers[a].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.tileManagers)this._reloadSource(t)}_updatePlacement(t,a,d,g,w=!1){let P=!1,E=!1;const k={};for(const z of this._order){const N=this._layers[z];if(N.type!=="symbol")continue;if(!k[N.source]){const q=this.tileManagers[N.source];k[N.source]=q.getRenderableIds(!0).map((Y=>q.getTileByID(Y))).sort(((Y,ne)=>ne.tileID.overscaledZ-Y.tileID.overscaledZ||(Y.tileID.isLessThan(ne.tileID)?-1:1)))}const Z=this.crossTileSymbolIndex.addLayer(N,k[N.source],t.center.lng);P=P||Z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Q(),t.zoom))&&(this.pauseablePlacement=new Da(t,this.map.terrain,this._order,w,a,d,g,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Q()),E=!0),P&&this.pauseablePlacement.placement.setStale()),E||P)for(const z of this._order){const N=this._layers[z];N.type==="symbol"&&this.placement.updateLayerOpacities(N,k[N.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Q())}_releaseSymbolFadeTiles(){for(const t in this.tileManagers)this.tileManagers[t].releaseSymbolFadeTiles()}getImages(t,a){return l._(this,void 0,void 0,(function*(){const d=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const g=this.tileManagers[a.source];return g&&g.setDependencies(a.tileID.key,a.type,a.icons),d}))}getGlyphs(t,a){return l._(this,void 0,void 0,(function*(){const d=yield this.glyphManager.getGlyphs(a.stacks),g=this.tileManagers[a.source];return g&&g.setDependencies(a.tileID.key,a.type,[""]),d}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,a={}){this._checkLoaded(),t&&this._validate(l.C.glyphs,"glyphs",t,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}getDashes(t,a){return l._(this,void 0,void 0,(function*(){const d={};for(const[g,w]of Object.entries(a.dashes))d[g]=this.lineAtlas.getDash(w.dasharray,w.round);return d}))}addSprite(t,a,d={},g){this._checkLoaded();const w=[{id:t,url:a}],P=[...Pt(this.stylesheet.sprite),...w];this._validate(l.C.sprite,"sprite",P,null,d)||(this.stylesheet.sprite=P,this._loadSprite(w,!0,g))}removeSprite(t){this._checkLoaded();const a=Pt(this.stylesheet.sprite);if(a.find((d=>d.id===t))){if(this._spritesImagesIds[t])for(const d of this._spritesImagesIds[t])this.imageManager.removeImage(d),this._changedImages[d]=!0;a.splice(a.findIndex((d=>d.id===t)),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}else this.fire(new l.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Pt(this.stylesheet.sprite)}setSprite(t,a={},d){this._checkLoaded(),t&&this._validate(l.C.sprite,"sprite",t,null,a)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,d):(this._unloadSprite(),d&&d(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const t in this.tileManagers){const a=this.tileManagers[t];a.setEventedParent(null),a.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const t in this._layers){const a=this._layers[t];a.setEventedParent(null),a.onRemove&&a.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var Rm=l.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class vh{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,a,d,g,w,P,E,k,z){this.context=t;let N=this.boundPaintVertexBuffers.length!==g.length;for(let Z=0;!N&&Z<g.length;Z++)this.boundPaintVertexBuffers[Z]!==g[Z]&&(N=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==d||N||this.boundIndexBuffer!==w||this.boundVertexOffset!==P||this.boundDynamicVertexBuffer!==E||this.boundDynamicVertexBuffer2!==k||this.boundDynamicVertexBuffer3!==z?this.freshBind(a,d,g,w,P,E,k,z):(t.bindVertexArray.set(this.vao),E&&E.bind(),w&&w.dynamicDraw&&w.bind(),k&&k.bind(),z&&z.bind())}freshBind(t,a,d,g,w,P,E,k){const z=t.numAttributes,N=this.context,Z=N.gl;this.vao&&this.destroy(),this.vao=N.createVertexArray(),N.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=g,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=E,this.boundDynamicVertexBuffer3=k,a.enableAttributes(Z,t);for(const q of d)q.enableAttributes(Z,t);P&&P.enableAttributes(Z,t),E&&E.enableAttributes(Z,t),k&&k.enableAttributes(Z,t),a.bind(),a.setVertexAttribPointers(Z,t,w);for(const q of d)q.bind(),q.setVertexAttribPointers(Z,t,w);P&&(P.bind(),P.setVertexAttribPointers(Z,t,w)),g&&g.bind(),E&&(E.bind(),E.setVertexAttribPointers(Z,t,w)),k&&(k.bind(),k.setVertexAttribPointers(Z,t,w)),N.currentNumAttributes=z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Lm=(b,t,a,d,g)=>({u_texture:0,u_ele_delta:b,u_fog_matrix:t,u_fog_color:a?a.properties.get("fog-color"):l.bp.white,u_fog_ground_blend:a?a.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:g?0:a?a.calculateFogBlendOpacity(d):0,u_horizon_color:a?a.properties.get("horizon-color"):l.bp.white,u_horizon_fog_blend:a?a.properties.get("horizon-fog-blend"):1,u_is_globe_mode:g?1:0}),wc={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function xh(b){const t=[];for(let a=0;a<b.length;a++){if(b[a]===null)continue;const d=b[a].split(" ");t.push(d.pop())}return t}class bh{constructor(t,a,d,g,w,P,E,k,z=[]){const N=t.gl;this.program=N.createProgram();const Z=xh(a.staticAttributes),q=d?d.getBinderAttributes():[],Y=Z.concat(q),ne=Yr.prelude.staticUniforms?xh(Yr.prelude.staticUniforms):[],de=E.staticUniforms?xh(E.staticUniforms):[],pe=a.staticUniforms?xh(a.staticUniforms):[],fe=d?d.getBinderUniforms():[],me=ne.concat(de).concat(pe).concat(fe),Se=[];for(const Ve of me)Se.indexOf(Ve)<0&&Se.push(Ve);const ge=d?d.defines():[];Nn(N)&&ge.unshift("#version 300 es"),w&&ge.push("#define OVERDRAW_INSPECTOR;"),P&&ge.push("#define TERRAIN3D;"),k&&ge.push(k),z&&ge.push(...z);let Te=ge.concat(Yr.prelude.fragmentSource,E.fragmentSource,a.fragmentSource).join(`
`),Me=ge.concat(Yr.prelude.vertexSource,E.vertexSource,a.vertexSource).join(`
`);Nn(N)||(Te=(function(Ve){return Ve.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(Te),Me=(function(Ve){return Ve.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(Me));const be=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(be,Te),N.compileShader(be),!N.getShaderParameter(be,N.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${N.getShaderInfoLog(be)}`);N.attachShader(this.program,be);const ze=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(ze,Me),N.compileShader(ze),!N.getShaderParameter(ze,N.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${N.getShaderInfoLog(ze)}`);N.attachShader(this.program,ze),this.attributes={};const Ke={};this.numAttributes=Y.length;for(let Ve=0;Ve<this.numAttributes;Ve++)Y[Ve]&&(N.bindAttribLocation(this.program,Ve,Y[Ve]),this.attributes[Y[Ve]]=Ve);if(N.linkProgram(this.program),!N.getProgramParameter(this.program,N.LINK_STATUS))throw new Error(`Program failed to link: ${N.getProgramInfoLog(this.program)}`);N.deleteShader(ze),N.deleteShader(be);for(let Ve=0;Ve<Se.length;Ve++){const Ge=Se[Ve];if(Ge&&!Ke[Ge]){const qe=N.getUniformLocation(this.program,Ge);qe&&(Ke[Ge]=qe)}}this.fixedUniforms=g(t,Ke),this.terrainUniforms=((Ve,Ge)=>({u_depth:new l.b_(Ve,Ge.u_depth),u_terrain:new l.b_(Ve,Ge.u_terrain),u_terrain_dim:new l.bq(Ve,Ge.u_terrain_dim),u_terrain_matrix:new l.c0(Ve,Ge.u_terrain_matrix),u_terrain_unpack:new l.c1(Ve,Ge.u_terrain_unpack),u_terrain_exaggeration:new l.bq(Ve,Ge.u_terrain_exaggeration)}))(t,Ke),this.projectionUniforms=((Ve,Ge)=>({u_projection_matrix:new l.c0(Ve,Ge.u_projection_matrix),u_projection_tile_mercator_coords:new l.c1(Ve,Ge.u_projection_tile_mercator_coords),u_projection_clipping_plane:new l.c1(Ve,Ge.u_projection_clipping_plane),u_projection_transition:new l.bq(Ve,Ge.u_projection_transition),u_projection_fallback_matrix:new l.c0(Ve,Ge.u_projection_fallback_matrix)}))(t,Ke),this.binderUniforms=d?d.getUniforms(t,Ke):[]}draw(t,a,d,g,w,P,E,k,z,N,Z,q,Y,ne,de,pe,fe,me,Se){const ge=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(d),t.setStencilMode(g),t.setColorMode(w),t.setCullFace(P),k){t.activeTexture.set(ge.TEXTURE2),ge.bindTexture(ge.TEXTURE_2D,k.depthTexture),t.activeTexture.set(ge.TEXTURE3),ge.bindTexture(ge.TEXTURE_2D,k.texture);for(const Me in this.terrainUniforms)this.terrainUniforms[Me].set(k[Me])}if(z)for(const Me in z)this.projectionUniforms[wc[Me]].set(z[Me]);if(E)for(const Me in this.fixedUniforms)this.fixedUniforms[Me].set(E[Me]);pe&&pe.setUniforms(t,this.binderUniforms,ne,{zoom:de});let Te=0;switch(a){case ge.LINES:Te=2;break;case ge.TRIANGLES:Te=3;break;case ge.LINE_STRIP:Te=1}for(const Me of Y.get()){const be=Me.vaos||(Me.vaos={});(be[N]||(be[N]=new vh)).bind(t,this,Z,pe?pe.getPaintVertexBuffers():[],q,Me.vertexOffset,fe,me,Se),ge.drawElements(a,Me.primitiveLength*Te,ge.UNSIGNED_SHORT,Me.primitiveOffset*Te*2)}}}function Tc(b,t,a){const d=1/l.aN(a,1,t.transform.tileZoom),g=Math.pow(2,a.tileID.overscaledZ),w=a.tileSize*Math.pow(2,t.transform.tileZoom)/g,P=w*(a.tileID.canonical.x+a.tileID.wrap*g),E=w*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[d,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[P>>16,E>>16],u_pixel_coord_lower:[65535&P,65535&E]}}const qd=(b,t,a,d)=>{const g=b.style.light,w=g.properties.get("position"),P=[w.x,w.y,w.z],E=l.c4();g.properties.get("anchor")==="viewport"&&l.c5(E,b.transform.bearingInRadians),l.c6(P,P,E);const k=b.transform.transformLightDirection(P),z=g.properties.get("color");return{u_lightpos:P,u_lightpos_globe:k,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[z.r,z.g,z.b],u_vertical_gradient:+t,u_opacity:a,u_fill_translate:d}},wh=(b,t,a,d,g,w,P)=>l.e(qd(b,t,a,d),Tc(w,b,P),{u_height_factor:-Math.pow(2,g.overscaledZ)/P.tileSize/8}),Th=(b,t,a,d)=>l.e(Tc(t,b,a),{u_fill_translate:d}),Zd=(b,t)=>({u_world:b,u_fill_translate:t}),Wd=(b,t,a,d,g)=>l.e(Th(b,t,a,g),{u_world:d}),Hd=(b,t,a,d,g)=>{const w=b.transform;let P,E,k=0;if(a.paint.get("circle-pitch-alignment")==="map"){const z=l.aN(t,1,w.zoom);P=!0,E=[z,z],k=z/(l.a5*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*g}else P=!1,E=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(a.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+P,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:E,u_globe_extrude_scale:k,u_translate:d}},Os=b=>({u_pixel_extrude_scale:[1/b.width,1/b.height]}),op=b=>({u_viewport_size:[b.width,b.height]}),Xd=(b,t=1)=>({u_color:b,u_overlay:0,u_overlay_scale:t}),Sc=(b,t,a,d)=>{const g=l.aN(b,1,t)/(l.a5*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI*d;return{u_extrude_scale:l.aN(b,1,t),u_intensity:a,u_globe_extrude_scale:g}},Kd=(b,t,a,d)=>{const g=l.N();l.c7(g,0,b.width,b.height,0,0,1);const w=b.context.gl;return{u_matrix:g,u_world:[w.drawingBufferWidth,w.drawingBufferHeight],u_image:a,u_color_ramp:d,u_opacity:t.paint.get("heatmap-opacity")}},_u=(b,t,a)=>{const d=a.paint.get("hillshade-accent-color");let g;switch(a.paint.get("hillshade-method")){case"basic":g=4;break;case"combined":g=1;break;case"igor":g=2;break;case"multidirectional":g=3;break;default:g=0}const w=a.getIlluminationProperties();for(let P=0;P<w.directionRadians.length;P++)a.paint.get("hillshade-illumination-anchor")==="viewport"&&(w.directionRadians[P]+=b.transform.bearingInRadians);return{u_image:0,u_latrange:xu(0,t.tileID),u_exaggeration:a.paint.get("hillshade-exaggeration"),u_altitudes:w.altitudeRadians,u_azimuths:w.directionRadians,u_accent:d,u_method:g,u_highlights:w.highlightColor,u_shadows:w.shadowColor}},vu=(b,t)=>{const a=t.stride,d=l.N();return l.c7(d,0,l.a5,-l.a5,0,0,1),l.O(d,d,[0,-l.a5,0]),{u_matrix:d,u_image:1,u_dimension:[a,a],u_zoom:b.overscaledZ,u_unpack:t.getUnpackVector()}};function xu(b,t){const a=Math.pow(2,t.canonical.z),d=t.canonical.y;return[new l.a9(0,d/a).toLngLat().lat,new l.a9(0,(d+1)/a).toLngLat().lat]}const ap=(b,t,a=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:a,u_opacity:b.paint.get("color-relief-opacity")}),Na=(b,t,a,d)=>{const g=b.transform;return{u_translation:bu(b,t,a),u_ratio:d/l.aN(t,1,g.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},lp=(b,t,a,d,g)=>l.e(Na(b,t,a,d),{u_image:0,u_image_height:g}),Sh=(b,t,a,d,g)=>{const w=b.transform,P=Ns(t,w);return{u_translation:bu(b,t,a),u_texsize:t.imageAtlasTexture.size,u_ratio:d/l.aN(t,1,w.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[P,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},Ph=(b,t,a,d,g)=>{const w=Ns(t,b.transform);return l.e(Na(b,t,a,d),{u_tileratio:w,u_crossfade_from:g.fromScale,u_crossfade_to:g.toScale,u_image:0,u_mix:g.t,u_lineatlas_width:b.lineAtlas.width,u_lineatlas_height:b.lineAtlas.height})},Pc=(b,t,a,d,g,w)=>{const P=Ns(t,b.transform);return l.e(Na(b,t,a,d),{u_image:0,u_image_height:w,u_tileratio:P,u_crossfade_from:g.fromScale,u_crossfade_to:g.toScale,u_image_dash:1,u_mix:g.t,u_lineatlas_width:b.lineAtlas.width,u_lineatlas_height:b.lineAtlas.height})};function Ns(b,t){return 1/l.aN(b,1,t.tileZoom)}function bu(b,t,a){return l.aO(b.transform,t,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Ch=(b,t,a,d,g)=>{return{u_tl_parent:b,u_scale_parent:t,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(P=d.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(w=d.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Yd(d.paint.get("raster-hue-rotate")),u_coords_top:[g[0].x,g[0].y,g[1].x,g[1].y],u_coords_bottom:[g[3].x,g[3].y,g[2].x,g[2].y]};var w,P};function Yd(b){b*=Math.PI/180;const t=Math.sin(b),a=Math.cos(b);return[(2*a+1)/3,(-Math.sqrt(3)*t-a+1)/3,(Math.sqrt(3)*t-a+1)/3]}const Qd=(b,t,a,d,g,w,P,E,k,z,N,Z,q)=>{const Y=P.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:Y.cameraToCenterDistance,u_pitch:Y.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:Y.width/Y.height,u_fade_change:P.options.fadeDuration?P.symbolFadeChange:1,u_label_plane_matrix:E,u_coord_matrix:k,u_is_text:+N,u_pitch_with_map:+d,u_is_along_line:g,u_is_variable_anchor:w,u_texsize:Z,u_texture:0,u_translation:z,u_pitched_scale:q}},Eh=(b,t,a,d,g,w,P,E,k,z,N,Z,q,Y)=>{const ne=P.transform;return l.e(Qd(b,t,a,d,g,w,P,E,k,z,N,Z,Y),{u_gamma_scale:d?Math.cos(ne.pitch*Math.PI/180)*ne.cameraToCenterDistance:1,u_device_pixel_ratio:P.pixelRatio,u_is_halo:1})},xl=(b,t,a,d,g,w,P,E,k,z,N,Z,q)=>l.e(Eh(b,t,a,d,g,w,P,E,k,z,!0,N,0,q),{u_texsize_icon:Z,u_texture_icon:1}),Jd=(b,t)=>({u_opacity:b,u_color:t}),uo=(b,t,a,d,g)=>l.e((function(w,P,E,k){const z=E.imageManager.getPattern(w.from.toString()),N=E.imageManager.getPattern(w.to.toString()),{width:Z,height:q}=E.imageManager.getPixelSize(),Y=Math.pow(2,k.tileID.overscaledZ),ne=k.tileSize*Math.pow(2,E.transform.tileZoom)/Y,de=ne*(k.tileID.canonical.x+k.tileID.wrap*Y),pe=ne*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:N.tl,u_pattern_br_b:N.br,u_texsize:[Z,q],u_mix:P.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:N.displaySize,u_scale_a:P.fromScale,u_scale_b:P.toScale,u_tile_units_to_pixels:1/l.aN(k,1,E.transform.tileZoom),u_pixel_coord_upper:[de>>16,pe>>16],u_pixel_coord_lower:[65535&de,65535&pe]}})(a,g,t,d),{u_opacity:b}),Cc=(b,t)=>{},cp={fillExtrusion:(b,t)=>({u_lightpos:new l.c2(b,t.u_lightpos),u_lightpos_globe:new l.c2(b,t.u_lightpos_globe),u_lightintensity:new l.bq(b,t.u_lightintensity),u_lightcolor:new l.c2(b,t.u_lightcolor),u_vertical_gradient:new l.bq(b,t.u_vertical_gradient),u_opacity:new l.bq(b,t.u_opacity),u_fill_translate:new l.c3(b,t.u_fill_translate)}),fillExtrusionPattern:(b,t)=>({u_lightpos:new l.c2(b,t.u_lightpos),u_lightpos_globe:new l.c2(b,t.u_lightpos_globe),u_lightintensity:new l.bq(b,t.u_lightintensity),u_lightcolor:new l.c2(b,t.u_lightcolor),u_vertical_gradient:new l.bq(b,t.u_vertical_gradient),u_height_factor:new l.bq(b,t.u_height_factor),u_opacity:new l.bq(b,t.u_opacity),u_fill_translate:new l.c3(b,t.u_fill_translate),u_image:new l.b_(b,t.u_image),u_texsize:new l.c3(b,t.u_texsize),u_pixel_coord_upper:new l.c3(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.c3(b,t.u_pixel_coord_lower),u_scale:new l.c2(b,t.u_scale),u_fade:new l.bq(b,t.u_fade)}),fill:(b,t)=>({u_fill_translate:new l.c3(b,t.u_fill_translate)}),fillPattern:(b,t)=>({u_image:new l.b_(b,t.u_image),u_texsize:new l.c3(b,t.u_texsize),u_pixel_coord_upper:new l.c3(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.c3(b,t.u_pixel_coord_lower),u_scale:new l.c2(b,t.u_scale),u_fade:new l.bq(b,t.u_fade),u_fill_translate:new l.c3(b,t.u_fill_translate)}),fillOutline:(b,t)=>({u_world:new l.c3(b,t.u_world),u_fill_translate:new l.c3(b,t.u_fill_translate)}),fillOutlinePattern:(b,t)=>({u_world:new l.c3(b,t.u_world),u_image:new l.b_(b,t.u_image),u_texsize:new l.c3(b,t.u_texsize),u_pixel_coord_upper:new l.c3(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.c3(b,t.u_pixel_coord_lower),u_scale:new l.c2(b,t.u_scale),u_fade:new l.bq(b,t.u_fade),u_fill_translate:new l.c3(b,t.u_fill_translate)}),circle:(b,t)=>({u_camera_to_center_distance:new l.bq(b,t.u_camera_to_center_distance),u_scale_with_map:new l.b_(b,t.u_scale_with_map),u_pitch_with_map:new l.b_(b,t.u_pitch_with_map),u_extrude_scale:new l.c3(b,t.u_extrude_scale),u_device_pixel_ratio:new l.bq(b,t.u_device_pixel_ratio),u_globe_extrude_scale:new l.bq(b,t.u_globe_extrude_scale),u_translate:new l.c3(b,t.u_translate)}),collisionBox:(b,t)=>({u_pixel_extrude_scale:new l.c3(b,t.u_pixel_extrude_scale)}),collisionCircle:(b,t)=>({u_viewport_size:new l.c3(b,t.u_viewport_size)}),debug:(b,t)=>({u_color:new l.b$(b,t.u_color),u_overlay:new l.b_(b,t.u_overlay),u_overlay_scale:new l.bq(b,t.u_overlay_scale)}),depth:Cc,clippingMask:Cc,heatmap:(b,t)=>({u_extrude_scale:new l.bq(b,t.u_extrude_scale),u_intensity:new l.bq(b,t.u_intensity),u_globe_extrude_scale:new l.bq(b,t.u_globe_extrude_scale)}),heatmapTexture:(b,t)=>({u_matrix:new l.c0(b,t.u_matrix),u_world:new l.c3(b,t.u_world),u_image:new l.b_(b,t.u_image),u_color_ramp:new l.b_(b,t.u_color_ramp),u_opacity:new l.bq(b,t.u_opacity)}),hillshade:(b,t)=>({u_image:new l.b_(b,t.u_image),u_latrange:new l.c3(b,t.u_latrange),u_exaggeration:new l.bq(b,t.u_exaggeration),u_altitudes:new l.c9(b,t.u_altitudes),u_azimuths:new l.c9(b,t.u_azimuths),u_accent:new l.b$(b,t.u_accent),u_method:new l.b_(b,t.u_method),u_shadows:new l.c8(b,t.u_shadows),u_highlights:new l.c8(b,t.u_highlights)}),hillshadePrepare:(b,t)=>({u_matrix:new l.c0(b,t.u_matrix),u_image:new l.b_(b,t.u_image),u_dimension:new l.c3(b,t.u_dimension),u_zoom:new l.bq(b,t.u_zoom),u_unpack:new l.c1(b,t.u_unpack)}),colorRelief:(b,t)=>({u_image:new l.b_(b,t.u_image),u_unpack:new l.c1(b,t.u_unpack),u_dimension:new l.c3(b,t.u_dimension),u_elevation_stops:new l.b_(b,t.u_elevation_stops),u_color_stops:new l.b_(b,t.u_color_stops),u_color_ramp_size:new l.b_(b,t.u_color_ramp_size),u_opacity:new l.bq(b,t.u_opacity)}),line:(b,t)=>({u_translation:new l.c3(b,t.u_translation),u_ratio:new l.bq(b,t.u_ratio),u_device_pixel_ratio:new l.bq(b,t.u_device_pixel_ratio),u_units_to_pixels:new l.c3(b,t.u_units_to_pixels)}),lineGradient:(b,t)=>({u_translation:new l.c3(b,t.u_translation),u_ratio:new l.bq(b,t.u_ratio),u_device_pixel_ratio:new l.bq(b,t.u_device_pixel_ratio),u_units_to_pixels:new l.c3(b,t.u_units_to_pixels),u_image:new l.b_(b,t.u_image),u_image_height:new l.bq(b,t.u_image_height)}),linePattern:(b,t)=>({u_translation:new l.c3(b,t.u_translation),u_texsize:new l.c3(b,t.u_texsize),u_ratio:new l.bq(b,t.u_ratio),u_device_pixel_ratio:new l.bq(b,t.u_device_pixel_ratio),u_image:new l.b_(b,t.u_image),u_units_to_pixels:new l.c3(b,t.u_units_to_pixels),u_scale:new l.c2(b,t.u_scale),u_fade:new l.bq(b,t.u_fade)}),lineSDF:(b,t)=>({u_translation:new l.c3(b,t.u_translation),u_ratio:new l.bq(b,t.u_ratio),u_device_pixel_ratio:new l.bq(b,t.u_device_pixel_ratio),u_units_to_pixels:new l.c3(b,t.u_units_to_pixels),u_image:new l.b_(b,t.u_image),u_mix:new l.bq(b,t.u_mix),u_tileratio:new l.bq(b,t.u_tileratio),u_crossfade_from:new l.bq(b,t.u_crossfade_from),u_crossfade_to:new l.bq(b,t.u_crossfade_to),u_lineatlas_width:new l.bq(b,t.u_lineatlas_width),u_lineatlas_height:new l.bq(b,t.u_lineatlas_height)}),lineGradientSDF:(b,t)=>({u_translation:new l.c3(b,t.u_translation),u_ratio:new l.bq(b,t.u_ratio),u_device_pixel_ratio:new l.bq(b,t.u_device_pixel_ratio),u_units_to_pixels:new l.c3(b,t.u_units_to_pixels),u_image:new l.b_(b,t.u_image),u_image_height:new l.bq(b,t.u_image_height),u_tileratio:new l.bq(b,t.u_tileratio),u_crossfade_from:new l.bq(b,t.u_crossfade_from),u_crossfade_to:new l.bq(b,t.u_crossfade_to),u_image_dash:new l.b_(b,t.u_image_dash),u_mix:new l.bq(b,t.u_mix),u_lineatlas_width:new l.bq(b,t.u_lineatlas_width),u_lineatlas_height:new l.bq(b,t.u_lineatlas_height)}),raster:(b,t)=>({u_tl_parent:new l.c3(b,t.u_tl_parent),u_scale_parent:new l.bq(b,t.u_scale_parent),u_buffer_scale:new l.bq(b,t.u_buffer_scale),u_fade_t:new l.bq(b,t.u_fade_t),u_opacity:new l.bq(b,t.u_opacity),u_image0:new l.b_(b,t.u_image0),u_image1:new l.b_(b,t.u_image1),u_brightness_low:new l.bq(b,t.u_brightness_low),u_brightness_high:new l.bq(b,t.u_brightness_high),u_saturation_factor:new l.bq(b,t.u_saturation_factor),u_contrast_factor:new l.bq(b,t.u_contrast_factor),u_spin_weights:new l.c2(b,t.u_spin_weights),u_coords_top:new l.c1(b,t.u_coords_top),u_coords_bottom:new l.c1(b,t.u_coords_bottom)}),symbolIcon:(b,t)=>({u_is_size_zoom_constant:new l.b_(b,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.b_(b,t.u_is_size_feature_constant),u_size_t:new l.bq(b,t.u_size_t),u_size:new l.bq(b,t.u_size),u_camera_to_center_distance:new l.bq(b,t.u_camera_to_center_distance),u_pitch:new l.bq(b,t.u_pitch),u_rotate_symbol:new l.b_(b,t.u_rotate_symbol),u_aspect_ratio:new l.bq(b,t.u_aspect_ratio),u_fade_change:new l.bq(b,t.u_fade_change),u_label_plane_matrix:new l.c0(b,t.u_label_plane_matrix),u_coord_matrix:new l.c0(b,t.u_coord_matrix),u_is_text:new l.b_(b,t.u_is_text),u_pitch_with_map:new l.b_(b,t.u_pitch_with_map),u_is_along_line:new l.b_(b,t.u_is_along_line),u_is_variable_anchor:new l.b_(b,t.u_is_variable_anchor),u_texsize:new l.c3(b,t.u_texsize),u_texture:new l.b_(b,t.u_texture),u_translation:new l.c3(b,t.u_translation),u_pitched_scale:new l.bq(b,t.u_pitched_scale)}),symbolSDF:(b,t)=>({u_is_size_zoom_constant:new l.b_(b,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.b_(b,t.u_is_size_feature_constant),u_size_t:new l.bq(b,t.u_size_t),u_size:new l.bq(b,t.u_size),u_camera_to_center_distance:new l.bq(b,t.u_camera_to_center_distance),u_pitch:new l.bq(b,t.u_pitch),u_rotate_symbol:new l.b_(b,t.u_rotate_symbol),u_aspect_ratio:new l.bq(b,t.u_aspect_ratio),u_fade_change:new l.bq(b,t.u_fade_change),u_label_plane_matrix:new l.c0(b,t.u_label_plane_matrix),u_coord_matrix:new l.c0(b,t.u_coord_matrix),u_is_text:new l.b_(b,t.u_is_text),u_pitch_with_map:new l.b_(b,t.u_pitch_with_map),u_is_along_line:new l.b_(b,t.u_is_along_line),u_is_variable_anchor:new l.b_(b,t.u_is_variable_anchor),u_texsize:new l.c3(b,t.u_texsize),u_texture:new l.b_(b,t.u_texture),u_gamma_scale:new l.bq(b,t.u_gamma_scale),u_device_pixel_ratio:new l.bq(b,t.u_device_pixel_ratio),u_is_halo:new l.b_(b,t.u_is_halo),u_translation:new l.c3(b,t.u_translation),u_pitched_scale:new l.bq(b,t.u_pitched_scale)}),symbolTextAndIcon:(b,t)=>({u_is_size_zoom_constant:new l.b_(b,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.b_(b,t.u_is_size_feature_constant),u_size_t:new l.bq(b,t.u_size_t),u_size:new l.bq(b,t.u_size),u_camera_to_center_distance:new l.bq(b,t.u_camera_to_center_distance),u_pitch:new l.bq(b,t.u_pitch),u_rotate_symbol:new l.b_(b,t.u_rotate_symbol),u_aspect_ratio:new l.bq(b,t.u_aspect_ratio),u_fade_change:new l.bq(b,t.u_fade_change),u_label_plane_matrix:new l.c0(b,t.u_label_plane_matrix),u_coord_matrix:new l.c0(b,t.u_coord_matrix),u_is_text:new l.b_(b,t.u_is_text),u_pitch_with_map:new l.b_(b,t.u_pitch_with_map),u_is_along_line:new l.b_(b,t.u_is_along_line),u_is_variable_anchor:new l.b_(b,t.u_is_variable_anchor),u_texsize:new l.c3(b,t.u_texsize),u_texsize_icon:new l.c3(b,t.u_texsize_icon),u_texture:new l.b_(b,t.u_texture),u_texture_icon:new l.b_(b,t.u_texture_icon),u_gamma_scale:new l.bq(b,t.u_gamma_scale),u_device_pixel_ratio:new l.bq(b,t.u_device_pixel_ratio),u_is_halo:new l.b_(b,t.u_is_halo),u_translation:new l.c3(b,t.u_translation),u_pitched_scale:new l.bq(b,t.u_pitched_scale)}),background:(b,t)=>({u_opacity:new l.bq(b,t.u_opacity),u_color:new l.b$(b,t.u_color)}),backgroundPattern:(b,t)=>({u_opacity:new l.bq(b,t.u_opacity),u_image:new l.b_(b,t.u_image),u_pattern_tl_a:new l.c3(b,t.u_pattern_tl_a),u_pattern_br_a:new l.c3(b,t.u_pattern_br_a),u_pattern_tl_b:new l.c3(b,t.u_pattern_tl_b),u_pattern_br_b:new l.c3(b,t.u_pattern_br_b),u_texsize:new l.c3(b,t.u_texsize),u_mix:new l.bq(b,t.u_mix),u_pattern_size_a:new l.c3(b,t.u_pattern_size_a),u_pattern_size_b:new l.c3(b,t.u_pattern_size_b),u_scale_a:new l.bq(b,t.u_scale_a),u_scale_b:new l.bq(b,t.u_scale_b),u_pixel_coord_upper:new l.c3(b,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.c3(b,t.u_pixel_coord_lower),u_tile_units_to_pixels:new l.bq(b,t.u_tile_units_to_pixels)}),terrain:(b,t)=>({u_texture:new l.b_(b,t.u_texture),u_ele_delta:new l.bq(b,t.u_ele_delta),u_fog_matrix:new l.c0(b,t.u_fog_matrix),u_fog_color:new l.b$(b,t.u_fog_color),u_fog_ground_blend:new l.bq(b,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new l.bq(b,t.u_fog_ground_blend_opacity),u_horizon_color:new l.b$(b,t.u_horizon_color),u_horizon_fog_blend:new l.bq(b,t.u_horizon_fog_blend),u_is_globe_mode:new l.bq(b,t.u_is_globe_mode)}),terrainDepth:(b,t)=>({u_ele_delta:new l.bq(b,t.u_ele_delta)}),terrainCoords:(b,t)=>({u_texture:new l.b_(b,t.u_texture),u_terrain_coords_id:new l.bq(b,t.u_terrain_coords_id),u_ele_delta:new l.bq(b,t.u_ele_delta)}),projectionErrorMeasurement:(b,t)=>({u_input:new l.bq(b,t.u_input),u_output_expected:new l.bq(b,t.u_output_expected)}),atmosphere:(b,t)=>({u_sun_pos:new l.c2(b,t.u_sun_pos),u_atmosphere_blend:new l.bq(b,t.u_atmosphere_blend),u_globe_position:new l.c2(b,t.u_globe_position),u_globe_radius:new l.bq(b,t.u_globe_radius),u_inv_proj_matrix:new l.c0(b,t.u_inv_proj_matrix)}),sky:(b,t)=>({u_sky_color:new l.b$(b,t.u_sky_color),u_horizon_color:new l.b$(b,t.u_horizon_color),u_horizon:new l.c3(b,t.u_horizon),u_horizon_normal:new l.c3(b,t.u_horizon_normal),u_sky_horizon_blend:new l.bq(b,t.u_sky_horizon_blend),u_sky_blend:new l.bq(b,t.u_sky_blend)})};class up{constructor(t,a,d){this.context=t;const g=t.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ef={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class hp{constructor(t,a,d,g){this.length=a.length,this.attributes=d,this.itemSize=a.bytesPerElement,this.dynamicDraw=g,this.context=t;const w=t.gl;this.buffer=w.createBuffer(),t.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,a){for(let d=0;d<this.attributes.length;d++){const g=a.attributes[this.attributes[d].name];g!==void 0&&t.enableVertexAttribArray(g)}}setVertexAttribPointers(t,a,d){for(let g=0;g<this.attributes.length;g++){const w=this.attributes[g],P=a.attributes[w.name];P!==void 0&&t.vertexAttribPointer(P,w.components,t[ef[w.type]],!1,this.itemSize,w.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Vr{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Mh extends Vr{getDefault(){return l.bp.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ih extends Vr{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class na extends Vr{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class wu extends Vr{getDefault(){return[!0,!0,!0,!0]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ho extends Vr{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class bl extends Vr{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class wl extends Vr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const a=this.current;(t.func!==a.func||t.ref!==a.ref||t.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class is extends Vr{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Tl extends Vr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=t,this.dirty=!1}}class Ah extends Vr{getDefault(){return[0,1]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class kh extends Vr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=t,this.dirty=!1}}class Ro extends Vr{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Tu extends Vr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.BLEND):a.disable(a.BLEND),this.current=t,this.dirty=!1}}class Su extends Vr{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ec extends Vr{getDefault(){return l.bp.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Pu extends Vr{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class tf extends Vr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=t,this.dirty=!1}}class Sl extends Vr{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Is extends Vr{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Dh extends Vr{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Cu extends Vr{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Er extends Vr{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Rh extends Vr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Eu extends Vr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class dp extends Vr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Mc extends Vr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class fp extends Vr{getDefault(){return null}set(t){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class An extends Vr{getDefault(){return null}set(t){var a;if(t===this.current&&!this.dirty)return;const d=this.gl;Nn(d)?d.bindVertexArray(t):(a=d.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Lh extends Vr{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class zh extends Vr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Pl extends Vr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Cl extends Vr{constructor(t,a){super(t),this.context=t,this.parent=a}getDefault(){return null}}class El extends Cl{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class ja extends Cl{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Ic extends Cl{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const Ba="Framebuffer is not complete";class Mu{constructor(t,a,d,g,w){this.context=t,this.width=a,this.height=d;const P=t.gl,E=this.framebuffer=P.createFramebuffer();if(this.colorAttachment=new El(t,E),g)this.depthAttachment=w?new Ic(t,E):new ja(t,E);else if(w)throw new Error("Stencil cannot be set without depth");if(P.checkFramebufferStatus(P.FRAMEBUFFER)!==P.FRAMEBUFFER_COMPLETE)throw new Error(Ba)}destroy(){const t=this.context.gl,a=this.colorAttachment.get();if(a&&t.deleteTexture(a),this.depthAttachment){const d=this.depthAttachment.get();d&&t.deleteRenderbuffer(d)}t.deleteFramebuffer(this.framebuffer)}}class Fh{constructor(t){var a,d;if(this.gl=t,this.clearColor=new Mh(this),this.clearDepth=new Ih(this),this.clearStencil=new na(this),this.colorMask=new wu(this),this.depthMask=new ho(this),this.stencilMask=new bl(this),this.stencilFunc=new wl(this),this.stencilOp=new is(this),this.stencilTest=new Tl(this),this.depthRange=new Ah(this),this.depthTest=new kh(this),this.depthFunc=new Ro(this),this.blend=new Tu(this),this.blendFunc=new Su(this),this.blendColor=new Ec(this),this.blendEquation=new Pu(this),this.cullFace=new tf(this),this.cullFaceSide=new Sl(this),this.frontFace=new Is(this),this.program=new Dh(this),this.activeTexture=new Cu(this),this.viewport=new Er(this),this.bindFramebuffer=new Rh(this),this.bindRenderbuffer=new Eu(this),this.bindTexture=new dp(this),this.bindVertexBuffer=new Mc(this),this.bindElementBuffer=new fp(this),this.bindVertexArray=new An(this),this.pixelStoreUnpack=new Lh(this),this.pixelStoreUnpackPremultiplyAlpha=new zh(this),this.pixelStoreUnpackFlipY=new Pl(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),Nn(t)){this.HALF_FLOAT=t.HALF_FLOAT;const g=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=t.RGBA16F)!==null&&a!==void 0?a:g?.RGBA16F_EXT,this.RGB16F=(d=t.RGB16F)!==null&&d!==void 0?d:g?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const g=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=g?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,a){return new up(this,t,a)}createVertexBuffer(t,a,d){return new hp(this,t,a,d)}createRenderbuffer(t,a,d){const g=this.gl,w=g.createRenderbuffer();return this.bindRenderbuffer.set(w),g.renderbufferStorage(g.RENDERBUFFER,t,a,d),this.bindRenderbuffer.set(null),w}createFramebuffer(t,a,d,g){return new Mu(this,t,a,d,g)}clear({color:t,depth:a,stencil:d}){const g=this.gl;let w=0;t&&(w|=g.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(w|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),d!==void 0&&(w|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),g.clear(w)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){l.bR(t.blendFunction,Br.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return Nn(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var a;return Nn(this.gl)?this.gl.deleteVertexArray(t):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let Va;function Ua(b,t,a,d,g){const w=b.context,P=b.transform,E=w.gl,k=b.useProgram("collisionBox"),z=[];let N=0,Z=0;for(let fe=0;fe<d.length;fe++){const me=d[fe],Se=t.getTile(me).getBucket(a);if(!Se)continue;const ge=g?Se.textCollisionBox:Se.iconCollisionBox,Te=Se.collisionCircleArray;Te.length>0&&(z.push({circleArray:Te,circleOffset:Z,coord:me}),N+=Te.length/4,Z=N),ge&&k.draw(w,E.LINES,br.disabled,Ir.disabled,b.colorModeForRenderPass(),Mr.disabled,Os(b.transform),b.style.map.terrain&&b.style.map.terrain.getTerrainData(me),P.getProjectionData({overscaledTileID:me,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),a.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,null,b.transform.zoom,null,null,ge.collisionVertexBuffer)}if(!g||!z.length)return;const q=b.useProgram("collisionCircle"),Y=new l.ca;Y.resize(4*N),Y._trim();let ne=0;for(const fe of z)for(let me=0;me<fe.circleArray.length/4;me++){const Se=4*me,ge=fe.circleArray[Se+0],Te=fe.circleArray[Se+1],Me=fe.circleArray[Se+2],be=fe.circleArray[Se+3];Y.emplace(ne++,ge,Te,Me,be,0),Y.emplace(ne++,ge,Te,Me,be,1),Y.emplace(ne++,ge,Te,Me,be,2),Y.emplace(ne++,ge,Te,Me,be,3)}(!Va||Va.length<2*N)&&(Va=(function(fe){const me=2*fe,Se=new l.cc;Se.resize(me),Se._trim();for(let ge=0;ge<me;ge++){const Te=6*ge;Se.uint16[Te+0]=4*ge+0,Se.uint16[Te+1]=4*ge+1,Se.uint16[Te+2]=4*ge+2,Se.uint16[Te+3]=4*ge+2,Se.uint16[Te+4]=4*ge+3,Se.uint16[Te+5]=4*ge+0}return Se})(N));const de=w.createIndexBuffer(Va,!0),pe=w.createVertexBuffer(Y,l.cb.members,!0);for(const fe of z){const me=op(b.transform);q.draw(w,E.TRIANGLES,br.disabled,Ir.disabled,b.colorModeForRenderPass(),Mr.disabled,me,b.style.map.terrain&&b.style.map.terrain.getTerrainData(fe.coord),null,a.id,pe,de,l.aX.simpleSegment(0,2*fe.circleOffset,fe.circleArray.length,fe.circleArray.length/2),null,b.transform.zoom,null,null,null)}pe.destroy(),de.destroy()}const Ac=l.ar(new Float32Array(16));function Oh(b,t,a,d,g,w){const{horizontalAlign:P,verticalAlign:E}=l.aS(b);return new l.P((-(P-.5)*t/g+d[0])*w,(-(E-.5)*a/g+d[1])*w)}function Ml(b,t,a,d,g,w){const P=t.tileAnchorPoint.add(new l.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let E=d.mult(w);a||(E=E.rotate(-g));const k=P.add(E);return vr(k.x,k.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(a){const E=qr(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(b),k=Math.atan(E.y/E.x)+(E.x<0?Math.PI:0);return b.add(d.rotate(k))}return b.add(d)}function rf(b,t,a,d,g,w,P,E,k,z,N,Z){const q=b.text.placedSymbolArray,Y=b.text.dynamicLayoutVertexArray,ne=b.icon.dynamicLayoutVertexArray,de={};Y.clear();for(let pe=0;pe<q.length;pe++){const fe=q.get(pe),me=fe.hidden||!fe.crossTileID||b.allowVerticalPlacement&&!fe.placedOrientation?null:d[fe.crossTileID];if(me){const Se=new l.P(fe.anchorX,fe.anchorY),ge={getElevation:Z,width:g.width,height:g.height,pitchedLabelPlaneMatrix:w,pitchWithMap:a,transform:g,tileAnchorPoint:Se,translation:z,unwrappedTileID:N},Te=a?cl(Se.x,Se.y,ge):qr(Se.x,Se.y,ge),Me=hc(g.cameraToCenterDistance,Te.signedDistanceFromCamera);let be=l.aA(b.textSizeData,E,fe)*Me/l.aM;a&&(be*=b.tilePixelRatio/P);const{width:ze,height:Ke,anchor:Ve,textOffset:Ge,textBoxScale:qe}=me,vt=Oh(Ve,ze,Ke,Ge,qe,be),bt=g.getPitchedTextCorrection(Se.x+z[0],Se.y+z[1],N),ct=Ml(Te.point,ge,t,vt,-g.bearingInRadians,bt),kt=b.allowVerticalPlacement&&fe.placedOrientation===l.az.vertical?Math.PI/2:0;for(let pr=0;pr<fe.numGlyphs;pr++)l.aG(Y,ct,kt);k&&fe.associatedIconIndex>=0&&(de[fe.associatedIconIndex]={shiftedAnchor:ct,angle:kt})}else ul(fe.numGlyphs,Y)}if(k){ne.clear();const pe=b.icon.placedSymbolArray;for(let fe=0;fe<pe.length;fe++){const me=pe.get(fe);if(me.hidden)ul(me.numGlyphs,ne);else{const Se=de[fe];if(Se)for(let ge=0;ge<me.numGlyphs;ge++)l.aG(ne,Se.shiftedAnchor,Se.angle);else ul(me.numGlyphs,ne)}}b.icon.dynamicLayoutVertexBuffer.updateData(ne)}b.text.dynamicLayoutVertexBuffer.updateData(Y)}function Nh(b,t,a){return a.iconsInText&&t?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function Il(b,t,a,d,g,w,P,E,k,z,N,Z,q){const Y=b.context,ne=Y.gl,de=b.transform,pe=E==="map",fe=k==="map",me=E!=="viewport"&&a.layout.get("symbol-placement")!=="point",Se=pe&&!fe&&!me,ge=!a.layout.get("symbol-sort-key").isConstant();let Te=!1;const Me=b.getDepthModeForSublayer(0,br.ReadOnly),be=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ze=[],Ke=de.getCircleRadiusCorrection();for(const Ve of d){const Ge=t.getTile(Ve),qe=Ge.getBucket(a);if(!qe)continue;const vt=g?qe.text:qe.icon;if(!vt||!vt.segments.get().length||!vt.hasVisibleVertices)continue;const bt=vt.programConfigurations.get(a.id),ct=g||qe.sdfIcons,kt=g?qe.textSizeData:qe.iconSizeData,pr=fe||de.pitch!==0,Qr=b.useProgram(Nh(ct,g,qe),bt),Sn=l.ay(kt,de.zoom),cn=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ve);let Pn,un,Cn,Dn,Ei=[0,0],Kn=null;if(g)un=Ge.glyphAtlasTexture,Cn=ne.LINEAR,Pn=Ge.glyphAtlasTexture.size,qe.iconsInText&&(Ei=Ge.imageAtlasTexture.size,Kn=Ge.imageAtlasTexture,Dn=pr||b.options.rotating||b.options.zooming||kt.kind==="composite"||kt.kind==="camera"?ne.LINEAR:ne.NEAREST);else{const pn=a.layout.get("icon-size").constantOr(0)!==1||qe.iconsNeedLinear;un=Ge.imageAtlasTexture,Cn=ct||b.options.rotating||b.options.zooming||pn||pr?ne.LINEAR:ne.NEAREST,Pn=Ge.imageAtlasTexture.size}const Hr=l.aN(Ge,1,b.transform.zoom),fi=ds(pe,b.transform,Hr),_o=l.N();l.aB(_o,fi);const Vo=dh(fe,pe,b.transform,Hr),vo=l.aO(de,Ge,w,P),os=de.getProjectionData({overscaledTileID:Ve,applyGlobeMatrix:!q,applyTerrainMatrix:!0}),ua=be&&qe.hasTextData(),Uo=a.layout.get("icon-text-fit")!=="none"&&ua&&qe.hasIconData();if(me){const pn=b.style.map.terrain?(li,pi)=>b.style.map.terrain.getElevation(Ve,li,pi):null,hn=a.layout.get("text-rotation-alignment")==="map";fh(qe,b,g,fi,_o,fe,z,hn,Ve.toUnwrapped(),de.width,de.height,vo,pn)}const ha=g&&be||Uo,vs=me||ha?Ac:fe?fi:b.transform.clipSpaceToPixelsMatrix,$o=ct&&a.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Zs;Zs=ct?qe.iconsInText?xl(kt.kind,Sn,Se,fe,me,ha,b,vs,Vo,vo,Pn,Ei,Ke):Eh(kt.kind,Sn,Se,fe,me,ha,b,vs,Vo,vo,g,Pn,0,Ke):Qd(kt.kind,Sn,Se,fe,me,ha,b,vs,Vo,vo,g,Pn,Ke);const Ws={program:Qr,buffers:vt,uniformValues:Zs,projectionData:os,atlasTexture:un,atlasTextureIcon:Kn,atlasInterpolation:Cn,atlasInterpolationIcon:Dn,isSDF:ct,hasHalo:$o};if(ge&&qe.canOverlap){Te=!0;const pn=vt.segments.get();for(const hn of pn)ze.push({segments:new l.aX([hn]),sortKey:hn.sortKey,state:Ws,terrainData:cn})}else ze.push({segments:vt.segments,sortKey:0,state:Ws,terrainData:cn})}Te&&ze.sort(((Ve,Ge)=>Ve.sortKey-Ge.sortKey));for(const Ve of ze){const Ge=Ve.state;if(Y.activeTexture.set(ne.TEXTURE0),Ge.atlasTexture.bind(Ge.atlasInterpolation,ne.CLAMP_TO_EDGE),Ge.atlasTextureIcon&&(Y.activeTexture.set(ne.TEXTURE1),Ge.atlasTextureIcon&&Ge.atlasTextureIcon.bind(Ge.atlasInterpolationIcon,ne.CLAMP_TO_EDGE)),Ge.isSDF){const qe=Ge.uniformValues;Ge.hasHalo&&(qe.u_is_halo=1,jh(Ge.buffers,Ve.segments,a,b,Ge.program,Me,N,Z,qe,Ge.projectionData,Ve.terrainData)),qe.u_is_halo=0}jh(Ge.buffers,Ve.segments,a,b,Ge.program,Me,N,Z,Ge.uniformValues,Ge.projectionData,Ve.terrainData)}}function jh(b,t,a,d,g,w,P,E,k,z,N){const Z=d.context;g.draw(Z,Z.gl.TRIANGLES,w,P,E,Mr.backCCW,k,N,z,a.id,b.layoutVertexBuffer,b.indexBuffer,t,a.paint,d.transform.zoom,b.programConfigurations.get(a.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function nf(b,t,a,d,g){const w=b.context,P=w.gl,E=Ir.disabled,k=new Br([P.ONE,P.ONE],l.bp.transparent,[!0,!0,!0,!0]),z=t.getBucket(a);if(!z)return;const N=d.key;let Z=a.heatmapFbos.get(N);Z||(Z=Iu(w,t.tileSize,t.tileSize),a.heatmapFbos.set(N,Z)),w.bindFramebuffer.set(Z.framebuffer),w.viewport.set([0,0,t.tileSize,t.tileSize]),w.clear({color:l.bp.transparent});const q=z.programConfigurations.get(a.id),Y=b.useProgram("heatmap",q,!g),ne=b.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),de=b.style.map.terrain.getTerrainData(d);Y.draw(w,P.TRIANGLES,br.disabled,E,k,Mr.disabled,Sc(t,b.transform.zoom,a.paint.get("heatmap-intensity"),1),de,ne,a.id,z.layoutVertexBuffer,z.indexBuffer,z.segments,a.paint,b.transform.zoom,q)}function pp(b,t,a,d,g){const w=b.context,P=w.gl,E=b.transform;w.setColorMode(b.colorModeForRenderPass());const k=kc(w,t),z=a.key,N=t.heatmapFbos.get(z);if(!N)return;w.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,N.colorAttachment.get()),w.activeTexture.set(P.TEXTURE1),k.bind(P.LINEAR,P.CLAMP_TO_EDGE);const Z=E.getProjectionData({overscaledTileID:a,applyTerrainMatrix:g,applyGlobeMatrix:!d});b.useProgram("heatmapTexture").draw(w,P.TRIANGLES,br.disabled,Ir.disabled,b.colorModeForRenderPass(),Mr.disabled,Kd(b,t,0,1),null,Z,t.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,t.paint,E.zoom),N.destroy(),t.heatmapFbos.delete(z)}function Iu(b,t,a){var d,g;const w=b.gl,P=w.createTexture();w.bindTexture(w.TEXTURE_2D,P),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.LINEAR),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.LINEAR);const E=(d=b.HALF_FLOAT)!==null&&d!==void 0?d:w.UNSIGNED_BYTE,k=(g=b.RGBA16F)!==null&&g!==void 0?g:w.RGBA;w.texImage2D(w.TEXTURE_2D,0,k,t,a,0,w.RGBA,E,null);const z=b.createFramebuffer(t,a,!1,!1);return z.colorAttachment.set(P),z}function kc(b,t){return t.colorRampTexture||(t.colorRampTexture=new l.T(b,t.colorRamp,b.gl.RGBA)),t.colorRampTexture}function ia(b,t,a,d,g,w,P,E){let k=256;if(g.stepInterpolant){const z=t.getSource().maxzoom,N=P.canonical.z===z?Math.ceil(1<<b.transform.maxZoom-P.canonical.z):1;k=l.an(l.ce(w.maxLineLength/l.a5*1024*N),256,a.maxTextureSize)}return E.gradient=l.cf({expression:g.gradientExpression(),evaluationKey:"lineProgress",resolution:k,image:E.gradient||void 0,clips:w.lineClipsArray}),E.texture?E.texture.update(E.gradient):E.texture=new l.T(a,E.gradient,d.RGBA),E.version=g.gradientVersion,E.texture}function sf(b,t,a,d,g){b.activeTexture.set(t.TEXTURE0),a.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),d.updatePaintBuffers(g)}function yn(b,t,a,d,g,w){(g||b.lineAtlas.dirty)&&(t.activeTexture.set(a.TEXTURE0),b.lineAtlas.bind(t)),d.updatePaintBuffers(w)}function Ui(b,t,a,d,g,w,P){const E=w.gradients[g.id];let k=E.texture;g.gradientVersion!==E.version&&(k=ia(b,t,a,d,g,w,P,E)),a.activeTexture.set(d.TEXTURE0),k.bind(g.stepInterpolant?d.NEAREST:d.LINEAR,d.CLAMP_TO_EDGE)}function Li(b,t,a,d,g,w,P,E,k){const z=w.gradients[g.id];let N=z.texture;g.gradientVersion!==z.version&&(N=ia(b,t,a,d,g,w,P,z)),a.activeTexture.set(d.TEXTURE0),N.bind(g.stepInterpolant?d.NEAREST:d.LINEAR,d.CLAMP_TO_EDGE),a.activeTexture.set(d.TEXTURE1),b.lineAtlas.bind(a),E.updatePaintBuffers(k)}function js(b,t,a,d,g){if(!a||!d||!d.imageAtlas)return;const w=d.imageAtlas.patternPositions;let P=w[a.to.toString()],E=w[a.from.toString()];if(!P&&E&&(P=E),!E&&P&&(E=P),!P||!E){const k=g.getPaintProperty(t);P=w[k],E=w[k]}P&&E&&b.setConstantPatternPositions(P,E)}function Al(b,t,a,d,g,w,P,E){const k=b.context.gl,z="fill-pattern",N=a.paint.get(z),Z=N&&N.constantOr(1),q=a.getCrossfadeParameters();let Y,ne,de,pe,fe;const me=b.transform,Se=a.paint.get("fill-translate"),ge=a.paint.get("fill-translate-anchor");P?(ne=Z&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Y=k.LINES):(ne=Z?"fillPattern":"fill",Y=k.TRIANGLES);const Te=N.constantOr(null);for(const Me of d){const be=t.getTile(Me);if(Z&&!be.patternsLoaded())continue;const ze=be.getBucket(a);if(!ze)continue;const Ke=ze.programConfigurations.get(a.id),Ve=b.useProgram(ne,Ke),Ge=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Me);Z&&(b.context.activeTexture.set(k.TEXTURE0),be.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),Ke.updatePaintBuffers(q)),js(Ke,z,Te,be,a);const qe=me.getProjectionData({overscaledTileID:Me,applyGlobeMatrix:!E,applyTerrainMatrix:!0}),vt=l.aO(me,be,Se,ge);if(P){pe=ze.indexBuffer2,fe=ze.segments2;const ct=[k.drawingBufferWidth,k.drawingBufferHeight];de=ne==="fillOutlinePattern"&&Z?Wd(b,q,be,ct,vt):Zd(ct,vt)}else pe=ze.indexBuffer,fe=ze.segments,de=Z?Th(b,q,be,vt):{u_fill_translate:vt};const bt=b.stencilModeForClipping(Me);Ve.draw(b.context,Y,g,bt,w,Mr.backCCW,de,Ge,qe,a.id,ze.layoutVertexBuffer,pe,fe,a.paint,b.transform.zoom,Ke)}}function Bh(b,t,a,d,g,w,P,E){const k=b.context,z=k.gl,N="fill-extrusion-pattern",Z=a.paint.get(N),q=Z.constantOr(1),Y=a.getCrossfadeParameters(),ne=a.paint.get("fill-extrusion-opacity"),de=Z.constantOr(null),pe=b.transform;for(const fe of d){const me=t.getTile(fe),Se=me.getBucket(a);if(!Se)continue;const ge=b.style.map.terrain&&b.style.map.terrain.getTerrainData(fe),Te=Se.programConfigurations.get(a.id),Me=b.useProgram(q?"fillExtrusionPattern":"fillExtrusion",Te);q&&(b.context.activeTexture.set(z.TEXTURE0),me.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),Te.updatePaintBuffers(Y));const be=pe.getProjectionData({overscaledTileID:fe,applyGlobeMatrix:!E,applyTerrainMatrix:!0});js(Te,N,de,me,a);const ze=l.aO(pe,me,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Ke=a.paint.get("fill-extrusion-vertical-gradient"),Ve=q?wh(b,Ke,ne,ze,fe,Y,me):qd(b,Ke,ne,ze);Me.draw(k,k.gl.TRIANGLES,g,w,P,Mr.backCCW,Ve,ge,be,a.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,a.paint,b.transform.zoom,Te,b.style.map.terrain&&Se.centroidVertexBuffer)}}function $a(b,t,a,d,g,w,P,E,k){var z;const N=b.style.projection,Z=b.context,q=b.transform,Y=Z.gl,ne=[`#define NUM_ILLUMINATION_SOURCES ${a.paint.get("hillshade-highlight-color").values.length}`],de=b.useProgram("hillshade",null,!1,ne),pe=!b.options.moving;for(const fe of d){const me=t.getTile(fe),Se=me.fbo;if(!Se)continue;const ge=N.getMeshFromTileID(Z,fe.canonical,E,!0,"raster"),Te=(z=b.style.map.terrain)===null||z===void 0?void 0:z.getTerrainData(fe);Z.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,Se.colorAttachment.get());const Me=q.getProjectionData({overscaledTileID:fe,aligned:pe,applyGlobeMatrix:!k,applyTerrainMatrix:!0});de.draw(Z,Y.TRIANGLES,w,g[fe.overscaledZ],P,Mr.backCCW,_u(b,me,a),Te,Me,a.id,ge.vertexBuffer,ge.indexBuffer,ge.segments)}}function fo(b,t,a,d,g,w,P,E,k){var z;const N=b.style.projection,Z=b.context,q=b.transform,Y=Z.gl,ne=b.useProgram("colorRelief"),de=!b.options.moving;let pe=!0,fe=0;for(const me of d){const Se=t.getTile(me),ge=Se.dem;if(pe){const Ve=Y.getParameter(Y.MAX_TEXTURE_SIZE),{elevationTexture:Ge,colorTexture:qe}=a.getColorRampTextures(Z,Ve,ge.getUnpackVector());Z.activeTexture.set(Y.TEXTURE1),Ge.bind(Y.NEAREST,Y.CLAMP_TO_EDGE),Z.activeTexture.set(Y.TEXTURE4),qe.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),pe=!1,fe=Ge.size[0]}if(!ge||!ge.data)continue;const Te=ge.stride,Me=ge.getPixels();if(Z.activeTexture.set(Y.TEXTURE0),Z.pixelStoreUnpackPremultiplyAlpha.set(!1),Se.demTexture=Se.demTexture||b.getTileTexture(Te),Se.demTexture){const Ve=Se.demTexture;Ve.update(Me,{premultiply:!1}),Ve.bind(Y.LINEAR,Y.CLAMP_TO_EDGE)}else Se.demTexture=new l.T(Z,Me,Y.RGBA,{premultiply:!1}),Se.demTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const be=N.getMeshFromTileID(Z,me.canonical,E,!0,"raster"),ze=(z=b.style.map.terrain)===null||z===void 0?void 0:z.getTerrainData(me),Ke=q.getProjectionData({overscaledTileID:me,aligned:de,applyGlobeMatrix:!k,applyTerrainMatrix:!0});ne.draw(Z,Y.TRIANGLES,w,g[me.overscaledZ],P,Mr.backCCW,ap(a,Se.dem,fe),ze,Ke,a.id,be.vertexBuffer,be.indexBuffer,be.segments)}}const po=[new l.P(0,0),new l.P(l.a5,0),new l.P(l.a5,l.a5),new l.P(0,l.a5)];function mo(b,t,a,d,g,w,P,E,k=!1,z=!1){const N=d[d.length-1].overscaledZ,Z=b.context,q=Z.gl,Y=b.useProgram("raster"),ne=b.transform,de=b.style.projection,pe=b.colorModeForRenderPass(),fe=!b.options.moving,me=a.paint.get("raster-opacity"),Se=a.paint.get("raster-resampling"),ge=a.paint.get("raster-fade-duration"),Te=!!b.style.map.terrain;for(const Me of d){const be=b.getDepthModeForSublayer(Me.overscaledZ-N,me===1?br.ReadWrite:br.ReadOnly,q.LESS),ze=t.getTile(Me),Ke=Se==="nearest"?q.NEAREST:q.LINEAR;Z.activeTexture.set(q.TEXTURE0),ze.texture.bind(Ke,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),Z.activeTexture.set(q.TEXTURE1);const{parentTile:Ve,parentScaleBy:Ge,parentTopLeft:qe,fadeValues:vt}=Au(ze,t,ge,Te);ze.fadeOpacity=vt.tileOpacity,Ve?(Ve.fadeOpacity=vt.parentTileOpacity,Ve.texture.bind(Ke,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST)):ze.texture.bind(Ke,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),ze.texture.useMipmap&&Z.extTextureFilterAnisotropic&&b.transform.pitch>20&&q.texParameterf(q.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax);const bt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Me),ct=ne.getProjectionData({overscaledTileID:Me,aligned:fe,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),kt=Ch(qe,Ge,vt.fadeMix,a,E),pr=de.getMeshFromTileID(Z,Me.canonical,w,P,"raster");Y.draw(Z,q.TRIANGLES,be,g?g[Me.overscaledZ]:Ir.disabled,pe,k?Mr.frontCCW:Mr.backCCW,kt,bt,ct,a.id,pr.vertexBuffer,pr.indexBuffer,pr.segments)}}function Au(b,t,a,d){const g={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(a===0||d)return g;if(b.fadingParentID){const w=t.getLoadedTile(b.fadingParentID);if(!w)return g;const P=Math.pow(2,w.tileID.overscaledZ-b.tileID.overscaledZ),E=[b.tileID.canonical.x*P%1,b.tileID.canonical.y*P%1],k=(function(z,N,Z){const q=Q(),Y=(q-N.timeAdded)/Z,ne=z.fadingDirection===Ze.Incoming,de=l.an((q-z.timeAdded)/Z,0,1),pe=l.an(1-Y,0,1),fe=ne?de:pe;return{tileOpacity:fe,parentTileOpacity:ne?pe:de,fadeMix:{opacity:1,mix:1-fe}}})(b,w,a);return{parentTile:w,parentScaleBy:P,parentTopLeft:E,fadeValues:k}}if(b.selfFading){const w=(function(P,E){const k=(Q()-P.timeAdded)/E,z=l.an(k,0,1);return{tileOpacity:z,fadeMix:{opacity:z,mix:0}}})(b,a);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:w}}return g}const Vh=new l.bp(1,0,0,1),kl=new l.bp(0,1,0,1),sa=new l.bp(0,0,1,1),wn=new l.bp(1,0,1,1),Wr=new l.bp(0,1,1,1);function Lo(b,t,a,d){Ci(b,0,t+a/2,b.transform.width,a,d)}function Pi(b,t,a,d){Ci(b,t-a/2,0,a,b.transform.height,d)}function Ci(b,t,a,d,g,w){const P=b.context,E=P.gl;E.enable(E.SCISSOR_TEST),E.scissor(t*b.pixelRatio,a*b.pixelRatio,d*b.pixelRatio,g*b.pixelRatio),P.clear({color:w}),E.disable(E.SCISSOR_TEST)}function Ga(b,t,a){const d=b.context,g=d.gl,w=b.useProgram("debug"),P=br.disabled,E=Ir.disabled,k=b.colorModeForRenderPass(),z="$debug",N=b.style.map.terrain&&b.style.map.terrain.getTerrainData(a);d.activeTexture.set(g.TEXTURE0);const Z=t.getTileByID(a.key).latestRawTileData,q=Math.floor((Z&&Z.byteLength||0)/1024),Y=t.getTile(a).tileSize,ne=512/Math.min(Y,512)*(a.overscaledZ/b.transform.zoom)*.5;let de=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(de+=` => ${a.overscaledZ}`),(function(fe,me){fe.initDebugOverlayCanvas();const Se=fe.debugOverlayCanvas,ge=fe.context.gl,Te=fe.debugOverlayCanvas.getContext("2d");Te.clearRect(0,0,Se.width,Se.height),Te.shadowColor="white",Te.shadowBlur=2,Te.lineWidth=1.5,Te.strokeStyle="white",Te.textBaseline="top",Te.font="bold 36px Open Sans, sans-serif",Te.fillText(me,5,5),Te.strokeText(me,5,5),fe.debugOverlayTexture.update(Se),fe.debugOverlayTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE)})(b,`${de} ${q}kB`);const pe=b.transform.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(d,g.TRIANGLES,P,E,Br.alphaBlended,Mr.disabled,Xd(l.bp.transparent,ne),null,pe,z,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),w.draw(d,g.LINE_STRIP,P,E,k,Mr.disabled,Xd(l.bp.red),N,pe,z,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function qa(b,t,a,d){const{isRenderingGlobe:g}=d,w=b.context,P=w.gl,E=b.transform,k=b.colorModeForRenderPass(),z=b.getDepthModeFor3D(),N=b.useProgram("terrain");w.bindFramebuffer.set(null),w.viewport.set([0,0,b.width,b.height]);for(const Z of a){const q=t.getTerrainMesh(Z.tileID),Y=b.renderToTexture.getTexture(Z),ne=t.getTerrainData(Z.tileID);w.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,Y.texture);const de=t.getMeshFrameDelta(E.zoom),pe=E.calculateFogMatrix(Z.tileID.toUnwrapped()),fe=Lm(de,pe,b.style.sky,E.pitch,g),me=E.getProjectionData({overscaledTileID:Z.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});N.draw(w,P.TRIANGLES,z,Ir.disabled,k,Mr.backCCW,fe,ne,me,"terrain",q.vertexBuffer,q.indexBuffer,q.segments)}}function $i(b,t){if(!t.mesh){const a=new l.aW;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(1,1),a.emplaceBack(-1,1);const d=new l.aY;d.emplaceBack(0,1,2),d.emplaceBack(0,2,3),t.mesh=new ln(b.createVertexBuffer(a,Fs.members),b.createIndexBuffer(d),l.aX.simpleSegment(0,0,a.length,d.length))}return t.mesh}class ku{constructor(t,a){this.context=new Fh(t),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ls.maxOverzooming+Ls.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new wi}resize(t,a,d){if(this.width=Math.floor(t*d),this.height=Math.floor(a*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style._order)this.style._layers[g].resize()}setup(){const t=this.context,a=new l.aW;a.emplaceBack(0,0),a.emplaceBack(l.a5,0),a.emplaceBack(0,l.a5),a.emplaceBack(l.a5,l.a5),this.tileExtentBuffer=t.createVertexBuffer(a,Fs.members),this.tileExtentSegments=l.aX.simpleSegment(0,0,4,2);const d=new l.aW;d.emplaceBack(0,0),d.emplaceBack(l.a5,0),d.emplaceBack(0,l.a5),d.emplaceBack(l.a5,l.a5),this.debugBuffer=t.createVertexBuffer(d,Fs.members),this.debugSegments=l.aX.simpleSegment(0,0,4,5);const g=new l.ch;g.emplaceBack(0,0,0,0),g.emplaceBack(l.a5,0,l.a5,0),g.emplaceBack(0,l.a5,0,l.a5),g.emplaceBack(l.a5,l.a5,l.a5,l.a5),this.rasterBoundsBuffer=t.createVertexBuffer(g,Rm.members),this.rasterBoundsSegments=l.aX.simpleSegment(0,0,4,2);const w=new l.aW;w.emplaceBack(0,0),w.emplaceBack(l.a5,0),w.emplaceBack(0,l.a5),w.emplaceBack(l.a5,l.a5),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(w,Fs.members),this.rasterBoundsSegmentsPosOnly=l.aX.simpleSegment(0,0,4,5);const P=new l.aW;P.emplaceBack(0,0),P.emplaceBack(1,0),P.emplaceBack(0,1),P.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(P,Fs.members),this.viewportSegments=l.aX.simpleSegment(0,0,4,2);const E=new l.ci;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(E);const k=new l.aY;k.emplaceBack(1,0,2),k.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(k);const z=this.context.gl;this.stencilClearMode=new Ir({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.tileExtentMesh=new ln(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,a=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=l.N();l.c7(d,0,this.width,this.height,0,0,1),l.Q(d,d,[a.drawingBufferWidth,a.drawingBufferHeight,0]);const g={mainMatrix:d,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:d};this.useProgram("clippingMask",null,!0).draw(t,a.TRIANGLES,br.disabled,this.stencilClearMode,Br.disabled,Mr.disabled,null,null,g,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,a,d){if(this.currentStencilSource===t.source||!t.isTileClipped()||!a||!a.length)return;this.currentStencilSource=t.source,this.nextStencilID+a.length>256&&this.clearStencil();const g=this.context;g.setColorMode(Br.disabled),g.setDepthMode(br.disabled);const w={};for(const P of a)w[P.key]=this.nextStencilID++;this._renderTileMasks(w,a,d,!0),this._renderTileMasks(w,a,d,!1),this._tileClippingMaskIDs=w}_renderTileMasks(t,a,d,g){const w=this.context,P=w.gl,E=this.style.projection,k=this.transform,z=this.useProgram("clippingMask");for(const N of a){const Z=t[N.key],q=this.style.map.terrain&&this.style.map.terrain.getTerrainData(N),Y=E.getMeshFromTileID(this.context,N.canonical,g,!0,"stencil"),ne=k.getProjectionData({overscaledTileID:N,applyGlobeMatrix:!d,applyTerrainMatrix:!0});z.draw(w,P.TRIANGLES,br.disabled,new Ir({func:P.ALWAYS,mask:0},Z,255,P.KEEP,P.KEEP,P.REPLACE),Br.disabled,d?Mr.disabled:Mr.backCCW,null,q,ne,"$clipping",Y.vertexBuffer,Y.indexBuffer,Y.segments)}}_renderTilesDepthBuffer(){const t=this.context,a=t.gl,d=this.style.projection,g=this.transform,w=this.useProgram("depth"),P=this.getDepthModeFor3D(),E=gn(g,{tileSize:g.tileSize});for(const k of E){const z=this.style.map.terrain&&this.style.map.terrain.getTerrainData(k),N=d.getMeshFromTileID(this.context,k.canonical,!0,!0,"raster"),Z=g.getProjectionData({overscaledTileID:k,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(t,a.TRIANGLES,P,Ir.disabled,Br.disabled,Mr.backCCW,null,z,Z,"$clipping",N.vertexBuffer,N.indexBuffer,N.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,a=this.context.gl;return new Ir({func:a.NOTEQUAL,mask:255},t,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(t){const a=this.context.gl;return new Ir({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,a.KEEP,a.KEEP,a.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const a=this.context.gl,d=t.sort(((P,E)=>E.overscaledZ-P.overscaledZ)),g=d[d.length-1].overscaledZ,w=d[0].overscaledZ-g+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const P={};for(let E=0;E<w;E++)P[E+g]=new Ir({func:a.GEQUAL,mask:255},E+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=w,[P,d]}return[{[g]:Ir.disabled},d]}stencilConfigForOverlapTwoPass(t){const a=this.context.gl,d=t.sort(((P,E)=>E.overscaledZ-P.overscaledZ)),g=d[d.length-1].overscaledZ,w=d[0].overscaledZ-g+1;if(this.clearStencil(),w>1){const P={},E={};for(let k=0;k<w;k++)P[k+g]=new Ir({func:a.GREATER,mask:255},w+1+k,255,a.KEEP,a.KEEP,a.REPLACE),E[k+g]=new Ir({func:a.GREATER,mask:255},1+k,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID=2*w+1,[P,E,d]}return this.nextStencilID=3,[{[g]:new Ir({func:a.GREATER,mask:255},2,255,a.KEEP,a.KEEP,a.REPLACE)},{[g]:new Ir({func:a.GREATER,mask:255},1,255,a.KEEP,a.KEEP,a.REPLACE)},d]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Br([t.CONSTANT_COLOR,t.ONE],new l.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Br.unblended:Br.alphaBlended}getDepthModeForSublayer(t,a,d){if(!this.opaquePassEnabledForLayer())return br.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new br(d||this.context.gl.LEQUAL,a,[g,g])}getDepthModeFor3D(){return new br(this.context.gl.LEQUAL,br.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,a){var d,g;this.style=t,this.options=a,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(Q()),this.imageManager.beginFrame();const w=this.style._order,P=this.style.tileManagers,E={},k={},z={},N={isRenderingToTexture:!1,isRenderingGlobe:((d=t.projection)===null||d===void 0?void 0:d.transitionState)>0};for(const q in P){const Y=P[q];Y.used&&Y.prepare(this.context),E[q]=Y.getVisibleCoordinates(!1),k[q]=E[q].slice().reverse(),z[q]=Y.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let q=0;q<w.length;q++)if(this.style._layers[w[q]].is3D()){this.opaquePassCutoff=q;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const q of w){const Y=this.style._layers[q];if(!Y.hasOffscreenPass()||Y.isHidden(this.transform.zoom))continue;const ne=k[Y.source];(Y.type==="custom"||ne.length)&&this.renderLayer(this,P[Y.source],Y,ne,N)}if((g=this.style.projection)===null||g===void 0||g.updateGPUdependent({context:this.context,useProgram:q=>this.useProgram(q)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?l.bp.black:l.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(q,Y){const ne=q.context,de=ne.gl,pe=((Me,be,ze)=>{const Ke=Math.cos(be.rollInRadians),Ve=Math.sin(be.rollInRadians),Ge=Ur(be),qe=be.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Me.properties.get("sky-color"),u_horizon_color:Me.properties.get("horizon-color"),u_horizon:[(be.width/2-Ge*Ve)*ze,(be.height/2+Ge*Ke)*ze],u_horizon_normal:[-Ve,Ke],u_sky_horizon_blend:Me.properties.get("sky-horizon-blend")*be.height/2*ze,u_sky_blend:qe}})(Y,q.style.map.transform,q.pixelRatio),fe=new br(de.LEQUAL,br.ReadWrite,[0,1]),me=Ir.disabled,Se=q.colorModeForRenderPass(),ge=q.useProgram("sky"),Te=$i(ne,Y);ge.draw(ne,de.TRIANGLES,fe,me,Se,Mr.disabled,pe,null,void 0,"sky",Te.vertexBuffer,Te.indexBuffer,Te.segments)})(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const q=this.style._layers[w[this.currentLayer]],Y=P[q.source],ne=E[q.source];this._renderTileClippingMasks(q,ne,!1),this.renderLayer(this,Y,q,ne,N)}this.renderPass="translucent";let Z=!1;for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const q=this.style._layers[w[this.currentLayer]],Y=P[q.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(q,N))continue;this.opaquePassEnabledForLayer()||Z||(Z=!0,N.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ne=(q.type==="symbol"?z:k)[q.source];this._renderTileClippingMasks(q,E[q.source],!!this.renderToTexture),this.renderLayer(this,Y,q,ne,N)}if(N.isRenderingGlobe&&(function(q,Y,ne){const de=q.context,pe=de.gl,fe=q.useProgram("atmosphere"),me=new br(pe.LEQUAL,br.ReadOnly,[0,1]),Se=q.transform,ge=(function(qe,vt){const bt=qe.properties.get("position"),ct=[-bt.x,-bt.y,-bt.z],kt=l.ar(new Float64Array(16));return qe.properties.get("anchor")==="map"&&(l.bg(kt,kt,vt.rollInRadians),l.bh(kt,kt,-vt.pitchInRadians),l.bg(kt,kt,vt.bearingInRadians),l.bh(kt,kt,vt.center.lat*Math.PI/180),l.bJ(kt,kt,-vt.center.lng*Math.PI/180)),l.cg(ct,ct,kt),ct})(ne,q.transform),Te=Se.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Me=Y.properties.get("atmosphere-blend")*Te.projectionTransition;if(Me===0)return;const be=ml(Se.worldSize,Se.center.lat),ze=Se.inverseProjectionMatrix,Ke=new Float64Array(4);Ke[3]=1,l.aH(Ke,Ke,Se.modelViewProjectionMatrix),Ke[0]/=Ke[3],Ke[1]/=Ke[3],Ke[2]/=Ke[3],Ke[3]=1,l.aH(Ke,Ke,ze),Ke[0]/=Ke[3],Ke[1]/=Ke[3],Ke[2]/=Ke[3],Ke[3]=1;const Ve=((qe,vt,bt,ct,kt)=>({u_sun_pos:qe,u_atmosphere_blend:vt,u_globe_position:bt,u_globe_radius:ct,u_inv_proj_matrix:kt}))(ge,Me,[Ke[0],Ke[1],Ke[2]],be,ze),Ge=$i(de,Y);fe.draw(de,pe.TRIANGLES,me,Ir.disabled,Br.alphaBlended,Mr.disabled,Ve,null,null,"atmosphere",Ge.vertexBuffer,Ge.indexBuffer,Ge.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const q=(function(Y,ne){let de=null;const pe=Object.values(Y._layers).flatMap((ge=>ge.source&&!ge.isHidden(ne)?[Y.tileManagers[ge.source]]:[])),fe=pe.filter((ge=>ge.getSource().type==="vector")),me=pe.filter((ge=>ge.getSource().type!=="vector")),Se=ge=>{(!de||de.getSource().maxzoom<ge.getSource().maxzoom)&&(de=ge)};return fe.forEach((ge=>Se(ge))),de||me.forEach((ge=>Se(ge))),de})(this.style,this.transform.zoom);q&&(function(Y,ne,de){for(let pe=0;pe<de.length;pe++)Ga(Y,ne,de[pe])})(this,q,q.getVisibleCoordinates())}this.options.showPadding&&(function(q){const Y=q.transform.padding;Lo(q,q.transform.height-(Y.top||0),3,Vh),Lo(q,Y.bottom||0,3,kl),Pi(q,Y.left||0,3,sa),Pi(q,q.transform.width-(Y.right||0),3,wn);const ne=q.transform.centerPoint;(function(de,pe,fe,me){Ci(de,pe-1,fe-10,2,20,me),Ci(de,pe-10,fe-1,20,2,me)})(q,ne.x,q.transform.height-ne.y,Wr)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,d=this.transform.modelViewProjectionMatrix;let g=this.terrainFacilitator.dirty;g||(g=t?!l.cj(a,d):!l.ck(a,d)),g||(g=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),g&&(l.cl(a,d),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(w,P){const E=w.context,k=E.gl,z=w.transform,N=Br.unblended,Z=new br(k.LEQUAL,br.ReadWrite,[0,1]),q=P.tileManager.getRenderableTiles(),Y=w.useProgram("terrainDepth");E.bindFramebuffer.set(P.getFramebuffer("depth").framebuffer),E.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),E.clear({color:l.bp.transparent,depth:1});for(const ne of q){const de=P.getTerrainMesh(ne.tileID),pe=P.getTerrainData(ne.tileID),fe=z.getProjectionData({overscaledTileID:ne.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),me={u_ele_delta:P.getMeshFrameDelta(z.zoom)};Y.draw(E,k.TRIANGLES,Z,Ir.disabled,N,Mr.backCCW,me,pe,fe,"terrain",de.vertexBuffer,de.indexBuffer,de.segments)}E.bindFramebuffer.set(null),E.viewport.set([0,0,w.width,w.height])})(this,this.style.map.terrain),(function(w,P){const E=w.context,k=E.gl,z=w.transform,N=Br.unblended,Z=new br(k.LEQUAL,br.ReadWrite,[0,1]),q=P.getCoordsTexture(),Y=P.tileManager.getRenderableTiles(),ne=w.useProgram("terrainCoords");E.bindFramebuffer.set(P.getFramebuffer("coords").framebuffer),E.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),E.clear({color:l.bp.transparent,depth:1}),P.coordsIndex=[];for(const de of Y){const pe=P.getTerrainMesh(de.tileID),fe=P.getTerrainData(de.tileID);E.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,q.texture);const me={u_terrain_coords_id:(255-P.coordsIndex.length)/255,u_texture:0,u_ele_delta:P.getMeshFrameDelta(z.zoom)},Se=z.getProjectionData({overscaledTileID:de.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ne.draw(E,k.TRIANGLES,Z,Ir.disabled,N,Mr.backCCW,me,fe,Se,"terrain",pe.vertexBuffer,pe.indexBuffer,pe.segments),P.coordsIndex.push(de.tileID.key)}E.bindFramebuffer.set(null),E.viewport.set([0,0,w.width,w.height])})(this,this.style.map.terrain))}renderLayer(t,a,d,g,w){d.isHidden(this.transform.zoom)||(d.type==="background"||d.type==="custom"||(g||[]).length)&&(this.id=d.id,l.cm(d)?(function(P,E,k,z,N,Z){if(P.renderPass!=="translucent")return;const{isRenderingToTexture:q}=Z,Y=Ir.disabled,ne=P.colorModeForRenderPass();(k._unevaluatedLayout.hasValue("text-variable-anchor")||k._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(de,pe,fe,me,Se,ge,Te,Me,be){const ze=pe.transform,Ke=pe.style.map.terrain,Ve=Se==="map",Ge=ge==="map";for(const qe of de){const vt=me.getTile(qe),bt=vt.getBucket(fe);if(!bt||!bt.text||!bt.text.segments.get().length)continue;const ct=l.ay(bt.textSizeData,ze.zoom),kt=l.aN(vt,1,pe.transform.zoom),pr=ds(Ve,pe.transform,kt),Qr=fe.layout.get("icon-text-fit")!=="none"&&bt.hasIconData();if(ct){const Sn=Math.pow(2,ze.zoom-vt.tileID.overscaledZ),cn=Ke?(Pn,un)=>Ke.getElevation(qe,Pn,un):null;rf(bt,Ve,Ge,be,ze,pr,Sn,ct,Qr,l.aO(ze,vt,Te,Me),qe.toUnwrapped(),cn)}}})(z,P,k,E,k.layout.get("text-rotation-alignment"),k.layout.get("text-pitch-alignment"),k.paint.get("text-translate"),k.paint.get("text-translate-anchor"),N),k.paint.get("icon-opacity").constantOr(1)!==0&&Il(P,E,k,z,!1,k.paint.get("icon-translate"),k.paint.get("icon-translate-anchor"),k.layout.get("icon-rotation-alignment"),k.layout.get("icon-pitch-alignment"),k.layout.get("icon-keep-upright"),Y,ne,q),k.paint.get("text-opacity").constantOr(1)!==0&&Il(P,E,k,z,!0,k.paint.get("text-translate"),k.paint.get("text-translate-anchor"),k.layout.get("text-rotation-alignment"),k.layout.get("text-pitch-alignment"),k.layout.get("text-keep-upright"),Y,ne,q),E.map.showCollisionBoxes&&(Ua(P,E,k,z,!0),Ua(P,E,k,z,!1))})(t,a,d,g,this.style.placement.variableOffsets,w):l.cn(d)?(function(P,E,k,z,N){if(P.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=N,q=k.paint.get("circle-opacity"),Y=k.paint.get("circle-stroke-width"),ne=k.paint.get("circle-stroke-opacity"),de=!k.layout.get("circle-sort-key").isConstant();if(q.constantOr(1)===0&&(Y.constantOr(1)===0||ne.constantOr(1)===0))return;const pe=P.context,fe=pe.gl,me=P.transform,Se=P.getDepthModeForSublayer(0,br.ReadOnly),ge=Ir.disabled,Te=P.colorModeForRenderPass(),Me=[],be=me.getCircleRadiusCorrection();for(let ze=0;ze<z.length;ze++){const Ke=z[ze],Ve=E.getTile(Ke),Ge=Ve.getBucket(k);if(!Ge)continue;const qe=k.paint.get("circle-translate"),vt=k.paint.get("circle-translate-anchor"),bt=l.aO(me,Ve,qe,vt),ct=Ge.programConfigurations.get(k.id),kt=P.useProgram("circle",ct),pr=Ge.layoutVertexBuffer,Qr=Ge.indexBuffer,Sn=P.style.map.terrain&&P.style.map.terrain.getTerrainData(Ke),cn={programConfiguration:ct,program:kt,layoutVertexBuffer:pr,indexBuffer:Qr,uniformValues:Hd(P,Ve,k,bt,be),terrainData:Sn,projectionData:me.getProjectionData({overscaledTileID:Ke,applyGlobeMatrix:!Z,applyTerrainMatrix:!0})};if(de){const Pn=Ge.segments.get();for(const un of Pn)Me.push({segments:new l.aX([un]),sortKey:un.sortKey,state:cn})}else Me.push({segments:Ge.segments,sortKey:0,state:cn})}de&&Me.sort(((ze,Ke)=>ze.sortKey-Ke.sortKey));for(const ze of Me){const{programConfiguration:Ke,program:Ve,layoutVertexBuffer:Ge,indexBuffer:qe,uniformValues:vt,terrainData:bt,projectionData:ct}=ze.state;Ve.draw(pe,fe.TRIANGLES,Se,ge,Te,Mr.backCCW,vt,bt,ct,k.id,Ge,qe,ze.segments,k.paint,P.transform.zoom,Ke)}})(t,a,d,g,w):l.co(d)?(function(P,E,k,z,N){if(k.paint.get("heatmap-opacity")===0)return;const Z=P.context,{isRenderingToTexture:q,isRenderingGlobe:Y}=N;if(P.style.map.terrain){for(const ne of z){const de=E.getTile(ne);E.hasRenderableParent(ne)||(P.renderPass==="offscreen"?nf(P,de,k,ne,Y):P.renderPass==="translucent"&&pp(P,k,ne,q,Y))}Z.viewport.set([0,0,P.width,P.height])}else P.renderPass==="offscreen"?(function(ne,de,pe,fe){const me=ne.context,Se=me.gl,ge=ne.transform,Te=Ir.disabled,Me=new Br([Se.ONE,Se.ONE],l.bp.transparent,[!0,!0,!0,!0]);(function(be,ze,Ke){const Ve=be.gl;be.activeTexture.set(Ve.TEXTURE1),be.viewport.set([0,0,ze.width/4,ze.height/4]);let Ge=Ke.heatmapFbos.get(l.cd);Ge?(Ve.bindTexture(Ve.TEXTURE_2D,Ge.colorAttachment.get()),be.bindFramebuffer.set(Ge.framebuffer)):(Ge=Iu(be,ze.width/4,ze.height/4),Ke.heatmapFbos.set(l.cd,Ge))})(me,ne,pe),me.clear({color:l.bp.transparent});for(let be=0;be<fe.length;be++){const ze=fe[be];if(de.hasRenderableParent(ze))continue;const Ke=de.getTile(ze),Ve=Ke.getBucket(pe);if(!Ve)continue;const Ge=Ve.programConfigurations.get(pe.id),qe=ne.useProgram("heatmap",Ge),vt=ge.getProjectionData({overscaledTileID:ze,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),bt=ge.getCircleRadiusCorrection();qe.draw(me,Se.TRIANGLES,br.disabled,Te,Me,Mr.backCCW,Sc(Ke,ge.zoom,pe.paint.get("heatmap-intensity"),bt),null,vt,pe.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ve.segments,pe.paint,ge.zoom,Ge)}me.viewport.set([0,0,ne.width,ne.height])})(P,E,k,z):P.renderPass==="translucent"&&(function(ne,de){const pe=ne.context,fe=pe.gl;pe.setColorMode(ne.colorModeForRenderPass());const me=de.heatmapFbos.get(l.cd);me&&(pe.activeTexture.set(fe.TEXTURE0),fe.bindTexture(fe.TEXTURE_2D,me.colorAttachment.get()),pe.activeTexture.set(fe.TEXTURE1),kc(pe,de).bind(fe.LINEAR,fe.CLAMP_TO_EDGE),ne.useProgram("heatmapTexture").draw(pe,fe.TRIANGLES,br.disabled,Ir.disabled,ne.colorModeForRenderPass(),Mr.disabled,Kd(ne,de,0,1),null,null,de.id,ne.viewportBuffer,ne.quadTriangleIndexBuffer,ne.viewportSegments,de.paint,ne.transform.zoom))})(P,k)})(t,a,d,g,w):l.cp(d)?(function(P,E,k,z,N){if(P.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=N,q=k.paint.get("line-opacity"),Y=k.paint.get("line-width");if(q.constantOr(1)===0||Y.constantOr(1)===0)return;const ne=P.getDepthModeForSublayer(0,br.ReadOnly),de=P.colorModeForRenderPass(),pe=k.paint.get("line-dasharray"),fe=pe.constantOr(1),me=k.paint.get("line-pattern"),Se=me.constantOr(1),ge=k.paint.get("line-gradient"),Te=k.getCrossfadeParameters();let Me;Me=Se?"linePattern":fe&&ge?"lineGradientSDF":fe?"lineSDF":ge?"lineGradient":"line";const be=P.context,ze=be.gl,Ke=P.transform;let Ve=!0;for(const Ge of z){const qe=E.getTile(Ge);if(Se&&!qe.patternsLoaded())continue;const vt=qe.getBucket(k);if(!vt)continue;const bt=vt.programConfigurations.get(k.id),ct=P.context.program.get(),kt=P.useProgram(Me,bt),pr=Ve||kt.program!==ct,Qr=P.style.map.terrain&&P.style.map.terrain.getTerrainData(Ge),Sn=me.constantOr(null),cn=pe&&pe.constantOr(null);if(Sn&&qe.imageAtlas){const Ei=qe.imageAtlas,Kn=Ei.patternPositions[Sn.to.toString()],Hr=Ei.patternPositions[Sn.from.toString()];Kn&&Hr&&bt.setConstantPatternPositions(Kn,Hr)}else if(cn){const Ei=k.layout.get("line-cap")==="round",Kn=P.lineAtlas.getDash(cn.to,Ei),Hr=P.lineAtlas.getDash(cn.from,Ei);bt.setConstantDashPositions(Kn,Hr)}const Pn=Ke.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!Z,applyTerrainMatrix:!0}),un=Ke.getPixelScale();let Cn;Se?(Cn=Sh(P,qe,k,un,Te),sf(be,ze,qe,bt,Te)):fe&&ge?(Cn=Pc(P,qe,k,un,Te,vt.lineClipsArray.length),Li(P,E,be,ze,k,vt,Ge,bt,Te)):fe?(Cn=Ph(P,qe,k,un,Te),yn(P,be,ze,bt,pr,Te)):ge?(Cn=lp(P,qe,k,un,vt.lineClipsArray.length),Ui(P,E,be,ze,k,vt,Ge)):Cn=Na(P,qe,k,un);const Dn=P.stencilModeForClipping(Ge);kt.draw(be,ze.TRIANGLES,ne,Dn,de,Mr.disabled,Cn,Qr,Pn,k.id,vt.layoutVertexBuffer,vt.indexBuffer,vt.segments,k.paint,P.transform.zoom,bt,vt.layoutVertexBuffer2),Ve=!1}})(t,a,d,g,w):l.cq(d)?(function(P,E,k,z,N){const Z=k.paint.get("fill-color"),q=k.paint.get("fill-opacity");if(q.constantOr(1)===0)return;const{isRenderingToTexture:Y}=N,ne=P.colorModeForRenderPass(),de=k.paint.get("fill-pattern"),pe=P.opaquePassEnabledForLayer()&&!de.constantOr(1)&&Z.constantOr(l.bp.transparent).a===1&&q.constantOr(0)===1?"opaque":"translucent";if(P.renderPass===pe){const fe=P.getDepthModeForSublayer(1,P.renderPass==="opaque"?br.ReadWrite:br.ReadOnly);Al(P,E,k,z,fe,ne,!1,Y)}if(P.renderPass==="translucent"&&k.paint.get("fill-antialias")){const fe=P.getDepthModeForSublayer(k.getPaintProperty("fill-outline-color")?2:0,br.ReadOnly);Al(P,E,k,z,fe,ne,!0,Y)}})(t,a,d,g,w):l.cr(d)?(function(P,E,k,z,N){const Z=k.paint.get("fill-extrusion-opacity");if(Z===0)return;const{isRenderingToTexture:q}=N;if(P.renderPass==="translucent"){const Y=new br(P.context.gl.LEQUAL,br.ReadWrite,P.depthRangeFor3D);if(Z!==1||k.paint.get("fill-extrusion-pattern").constantOr(1))Bh(P,E,k,z,Y,Ir.disabled,Br.disabled,q),Bh(P,E,k,z,Y,P.stencilModeFor3D(),P.colorModeForRenderPass(),q);else{const ne=P.colorModeForRenderPass();Bh(P,E,k,z,Y,Ir.disabled,ne,q)}}})(t,a,d,g,w):l.cs(d)?(function(P,E,k,z,N){if(P.renderPass!=="offscreen"&&P.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=N,q=P.context,Y=P.style.projection.useSubdivision,ne=P.getDepthModeForSublayer(0,br.ReadOnly),de=P.colorModeForRenderPass();if(P.renderPass==="offscreen")(function(pe,fe,me,Se,ge,Te,Me){const be=pe.context,ze=be.gl;for(const Ke of me){const Ve=fe.getTile(Ke),Ge=Ve.dem;if(!Ge||!Ge.data||!Ve.needsHillshadePrepare)continue;const qe=Ge.dim,vt=Ge.stride,bt=Ge.getPixels();if(be.activeTexture.set(ze.TEXTURE1),be.pixelStoreUnpackPremultiplyAlpha.set(!1),Ve.demTexture=Ve.demTexture||pe.getTileTexture(vt),Ve.demTexture){const kt=Ve.demTexture;kt.update(bt,{premultiply:!1}),kt.bind(ze.NEAREST,ze.CLAMP_TO_EDGE)}else Ve.demTexture=new l.T(be,bt,ze.RGBA,{premultiply:!1}),Ve.demTexture.bind(ze.NEAREST,ze.CLAMP_TO_EDGE);be.activeTexture.set(ze.TEXTURE0);let ct=Ve.fbo;if(!ct){const kt=new l.T(be,{width:qe,height:qe,data:null},ze.RGBA);kt.bind(ze.LINEAR,ze.CLAMP_TO_EDGE),ct=Ve.fbo=be.createFramebuffer(qe,qe,!0,!1),ct.colorAttachment.set(kt.texture)}be.bindFramebuffer.set(ct.framebuffer),be.viewport.set([0,0,qe,qe]),pe.useProgram("hillshadePrepare").draw(be,ze.TRIANGLES,ge,Te,Me,Mr.disabled,vu(Ve.tileID,Ge),null,null,Se.id,pe.rasterBoundsBuffer,pe.quadTriangleIndexBuffer,pe.rasterBoundsSegments),Ve.needsHillshadePrepare=!1}})(P,E,z,k,ne,Ir.disabled,de),q.viewport.set([0,0,P.width,P.height]);else if(P.renderPass==="translucent")if(Y){const[pe,fe,me]=P.stencilConfigForOverlapTwoPass(z);$a(P,E,k,me,pe,ne,de,!1,Z),$a(P,E,k,me,fe,ne,de,!0,Z)}else{const[pe,fe]=P.getStencilConfigForOverlapAndUpdateStencilID(z);$a(P,E,k,fe,pe,ne,de,!1,Z)}})(t,a,d,g,w):l.ct(d)?(function(P,E,k,z,N){if(P.renderPass!=="translucent"||!z.length)return;const{isRenderingToTexture:Z}=N,q=P.style.projection.useSubdivision,Y=P.getDepthModeForSublayer(0,br.ReadOnly),ne=P.colorModeForRenderPass();if(q){const[de,pe,fe]=P.stencilConfigForOverlapTwoPass(z);fo(P,E,k,fe,de,Y,ne,!1,Z),fo(P,E,k,fe,pe,Y,ne,!0,Z)}else{const[de,pe]=P.getStencilConfigForOverlapAndUpdateStencilID(z);fo(P,E,k,pe,de,Y,ne,!1,Z)}})(t,a,d,g,w):l.bU(d)?(function(P,E,k,z,N){if(P.renderPass!=="translucent"||k.paint.get("raster-opacity")===0||!z.length)return;const{isRenderingToTexture:Z}=N,q=E.getSource(),Y=P.style.projection.useSubdivision;if(q instanceof Mt)mo(P,E,k,z,null,!1,!1,q.tileCoords,q.flippedWindingOrder,Z);else if(Y){const[ne,de,pe]=P.stencilConfigForOverlapTwoPass(z);mo(P,E,k,pe,ne,!1,!0,po,!1,Z),mo(P,E,k,pe,de,!0,!0,po,!1,Z)}else{const[ne,de]=P.getStencilConfigForOverlapAndUpdateStencilID(z);mo(P,E,k,de,ne,!1,!0,po,!1,Z)}})(t,a,d,g,w):l.cu(d)?(function(P,E,k,z,N){const Z=k.paint.get("background-color"),q=k.paint.get("background-opacity");if(q===0)return;const{isRenderingToTexture:Y}=N,ne=P.context,de=ne.gl,pe=P.style.projection,fe=P.transform,me=fe.tileSize,Se=k.paint.get("background-pattern");if(P.isPatternMissing(Se))return;const ge=!Se&&Z.a===1&&q===1&&P.opaquePassEnabledForLayer()?"opaque":"translucent";if(P.renderPass!==ge)return;const Te=Ir.disabled,Me=P.getDepthModeForSublayer(0,ge==="opaque"?br.ReadWrite:br.ReadOnly),be=P.colorModeForRenderPass(),ze=P.useProgram(Se?"backgroundPattern":"background"),Ke=z||gn(fe,{tileSize:me,terrain:P.style.map.terrain});Se&&(ne.activeTexture.set(de.TEXTURE0),P.imageManager.bind(P.context));const Ve=k.getCrossfadeParameters();for(const Ge of Ke){const qe=fe.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),vt=Se?uo(q,P,Se,{tileID:Ge,tileSize:me},Ve):Jd(q,Z),bt=P.style.map.terrain&&P.style.map.terrain.getTerrainData(Ge),ct=pe.getMeshFromTileID(ne,Ge.canonical,!1,!0,"raster");ze.draw(ne,de.TRIANGLES,Me,Te,be,Mr.backCCW,vt,bt,qe,k.id,ct.vertexBuffer,ct.indexBuffer,ct.segments)}})(t,0,d,g,w):l.cv(d)&&(function(P,E,k,z){const{isRenderingGlobe:N}=z,Z=P.context,q=k.implementation,Y=P.style.projection,ne=P.transform,de=ne.getProjectionDataForCustomLayer(N),pe={farZ:ne.farZ,nearZ:ne.nearZ,fov:ne.fov*Math.PI/180,modelViewProjectionMatrix:ne.modelViewProjectionMatrix,projectionMatrix:ne.projectionMatrix,shaderData:{variantName:Y.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Y.shaderPreludeCode.vertexSource}`,define:Y.shaderDefine},defaultProjectionData:de},fe=q.renderingMode?q.renderingMode:"2d";if(P.renderPass==="offscreen"){const me=q.prerender;me&&(P.setCustomLayerDefaults(),Z.setColorMode(P.colorModeForRenderPass()),me.call(q,Z.gl,pe),Z.setDirty(),P.setBaseState())}else if(P.renderPass==="translucent"){P.setCustomLayerDefaults(),Z.setColorMode(P.colorModeForRenderPass()),Z.setStencilMode(Ir.disabled);const me=fe==="3d"?P.getDepthModeFor3D():P.getDepthModeForSublayer(0,br.ReadOnly);Z.setDepthMode(me),q.render(Z.gl,pe),Z.setDirty(),P.setBaseState(),Z.bindFramebuffer.set(null)}})(t,0,d,w))}saveTileTexture(t){const a=this._tileTextures[t.size[0]];a?a.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const a=this._tileTextures[t];return a&&a.length>0?a.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const a=this.imageManager.getPattern(t.from.toString()),d=this.imageManager.getPattern(t.to.toString());return!a||!d}useProgram(t,a,d=!1,g=[]){this.cache=this.cache||{};const w=!!this.style.map.terrain,P=this.style.projection,E=d?Yr.projectionMercator:P.shaderPreludeCode,k=d?rs:P.shaderDefine,z=t+(a?a.cacheKey:"")+`/${d?fs:P.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(w?"/terrain":"")+(g?`/${g.join("/")}`:"");return this.cache[z]||(this.cache[z]=new bh(this.context,Yr[t],a,cp[t],this._showOverdrawInspector,w,E,k,g)),this.cache[z]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var t,a;if(this._tileTextures){for(const d in this._tileTextures){const g=this._tileTextures[d];if(g)for(const w of g)w.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((t=this.tileExtentMesh.vertexBuffer)===null||t===void 0||t.destroy()),this.tileExtentMesh&&((a=this.tileExtentMesh.indexBuffer)===null||a===void 0||a.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const d in this.cache){const g=this.cache[d];g&&g.program&&this.context.gl.deleteProgram(g.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:a}=this.context.gl;return this.width!==t||this.height!==a}}function Uh(b,t){let a,d=!1,g=null,w=null;const P=()=>{g=null,d&&(b.apply(w,a),g=setTimeout(P,t),d=!1)};return(...E)=>(d=!0,w=this,a=E,g||P(),g)}class $h{constructor(t){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let d;return a.split("&").map((g=>g.split("="))).forEach((g=>{g[0]===this._hashName&&(d=g)})),(d&&d[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(!this._isValidHash(a))return!1;const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:d,pitch:+(a[4]||0)}),!0},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const d=a.join("/");let g=d;g.split("&").length>0&&(g=g.split("&")[0]),this._hashName&&(g=`${this._hashName}=${d}`);let w=window.location.hash.replace(g,"");w.startsWith("#&")?w=w.slice(0,1)+w.slice(2):w==="#"&&(w="");let P=window.location.href.replace(/(#.+)?$/,w);P=P.replace("&&","&"),window.history.replaceState(window.history.state,null,P)},this._updateHash=Uh(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const a=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,g=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,g),P=Math.round(a.lng*w)/w,E=Math.round(a.lat*w)/w,k=this._map.getBearing(),z=this._map.getPitch();let N="";if(N+=t?`/${P}/${E}/${d}`:`${d}/${E}/${P}`,(k||z)&&(N+="/"+Math.round(10*k)/10),z&&(N+=`/${Math.round(z)}`),this._hashName){const Z=this._hashName;let q=!1;const Y=window.location.hash.slice(1).split("&").map((ne=>{const de=ne.split("=")[0];return de===Z?(q=!0,`${de}=${N}`):ne})).filter((ne=>ne));return q||Y.push(`${Z}=${N}`),`#${Y.join("&")}`}return`#${N}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new l.V(+t[2],+t[1])}catch{return!1}const a=+t[0],d=+(t[3]||0),g=+(t[4]||0);return a>=this._map.getMinZoom()&&a<=this._map.getMaxZoom()&&d>=-180&&d<=180&&g>=this._map.getMinPitch()&&g<=this._map.getMaxPitch()}}const go={linearity:.3,easing:l.cw(0,0,.3,1)},of=l.e({deceleration:2500,maxSpeed:1400},go),oi=l.e({deceleration:20,maxSpeed:1400},go),ms=l.e({deceleration:1e3,maxSpeed:360},go),Gh=l.e({deceleration:1e3,maxSpeed:90},go),Bs=l.e({deceleration:1e3,maxSpeed:360},go);class zm{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Q(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,a=Q();for(;t.length>0&&a-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,roll:0,pan:new l.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)a.zoom+=w.zoomDelta||0,a.bearing+=w.bearingDelta||0,a.pitch+=w.pitchDelta||0,a.roll+=w.rollDelta||0,w.panDelta&&a.pan._add(w.panDelta),w.around&&(a.around=w.around),w.pinchAround&&(a.pinchAround=w.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(a.pan.mag()){const w=zo(a.pan.mag(),d,l.e({},of,t||{})),P=a.pan.mult(w.amount/a.pan.mag()),E=this._map.cameraHelper.handlePanInertia(P,this._map.transform);g.center=E.easingCenter,g.offset=E.easingOffset,Vs(g,w)}if(a.zoom){const w=zo(a.zoom,d,oi);g.zoom=this._map.transform.zoom+w.amount,Vs(g,w)}if(a.bearing){const w=zo(a.bearing,d,ms);g.bearing=this._map.transform.bearing+l.an(w.amount,-179,179),Vs(g,w)}if(a.pitch){const w=zo(a.pitch,d,Gh);g.pitch=this._map.transform.pitch+w.amount,Vs(g,w)}if(a.roll){const w=zo(a.roll,d,Bs);g.roll=this._map.transform.roll+l.an(w.amount,-179,179),Vs(g,w)}if(g.zoom||g.bearing){const w=a.pinchAround===void 0?a.around:a.pinchAround;g.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),l.e(g,{noMoveStart:!0})}}function Vs(b,t){(!b.duration||b.duration<t.duration)&&(b.duration=t.duration,b.easing=t.easing)}function zo(b,t,a){const{maxSpeed:d,linearity:g,deceleration:w}=a,P=l.an(b*g/(t/1e3),-d,d),E=Math.abs(P)/(w*g);return{easing:a.easing,duration:1e3*E,amount:P*(E/2)}}class $n extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,d,g={}){d=d instanceof MouseEvent?d:new MouseEvent(t,d);const w=X.mousePos(a.getCanvas(),d),P=a.unproject(w);super(t,l.e({point:w,lngLat:P,originalEvent:d},g)),this._defaultPrevented=!1,this.target=a}}class Za extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,d){const g=t==="touchend"?d.changedTouches:d.touches,w=X.touchPos(a.getCanvasContainer(),g),P=w.map((k=>a.unproject(k))),E=w.reduce(((k,z,N,Z)=>k.add(z.div(Z.length))),new l.P(0,0));super(t,{points:w,point:E,lngLats:P,lngLat:a.unproject(E),originalEvent:d}),this._defaultPrevented=!1}}class Du extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,d){super(t,{originalEvent:d}),this._defaultPrevented=!1}}class Us{constructor(t,a){this._map=t,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Du(t.type,this._map,t))}mousedown(t,a){return this._mousedownPos=a,this._firePreventable(new $n(t.type,this._map,t))}mouseup(t){this._map.fire(new $n(t.type,this._map,t))}click(t,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new $n(t.type,this._map,t))}dblclick(t){return this._firePreventable(new $n(t.type,this._map,t))}mouseover(t){this._map.fire(new $n(t.type,this._map,t))}mouseout(t){this._map.fire(new $n(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Za(t.type,this._map,t))}touchmove(t){this._map.fire(new Za(t.type,this._map,t))}touchend(t){this._map.fire(new Za(t.type,this._map,t))}touchcancel(t){this._map.fire(new Za(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class $s{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new $n(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $n("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new $n(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Gs{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(l.P.convert(t),this._map.terrain)}}class gs{constructor(t,a){this._map=t,this._tr=new Gs(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,a){this.isEnabled()&&t.shiftKey&&t.button===0&&(X.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(t,a){if(!this._active)return;const d=a;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=d,this._box||(this._box=X.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const w=Math.min(g.x,d.x),P=Math.max(g.x,d.x),E=Math.min(g.y,d.y),k=Math.max(g.y,d.y);X.setTransform(this._box,`translate(${w}px,${E}px)`),this._box.style.width=P-w+"px",this._box.style.height=k-E+"px"}mouseupWindow(t,a){if(!this._active||t.button!==0)return;const d=this._startPos,g=a;if(this.reset(),X.suppressClick(),d.x!==g.x||d.y!==g.y)return this._map.fire(new l.l("boxzoomend",{originalEvent:t})),{cameraAnimation:w=>w.fitScreenCoordinates(d,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(X.remove(this._box),this._box=null),X.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,a){return this._map.fire(new l.l(t,{originalEvent:a}))}}function di(b,t){if(b.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${t.length}`);const a={};for(let d=0;d<b.length;d++)a[b[d].identifier]=t[d];return a}class zt{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,a,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),d.length===this.numTouches&&(this.centroid=(function(g){const w=new l.P(0,0);for(const P of g)w._add(P);return w.div(g.length)})(a),this.touches=di(d,a)))}touchmove(t,a,d){if(this.aborted||!this.centroid)return;const g=di(d,a);for(const w in this.touches){const P=g[w];(!P||P.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(t,a,d){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class Ru{constructor(t){this.singleTap=new zt(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,a,d){this.singleTap.touchstart(t,a,d)}touchmove(t,a,d){this.singleTap.touchmove(t,a,d)}touchend(t,a,d){const g=this.singleTap.touchend(t,a,d);if(g){const w=t.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(g)<30;if(w&&P||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class Lu{constructor(t){this._tr=new Gs(t),this._zoomIn=new Ru({numTouches:1,numTaps:2}),this._zoomOut=new Ru({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,a,d){this._zoomIn.touchstart(t,a,d),this._zoomOut.touchstart(t,a,d)}touchmove(t,a,d){this._zoomIn.touchmove(t,a,d),this._zoomOut.touchmove(t,a,d)}touchend(t,a,d){const g=this._zoomIn.touchend(t,a,d),w=this._zoomOut.touchend(t,a,d),P=this._tr;return g?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:P.zoom+1,around:P.unproject(g)},{originalEvent:t})}):w?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:P.zoom-1,around:P.unproject(w)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wa{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const a=this._moveFunction(...t);if(a.bearingDelta||a.pitchDelta||a.rollDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(t,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(a)?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,a){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const g=Array.isArray(a)?a[0]:a;return!this._moved&&g.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=g,this._move(d,g))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&X.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const zi=0,Fi=2,Tn={[zi]:1,[Fi]:2};class ss{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const a=X.mouseButton(t);this._eventButton=a}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!(function(a,d){const g=Tn[d];return a.buttons===void 0||(a.buttons&g)!==g})(t,this._eventButton)}isValidEndEvent(t){return X.mouseButton(t)===this._eventButton}}class qh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class af{constructor(t=new ss({checkCorrectEvent:()=>!0}),a=new qh){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=a}_executeRelevantHandler(t,a,d){return t instanceof MouseEvent?a(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?d(t):void 0}startMove(t){this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.startMove(a)),(a=>this.oneFingerTouchMoveStateManager.startMove(a)))}endMove(t){this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.endMove(a)),(a=>this.oneFingerTouchMoveStateManager.endMove(a)))}isValidStartEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidStartEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidStartEvent(a)))}isValidMoveEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidMoveEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(a)))}isValidEndEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidEndEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidEndEvent(a)))}}const Ha=b=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=t=>{t.preventDefault()}};class lf{constructor(t,a){this._clickTolerance=t.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,a,d){return this._calculateTransform(t,a,d)}touchmove(t,a,d){if(this._active){if(!this._shouldBePrevented(d.length))return t.preventDefault(),this._calculateTransform(t,a,d);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,a,d){this._calculateTransform(t,a,d),this._active&&this._shouldBePrevented(d.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,a,d){d.length>0&&(this._active=!0);const g=di(d,a),w=new l.P(0,0),P=new l.P(0,0);let E=0;for(const z in g){const N=g[z],Z=this._touches[z];Z&&(w._add(N),P._add(N.sub(Z)),E++,g[z]=N)}if(this._touches=g,this._shouldBePrevented(E)||!P.mag())return;const k=P.div(E);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(E),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,a,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([a[0],a[1]]))}touchmove(t,a,d){if(!this._firstTwoTouches)return;t.preventDefault();const[g,w]=this._firstTwoTouches,P=Dl(d,a,g),E=Dl(d,a,w);if(!P||!E)return;const k=this._aroundCenter?null:P.add(E).div(2);return this._move([P,E],k,t)}touchend(t,a,d){if(!this._firstTwoTouches)return;const[g,w]=this._firstTwoTouches,P=Dl(d,a,g),E=Dl(d,a,w);P&&E||(this._active&&X.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Dl(b,t,a){for(let d=0;d<b.length;d++)if(b[d].identifier===a)return t[d]}function cf(b,t){return Math.log(b/t)/Math.LN2}class Xa extends zu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,a){const d=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(cf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:cf(this._distance,d),pinchAround:a}}}function Zh(b,t){return 180*b.angleWith(t)/Math.PI}class uf extends zu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,a,d){const g=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Zh(this._vector,g),pinchAround:a}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const a=25/(Math.PI*this._minDiameter)*360,d=Zh(t,this._startVector);return Math.abs(d)<a}}function Rl(b){return Math.abs(b.y)>Math.abs(b.x)}class Fu extends zu{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,a,d){super.touchstart(t,a,d),this._currentTouchCount=d.length}_start(t){this._lastPoints=t,Rl(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,a,d){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const g=t[0].sub(this._lastPoints[0]),w=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,w,d.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(g.y+w.y)/2*-.5}):void 0}gestureBeginsVertically(t,a,d){if(this._valid!==void 0)return this._valid;const g=t.mag()>=2,w=a.mag()>=2;if(!g&&!w)return;if(!g||!w)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const P=t.y>0==a.y>0;return Rl(t)&&Rl(a)&&P}}const oa={panStep:100,bearingStep:15,pitchStep:10};class rn{constructor(t){this._tr=new Gs(t);const a=oa;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let a=0,d=0,g=0,w=0,P=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:t.shiftKey?d=-1:(t.preventDefault(),w=-1);break;case 39:t.shiftKey?d=1:(t.preventDefault(),w=1);break;case 38:t.shiftKey?g=1:(t.preventDefault(),P=-1);break;case 40:t.shiftKey?g=-1:(t.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(d=0,g=0),{cameraAnimation:E=>{const k=this._tr;E.easeTo({duration:300,easeId:"keyboardHandler",easing:Dc,zoom:a?Math.round(k.zoom)+a*(t.shiftKey?2:1):k.zoom,bearing:k.bearing+d*this._bearingStep,pitch:k.pitch+g*this._pitchStep,offset:[-w*this._panStep,-P*this._panStep],center:k.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Dc(b){return b*(2-b)}const Rc=4.000244140625,Ll=1/450;class zl{constructor(t,a){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=t,this._tr=new Gs(t),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Ll}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let a=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const d=Q(),g=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,a!==0&&a%Rc==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(g*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),t.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=t,this._delta-=a,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=X.mousePos(this._map.getCanvas(),t),d=this._tr;this._aroundPoint=this._aroundCenter?d.transform.locationToScreenPoint(l.V.convert(d.center)):a,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const E=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=E),typeof this._targetZoom=="number"&&(this._targetZoom+=E)}if(this._delta!==0){const E=this._type==="wheel"&&Math.abs(this._delta)>Rc?this._wheelZoomRate:this._defaultZoomRate;let k=2/(1+Math.exp(-Math.abs(this._delta*E)));this._delta<0&&k!==0&&(k=1/k);const z=typeof this._targetZoom!="number"?t.scale:l.aq(this._targetZoom);this._targetZoom=t.applyConstrain(t.getCameraLngLat(),l.at(z*k)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,d=this._startZoom,g=this._easing;let w,P=!1;if(this._type==="wheel"&&d&&g){const E=Q()-this._lastWheelEventTime,k=Math.min((E+5)/200,1),z=g(k);w=l.G.number(d,a,z),k<1?this._frameId||(this._frameId=!0):P=!0}else w=a,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=w,{noInertia:!0,needsRenderFrame:!P,zoomDelta:w-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let a=l.cy;if(this._prevEase){const d=this._prevEase,g=(Q()-d.start)/d.duration,w=d.easing(g+.01)-d.easing(g),P=.27/Math.sqrt(w*w+1e-4)*.01,E=Math.sqrt(.0729-P*P);a=l.cw(P,E,.25,1)}return this._prevEase={start:Q(),duration:t,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Ka{constructor(t,a){this._clickZoom=t,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Wh{constructor(t){this._tr=new Gs(t),this.reset()}reset(){this._active=!1}dblclick(t,a){return t.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hh{constructor(){this._tap=new Ru({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,a,d){if(!this._swipePoint)if(this._tapTime){const g=a[0],w=t.timeStamp-this._tapTime<500,P=this._tapPoint.dist(g)<30;w&&P?d.length>0&&(this._swipePoint=g,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(t,a,d)}touchmove(t,a,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const g=a[0],w=g.y-this._swipePoint.y;return this._swipePoint=g,t.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(t,a,d)}touchend(t,a,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const g=this._tap.touchend(t,a,d);g&&(this._tapTime=t.timeStamp,this._tapPoint=g)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xh{constructor(t,a,d){this._el=t,this._mousePan=a,this._touchPan=d}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class As{constructor(t,a,d,g){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=a,this._mousePitch=d,this._mouseRoll=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Fo{constructor(t,a,d,g){this._el=t,this._touchZoom=a,this._touchRotate=d,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class jt{constructor(t,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=X.create("div","maplibregl-cooperative-gesture-screen",t);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const d=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),g=document.createElement("div");g.className="maplibregl-desktop-message",g.textContent=a,this._container.appendChild(g);const w=document.createElement("div");w.className="maplibregl-mobile-message",w.textContent=d,this._container.appendChild(w),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(X.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,a){this._enabled&&(this._map.fire(new l.l("cooperativegestureprevented",{gestureType:t,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Kt=b=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class Fl extends l.l{}function Ou(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}class qs{constructor(t,a){this.handleWindowEvent=g=>{this.handleEvent(g,`${g.type}Window`)},this.handleEvent=(g,w)=>{if(g.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const P=g.type==="renderFrame"?void 0:g,E={needsRenderFrame:!1},k={},z={};for(const{handlerName:q,handler:Y,allowed:ne}of this._handlers){if(!Y.isEnabled())continue;let de;if(this._blockedByActive(z,ne,q))Y.reset();else if(Y[w||g.type]){if(l.cz(g,w||g.type)){const pe=X.mousePos(this._map.getCanvas(),g);de=Y[w||g.type](g,pe)}else if(l.cA(g,w||g.type)){const pe=this._getMapTouches(g.touches),fe=X.touchPos(this._map.getCanvas(),pe);de=Y[w||g.type](g,fe,pe)}else l.cB(w||g.type)||(de=Y[w||g.type](g));this.mergeHandlerResult(E,k,de,q,P),de&&de.needsRenderFrame&&this._triggerRenderFrame()}(de||Y.isActive())&&(z[q]=Y)}const N={};for(const q in this._previousActiveHandlers)z[q]||(N[q]=P);this._previousActiveHandlers=z,(Object.keys(N).length||Ou(E))&&(this._changes.push([E,k,N]),this._triggerRenderFrame()),(Object.keys(z).length||Ou(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=E;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new zm(t),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,w,P]of this._listeners)X.addEventListener(g,w,g===document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[t,a,d]of this._listeners)X.removeEventListener(t,a,t===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(t){const a=this._map,d=a.getCanvasContainer();this._add("mapEvent",new Us(a,t));const g=a.boxZoom=new gs(a,t);this._add("boxZoom",g),t.interactive&&t.boxZoom&&g.enable();const w=a.cooperativeGestures=new jt(a,t.cooperativeGestures);this._add("cooperativeGestures",w),t.cooperativeGestures&&w.enable();const P=new Lu(a),E=new Wh(a);a.doubleClickZoom=new Ka(E,P),this._add("tapZoom",P),this._add("clickZoom",E),t.interactive&&t.doubleClickZoom&&a.doubleClickZoom.enable();const k=new Hh;this._add("tapDragZoom",k);const z=a.touchPitch=new Fu(a);this._add("touchPitch",z),t.interactive&&t.touchPitch&&a.touchPitch.enable(t.touchPitch);const N=()=>a.project(a.getCenter()),Z=(function({enable:ge,clickTolerance:Te,aroundCenter:Me=!0,minPixelCenterThreshold:be=100,rotateDegreesPerPixelMoved:ze=.8},Ke){const Ve=new ss({checkCorrectEvent:Ge=>X.mouseButton(Ge)===0&&Ge.ctrlKey||X.mouseButton(Ge)===2&&!Ge.ctrlKey});return new Wa({clickTolerance:Te,move:(Ge,qe)=>{const vt=Ke();if(Me&&Math.abs(vt.y-Ge.y)>be)return{bearingDelta:l.cx(new l.P(Ge.x,qe.y),qe,vt)};let bt=(qe.x-Ge.x)*ze;return Me&&qe.y<vt.y&&(bt=-bt),{bearingDelta:bt}},moveStateManager:Ve,enable:ge,assignEvents:Ha})})(t,N),q=(function({enable:ge,clickTolerance:Te,pitchDegreesPerPixelMoved:Me=-.5}){const be=new ss({checkCorrectEvent:ze=>X.mouseButton(ze)===0&&ze.ctrlKey||X.mouseButton(ze)===2});return new Wa({clickTolerance:Te,move:(ze,Ke)=>({pitchDelta:(Ke.y-ze.y)*Me}),moveStateManager:be,enable:ge,assignEvents:Ha})})(t),Y=(function({enable:ge,clickTolerance:Te,rollDegreesPerPixelMoved:Me=.3},be){const ze=new ss({checkCorrectEvent:Ke=>X.mouseButton(Ke)===2&&Ke.ctrlKey});return new Wa({clickTolerance:Te,move:(Ke,Ve)=>{const Ge=be();let qe=(Ve.x-Ke.x)*Me;return Ve.y<Ge.y&&(qe=-qe),{rollDelta:qe}},moveStateManager:ze,enable:ge,assignEvents:Ha})})(t,N);a.dragRotate=new As(t,Z,q,Y),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",q,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Y,["mousePitch"]),t.interactive&&t.dragRotate&&a.dragRotate.enable();const ne=(function({enable:ge,clickTolerance:Te}){const Me=new ss({checkCorrectEvent:be=>X.mouseButton(be)===0&&!be.ctrlKey});return new Wa({clickTolerance:Te,move:(be,ze)=>({around:ze,panDelta:ze.sub(be)}),activateOnStart:!0,moveStateManager:Me,enable:ge,assignEvents:Ha})})(t),de=new lf(t,a);a.dragPan=new Xh(d,ne,de),this._add("mousePan",ne),this._add("touchPan",de,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&a.dragPan.enable(t.dragPan);const pe=new uf,fe=new Xa;a.touchZoomRotate=new Fo(d,fe,pe,k),this._add("touchRotate",pe,["touchPan","touchZoom"]),this._add("touchZoom",fe,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&a.touchZoomRotate.enable(t.touchZoomRotate),this._add("blockableMapEvent",new $s(a));const me=a.scrollZoom=new zl(a,(()=>this._triggerRenderFrame()));this._add("scrollZoom",me,["mousePan"]),t.interactive&&t.scrollZoom&&a.scrollZoom.enable(t.scrollZoom);const Se=a.keyboard=new rn(a);this._add("keyboard",Se),t.interactive&&t.keyboard&&a.keyboard.enable()}_add(t,a,d){this._handlers.push({handlerName:t,handler:a,allowed:d}),this._handlersById[t]=a}stop(t){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Kt(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,a,d){for(const g in t)if(g!==d&&(!a||a.indexOf(g)<0))return!0;return!1}_getMapTouches(t){const a=[];for(const d of t)this._el.contains(d.target)&&a.push(d);return a}mergeHandlerResult(t,a,d,g,w){if(!d)return;l.e(t,d);const P={handlerName:g,originalEvent:d.originalEvent||w};d.zoomDelta!==void 0&&(a.zoom=P),d.panDelta!==void 0&&(a.drag=P),d.rollDelta!==void 0&&(a.roll=P),d.pitchDelta!==void 0&&(a.pitch=P),d.bearingDelta!==void 0&&(a.rotate=P)}_applyChanges(){const t={},a={},d={};for(const[g,w,P]of this._changes)g.panDelta&&(t.panDelta=(t.panDelta||new l.P(0,0))._add(g.panDelta)),g.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+g.pitchDelta),g.rollDelta&&(t.rollDelta=(t.rollDelta||0)+g.rollDelta),g.around!==void 0&&(t.around=g.around),g.pinchAround!==void 0&&(t.pinchAround=g.pinchAround),g.noInertia&&(t.noInertia=g.noInertia),l.e(a,w),l.e(d,P);this._updateMapTransform(t,a,d),this._changes=[]}_updateMapTransform(t,a,d){const g=this._map,w=g._getTransformForUpdate(),P=g.terrain;if(!(Ou(t)||P&&this._terrainMovement))return this._fireEvents(a,d,!0);g._stop(!0);let{panDelta:E,zoomDelta:k,bearingDelta:z,pitchDelta:N,rollDelta:Z,around:q,pinchAround:Y}=t;Y!==void 0&&(q=Y),q=q||g.transform.centerPoint,P&&!w.isPointOnMapSurface(q)&&(q=w.centerPoint);const ne={panDelta:E,zoomDelta:k,rollDelta:Z,pitchDelta:N,bearingDelta:z,around:q};this._map.cameraHelper.useGlobeControls&&!w.isPointOnMapSurface(q)&&(q=w.centerPoint);const de=q.distSqr(w.centerPoint)<.01?w.center:w.screenPointToLocation(E?q.sub(E):q);this._handleMapControls({terrain:P,tr:w,deltasForHelper:ne,preZoomAroundLoc:de,combinedEventsInProgress:a,panDelta:E}),g._applyUpdatedTransform(w),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(a,d,!0)}_handleMapControls({terrain:t,tr:a,deltasForHelper:d,preZoomAroundLoc:g,combinedEventsInProgress:w,panDelta:P}){const E=this._map.cameraHelper;if(E.handleMapControlsRollPitchBearingZoom(d,a),t)return E.useGlobeControls?(this._terrainMovement||!w.drag&&!w.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void E.handleMapControlsPan(d,a,g)):this._terrainMovement||!w.drag&&!w.zoom?void(w.drag&&this._terrainMovement&&P?a.setCenter(a.screenPointToLocation(a.centerPoint.sub(P))):E.handleMapControlsPan(d,a,g)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void E.handleMapControlsPan(d,a,g));E.handleMapControlsPan(d,a,g)}_fireEvents(t,a,d){const g=Kt(this._eventsInProgress),w=Kt(t),P={};for(const Z in t){const{originalEvent:q}=t[Z];this._eventsInProgress[Z]||(P[`${Z}start`]=q),this._eventsInProgress[Z]=t[Z]}!g&&w&&this._fireEvent("movestart",w.originalEvent);for(const Z in P)this._fireEvent(Z,P[Z]);w&&this._fireEvent("move",w.originalEvent);for(const Z in t){const{originalEvent:q}=t[Z];this._fireEvent(Z,q)}const E={};let k;for(const Z in this._eventsInProgress){const{handlerName:q,originalEvent:Y}=this._eventsInProgress[Z];this._handlersById[q].isActive()||(delete this._eventsInProgress[Z],k=a[q]||Y,E[`${Z}end`]=k)}for(const Z in E)this._fireEvent(Z,E[Z]);const z=Kt(this._eventsInProgress),N=(g||w)&&!z;if(N&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Z=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Z.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Z)}if(d&&N){this._updatingCamera=!0;const Z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=Y=>Y!==0&&-this._bearingSnap<Y&&Y<this._bearingSnap;!Z||!Z.essential&&re.prefersReducedMotion?(this._map.fire(new l.l("moveend",{originalEvent:k})),q(this._map.getBearing())&&this._map.resetNorth()):(q(Z.bearing||this._map.getBearing())&&(Z.bearing=0),Z.freezeElevation=!0,this._map.easeTo(Z,{originalEvent:k})),this._updatingCamera=!1}}_fireEvent(t,a){this._map.fire(new l.l(t,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new Fl("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Hn extends l.E{constructor(t,a,d){super(),this._renderFrameCallback=()=>{const g=Math.min((Q()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(g)),g<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=d.bearingSnap,this.cameraHelper=a,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(t,a){t.apply(this.transform,!0),this.transform=t,this.cameraHelper=a}getCenter(){return new l.V(this.transform.center.lng,this.transform.center.lat)}setCenter(t,a){return this.jumpTo({center:t},a)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,a){return this.jumpTo({elevation:t},a),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,a,d){return t=l.P.convert(t).mult(-1),this.panTo(this.transform.center,l.e({offset:t},a),d)}panTo(t,a,d){return this.easeTo(l.e({center:t},a),d)}getZoom(){return this.transform.zoom}setZoom(t,a){return this.jumpTo({zoom:t},a),this}zoomTo(t,a,d){return this.easeTo(l.e({zoom:t},a),d)}zoomIn(t,a){return this.zoomTo(this.getZoom()+1,t,a),this}zoomOut(t,a){return this.zoomTo(this.getZoom()-1,t,a),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,a){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new l.l("movestart",a)).fire(new l.l("move",a)).fire(new l.l("moveend",a))),this}getBearing(){return this.transform.bearing}setBearing(t,a){return this.jumpTo({bearing:t},a),this}getPadding(){return this.transform.padding}setPadding(t,a){return this.jumpTo({padding:t},a),this}rotateTo(t,a,d){return this.easeTo(l.e({bearing:t},a),d)}resetNorth(t,a){return this.rotateTo(0,l.e({duration:1e3},t),a),this}resetNorthPitch(t,a){return this.easeTo(l.e({bearing:0,pitch:0,roll:0,duration:1e3},t),a),this}snapToNorth(t,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,a):this}getPitch(){return this.transform.pitch}setPitch(t,a){return this.jumpTo({pitch:t},a),this}getRoll(){return this.transform.roll}setRoll(t,a){return this.jumpTo({roll:t},a),this}cameraForBounds(t,a){t=Xr.convert(t).adjustAntiMeridian();const d=a&&a.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),d,a)}_cameraForBoxAndBearing(t,a,d,g){const w={top:0,bottom:0,right:0,left:0};if(typeof(g=l.e({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding=="number"){const z=g.padding;g.padding={top:z,bottom:z,right:z,left:z}}const P=l.e(w,g.padding);g.padding=P;const E=this.transform,k=new Xr(t,a);return this.cameraHelper.cameraForBoxAndBearing(g,P,k,d,E)}fitBounds(t,a,d){return this._fitInternal(this.cameraForBounds(t,a),a,d)}fitScreenCoordinates(t,a,d,g,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(l.P.convert(t)),this.transform.screenPointToLocation(l.P.convert(a)),d,g),g,w)}_fitInternal(t,a,d){return t?(delete(a=l.e(t,a)).padding,a.linear?this.easeTo(a,d):this.flyTo(a,d)):this}jumpTo(t,a){this.stop();const d=this._getTransformForUpdate();let g=!1,w=!1,P=!1;const E=d.zoom;this.cameraHelper.handleJumpToCenterZoom(d,t);const k=d.zoom!==E;return"elevation"in t&&d.elevation!==+t.elevation&&d.setElevation(+t.elevation),"bearing"in t&&d.bearing!==+t.bearing&&(g=!0,d.setBearing(+t.bearing)),"pitch"in t&&d.pitch!==+t.pitch&&(w=!0,d.setPitch(+t.pitch)),"roll"in t&&d.roll!==+t.roll&&(P=!0,d.setRoll(+t.roll)),t.padding==null||d.isPaddingEqual(t.padding)||d.setPadding(t.padding),this._applyUpdatedTransform(d),this.fire(new l.l("movestart",a)).fire(new l.l("move",a)),k&&this.fire(new l.l("zoomstart",a)).fire(new l.l("zoom",a)).fire(new l.l("zoomend",a)),g&&this.fire(new l.l("rotatestart",a)).fire(new l.l("rotate",a)).fire(new l.l("rotateend",a)),w&&this.fire(new l.l("pitchstart",a)).fire(new l.l("pitch",a)).fire(new l.l("pitchend",a)),P&&this.fire(new l.l("rollstart",a)).fire(new l.l("roll",a)).fire(new l.l("rollend",a)),this.fire(new l.l("moveend",a))}calculateCameraOptionsFromTo(t,a,d,g=0){const w=l.a9.fromLngLat(t,a),P=l.a9.fromLngLat(d,g),E=P.x-w.x,k=P.y-w.y,z=P.z-w.z,N=Math.hypot(E,k,z);if(N===0)throw new Error("Can't calculate camera options with same From and To");const Z=Math.hypot(E,k),q=l.at(this.transform.cameraToCenterDistance/N/this.transform.tileSize),Y=180*Math.atan2(E,-k)/Math.PI;let ne=180*Math.acos(Z/N)/Math.PI;return ne=z<0?90-ne:90+ne,{center:P.toLngLat(),elevation:g,zoom:q,pitch:ne,bearing:Y}}calculateCameraOptionsFromCameraLngLatAltRotation(t,a,d,g,w){const P=this.transform.calculateCenterFromCameraLngLatAlt(t,a,d,g);return{center:P.center,elevation:P.elevation,zoom:P.zoom,bearing:d,pitch:g,roll:w}}easeTo(t,a){this._stop(!1,t.easeId),((t=l.e({offset:[0,0],duration:500,easing:l.cy},t)).animate===!1||!t.essential&&re.prefersReducedMotion)&&(t.duration=0);const d=this._getTransformForUpdate(),g=this.getBearing(),w=d.pitch,P=d.roll,E="bearing"in t?this._normalizeBearing(t.bearing,g):g,k="pitch"in t?+t.pitch:w,z="roll"in t?this._normalizeBearing(t.roll,P):P,N="padding"in t?t.padding:d.padding,Z=l.P.convert(t.offset);let q,Y;t.around&&(q=l.V.convert(t.around),Y=d.locationToScreenPoint(q));const ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},de=this.cameraHelper.handleEaseTo(d,{bearing:E,pitch:k,roll:z,padding:N,around:q,aroundPoint:Y,offsetAsPoint:Z,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||g!==E,this._pitching=this._pitching||k!==w,this._rolling=this._rolling||z!==P,this._padding=!d.isPaddingEqual(N),this._zooming=this._zooming||de.isZooming,this._easeId=t.easeId,this._prepareEase(a,t.noMoveStart,ne),this.terrain&&this._prepareElevation(de.elevationCenter),this._ease((pe=>{de.easeFunc(pe),this.terrain&&!t.freezeElevation&&this._updateElevation(pe),this._applyUpdatedTransform(d),this._fireMoveEvents(a)}),(pe=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a,pe)}),t),this}_prepareEase(t,a,d={}){this._moving=!0,a||d.moving||this.fire(new l.l("movestart",t)),this._zooming&&!d.zooming&&this.fire(new l.l("zoomstart",t)),this._rotating&&!d.rotating&&this.fire(new l.l("rotatestart",t)),this._pitching&&!d.pitching&&this.fire(new l.l("pitchstart",t)),this._rolling&&!d.rolling&&this.fire(new l.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&a!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(d-(a-(d*t+this._elevationStart))/(1-t)),this._elevationTarget=a}this.transform.setElevation(l.G.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const a=t.getCameraLngLat(),d=t.getCameraAltitude(),g=this.terrain?this.terrain.getElevationForLngLatZoom(a,t.zoom):0;if(d<g){const w=this.calculateCameraOptionsFromTo(a,g,t.center,t.elevation);return{pitch:w.pitch,zoom:w.zoom}}return{}}_applyUpdatedTransform(t){const a=[];if(a.push((g=>this._elevateCameraIfInsideTerrain(g))),this.transformCameraUpdate&&a.push((g=>this.transformCameraUpdate(g))),!a.length)return;const d=t.clone();for(const g of a){const w=d.clone(),{center:P,zoom:E,roll:k,pitch:z,bearing:N,elevation:Z}=g(w);P&&w.setCenter(P),Z!==void 0&&w.setElevation(Z),E!==void 0&&w.setZoom(E),k!==void 0&&w.setRoll(k),z!==void 0&&w.setPitch(z),N!==void 0&&w.setBearing(N),d.apply(w,!1)}this.transform.apply(d,!1)}_fireMoveEvents(t){this.fire(new l.l("move",t)),this._zooming&&this.fire(new l.l("zoom",t)),this._rotating&&this.fire(new l.l("rotate",t)),this._pitching&&this.fire(new l.l("pitch",t)),this._rolling&&this.fire(new l.l("roll",t))}_afterEase(t,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const d=this._zooming,g=this._rotating,w=this._pitching,P=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,d&&this.fire(new l.l("zoomend",t)),g&&this.fire(new l.l("rotateend",t)),w&&this.fire(new l.l("pitchend",t)),P&&this.fire(new l.l("rollend",t)),this.fire(new l.l("moveend",t))}flyTo(t,a){if(!t.essential&&re.prefersReducedMotion){const qe=l.U(t,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(qe,a)}this.stop(),t=l.e({offset:[0,0],speed:1.2,curve:1.42,easing:l.cy},t);const d=this._getTransformForUpdate(),g=d.bearing,w=d.pitch,P=d.roll,E=d.padding,k="bearing"in t?this._normalizeBearing(t.bearing,g):g,z="pitch"in t?+t.pitch:w,N="roll"in t?this._normalizeBearing(t.roll,P):P,Z="padding"in t?t.padding:d.padding,q=l.P.convert(t.offset);let Y=d.centerPoint.add(q);const ne=d.screenPointToLocation(Y),de=this.cameraHelper.handleFlyTo(d,{bearing:k,pitch:z,roll:N,padding:Z,locationAtOffset:ne,offsetAsPoint:q,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let pe=t.curve;const fe=Math.max(d.width,d.height),me=fe/de.scaleOfZoom,Se=de.pixelPathLength;typeof de.scaleOfMinZoom=="number"&&(pe=Math.sqrt(fe/de.scaleOfMinZoom/Se*2));const ge=pe*pe;function Te(qe){const vt=(me*me-fe*fe+(qe?-1:1)*ge*ge*Se*Se)/(2*(qe?me:fe)*ge*Se);return Math.log(Math.sqrt(vt*vt+1)-vt)}function Me(qe){return(Math.exp(qe)-Math.exp(-qe))/2}function be(qe){return(Math.exp(qe)+Math.exp(-qe))/2}const ze=Te(!1);let Ke=function(qe){return be(ze)/be(ze+pe*qe)},Ve=function(qe){return fe*((be(ze)*(Me(vt=ze+pe*qe)/be(vt))-Me(ze))/ge)/Se;var vt},Ge=(Te(!0)-ze)/pe;if(Math.abs(Se)<2e-6||!isFinite(Ge)){if(Math.abs(fe-me)<1e-6)return this.easeTo(t,a);const qe=me<fe?-1:1;Ge=Math.abs(Math.log(me/fe))/pe,Ve=()=>0,Ke=vt=>Math.exp(qe*pe*vt)}return t.duration="duration"in t?+t.duration:1e3*Ge/("screenSpeed"in t?+t.screenSpeed/pe:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=g!==k,this._pitching=z!==w,this._rolling=N!==P,this._padding=!d.isPaddingEqual(Z),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(de.targetCenter),this._ease((qe=>{const vt=qe*Ge,bt=1/Ke(vt),ct=Ve(vt);this._rotating&&d.setBearing(l.G.number(g,k,qe)),this._pitching&&d.setPitch(l.G.number(w,z,qe)),this._rolling&&d.setRoll(l.G.number(P,N,qe)),this._padding&&(d.interpolatePadding(E,Z,qe),Y=d.centerPoint.add(q)),de.easeFunc(qe,bt,ct,Y),this.terrain&&!t.freezeElevation&&this._updateElevation(qe),this._applyUpdatedTransform(d),this._fireMoveEvents(a)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,a){var d;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,a)}return t||(d=this.handlers)===null||d===void 0||d.stop(!1),this}_ease(t,a,d){d.animate===!1||d.duration===0?(t(1),a()):(this._easeStart=Q(),this._easeOptions=d,this._onEaseFrame=t,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,a){t=l.W(t,-180,180);const d=Math.abs(t-a);return Math.abs(t-360-a)<d&&(t-=360),Math.abs(t+360-a)<d&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLat(l.V.convert(t),this.transform):null}}const ys={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Kh{constructor(t=ys){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=X.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=X.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=X.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){X.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,a){const d=this._map._getUIString(`AttributionControl.${a}`);t.title=d,t.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((g=>typeof g!="string"?"":g))):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const a=this._map.style.tileManagers;for(const g in a){const w=a[g];if(w.used||w.usedForTerrain){const P=w.getSource();P.attribution&&t.indexOf(P.attribution)<0&&t.push(P.attribution)}}t=t.filter((g=>String(g).trim())),t.sort(((g,w)=>g.length-w.length)),t=t.filter(((g,w)=>{for(let P=w+1;P<t.length;P++)if(t[P].indexOf(g)>=0)return!1;return!0}));const d=t.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,t.length?(this._innerContainer.innerHTML=X.sanitize(d),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Oo{constructor(t={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const d=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=X.create("div","maplibregl-ctrl");const a=X.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){X.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Ya{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const a=++this._id;return this._queue.push({callback:t,id:a,cancelled:!1}),a}remove(t){const a=this._currentlyRunning,d=a?this._queue.concat(a):this._queue;for(const g of d)if(g.id===t)return void(g.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const d of a)if(!d.cancelled&&(d.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Yh=l.aU([{name:"a_pos3d",type:"Int16",components:3}]);class Lc extends l.E{constructor(t){super(),this._lastTilesetChange=Q(),this.tileManager=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(t,a){this.tileManager.update(t,a),this._renderableTilesKeys=[];const d={};for(const g of gn(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a,calculateTileZoom:this.tileManager._source.calculateTileZoom}))d[g.key]=!0,this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.terrainRttPosMatrix32f=new Float64Array(16),l.c7(g.terrainRttPosMatrix32f,0,l.a5,l.a5,0,0,1),this._tiles[g.key]=new ut(g,this.tileSize),this._lastTilesetChange=Q());for(const g in this._tiles)d[g]||delete this._tiles[g]}freeRtt(t){for(const a in this._tiles){const d=this._tiles[a];(!t||d.tileID.equals(t)||d.tileID.isChildOf(t)||t.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,a){return a?this._getTerrainCoordsForTileRanges(t,a):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const a={};for(const d of this._renderableTilesKeys){const g=this._tiles[d].tileID,w=t.clone(),P=l.bk();if(g.canonical.equals(t.canonical))l.c7(P,0,l.a5,l.a5,0,0,1);else if(g.canonical.isChildOf(t.canonical)){const E=g.canonical.z-t.canonical.z,k=g.canonical.x-(g.canonical.x>>E<<E),z=g.canonical.y-(g.canonical.y>>E<<E),N=l.a5>>E;l.c7(P,0,N,N,0,0,1),l.O(P,P,[-k*N,-z*N,0])}else{if(!t.canonical.isChildOf(g.canonical))continue;{const E=t.canonical.z-g.canonical.z,k=t.canonical.x-(t.canonical.x>>E<<E),z=t.canonical.y-(t.canonical.y>>E<<E),N=l.a5>>E;l.c7(P,0,l.a5,l.a5,0,0,1),l.O(P,P,[k*N,z*N,0]),l.Q(P,P,[1/2**E,1/2**E,0])}}w.terrainRttPosMatrix32f=new Float32Array(P),a[d]=w}return a}_getTerrainCoordsForTileRanges(t,a){const d={};for(const g of this._renderableTilesKeys){const w=this._tiles[g].tileID;if(!this._isWithinTileRanges(w,a))continue;const P=t.clone(),E=l.bk();if(w.canonical.z===t.canonical.z){const k=t.canonical.x-w.canonical.x+t.wrap*(1<<t.canonical.z),z=t.canonical.y-w.canonical.y;l.c7(E,0,l.a5,l.a5,0,0,1),l.O(E,E,[k*l.a5,z*l.a5,0])}else if(w.canonical.z>t.canonical.z){const k=w.canonical.z-t.canonical.z,z=w.canonical.x-(w.canonical.x>>k<<k)+t.wrap*(1<<w.canonical.z),N=w.canonical.y-(w.canonical.y>>k<<k),Z=t.canonical.x-(w.canonical.x>>k),q=t.canonical.y-(w.canonical.y>>k),Y=l.a5>>k;l.c7(E,0,Y,Y,0,0,1),l.O(E,E,[-z*Y+Z*l.a5,-N*Y+q*l.a5,0])}else{const k=t.canonical.z-w.canonical.z,z=t.canonical.x-(t.canonical.x>>k<<k)+t.wrap*(1<<t.canonical.z),N=t.canonical.y-(t.canonical.y>>k<<k),Z=(t.canonical.x>>k)-w.canonical.x,q=(t.canonical.y>>k)-w.canonical.y,Y=l.a5<<k;l.c7(E,0,Y,Y,0,0,1),l.O(E,E,[z*l.a5+Z*Y,N*l.a5+q*Y,0])}P.terrainRttPosMatrix32f=new Float32Array(E),d[g]=P}return d}getSourceTile(t,a){const d=this.tileManager._source;let g=t.overscaledZ-this.deltaZoom;if(g>d.maxzoom&&(g=d.maxzoom),g<d.minzoom)return;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(g).key);let w=this.findTileInCaches(this._sourceTileCache[t.key]);if(!w?.dem&&a)for(;g>=d.minzoom&&!w?.dem;)w=this.findTileInCaches(t.scaledTo(g--).key);return w}findTileInCaches(t){let a=this.tileManager.getTileByID(t);return a||(a=this.tileManager._outOfViewCache.getByKey(t),a)}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,a){const d=a[t.canonical.z];return!!d&&(t.wrap>d.minWrap||t.wrap<d.maxWrap||t.canonical.x>=d.minTileXWrapped&&t.canonical.x<=d.maxTileXWrapped&&t.canonical.y>=d.minTileY&&t.canonical.y<=d.maxTileY)}}class _n{constructor(t,a,d){this._meshCache={},this.painter=t,this.tileManager=new Lc(a),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,a,d,g=l.a5){var w;if(!(a>=0&&a<g&&d>=0&&d<g))return 0;const P=this.getTerrainData(t),E=(w=P.tile)===null||w===void 0?void 0:w.dem;if(!E)return 0;const k=l.cC([],[a/g*l.a5,d/g*l.a5],P.u_terrain_matrix),z=[k[0]*E.dim,k[1]*E.dim],N=Math.floor(z[0]),Z=Math.floor(z[1]),q=z[0]-N,Y=z[1]-Z;return E.get(N,Z)*(1-q)*(1-Y)+E.get(N+1,Z)*q*(1-Y)+E.get(N,Z+1)*(1-q)*Y+E.get(N+1,Z+1)*q*Y}getElevationForLngLatZoom(t,a){if(!l.cD(a,t.wrap()))return 0;const{tileID:d,mercatorX:g,mercatorY:w}=this._getOverscaledTileIDFromLngLatZoom(t,a);return this.getElevation(d,g%l.a5,w%l.a5,l.a5)}getElevationForLngLat(t,a){const d=gn(a,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let g=0;for(const w of d)w.canonical.z>g&&(g=Math.min(w.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(t,g)}getElevation(t,a,d,g=l.a5){return this.getDEMElevation(t,a,d,g)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const g=this.painter.context,w=new l.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new l.T(g,w,g.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new l.T(g,new l.R({width:1,height:1}),g.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.ar([])}const a=this.tileManager.getSourceTile(t,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const g=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new l.T(g,a.dem.getPixels(),g.gl.RGBA,{premultiply:!1}),a.demTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const d=a&&a.toString()+a.tileID.key+t.key;if(d&&!this._demMatrixCache[d]){const g=this.tileManager.getSource().maxzoom;let w=t.canonical.z-a.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=g?w=t.canonical.z-g:l.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const P=t.canonical.x-(t.canonical.x>>w<<w),E=t.canonical.y-(t.canonical.y>>w<<w),k=l.cE(new Float64Array(16),[1/(l.a5<<w),1/(l.a5<<w),0]);l.O(k,k,[P*l.a5,E*l.a5,0]),this._demMatrixCache[t.key]={matrix:k,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(t){const a=this.painter,d=a.width/devicePixelRatio,g=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===g||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new l.T(a.context,{width:d,height:g,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new l.T(a.context,{width:d,height:g,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(d,g,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,d,g))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let w=0,P=0;w<this._coordsTextureSize;w++)for(let E=0;E<this._coordsTextureSize;E++,P+=4)a[P+0]=255&E,a[P+1]=255&w,a[P+2]=E>>8<<4|w>>8,a[P+3]=0;const d=new l.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),g=new l.T(t,d,t.gl.RGBA,{premultiply:!1});return g.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),d=this.painter.context,g=d.gl,w=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),P=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),E=Math.round(this.painter.height/devicePixelRatio);d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(w,E-P-1,1,1,g.RGBA,g.UNSIGNED_BYTE,a),d.bindFramebuffer.set(null);const k=a[0]+(a[2]>>4<<8),z=a[1]+((15&a[2])<<8),N=this.coordsIndex[255-a[3]],Z=N&&this.tileManager.getTileByID(N);if(!Z)return null;const q=this._coordsTextureSize,Y=(1<<Z.tileID.canonical.z)*q;return new l.a9((Z.tileID.canonical.x*q+k)/Y+Z.tileID.wrap,(Z.tileID.canonical.y*q+z)/Y,this.getElevation(Z.tileID,k,z,q))}depthAtPoint(t){const a=new Uint8Array(4),d=this.painter.context,g=d.gl;return d.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),g.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,a),d.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(t){var a;const d=((a=this.painter.style.projection)===null||a===void 0?void 0:a.transitionState)>0,g=d&&t.canonical.y===0,w=d&&t.canonical.y===(1<<t.canonical.z)-1,P=`m_${g?"n":""}_${w?"s":""}`;if(this._meshCache[P])return this._meshCache[P];const E=this.painter.context,k=new l.cF,z=new l.aY,N=this.meshSize,Z=l.a5/N,q=N*N;for(let be=0;be<=N;be++)for(let ze=0;ze<=N;ze++)k.emplaceBack(ze*Z,be*Z,0);for(let be=0;be<q;be+=N+1)for(let ze=0;ze<N;ze++)z.emplaceBack(ze+be,N+ze+be+1,N+ze+be+2),z.emplaceBack(ze+be,N+ze+be+2,ze+be+1);const Y=k.length,ne=Y+(N+1),de=(N+1)*N,pe=g?l.br:0,fe=g?0:1,me=w?l.bs:l.a5,Se=w?0:1;for(let be=0;be<=N;be++)k.emplaceBack(be*Z,pe,fe);for(let be=0;be<=N;be++)k.emplaceBack(be*Z,me,Se);for(let be=0;be<N;be++)z.emplaceBack(de+be,ne+be,ne+be+1),z.emplaceBack(de+be,ne+be+1,de+be+1),z.emplaceBack(0+be,Y+be+1,Y+be),z.emplaceBack(0+be,0+be+1,Y+be+1);const ge=k.length,Te=ge+2*(N+1);for(const be of[0,1])for(let ze=0;ze<=N;ze++)for(const Ke of[0,1])k.emplaceBack(be*l.a5,ze*Z,Ke);for(let be=0;be<2*N;be+=2)z.emplaceBack(ge+be,ge+be+1,ge+be+3),z.emplaceBack(ge+be,ge+be+3,ge+be+2),z.emplaceBack(Te+be,Te+be+3,Te+be+1),z.emplaceBack(Te+be,Te+be+2,Te+be+3);const Me=new ln(E.createVertexBuffer(k,Yh.members),E.createIndexBuffer(z),l.aX.simpleSegment(0,0,k.length,z.length));return this._meshCache[P]=Me,Me}getMeshFrameDelta(t){return 2*Math.PI*l.bE/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,a){var d;if(!l.cD(a,t.wrap()))return 0;const{tileID:g}=this._getOverscaledTileIDFromLngLatZoom(t,a);return(d=this.getMinMaxElevation(g).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(t){const a=this.getTerrainData(t).tile,d={minElevation:null,maxElevation:null};return a&&a.dem&&(d.minElevation=a.dem.min*this.exaggeration,d.maxElevation=a.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(t,a){const d=l.a9.fromLngLat(t.wrap()),g=(1<<a)*l.a5,w=d.x*g,P=d.y*g,E=Math.floor(w/l.a5),k=Math.floor(P/l.a5);return{tileID:new l.a2(a,0,a,E,k),mercatorX:w,mercatorY:P}}}class Gn{constructor(t,a,d){this._context=t,this._size=a,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new l.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(d.texture),{id:t,fbo:a,texture:d,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((a=>t.id!==a)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((t=>!t.inUse))===!1}}const yo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class _s{constructor(t,a){this.painter=t,this.terrain=a,this.pool=new Gn(t.context,30,a.tileManager.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=t._order.filter((d=>!t._layers[d].isHidden(a))),this._coordsAscending={};for(const d in t.tileManagers){this._coordsAscending[d]={};const g=t.tileManagers[d].getVisibleCoordinates(),w=t.tileManagers[d].getSource(),P=w instanceof Mt?w.terrainTileRanges:null;for(const E of g){const k=this.terrain.tileManager.getTerrainCoords(E,P);for(const z in k)this._coordsAscending[d][z]||(this._coordsAscending[d][z]=[]),this._coordsAscending[d][z].push(k[z])}}this._coordsAscendingStr={};for(const d of t._order){const g=t._layers[d],w=g.source;if(yo[g.type]&&!this._coordsAscendingStr[w]){this._coordsAscendingStr[w]={};for(const P in this._coordsAscending[w])this._coordsAscendingStr[w][P]=this._coordsAscending[w][P].map((E=>E.key)).sort().join()}}for(const d of this._renderableTiles)for(const g in this._coordsAscendingStr){const w=this._coordsAscendingStr[g][d.tileID.key];w&&w!==d.rttCoords[g]&&(d.rtt=[])}}renderLayer(t,a){if(t.isHidden(this.painter.transform.zoom))return!1;const d=Object.assign(Object.assign({},a),{isRenderingToTexture:!0}),g=t.type,w=this.painter,P=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(yo[g]&&(this._prevType&&yo[this._prevType]||this._stacks.push([]),this._prevType=g,this._stacks[this._stacks.length-1].push(t.id),!P))return!0;if(yo[this._prevType]||yo[g]&&P){this._prevType=g;const E=this._stacks.length-1,k=this._stacks[E]||[];for(const z of this._renderableTiles){if(this.pool.isFull()&&(qa(this.painter,this.terrain,this._rttTiles,d),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(z),z.rtt[E]){const Z=this.pool.getObjectForId(z.rtt[E].id);if(Z.stamp===z.rtt[E].stamp){this.pool.useObject(Z);continue}}const N=this.pool.getOrCreateFreeObject();this.pool.useObject(N),this.pool.stampObject(N),z.rtt[E]={id:N.id,stamp:N.stamp},w.context.bindFramebuffer.set(N.fbo.framebuffer),w.context.clear({color:l.bp.transparent,stencil:0}),w.currentStencilSource=void 0;for(let Z=0;Z<k.length;Z++){const q=w.style._layers[k[Z]],Y=q.source?this._coordsAscending[q.source][z.tileID.key]:[z.tileID];w.context.viewport.set([0,0,N.fbo.width,N.fbo.height]),w._renderTileClippingMasks(q,Y,!0),w.renderLayer(w,w.style.tileManagers[q.source],q,Y,d),q.source&&(z.rttCoords[q.source]=this._coordsAscendingStr[q.source][z.tileID.key])}}return qa(this.painter,this.terrain,this._rttTiles,d),this._rttTiles=[],this.pool.freeAllObjects(),yo[g]}return!1}}const Qa={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ol=A,No={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ys,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},Nu={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class jo{constructor(t,a,d=!1){this.mousedown=w=>{this.startMove(w,X.mousePos(this.element,w)),X.addEventListener(window,"mousemove",this.mousemove),X.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.move(w,X.mousePos(this.element,w))},this.mouseup=w=>{this._rotatePitchHandler.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=X.touchPos(this.element,w.targetTouches)[0],this.startMove(w,this._startPos),X.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),X.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=X.touchPos(this.element,w.targetTouches)[0],this.move(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=a;const g=new af;this._rotatePitchHandler=new Wa({clickTolerance:3,move:(w,P)=>{const E=a.getBoundingClientRect(),k=new l.P((E.bottom-E.top)/2,(E.right-E.left)/2);return{bearingDelta:l.cx(new l.P(w.x,P.y),P,k),pitchDelta:d?-.5*(P.y-w.y):void 0}},moveStateManager:g,enable:!0,assignEvents:()=>{}}),this.map=t,X.addEventListener(a,"mousedown",this.mousedown),X.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),X.addEventListener(a,"touchcancel",this.reset)}startMove(t,a){this._rotatePitchHandler.dragStart(t,a),X.disableDrag()}move(t,a){const d=this.map,{bearingDelta:g,pitchDelta:w}=this._rotatePitchHandler.dragMove(t,a)||{};g&&d.setBearing(d.getBearing()+g),w&&d.setPitch(d.getPitch()+w)}off(){const t=this.element;X.removeEventListener(t,"mousedown",this.mousedown),X.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),X.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),X.removeEventListener(window,"touchend",this.touchend),X.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){X.enableDrag(),X.removeEventListener(window,"mousemove",this.mousemove),X.removeEventListener(window,"mouseup",this.mouseup),X.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),X.removeEventListener(window,"touchend",this.touchend)}}let Bo;function zc(b,t,a,d=!1){if(d||!a.getCoveringTilesDetailsProvider().allowWorldCopies())return b?.wrap();const g=new l.V(b.lng,b.lat);if(b=new l.V(b.lng,b.lat),t){const w=new l.V(b.lng-360,b.lat),P=new l.V(b.lng+360,b.lat),E=a.locationToScreenPoint(b).distSqr(t);a.locationToScreenPoint(w).distSqr(t)<E?b=w:a.locationToScreenPoint(P).distSqr(t)<E&&(b=P)}for(;Math.abs(b.lng-a.center.lng)>180;){const w=a.locationToScreenPoint(b);if(w.x>=0&&w.y>=0&&w.x<=a.width&&w.y<=a.height)break;b.lng>a.center.lng?b.lng-=360:b.lng+=360}return b.lng!==g.lng&&a.isPointOnMapSurface(a.locationToScreenPoint(b))?b:g}const vn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Nl(b,t,a){const d=b.classList;for(const g in vn)d.remove(`maplibregl-${a}-anchor-${g}`);d.add(`maplibregl-${a}-anchor-${t}`)}class jl extends l.E{constructor(t){if(super(),this._onKeyPress=a=>{const d=a.code,g=a.charCode||a.keyCode;d!=="Space"&&d!=="Enter"&&g!==32&&g!==13||this.togglePopup()},this._onMapClick=a=>{const d=a.originalEvent.target,g=this._element;this._popup&&(d===g||g.contains(d))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();(a?.type==="terrain"||a?.type==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=zc(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),X.setTransform(this._element,`${vn[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${g}`),re.frameAsync(new AbortController).then((()=>{this._updateOpacity(a&&a.type==="moveend")})).catch((()=>{}))},this._onMove=a=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.l("dragstart"))),this.fire(new l.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.l("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=l.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=X.create("div");const a=X.createNS("http://www.w3.org/2000/svg","svg"),d=41,g=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${d}px`),a.setAttributeNS(null,"width",`${g}px`),a.setAttributeNS(null,"viewBox",`0 0 ${g} ${d}`);const w=X.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");const P=X.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill-rule","nonzero");const E=X.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"transform","translate(3.0, 29.0)"),E.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const fe of k){const me=X.createNS("http://www.w3.org/2000/svg","ellipse");me.setAttributeNS(null,"opacity","0.04"),me.setAttributeNS(null,"cx","10.5"),me.setAttributeNS(null,"cy","5.80029008"),me.setAttributeNS(null,"rx",fe.rx),me.setAttributeNS(null,"ry",fe.ry),E.appendChild(me)}const z=X.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const N=X.createNS("http://www.w3.org/2000/svg","path");N.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(N);const Z=X.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"opacity","0.25"),Z.setAttributeNS(null,"fill","#000000");const q=X.createNS("http://www.w3.org/2000/svg","path");q.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Z.appendChild(q);const Y=X.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");const ne=X.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(8.0, 8.0)");const de=X.createNS("http://www.w3.org/2000/svg","circle");de.setAttributeNS(null,"fill","#000000"),de.setAttributeNS(null,"opacity","0.25"),de.setAttributeNS(null,"cx","5.5"),de.setAttributeNS(null,"cy","5.5"),de.setAttributeNS(null,"r","5.4999962");const pe=X.createNS("http://www.w3.org/2000/svg","circle");pe.setAttributeNS(null,"fill","#FFFFFF"),pe.setAttributeNS(null,"cx","5.5"),pe.setAttributeNS(null,"cy","5.5"),pe.setAttributeNS(null,"r","5.4999962"),ne.appendChild(de),ne.appendChild(pe),P.appendChild(E),P.appendChild(z),P.appendChild(Z),P.appendChild(Y),P.appendChild(ne),a.appendChild(P),a.setAttributeNS(null,"height",d*this._scale+"px"),a.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(a),this._offset=l.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(a=>{a.preventDefault()})),this._element.addEventListener("mousedown",(a=>{a.preventDefault()})),Nl(this._element,this._anchor,"marker"),t&&t.className)for(const a of t.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),X.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=l.V.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const g=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var a,d;const g=(a=this._map)===null||a===void 0?void 0:a.terrain,w=this._map.transform.isLocationOccluded(this._lngLat);if(!g||w){const Y=w?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Y&&(this._element.style.opacity=Y))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const P=this._map,E=P.terrain.depthAtPoint(this._pos),k=P.terrain.getElevationForLngLat(this._lngLat,P.transform);if(P.transform.lngLatToCameraDepth(this._lngLat,k)-E<.006)return void(this._element.style.opacity=this._opacity);const z=-this._offset.y/P.transform.pixelsPerMeter,N=Math.sin(P.getPitch()*Math.PI/180)*z,Z=P.terrain.depthAtPoint(new l.P(this._pos.x,this._pos.y-this._offset.y)),q=P.transform.lngLatToCameraDepth(this._lngLat,k+N)-Z>.006;!((d=this._popup)===null||d===void 0)&&d.isOpen()&&q&&this._popup.remove(),this._element.style.opacity=q?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=l.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,a){return(this._opacity===void 0||t===void 0&&a===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const ju={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let aa=0,la=!1;const ca={maxWidth:100,unit:"metric"};function xn(b,t,a){const d=a&&a.maxWidth||100,g=b._container.clientHeight/2,w=b._container.clientWidth/2,P=b.unproject([w-d/2,g]),E=b.unproject([w+d/2,g]),k=Math.round(b.project(E).x-b.project(P).x),z=Math.min(d,k,b._container.clientWidth),N=P.distanceTo(E);if(a&&a.unit==="imperial"){const Z=3.2808*N;Z>5280?kn(t,z,Z/5280,b._getUIString("ScaleControl.Miles")):kn(t,z,Z,b._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?kn(t,z,N/1852,b._getUIString("ScaleControl.NauticalMiles")):N>=1e3?kn(t,z,N/1e3,b._getUIString("ScaleControl.Kilometers")):kn(t,z,N,b._getUIString("ScaleControl.Meters"))}function kn(b,t,a,d){const g=(function(w){const P=Math.pow(10,`${Math.floor(w)}`.length-1);let E=w/P;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:E>=1?1:(function(k){const z=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*z)/z})(E),P*E})(a);b.style.width=t*(g/a)+"px",b.innerHTML=`${g}&nbsp;${d}`}const ai={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0,padding:void 0},Bl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ja(b){if(b){if(typeof b=="number"){const t=Math.round(Math.abs(b)/Math.SQRT2);return{center:new l.P(0,0),top:new l.P(0,b),"top-left":new l.P(t,t),"top-right":new l.P(-t,t),bottom:new l.P(0,-b),"bottom-left":new l.P(t,-t),"bottom-right":new l.P(-t,-t),left:new l.P(b,0),right:new l.P(-b,0)}}if(b instanceof l.P||Array.isArray(b)){const t=l.P.convert(b);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:l.P.convert(b.center||[0,0]),top:l.P.convert(b.top||[0,0]),"top-left":l.P.convert(b["top-left"]||[0,0]),"top-right":l.P.convert(b["top-right"]||[0,0]),bottom:l.P.convert(b.bottom||[0,0]),"bottom-left":l.P.convert(b["bottom-left"]||[0,0]),"bottom-right":l.P.convert(b["bottom-right"]||[0,0]),left:l.P.convert(b.left||[0,0]),right:l.P.convert(b.right||[0,0])}}return Ja(new l.P(0,0))}const Vl=A;v.AJAXError=l.cI,v.Event=l.l,v.Evented=l.E,v.LngLat=l.V,v.MercatorCoordinate=l.a9,v.Point=l.P,v.addProtocol=l.cJ,v.config=l.c,v.removeProtocol=l.cK,v.AttributionControl=Kh,v.BoxZoomHandler=gs,v.CanvasSource=ee,v.CooperativeGesturesHandler=jt,v.DoubleClickZoomHandler=Ka,v.DragPanHandler=Xh,v.DragRotateHandler=As,v.EdgeInsets=dl,v.FullscreenControl=class extends l.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var t;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=a?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:l.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=X.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){X.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=X.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);X.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new l.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},v.GeoJSONSource=Vt,v.GeolocateControl=class extends l.E{constructor(b){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new l.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const a=new l.V(t.coords.longitude,t.coords.latitude),d=t.coords.accuracy,g=this._map.getBearing(),w=l.e({bearing:g},this.options.fitBoundsOptions),P=Xr.fromLngLat(a,d);this._map.fitBounds(P,w,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const a=new l.V(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&la)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=X.create("button","maplibregl-ctrl-geolocate",this._container),X.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){l.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=X.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new jl({element:this._dotElement}),this._circleElement=X.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new jl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(a=>{const d=a?.[0]instanceof ResizeObserverEntry;a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.l("trackuserlocationend")),this.fire(new l.l("userlocationlostfocus")))}))}},this.options=l.e({},ju,b)}onAdd(b){return this._map=b,this._container=X.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return l._(this,arguments,void 0,(function*(t=!1){if(Bo!==void 0&&!t)return Bo;if(window.navigator.permissions===void 0)return Bo=!!window.navigator.geolocation,Bo;try{Bo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Bo=!!window.navigator.geolocation}return Bo}))})().then((t=>this._finishSetupUI(t))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),X.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,aa=0,la=!1}_isOutOfMapMaxBounds(b){const t=this._map.getMaxBounds(),a=b.coords;return t&&(a.longitude<t.getWest()||a.longitude>t.getEast()||a.latitude<t.getSouth()||a.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const b=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&b))return;const t=this._map.project(b),a=this._map.unproject([t.x+100,t.y]),d=b.distanceTo(a)/100,g=2*this._accuracy/d;this._circleElement.style.width=`${g.toFixed(2)}px`,this._circleElement.style.height=`${g.toFixed(2)}px`}trigger(){if(!this._setup)return l.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":aa--,la=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.l("trackuserlocationstart")),this.fire(new l.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),aa++,aa>1?(b={maximumAge:6e5,timeout:0},la=!0):(b=this.options.positionOptions,la=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},v.GlobeControl=class{constructor(){this._toggleProjection=()=>{var b;const t=(b=this._map.getProjection())===null||b===void 0?void 0:b.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((b=this._map.getProjection())===null||b===void 0?void 0:b.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=X.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=X.create("button","maplibregl-ctrl-globe",this._container),X.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){X.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},v.Hash=$h,v.ImageSource=Mt,v.KeyboardHandler=rn,v.LngLatBounds=Xr,v.LogoControl=Oo,v.Map=class extends Hn{constructor(b){var t,a;l.cG.mark(l.cH.create);const d=Object.assign(Object.assign(Object.assign({},No),b),{canvasContextAttributes:Object.assign(Object.assign({},No.canvasContextAttributes),b.canvasContextAttributes)});if(d.minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const g=new pl,w=new za;if(d.minZoom!==void 0&&g.setMinZoom(d.minZoom),d.maxZoom!==void 0&&g.setMaxZoom(d.maxZoom),d.minPitch!==void 0&&g.setMinPitch(d.minPitch),d.maxPitch!==void 0&&g.setMaxPitch(d.maxPitch),d.renderWorldCopies!==void 0&&g.setRenderWorldCopies(d.renderWorldCopies),d.transformConstrain!==null&&g.setConstrainOverride(d.transformConstrain),super(g,w,{bearingSnap:d.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Ya,this._controls=[],this._mapId=l.af(),this._lostContextStyle={style:null,images:null},this._contextLost=E=>{E.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const k of Object.values(this.style._layers))if(k.type==="custom"&&console.warn(`Custom layer with id '${k.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),k._listeners)for(const[z]of Object.entries(k._listeners))console.warn(`Custom layer with id '${k.id}' had event listeners for event '${z}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new l.l("webglcontextlost",{originalEvent:E}))},this._contextRestored=E=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._lostContextStyle={style:null,images:null},this._setupPainter(),this.resize(),this._update(),this._resizeInternal(),this.fire(new l.l("webglcontextrestored",{originalEvent:E}))},this._onMapScroll=E=>{if(E.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=d.interactive,this._maxTileCacheSize=d.maxTileCacheSize,this._maxTileCacheZoomLevels=d.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},d.canvasContextAttributes),this._trackResize=d.trackResize===!0,this._bearingSnap=d.bearingSnap,this._centerClampedToGround=d.centerClampedToGround,this._refreshExpiredTiles=d.refreshExpiredTiles===!0,this._fadeDuration=d.fadeDuration,this._crossSourceCollisions=d.crossSourceCollisions===!0,this._collectResourceTiming=d.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Qa),d.locale),this._clickTolerance=d.clickTolerance,this._overridePixelRatio=d.pixelRatio,this._maxCanvasSize=d.maxCanvasSize,this._zoomLevelsToOverscale=d.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=d.transformCameraUpdate,this.transformConstrain=d.transformConstrain,this.cancelPendingTileRequestsWhileZooming=d.cancelPendingTileRequestsWhileZooming===!0,d.reduceMotion!==void 0&&(re.prefersReducedMotion=d.reduceMotion),this._imageQueueHandle=He.addThrottleControl((()=>this.isMoving())),this._requestManager=new nt(d.transformRequest),typeof d.container=="string"){if(this._container=document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(d.maxBounds&&this.setMaxBounds(d.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let E=!1;const k=Uh((z=>{this._trackResize&&!this._removed&&(this.resize(z),this.redraw())}),50);this._resizeObserver=new ResizeObserver((z=>{E?k(z):E=!0})),this._resizeObserver.observe(this._container)}this.handlers=new qs(this,d),this._hash=d.hash&&new $h(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,elevation:d.elevation,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,roll:d.roll}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,l.e({},d.fitBoundsOptions,{duration:0}))));const P=typeof d.style=="string"||((a=(t=d.style)===null||t===void 0?void 0:t.projection)===null||a===void 0?void 0:a.type)!=="globe";this.resize(null,P),this._localIdeographFontFamily=d.localIdeographFontFamily,this._validateStyle=d.validateStyle,d.style&&this.setStyle(d.style,{localIdeographFontFamily:d.localIdeographFontFamily}),d.attributionControl&&this.addControl(new Kh(typeof d.attributionControl=="boolean"?void 0:d.attributionControl)),d.maplibreLogo&&this.addControl(new Oo,d.logoPosition),this.on("style.load",(()=>{if(P||this._resizeTransform(),this.transform.unmodified){const E=l.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(E)}})),this.on("data",(E=>{this._update(E.dataType==="style"),this.fire(new l.l(`${E.dataType}data`,E))})),this.on("dataloading",(E=>{this.fire(new l.l(`${E.dataType}dataloading`,E))})),this.on("dataabort",(E=>{this.fire(new l.l("sourcedataabort",E))}))}_getMapId(){return this._mapId}setGlobalStateProperty(b,t){return this.style.setGlobalStateProperty(b,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(b,t){if(t===void 0&&(t=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new l.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=b.onAdd(this);this._controls.push(b);const d=this._controlPositions[t];return t.indexOf("bottom")!==-1?d.insertBefore(a,d.firstChild):d.appendChild(a),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new l.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(b);return t>-1&&this._controls.splice(t,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}coveringTiles(b){return gn(this.transform,b)}calculateCameraOptionsFromTo(b,t,a,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLat(a,this.transform)),super.calculateCameraOptionsFromTo(b,t,a,d)}resize(b,t=!0){if(this._lostContextStyle.style!==null)return this;this._resizeInternal(t);const a=!this._moving;return a&&(this.stop(),this.fire(new l.l("movestart",b)).fire(new l.l("move",b))),this.fire(new l.l("resize",b)),a&&this.fire(new l.l("moveend",b)),this}_resizeInternal(b=!0){const[t,a]=this._containerDimensions(),d=this._getClampedPixelRatio(t,a);if(this._resizeCanvas(t,a,d),this.painter.resize(t,a,d),this.painter.overLimit()){const g=this.painter.context.gl;this._maxCanvasSize=[g.drawingBufferWidth,g.drawingBufferHeight];const w=this._getClampedPixelRatio(t,a);this._resizeCanvas(t,a,w),this.painter.resize(t,a,w)}this._resizeTransform(b)}_resizeTransform(b=!0){var t;const[a,d]=this._containerDimensions();this.transform.resize(a,d,b),(t=this._requestedCameraState)===null||t===void 0||t.resize(a,d,b)}_getClampedPixelRatio(b,t){const{0:a,1:d}=this._maxCanvasSize,g=this.getPixelRatio(),w=b*g,P=t*g;return Math.min(w>a?a/w:1,P>d?d/P:1)*g}getPixelRatio(){var b;return(b=this._overridePixelRatio)!==null&&b!==void 0?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(Xr.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom){const t=this._getTransformForUpdate();return t.setMinZoom(b),this._applyUpdatedTransform(t),this._update(),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom){const t=this._getTransformForUpdate();return t.setMaxZoom(b),this._applyUpdatedTransform(t),this._update(),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),this._update()}setTransformConstrain(b){return this.transform.setConstrainOverride(b),this._update()}project(b){return this.transform.locationToScreenPoint(l.V.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(l.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||((b=this.handlers)===null||b===void 0?void 0:b.isMoving())}isZooming(){var b;return this._zooming||((b=this.handlers)===null||b===void 0?void 0:b.isZooming())}isRotating(){var b;return this._rotating||((b=this.handlers)===null||b===void 0?void 0:b.isRotating())}_createDelegatedListener(b,t,a){if(b==="mouseenter"||b==="mouseover"){let d=!1;return{layers:t,listener:a,delegates:{mousemove:w=>{const P=t.filter((k=>this.getLayer(k))),E=P.length!==0?this.queryRenderedFeatures(w.point,{layers:P}):[];E.length?d||(d=!0,a.call(this,new $n(b,this,w.originalEvent,{features:E}))):d=!1},mouseout:()=>{d=!1}}}}if(b==="mouseleave"||b==="mouseout"){let d=!1;return{layers:t,listener:a,delegates:{mousemove:P=>{const E=t.filter((k=>this.getLayer(k)));(E.length!==0?this.queryRenderedFeatures(P.point,{layers:E}):[]).length?d=!0:d&&(d=!1,a.call(this,new $n(b,this,P.originalEvent)))},mouseout:P=>{d&&(d=!1,a.call(this,new $n(b,this,P.originalEvent)))}}}}{const d=g=>{const w=t.filter((E=>this.getLayer(E))),P=w.length!==0?this.queryRenderedFeatures(g.point,{layers:w}):[];P.length&&(g.features=P,a.call(this,g),delete g.features)};return{layers:t,listener:a,delegates:{[b]:d}}}}_saveDelegatedListener(b,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(t)}_removeDelegatedListener(b,t,a){if(!this._delegatedListeners||!this._delegatedListeners[b])return;const d=this._delegatedListeners[b];for(let g=0;g<d.length;g++){const w=d[g];if(w.listener===a&&w.layers.length===t.length&&w.layers.every((P=>t.includes(P)))){for(const P in w.delegates)this.off(P,w.delegates[P]);return void d.splice(g,1)}}}on(b,t,a){if(a===void 0)return super.on(b,t);const d=typeof t=="string"?[t]:t,g=this._createDelegatedListener(b,d,a);this._saveDelegatedListener(b,g);for(const w in g.delegates)this.on(w,g.delegates[w]);return{unsubscribe:()=>{this._removeDelegatedListener(b,d,a)}}}once(b,t,a){if(a===void 0)return super.once(b,t);const d=typeof t=="string"?[t]:t,g=this._createDelegatedListener(b,d,a);for(const w in g.delegates){const P=g.delegates[w];g.delegates[w]=(...E)=>{this._removeDelegatedListener(b,d,a),P(...E)}}this._saveDelegatedListener(b,g);for(const w in g.delegates)this.once(w,g.delegates[w]);return this}off(b,t,a){return a===void 0?super.off(b,t):(this._removeDelegatedListener(b,typeof t=="string"?[t]:t,a),this)}queryRenderedFeatures(b,t){if(!this.style)return[];let a;const d=b instanceof l.P||Array.isArray(b),g=d?b:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(d?{}:b)||{},g instanceof l.P||typeof g[0]=="number")a=[l.P.convert(g)];else{const w=l.P.convert(g[0]),P=l.P.convert(g[1]);a=[w,new l.P(P.x,w.y),P,new l.P(w.x,P.y),w]}return this.style.queryRenderedFeatures(a,t,this.transform)}querySourceFeatures(b,t){return this.style.querySourceFeatures(b,t)}setStyle(b,t){return(t=l.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(b,t))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const t=this._locale[b];if(t==null)throw new Error(`Missing UI string '${b}'`);return t}_updateStyle(b,t){var a,d;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(b,t)));const g=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new vl(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b,t,g):this.style.loadJSON(b,t,g),this):((d=(a=this.style)===null||a===void 0?void 0:a.projection)===null||d===void 0||d.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new vl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,t){if(typeof b=="string"){const a=this._requestManager.transformRequest(b,"Style");l.j(a,new AbortController).then((d=>{this._updateDiff(d.data,t)})).catch((d=>{d&&this.fire(new l.k(d))}))}else typeof b=="object"&&this._updateDiff(b,t)}_updateDiff(b,t){try{this.style.setState(b,t)&&this._update(!0)}catch(a){l.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(b,t)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():l.w("There is no style added to the map.")}addSource(b,t){return this._lazyInitEmptyStyle(),this.style.addSource(b,t),this._update(!0)}isSourceLoaded(b){const t=this.style&&this.style.tileManagers[b];if(t!==void 0)return t.loaded();this.fire(new l.k(new Error(`There is no tile manager with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){const t=this.style.tileManagers[b.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);this.terrain===null&&t.reload();for(const a in this.style._layers){const d=this.style._layers[a];d.type==="hillshade"&&d.source===b.source&&l.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),d.type==="color-relief"&&d.source===b.source&&l.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new _n(this.painter,t,b),this.painter.renderToTexture=new _s(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=a=>{var d;a.dataType==="style"?this.terrain.tileManager.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==b.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((d=a.source)===null||d===void 0?void 0:d.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new l.l("terrain",{terrain:b})),this}getTerrain(){var b,t;return(t=(b=this.terrain)===null||b===void 0?void 0:b.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const b=this.style&&this.style.tileManagers;for(const t of Object.values(b))if(!t.areTilesLoaded())return!1;return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}setSourceTileLodParams(b,t,a){if(a){const d=this.getSource(a);if(!d)throw new Error(`There is no source with ID "${a}", cannot set LOD parameters`);d.calculateTileZoom=Kr(Math.max(1,b),Math.max(1,t))}else for(const d in this.style.tileManagers)this.style.tileManagers[d].getSource().calculateTileZoom=Kr(Math.max(1,b),Math.max(1,t));return this._update(!0),this}refreshTiles(b,t){const a=this.style.tileManagers[b];if(!a)throw new Error(`There is no tile manager with ID "${b}", cannot refresh tile`);t===void 0?a.reload(!0):a.refreshTiles(t.map((d=>new l.ac(d.z,d.x,d.y))))}addImage(b,t,a={}){const{pixelRatio:d=1,sdf:g=!1,stretchX:w,stretchY:P,content:E,textFitWidth:k,textFitHeight:z}=a;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||l.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:N,height:Z,data:q}=t,Y=t;return this.style.addImage(b,{data:new l.R({width:N,height:Z},new Uint8Array(q)),pixelRatio:d,stretchX:w,stretchY:P,content:E,textFitWidth:k,textFitHeight:z,sdf:g,version:0,userImage:Y}),Y.onAdd&&Y.onAdd(this,b),this}}{const{width:N,height:Z,data:q}=re.getImageData(t);this.style.addImage(b,{data:new l.R({width:N,height:Z},q),pixelRatio:d,stretchX:w,stretchY:P,content:E,textFitWidth:k,textFitHeight:z,sdf:g,version:0})}}updateImage(b,t){const a=this.style.getImage(b);if(!a)return this.fire(new l.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=t instanceof HTMLImageElement||l.b(t)?re.getImageData(t):t,{width:g,height:w,data:P}=d;if(g===void 0||w===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(g!==a.data.width||w!==a.data.height)return this.fire(new l.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const E=!(t instanceof HTMLImageElement||l.b(t));return a.data.replace(P,E),this.style.updateImage(b,a),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new l.k(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return He.getImage(this._requestManager.transformRequest(b,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,t){return this._lazyInitEmptyStyle(),this.style.addLayer(b,t),this._update(!0)}moveLayer(b,t){return this.style.moveLayer(b,t),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,t,a){return this.style.setLayerZoomRange(b,t,a),this._update(!0)}setFilter(b,t,a={}){return this.style.setFilter(b,t,a),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,t,a,d={}){return this.style.setPaintProperty(b,t,a,d),this._update(!0)}getPaintProperty(b,t){return this.style.getPaintProperty(b,t)}setLayoutProperty(b,t,a,d={}){return this.style.setLayoutProperty(b,t,a,d),this._update(!0)}getLayoutProperty(b,t){return this.style.getLayoutProperty(b,t)}setGlyphs(b,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,t,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,t,a,(d=>{d||this._update(!0)})),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,t,(a=>{a||this._update(!0)})),this}setLight(b,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(b,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,t){return this.style.setFeatureState(b,t),this._update()}removeFeatureState(b,t){return this.style.removeFeatureState(b,t),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,t=0;return this._container&&(b=this._container.clientWidth||400,t=this._container.clientHeight||300),[b,t]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");const t=this._canvasContainer=X.create("div","maplibregl-canvas-container",b);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=X.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),d=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],d);const g=this._controlContainer=X.create("div","maplibregl-control-container",b),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((P=>{w[P]=X.create("div",`maplibregl-ctrl-${P} `,g)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,t,a){this._canvas.width=Math.floor(a*b),this._canvas.height=Math.floor(a*t),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",(d=>{t={requestedAttributes:b},d&&(t.statusMessage=d.statusMessage,t.type=d.type)}),{once:!0});let a=null;if(a=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!a){const d="Failed to initialize WebGL";throw t?(t.message=d,new Error(JSON.stringify(t))):new Error(d)}this.painter=new ku(a,this.transform),le.testSupport(a)}migrateProjection(b,t){super.migrateProjection(b,t),this.painter.transform=b,this.fire(new l.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var t,a,d,g,w;const P=this._idleTriggered?this._fadeDuration:0,E=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let k=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Z=this.transform.zoom,q=Q();this.style.zoomHistory.update(Z,q);const Y=new l.H(Z,{now:q,fadeDuration:P,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ne=Y.crossFadingFactor();ne===1&&ne===this._crossFadingFactor||(k=!0,this._crossFadingFactor=ne),this.style.update(Y)}const z=((a=this.style.projection)===null||a===void 0?void 0:a.transitionState)>0!==E;(d=this.style.projection)===null||d===void 0||d.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((g=this.style.projection)===null||g===void 0?void 0:g.transitionState,(w=this.style.projection)===null||w===void 0?void 0:w.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||z)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,P,this._crossSourceCollisions,z),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:P,showPadding:this.showPadding}),this.fire(new l.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.cG.mark(l.cH.load),this.fire(new l.l("load"))),this.style&&(this.style.hasTransitions()||k)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const N=this._sourcesDirty||this._styleDirty||this._placementDirty;return N||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.l("idle")),!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,l.cG.mark(l.cH.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),He.removeThrottleControl(this._imageQueueHandle),(b=this._resizeObserver)===null||b===void 0||b.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),X.remove(this._canvasContainer),X.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),l.cG.clearMetrics(),this._removed=!0,this.fire(new l.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,re.frame(this._frameRequest,(b=>{l.cG.frame(b),this._frameRequest=null;try{this._render(b)}catch(t){if(!l.Z(t)&&!(function(a){return a.message===Ba})(t))throw t}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return Ol}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}},v.MapMouseEvent=$n,v.MapTouchEvent=Za,v.MapWheelEvent=Du,v.Marker=jl,v.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{const t=this._map.getZoom(),a=t===this._map.getMaxZoom(),d=t===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,a)=>{const d=this._map._getUIString(`NavigationControl.${a}`);t.title=d,t.setAttribute("aria-label",d)},this.options=l.e({},Nu,b),this._container=X.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),X.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),X.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=X.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new jo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){X.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,t){const a=X.create("button",b,this._container);return a.type="button",a.addEventListener("click",t),a}},v.Popup=class extends l.E{constructor(b){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&X.remove(this._content),this._container&&(X.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new l.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=X.create("div","maplibregl-popup",this._map.getContainer()),this._tip=X.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const P of this.options.className.split(" "))this._container.classList.add(P);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=zc(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const a=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let d=this.options.anchor;const g=Ja(this.options.offset);if(!d){const P=this._container.offsetWidth,E=this._container.offsetHeight,k=(function(N){var Z,q,Y,ne;return N?{top:(Z=N.top)!==null&&Z!==void 0?Z:0,right:(q=N.right)!==null&&q!==void 0?q:0,bottom:(Y=N.bottom)!==null&&Y!==void 0?Y:0,left:(ne=N.left)!==null&&ne!==void 0?ne:0}:{top:0,right:0,bottom:0,left:0}})(this.options.padding);let z;z=a.y+g.bottom.y<E+k.top?["top"]:a.y>this._map.transform.height-E-k.bottom?["bottom"]:[],a.x<P/2+k.left?z.push("left"):a.x>this._map.transform.width-P/2-k.right&&z.push("right"),d=z.length===0?"bottom":z.join("-")}let w=a.add(g[d]);this.options.subpixelPositioning||(w=w.round()),X.setTransform(this._container,`${vn[d]} translate(${w.x}px,${w.y}px)`),Nl(this._container,d,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=l.e(Object.create(ai),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=l.V.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const t=document.createDocumentFragment(),a=document.createElement("body");let d;for(a.innerHTML=b;d=a.firstChild,d;)t.appendChild(d);return this.setDOMContent(t)}getMaxWidth(){var b;return(b=this._container)===null||b===void 0?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=X.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}setPadding(b){this.options.padding=b,this._update()}_createCloseButton(){this.options.closeButton&&(this._closeButton=X.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(Bl);b&&b.focus()}},v.RasterDEMTileSource=Ae,v.RasterTileSource=Ms,v.ScaleControl=class{constructor(b){this._onMove=()=>{xn(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,xn(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ca),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=X.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){X.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},v.ScrollZoomHandler=zl,v.Style=vl,v.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=X.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=X.create("button","maplibregl-ctrl-terrain",this._container),X.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){X.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},v.TwoFingersTouchPitchHandler=Fu,v.TwoFingersTouchRotateHandler=uf,v.TwoFingersTouchZoomHandler=Xa,v.TwoFingersTouchZoomRotateHandler=Fo,v.VectorTileSource=Mo,v.VideoSource=xe,v.addSourceType=(b,t)=>l._(void 0,void 0,void 0,(function*(){if(oe(b))throw new Error(`A source type called "${b}" already exists.`);((a,d)=>{te[a]=d})(b,t)})),v.clearPrewarmedResources=function(){const b=St;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(er),St=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},v.createTileMesh=_c,v.getMaxParallelImageRequests=function(){return l.c.MAX_PARALLEL_IMAGE_REQUESTS},v.getRTLTextPluginStatus=function(){return Oe().getRTLTextPluginStatus()},v.getVersion=function(){return Vl},v.getWorkerCount=function(){return ir.workerCount},v.getWorkerUrl=function(){return l.c.WORKER_URL},v.importScriptInWorkers=function(b){return Lr().broadcast("IS",b)},v.isTimeFrozen=function(){return ce.isFrozen()},v.now=Q,v.prewarm=function(){yr().acquire(er)},v.restoreNow=function(){ce.restoreNow()},v.setMaxParallelImageRequests=function(b){l.c.MAX_PARALLEL_IMAGE_REQUESTS=b},v.setNow=function(b){ce.setNow(b)},v.setRTLTextPlugin=function(b,t){return Oe().setRTLTextPlugin(b,t)},v.setWorkerCount=function(b){ir.workerCount=b},v.setWorkerUrl=function(b){l.c.WORKER_URL=b}}));var x=s;return x}))})(g0)),g0.exports}var o5=Yk();const a5=lx(o5),Qk=u6({__proto__:null,default:a5},[o5]);var on;(function(r){r.assertEqual=m=>m;function n(m){}r.assertIs=n;function s(m){throw new Error}r.assertNever=s,r.arrayToEnum=m=>{const x={};for(const v of m)x[v]=v;return x},r.getValidEnumValues=m=>{const x=r.objectKeys(m).filter(l=>typeof m[m[l]]!="number"),v={};for(const l of x)v[l]=m[l];return r.objectValues(v)},r.objectValues=m=>r.objectKeys(m).map(function(x){return m[x]}),r.objectKeys=typeof Object.keys=="function"?m=>Object.keys(m):m=>{const x=[];for(const v in m)Object.prototype.hasOwnProperty.call(m,v)&&x.push(v);return x},r.find=(m,x)=>{for(const v of m)if(x(v))return v},r.isInteger=typeof Number.isInteger=="function"?m=>Number.isInteger(m):m=>typeof m=="number"&&isFinite(m)&&Math.floor(m)===m;function u(m,x=" | "){return m.map(v=>typeof v=="string"?`'${v}'`:v).join(x)}r.joinValues=u,r.jsonStringifyReplacer=(m,x)=>typeof x=="bigint"?x.toString():x})(on||(on={}));var C1;(function(r){r.mergeShapes=(n,s)=>({...n,...s})})(C1||(C1={}));const Yt=on.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ju=r=>{switch(typeof r){case"undefined":return Yt.undefined;case"string":return Yt.string;case"number":return isNaN(r)?Yt.nan:Yt.number;case"boolean":return Yt.boolean;case"function":return Yt.function;case"bigint":return Yt.bigint;case"symbol":return Yt.symbol;case"object":return Array.isArray(r)?Yt.array:r===null?Yt.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?Yt.promise:typeof Map<"u"&&r instanceof Map?Yt.map:typeof Set<"u"&&r instanceof Set?Yt.set:typeof Date<"u"&&r instanceof Date?Yt.date:Yt.object;default:return Yt.unknown}},Dt=on.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Jk=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class Ma extends Error{get errors(){return this.issues}constructor(n){super(),this.issues=[],this.addIssue=u=>{this.issues=[...this.issues,u]},this.addIssues=(u=[])=>{this.issues=[...this.issues,...u]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=n}format(n){const s=n||function(x){return x.message},u={_errors:[]},m=x=>{for(const v of x.issues)if(v.code==="invalid_union")v.unionErrors.map(m);else if(v.code==="invalid_return_type")m(v.returnTypeError);else if(v.code==="invalid_arguments")m(v.argumentsError);else if(v.path.length===0)u._errors.push(s(v));else{let l=u,A=0;for(;A<v.path.length;){const R=v.path[A];A===v.path.length-1?(l[R]=l[R]||{_errors:[]},l[R]._errors.push(s(v))):l[R]=l[R]||{_errors:[]},l=l[R],A++}}};return m(this),u}static assert(n){if(!(n instanceof Ma))throw new Error(`Not a ZodError: ${n}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,on.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(n=s=>s.message){const s={},u=[];for(const m of this.issues)m.path.length>0?(s[m.path[0]]=s[m.path[0]]||[],s[m.path[0]].push(n(m))):u.push(n(m));return{formErrors:u,fieldErrors:s}}get formErrors(){return this.flatten()}}Ma.create=r=>new Ma(r);const gm=(r,n)=>{let s;switch(r.code){case Dt.invalid_type:r.received===Yt.undefined?s="Required":s=`Expected ${r.expected}, received ${r.received}`;break;case Dt.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(r.expected,on.jsonStringifyReplacer)}`;break;case Dt.unrecognized_keys:s=`Unrecognized key(s) in object: ${on.joinValues(r.keys,", ")}`;break;case Dt.invalid_union:s="Invalid input";break;case Dt.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${on.joinValues(r.options)}`;break;case Dt.invalid_enum_value:s=`Invalid enum value. Expected ${on.joinValues(r.options)}, received '${r.received}'`;break;case Dt.invalid_arguments:s="Invalid function arguments";break;case Dt.invalid_return_type:s="Invalid function return type";break;case Dt.invalid_date:s="Invalid date";break;case Dt.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(s=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(s=`${s} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?s=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?s=`Invalid input: must end with "${r.validation.endsWith}"`:on.assertNever(r.validation):r.validation!=="regex"?s=`Invalid ${r.validation}`:s="Invalid";break;case Dt.too_small:r.type==="array"?s=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?s=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?s=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?s=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:s="Invalid input";break;case Dt.too_big:r.type==="array"?s=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?s=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?s=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?s=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?s=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:s="Invalid input";break;case Dt.custom:s="Invalid input";break;case Dt.invalid_intersection_types:s="Intersection results could not be merged";break;case Dt.not_multiple_of:s=`Number must be a multiple of ${r.multipleOf}`;break;case Dt.not_finite:s="Number must be finite";break;default:s=n.defaultError,on.assertNever(r)}return{message:s}};let l5=gm;function eD(r){l5=r}function D0(){return l5}const R0=r=>{const{data:n,path:s,errorMaps:u,issueData:m}=r,x=[...s,...m.path||[]],v={...m,path:x};if(m.message!==void 0)return{...m,path:x,message:m.message};let l="";const A=u.filter(R=>!!R).slice().reverse();for(const R of A)l=R(v,{data:n,defaultError:l}).message;return{...m,path:x,message:l}},tD=[];function Wt(r,n){const s=D0(),u=R0({issueData:n,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,s,s===gm?void 0:gm].filter(m=>!!m)});r.common.issues.push(u)}class no{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(n,s){const u=[];for(const m of s){if(m.status==="aborted")return Cr;m.status==="dirty"&&n.dirty(),u.push(m.value)}return{status:n.value,value:u}}static async mergeObjectAsync(n,s){const u=[];for(const m of s){const x=await m.key,v=await m.value;u.push({key:x,value:v})}return no.mergeObjectSync(n,u)}static mergeObjectSync(n,s){const u={};for(const m of s){const{key:x,value:v}=m;if(x.status==="aborted"||v.status==="aborted")return Cr;x.status==="dirty"&&n.dirty(),v.status==="dirty"&&n.dirty(),x.value!=="__proto__"&&(typeof v.value<"u"||m.alwaysSet)&&(u[x.value]=v.value)}return{status:n.value,value:u}}}const Cr=Object.freeze({status:"aborted"}),Qp=r=>({status:"dirty",value:r}),Co=r=>({status:"valid",value:r}),E1=r=>r.status==="aborted",M1=r=>r.status==="dirty",Zf=r=>r.status==="valid",Ag=r=>typeof Promise<"u"&&r instanceof Promise;function L0(r,n,s,u){if(typeof n=="function"?r!==n||!0:!n.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n.get(r)}function c5(r,n,s,u,m){if(typeof n=="function"?r!==n||!0:!n.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n.set(r,s),s}var ar;(function(r){r.errToObj=n=>typeof n=="string"?{message:n}:n||{},r.toString=n=>typeof n=="string"?n:n?.message})(ar||(ar={}));var mg,gg;class tu{constructor(n,s,u,m){this._cachedPath=[],this.parent=n,this.data=s,this._path=u,this._key=m}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const _w=(r,n)=>{if(Zf(n))return{success:!0,data:n.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const s=new Ma(r.common.issues);return this._error=s,this._error}}};function Rr(r){if(!r)return{};const{errorMap:n,invalid_type_error:s,required_error:u,description:m}=r;if(n&&(s||u))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return n?{errorMap:n,description:m}:{errorMap:(v,l)=>{var A,R;const{message:L}=r;return v.code==="invalid_enum_value"?{message:L??l.defaultError}:typeof l.data>"u"?{message:(A=L??u)!==null&&A!==void 0?A:l.defaultError}:v.code!=="invalid_type"?{message:l.defaultError}:{message:(R=L??s)!==null&&R!==void 0?R:l.defaultError}},description:m}}class Nr{get description(){return this._def.description}_getType(n){return Ju(n.data)}_getOrReturnCtx(n,s){return s||{common:n.parent.common,data:n.data,parsedType:Ju(n.data),schemaErrorMap:this._def.errorMap,path:n.path,parent:n.parent}}_processInputParams(n){return{status:new no,ctx:{common:n.parent.common,data:n.data,parsedType:Ju(n.data),schemaErrorMap:this._def.errorMap,path:n.path,parent:n.parent}}}_parseSync(n){const s=this._parse(n);if(Ag(s))throw new Error("Synchronous parse encountered promise.");return s}_parseAsync(n){const s=this._parse(n);return Promise.resolve(s)}parse(n,s){const u=this.safeParse(n,s);if(u.success)return u.data;throw u.error}safeParse(n,s){var u;const m={common:{issues:[],async:(u=s?.async)!==null&&u!==void 0?u:!1,contextualErrorMap:s?.errorMap},path:s?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:n,parsedType:Ju(n)},x=this._parseSync({data:n,path:m.path,parent:m});return _w(m,x)}"~validate"(n){var s,u;const m={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:n,parsedType:Ju(n)};if(!this["~standard"].async)try{const x=this._parseSync({data:n,path:[],parent:m});return Zf(x)?{value:x.value}:{issues:m.common.issues}}catch(x){!((u=(s=x?.message)===null||s===void 0?void 0:s.toLowerCase())===null||u===void 0)&&u.includes("encountered")&&(this["~standard"].async=!0),m.common={issues:[],async:!0}}return this._parseAsync({data:n,path:[],parent:m}).then(x=>Zf(x)?{value:x.value}:{issues:m.common.issues})}async parseAsync(n,s){const u=await this.safeParseAsync(n,s);if(u.success)return u.data;throw u.error}async safeParseAsync(n,s){const u={common:{issues:[],contextualErrorMap:s?.errorMap,async:!0},path:s?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:n,parsedType:Ju(n)},m=this._parse({data:n,path:u.path,parent:u}),x=await(Ag(m)?m:Promise.resolve(m));return _w(u,x)}refine(n,s){const u=m=>typeof s=="string"||typeof s>"u"?{message:s}:typeof s=="function"?s(m):s;return this._refinement((m,x)=>{const v=n(m),l=()=>x.addIssue({code:Dt.custom,...u(m)});return typeof Promise<"u"&&v instanceof Promise?v.then(A=>A?!0:(l(),!1)):v?!0:(l(),!1)})}refinement(n,s){return this._refinement((u,m)=>n(u)?!0:(m.addIssue(typeof s=="function"?s(u,m):s),!1))}_refinement(n){return new cc({schema:this,typeName:Sr.ZodEffects,effect:{type:"refinement",refinement:n}})}superRefine(n){return this._refinement(n)}constructor(n){this.spa=this.safeParseAsync,this._def=n,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:s=>this["~validate"](s)}}optional(){return Yc.create(this,this._def)}nullable(){return kd.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return oc.create(this)}promise(){return _m.create(this,this._def)}or(n){return Lg.create([this,n],this._def)}and(n){return zg.create(this,n,this._def)}transform(n){return new cc({...Rr(this._def),schema:this,typeName:Sr.ZodEffects,effect:{type:"transform",transform:n}})}default(n){const s=typeof n=="function"?n:()=>n;return new Bg({...Rr(this._def),innerType:this,defaultValue:s,typeName:Sr.ZodDefault})}brand(){return new Fx({typeName:Sr.ZodBranded,type:this,...Rr(this._def)})}catch(n){const s=typeof n=="function"?n:()=>n;return new Vg({...Rr(this._def),innerType:this,catchValue:s,typeName:Sr.ZodCatch})}describe(n){const s=this.constructor;return new s({...this._def,description:n})}pipe(n){return ry.create(this,n)}readonly(){return Ug.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const rD=/^c[^\s-]{8,}$/i,nD=/^[0-9a-z]+$/,iD=/^[0-9A-HJKMNP-TV-Z]{26}$/i,sD=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,oD=/^[a-z0-9_-]{21}$/i,aD=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,lD=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,cD=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,uD="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let zv;const hD=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,dD=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,fD=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,pD=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,mD=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,gD=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,u5="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",yD=new RegExp(`^${u5}$`);function h5(r){let n="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return r.precision?n=`${n}\\.\\d{${r.precision}}`:r.precision==null&&(n=`${n}(\\.\\d+)?`),n}function _D(r){return new RegExp(`^${h5(r)}$`)}function d5(r){let n=`${u5}T${h5(r)}`;const s=[];return s.push(r.local?"Z?":"Z"),r.offset&&s.push("([+-]\\d{2}:?\\d{2})"),n=`${n}(${s.join("|")})`,new RegExp(`^${n}$`)}function vD(r,n){return!!((n==="v4"||!n)&&hD.test(r)||(n==="v6"||!n)&&fD.test(r))}function xD(r,n){if(!aD.test(r))return!1;try{const[s]=r.split("."),u=s.replace(/-/g,"+").replace(/_/g,"/").padEnd(s.length+(4-s.length%4)%4,"="),m=JSON.parse(atob(u));return!(typeof m!="object"||m===null||!m.typ||!m.alg||n&&m.alg!==n)}catch{return!1}}function bD(r,n){return!!((n==="v4"||!n)&&dD.test(r)||(n==="v6"||!n)&&pD.test(r))}class sc extends Nr{_parse(n){if(this._def.coerce&&(n.data=String(n.data)),this._getType(n)!==Yt.string){const x=this._getOrReturnCtx(n);return Wt(x,{code:Dt.invalid_type,expected:Yt.string,received:x.parsedType}),Cr}const u=new no;let m;for(const x of this._def.checks)if(x.kind==="min")n.data.length<x.value&&(m=this._getOrReturnCtx(n,m),Wt(m,{code:Dt.too_small,minimum:x.value,type:"string",inclusive:!0,exact:!1,message:x.message}),u.dirty());else if(x.kind==="max")n.data.length>x.value&&(m=this._getOrReturnCtx(n,m),Wt(m,{code:Dt.too_big,maximum:x.value,type:"string",inclusive:!0,exact:!1,message:x.message}),u.dirty());else if(x.kind==="length"){const v=n.data.length>x.value,l=n.data.length<x.value;(v||l)&&(m=this._getOrReturnCtx(n,m),v?Wt(m,{code:Dt.too_big,maximum:x.value,type:"string",inclusive:!0,exact:!0,message:x.message}):l&&Wt(m,{code:Dt.too_small,minimum:x.value,type:"string",inclusive:!0,exact:!0,message:x.message}),u.dirty())}else if(x.kind==="email")cD.test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"email",code:Dt.invalid_string,message:x.message}),u.dirty());else if(x.kind==="emoji")zv||(zv=new RegExp(uD,"u")),zv.test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"emoji",code:Dt.invalid_string,message:x.message}),u.dirty());else if(x.kind==="uuid")sD.test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"uuid",code:Dt.invalid_string,message:x.message}),u.dirty());else if(x.kind==="nanoid")oD.test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"nanoid",code:Dt.invalid_string,message:x.message}),u.dirty());else if(x.kind==="cuid")rD.test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"cuid",code:Dt.invalid_string,message:x.message}),u.dirty());else if(x.kind==="cuid2")nD.test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"cuid2",code:Dt.invalid_string,message:x.message}),u.dirty());else if(x.kind==="ulid")iD.test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"ulid",code:Dt.invalid_string,message:x.message}),u.dirty());else if(x.kind==="url")try{new URL(n.data)}catch{m=this._getOrReturnCtx(n,m),Wt(m,{validation:"url",code:Dt.invalid_string,message:x.message}),u.dirty()}else x.kind==="regex"?(x.regex.lastIndex=0,x.regex.test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"regex",code:Dt.invalid_string,message:x.message}),u.dirty())):x.kind==="trim"?n.data=n.data.trim():x.kind==="includes"?n.data.includes(x.value,x.position)||(m=this._getOrReturnCtx(n,m),Wt(m,{code:Dt.invalid_string,validation:{includes:x.value,position:x.position},message:x.message}),u.dirty()):x.kind==="toLowerCase"?n.data=n.data.toLowerCase():x.kind==="toUpperCase"?n.data=n.data.toUpperCase():x.kind==="startsWith"?n.data.startsWith(x.value)||(m=this._getOrReturnCtx(n,m),Wt(m,{code:Dt.invalid_string,validation:{startsWith:x.value},message:x.message}),u.dirty()):x.kind==="endsWith"?n.data.endsWith(x.value)||(m=this._getOrReturnCtx(n,m),Wt(m,{code:Dt.invalid_string,validation:{endsWith:x.value},message:x.message}),u.dirty()):x.kind==="datetime"?d5(x).test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{code:Dt.invalid_string,validation:"datetime",message:x.message}),u.dirty()):x.kind==="date"?yD.test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{code:Dt.invalid_string,validation:"date",message:x.message}),u.dirty()):x.kind==="time"?_D(x).test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{code:Dt.invalid_string,validation:"time",message:x.message}),u.dirty()):x.kind==="duration"?lD.test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"duration",code:Dt.invalid_string,message:x.message}),u.dirty()):x.kind==="ip"?vD(n.data,x.version)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"ip",code:Dt.invalid_string,message:x.message}),u.dirty()):x.kind==="jwt"?xD(n.data,x.alg)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"jwt",code:Dt.invalid_string,message:x.message}),u.dirty()):x.kind==="cidr"?bD(n.data,x.version)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"cidr",code:Dt.invalid_string,message:x.message}),u.dirty()):x.kind==="base64"?mD.test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"base64",code:Dt.invalid_string,message:x.message}),u.dirty()):x.kind==="base64url"?gD.test(n.data)||(m=this._getOrReturnCtx(n,m),Wt(m,{validation:"base64url",code:Dt.invalid_string,message:x.message}),u.dirty()):on.assertNever(x);return{status:u.value,value:n.data}}_regex(n,s,u){return this.refinement(m=>n.test(m),{validation:s,code:Dt.invalid_string,...ar.errToObj(u)})}_addCheck(n){return new sc({...this._def,checks:[...this._def.checks,n]})}email(n){return this._addCheck({kind:"email",...ar.errToObj(n)})}url(n){return this._addCheck({kind:"url",...ar.errToObj(n)})}emoji(n){return this._addCheck({kind:"emoji",...ar.errToObj(n)})}uuid(n){return this._addCheck({kind:"uuid",...ar.errToObj(n)})}nanoid(n){return this._addCheck({kind:"nanoid",...ar.errToObj(n)})}cuid(n){return this._addCheck({kind:"cuid",...ar.errToObj(n)})}cuid2(n){return this._addCheck({kind:"cuid2",...ar.errToObj(n)})}ulid(n){return this._addCheck({kind:"ulid",...ar.errToObj(n)})}base64(n){return this._addCheck({kind:"base64",...ar.errToObj(n)})}base64url(n){return this._addCheck({kind:"base64url",...ar.errToObj(n)})}jwt(n){return this._addCheck({kind:"jwt",...ar.errToObj(n)})}ip(n){return this._addCheck({kind:"ip",...ar.errToObj(n)})}cidr(n){return this._addCheck({kind:"cidr",...ar.errToObj(n)})}datetime(n){var s,u;return typeof n=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:n}):this._addCheck({kind:"datetime",precision:typeof n?.precision>"u"?null:n?.precision,offset:(s=n?.offset)!==null&&s!==void 0?s:!1,local:(u=n?.local)!==null&&u!==void 0?u:!1,...ar.errToObj(n?.message)})}date(n){return this._addCheck({kind:"date",message:n})}time(n){return typeof n=="string"?this._addCheck({kind:"time",precision:null,message:n}):this._addCheck({kind:"time",precision:typeof n?.precision>"u"?null:n?.precision,...ar.errToObj(n?.message)})}duration(n){return this._addCheck({kind:"duration",...ar.errToObj(n)})}regex(n,s){return this._addCheck({kind:"regex",regex:n,...ar.errToObj(s)})}includes(n,s){return this._addCheck({kind:"includes",value:n,position:s?.position,...ar.errToObj(s?.message)})}startsWith(n,s){return this._addCheck({kind:"startsWith",value:n,...ar.errToObj(s)})}endsWith(n,s){return this._addCheck({kind:"endsWith",value:n,...ar.errToObj(s)})}min(n,s){return this._addCheck({kind:"min",value:n,...ar.errToObj(s)})}max(n,s){return this._addCheck({kind:"max",value:n,...ar.errToObj(s)})}length(n,s){return this._addCheck({kind:"length",value:n,...ar.errToObj(s)})}nonempty(n){return this.min(1,ar.errToObj(n))}trim(){return new sc({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new sc({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new sc({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(n=>n.kind==="datetime")}get isDate(){return!!this._def.checks.find(n=>n.kind==="date")}get isTime(){return!!this._def.checks.find(n=>n.kind==="time")}get isDuration(){return!!this._def.checks.find(n=>n.kind==="duration")}get isEmail(){return!!this._def.checks.find(n=>n.kind==="email")}get isURL(){return!!this._def.checks.find(n=>n.kind==="url")}get isEmoji(){return!!this._def.checks.find(n=>n.kind==="emoji")}get isUUID(){return!!this._def.checks.find(n=>n.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(n=>n.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(n=>n.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(n=>n.kind==="cuid2")}get isULID(){return!!this._def.checks.find(n=>n.kind==="ulid")}get isIP(){return!!this._def.checks.find(n=>n.kind==="ip")}get isCIDR(){return!!this._def.checks.find(n=>n.kind==="cidr")}get isBase64(){return!!this._def.checks.find(n=>n.kind==="base64")}get isBase64url(){return!!this._def.checks.find(n=>n.kind==="base64url")}get minLength(){let n=null;for(const s of this._def.checks)s.kind==="min"&&(n===null||s.value>n)&&(n=s.value);return n}get maxLength(){let n=null;for(const s of this._def.checks)s.kind==="max"&&(n===null||s.value<n)&&(n=s.value);return n}}sc.create=r=>{var n;return new sc({checks:[],typeName:Sr.ZodString,coerce:(n=r?.coerce)!==null&&n!==void 0?n:!1,...Rr(r)})};function wD(r,n){const s=(r.toString().split(".")[1]||"").length,u=(n.toString().split(".")[1]||"").length,m=s>u?s:u,x=parseInt(r.toFixed(m).replace(".","")),v=parseInt(n.toFixed(m).replace(".",""));return x%v/Math.pow(10,m)}class Md extends Nr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(n){if(this._def.coerce&&(n.data=Number(n.data)),this._getType(n)!==Yt.number){const x=this._getOrReturnCtx(n);return Wt(x,{code:Dt.invalid_type,expected:Yt.number,received:x.parsedType}),Cr}let u;const m=new no;for(const x of this._def.checks)x.kind==="int"?on.isInteger(n.data)||(u=this._getOrReturnCtx(n,u),Wt(u,{code:Dt.invalid_type,expected:"integer",received:"float",message:x.message}),m.dirty()):x.kind==="min"?(x.inclusive?n.data<x.value:n.data<=x.value)&&(u=this._getOrReturnCtx(n,u),Wt(u,{code:Dt.too_small,minimum:x.value,type:"number",inclusive:x.inclusive,exact:!1,message:x.message}),m.dirty()):x.kind==="max"?(x.inclusive?n.data>x.value:n.data>=x.value)&&(u=this._getOrReturnCtx(n,u),Wt(u,{code:Dt.too_big,maximum:x.value,type:"number",inclusive:x.inclusive,exact:!1,message:x.message}),m.dirty()):x.kind==="multipleOf"?wD(n.data,x.value)!==0&&(u=this._getOrReturnCtx(n,u),Wt(u,{code:Dt.not_multiple_of,multipleOf:x.value,message:x.message}),m.dirty()):x.kind==="finite"?Number.isFinite(n.data)||(u=this._getOrReturnCtx(n,u),Wt(u,{code:Dt.not_finite,message:x.message}),m.dirty()):on.assertNever(x);return{status:m.value,value:n.data}}gte(n,s){return this.setLimit("min",n,!0,ar.toString(s))}gt(n,s){return this.setLimit("min",n,!1,ar.toString(s))}lte(n,s){return this.setLimit("max",n,!0,ar.toString(s))}lt(n,s){return this.setLimit("max",n,!1,ar.toString(s))}setLimit(n,s,u,m){return new Md({...this._def,checks:[...this._def.checks,{kind:n,value:s,inclusive:u,message:ar.toString(m)}]})}_addCheck(n){return new Md({...this._def,checks:[...this._def.checks,n]})}int(n){return this._addCheck({kind:"int",message:ar.toString(n)})}positive(n){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ar.toString(n)})}negative(n){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ar.toString(n)})}nonpositive(n){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ar.toString(n)})}nonnegative(n){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ar.toString(n)})}multipleOf(n,s){return this._addCheck({kind:"multipleOf",value:n,message:ar.toString(s)})}finite(n){return this._addCheck({kind:"finite",message:ar.toString(n)})}safe(n){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ar.toString(n)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ar.toString(n)})}get minValue(){let n=null;for(const s of this._def.checks)s.kind==="min"&&(n===null||s.value>n)&&(n=s.value);return n}get maxValue(){let n=null;for(const s of this._def.checks)s.kind==="max"&&(n===null||s.value<n)&&(n=s.value);return n}get isInt(){return!!this._def.checks.find(n=>n.kind==="int"||n.kind==="multipleOf"&&on.isInteger(n.value))}get isFinite(){let n=null,s=null;for(const u of this._def.checks){if(u.kind==="finite"||u.kind==="int"||u.kind==="multipleOf")return!0;u.kind==="min"?(s===null||u.value>s)&&(s=u.value):u.kind==="max"&&(n===null||u.value<n)&&(n=u.value)}return Number.isFinite(s)&&Number.isFinite(n)}}Md.create=r=>new Md({checks:[],typeName:Sr.ZodNumber,coerce:r?.coerce||!1,...Rr(r)});class Id extends Nr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(n){if(this._def.coerce)try{n.data=BigInt(n.data)}catch{return this._getInvalidInput(n)}if(this._getType(n)!==Yt.bigint)return this._getInvalidInput(n);let u;const m=new no;for(const x of this._def.checks)x.kind==="min"?(x.inclusive?n.data<x.value:n.data<=x.value)&&(u=this._getOrReturnCtx(n,u),Wt(u,{code:Dt.too_small,type:"bigint",minimum:x.value,inclusive:x.inclusive,message:x.message}),m.dirty()):x.kind==="max"?(x.inclusive?n.data>x.value:n.data>=x.value)&&(u=this._getOrReturnCtx(n,u),Wt(u,{code:Dt.too_big,type:"bigint",maximum:x.value,inclusive:x.inclusive,message:x.message}),m.dirty()):x.kind==="multipleOf"?n.data%x.value!==BigInt(0)&&(u=this._getOrReturnCtx(n,u),Wt(u,{code:Dt.not_multiple_of,multipleOf:x.value,message:x.message}),m.dirty()):on.assertNever(x);return{status:m.value,value:n.data}}_getInvalidInput(n){const s=this._getOrReturnCtx(n);return Wt(s,{code:Dt.invalid_type,expected:Yt.bigint,received:s.parsedType}),Cr}gte(n,s){return this.setLimit("min",n,!0,ar.toString(s))}gt(n,s){return this.setLimit("min",n,!1,ar.toString(s))}lte(n,s){return this.setLimit("max",n,!0,ar.toString(s))}lt(n,s){return this.setLimit("max",n,!1,ar.toString(s))}setLimit(n,s,u,m){return new Id({...this._def,checks:[...this._def.checks,{kind:n,value:s,inclusive:u,message:ar.toString(m)}]})}_addCheck(n){return new Id({...this._def,checks:[...this._def.checks,n]})}positive(n){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ar.toString(n)})}negative(n){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ar.toString(n)})}nonpositive(n){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ar.toString(n)})}nonnegative(n){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ar.toString(n)})}multipleOf(n,s){return this._addCheck({kind:"multipleOf",value:n,message:ar.toString(s)})}get minValue(){let n=null;for(const s of this._def.checks)s.kind==="min"&&(n===null||s.value>n)&&(n=s.value);return n}get maxValue(){let n=null;for(const s of this._def.checks)s.kind==="max"&&(n===null||s.value<n)&&(n=s.value);return n}}Id.create=r=>{var n;return new Id({checks:[],typeName:Sr.ZodBigInt,coerce:(n=r?.coerce)!==null&&n!==void 0?n:!1,...Rr(r)})};class kg extends Nr{_parse(n){if(this._def.coerce&&(n.data=!!n.data),this._getType(n)!==Yt.boolean){const u=this._getOrReturnCtx(n);return Wt(u,{code:Dt.invalid_type,expected:Yt.boolean,received:u.parsedType}),Cr}return Co(n.data)}}kg.create=r=>new kg({typeName:Sr.ZodBoolean,coerce:r?.coerce||!1,...Rr(r)});class Wf extends Nr{_parse(n){if(this._def.coerce&&(n.data=new Date(n.data)),this._getType(n)!==Yt.date){const x=this._getOrReturnCtx(n);return Wt(x,{code:Dt.invalid_type,expected:Yt.date,received:x.parsedType}),Cr}if(isNaN(n.data.getTime())){const x=this._getOrReturnCtx(n);return Wt(x,{code:Dt.invalid_date}),Cr}const u=new no;let m;for(const x of this._def.checks)x.kind==="min"?n.data.getTime()<x.value&&(m=this._getOrReturnCtx(n,m),Wt(m,{code:Dt.too_small,message:x.message,inclusive:!0,exact:!1,minimum:x.value,type:"date"}),u.dirty()):x.kind==="max"?n.data.getTime()>x.value&&(m=this._getOrReturnCtx(n,m),Wt(m,{code:Dt.too_big,message:x.message,inclusive:!0,exact:!1,maximum:x.value,type:"date"}),u.dirty()):on.assertNever(x);return{status:u.value,value:new Date(n.data.getTime())}}_addCheck(n){return new Wf({...this._def,checks:[...this._def.checks,n]})}min(n,s){return this._addCheck({kind:"min",value:n.getTime(),message:ar.toString(s)})}max(n,s){return this._addCheck({kind:"max",value:n.getTime(),message:ar.toString(s)})}get minDate(){let n=null;for(const s of this._def.checks)s.kind==="min"&&(n===null||s.value>n)&&(n=s.value);return n!=null?new Date(n):null}get maxDate(){let n=null;for(const s of this._def.checks)s.kind==="max"&&(n===null||s.value<n)&&(n=s.value);return n!=null?new Date(n):null}}Wf.create=r=>new Wf({checks:[],coerce:r?.coerce||!1,typeName:Sr.ZodDate,...Rr(r)});class z0 extends Nr{_parse(n){if(this._getType(n)!==Yt.symbol){const u=this._getOrReturnCtx(n);return Wt(u,{code:Dt.invalid_type,expected:Yt.symbol,received:u.parsedType}),Cr}return Co(n.data)}}z0.create=r=>new z0({typeName:Sr.ZodSymbol,...Rr(r)});class Dg extends Nr{_parse(n){if(this._getType(n)!==Yt.undefined){const u=this._getOrReturnCtx(n);return Wt(u,{code:Dt.invalid_type,expected:Yt.undefined,received:u.parsedType}),Cr}return Co(n.data)}}Dg.create=r=>new Dg({typeName:Sr.ZodUndefined,...Rr(r)});class Rg extends Nr{_parse(n){if(this._getType(n)!==Yt.null){const u=this._getOrReturnCtx(n);return Wt(u,{code:Dt.invalid_type,expected:Yt.null,received:u.parsedType}),Cr}return Co(n.data)}}Rg.create=r=>new Rg({typeName:Sr.ZodNull,...Rr(r)});class ym extends Nr{constructor(){super(...arguments),this._any=!0}_parse(n){return Co(n.data)}}ym.create=r=>new ym({typeName:Sr.ZodAny,...Rr(r)});class jf extends Nr{constructor(){super(...arguments),this._unknown=!0}_parse(n){return Co(n.data)}}jf.create=r=>new jf({typeName:Sr.ZodUnknown,...Rr(r)});class oh extends Nr{_parse(n){const s=this._getOrReturnCtx(n);return Wt(s,{code:Dt.invalid_type,expected:Yt.never,received:s.parsedType}),Cr}}oh.create=r=>new oh({typeName:Sr.ZodNever,...Rr(r)});class F0 extends Nr{_parse(n){if(this._getType(n)!==Yt.undefined){const u=this._getOrReturnCtx(n);return Wt(u,{code:Dt.invalid_type,expected:Yt.void,received:u.parsedType}),Cr}return Co(n.data)}}F0.create=r=>new F0({typeName:Sr.ZodVoid,...Rr(r)});class oc extends Nr{_parse(n){const{ctx:s,status:u}=this._processInputParams(n),m=this._def;if(s.parsedType!==Yt.array)return Wt(s,{code:Dt.invalid_type,expected:Yt.array,received:s.parsedType}),Cr;if(m.exactLength!==null){const v=s.data.length>m.exactLength.value,l=s.data.length<m.exactLength.value;(v||l)&&(Wt(s,{code:v?Dt.too_big:Dt.too_small,minimum:l?m.exactLength.value:void 0,maximum:v?m.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:m.exactLength.message}),u.dirty())}if(m.minLength!==null&&s.data.length<m.minLength.value&&(Wt(s,{code:Dt.too_small,minimum:m.minLength.value,type:"array",inclusive:!0,exact:!1,message:m.minLength.message}),u.dirty()),m.maxLength!==null&&s.data.length>m.maxLength.value&&(Wt(s,{code:Dt.too_big,maximum:m.maxLength.value,type:"array",inclusive:!0,exact:!1,message:m.maxLength.message}),u.dirty()),s.common.async)return Promise.all([...s.data].map((v,l)=>m.type._parseAsync(new tu(s,v,s.path,l)))).then(v=>no.mergeArray(u,v));const x=[...s.data].map((v,l)=>m.type._parseSync(new tu(s,v,s.path,l)));return no.mergeArray(u,x)}get element(){return this._def.type}min(n,s){return new oc({...this._def,minLength:{value:n,message:ar.toString(s)}})}max(n,s){return new oc({...this._def,maxLength:{value:n,message:ar.toString(s)}})}length(n,s){return new oc({...this._def,exactLength:{value:n,message:ar.toString(s)}})}nonempty(n){return this.min(1,n)}}oc.create=(r,n)=>new oc({type:r,minLength:null,maxLength:null,exactLength:null,typeName:Sr.ZodArray,...Rr(n)});function qp(r){if(r instanceof yi){const n={};for(const s in r.shape){const u=r.shape[s];n[s]=Yc.create(qp(u))}return new yi({...r._def,shape:()=>n})}else return r instanceof oc?new oc({...r._def,type:qp(r.element)}):r instanceof Yc?Yc.create(qp(r.unwrap())):r instanceof kd?kd.create(qp(r.unwrap())):r instanceof ru?ru.create(r.items.map(n=>qp(n))):r}class yi extends Nr{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const n=this._def.shape(),s=on.objectKeys(n);return this._cached={shape:n,keys:s}}_parse(n){if(this._getType(n)!==Yt.object){const R=this._getOrReturnCtx(n);return Wt(R,{code:Dt.invalid_type,expected:Yt.object,received:R.parsedType}),Cr}const{status:u,ctx:m}=this._processInputParams(n),{shape:x,keys:v}=this._getCached(),l=[];if(!(this._def.catchall instanceof oh&&this._def.unknownKeys==="strip"))for(const R in m.data)v.includes(R)||l.push(R);const A=[];for(const R of v){const L=x[R],B=m.data[R];A.push({key:{status:"valid",value:R},value:L._parse(new tu(m,B,m.path,R)),alwaysSet:R in m.data})}if(this._def.catchall instanceof oh){const R=this._def.unknownKeys;if(R==="passthrough")for(const L of l)A.push({key:{status:"valid",value:L},value:{status:"valid",value:m.data[L]}});else if(R==="strict")l.length>0&&(Wt(m,{code:Dt.unrecognized_keys,keys:l}),u.dirty());else if(R!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const R=this._def.catchall;for(const L of l){const B=m.data[L];A.push({key:{status:"valid",value:L},value:R._parse(new tu(m,B,m.path,L)),alwaysSet:L in m.data})}}return m.common.async?Promise.resolve().then(async()=>{const R=[];for(const L of A){const B=await L.key,W=await L.value;R.push({key:B,value:W,alwaysSet:L.alwaysSet})}return R}).then(R=>no.mergeObjectSync(u,R)):no.mergeObjectSync(u,A)}get shape(){return this._def.shape()}strict(n){return ar.errToObj,new yi({...this._def,unknownKeys:"strict",...n!==void 0?{errorMap:(s,u)=>{var m,x,v,l;const A=(v=(x=(m=this._def).errorMap)===null||x===void 0?void 0:x.call(m,s,u).message)!==null&&v!==void 0?v:u.defaultError;return s.code==="unrecognized_keys"?{message:(l=ar.errToObj(n).message)!==null&&l!==void 0?l:A}:{message:A}}}:{}})}strip(){return new yi({...this._def,unknownKeys:"strip"})}passthrough(){return new yi({...this._def,unknownKeys:"passthrough"})}extend(n){return new yi({...this._def,shape:()=>({...this._def.shape(),...n})})}merge(n){return new yi({unknownKeys:n._def.unknownKeys,catchall:n._def.catchall,shape:()=>({...this._def.shape(),...n._def.shape()}),typeName:Sr.ZodObject})}setKey(n,s){return this.augment({[n]:s})}catchall(n){return new yi({...this._def,catchall:n})}pick(n){const s={};return on.objectKeys(n).forEach(u=>{n[u]&&this.shape[u]&&(s[u]=this.shape[u])}),new yi({...this._def,shape:()=>s})}omit(n){const s={};return on.objectKeys(this.shape).forEach(u=>{n[u]||(s[u]=this.shape[u])}),new yi({...this._def,shape:()=>s})}deepPartial(){return qp(this)}partial(n){const s={};return on.objectKeys(this.shape).forEach(u=>{const m=this.shape[u];n&&!n[u]?s[u]=m:s[u]=m.optional()}),new yi({...this._def,shape:()=>s})}required(n){const s={};return on.objectKeys(this.shape).forEach(u=>{if(n&&!n[u])s[u]=this.shape[u];else{let x=this.shape[u];for(;x instanceof Yc;)x=x._def.innerType;s[u]=x}}),new yi({...this._def,shape:()=>s})}keyof(){return f5(on.objectKeys(this.shape))}}yi.create=(r,n)=>new yi({shape:()=>r,unknownKeys:"strip",catchall:oh.create(),typeName:Sr.ZodObject,...Rr(n)});yi.strictCreate=(r,n)=>new yi({shape:()=>r,unknownKeys:"strict",catchall:oh.create(),typeName:Sr.ZodObject,...Rr(n)});yi.lazycreate=(r,n)=>new yi({shape:r,unknownKeys:"strip",catchall:oh.create(),typeName:Sr.ZodObject,...Rr(n)});class Lg extends Nr{_parse(n){const{ctx:s}=this._processInputParams(n),u=this._def.options;function m(x){for(const l of x)if(l.result.status==="valid")return l.result;for(const l of x)if(l.result.status==="dirty")return s.common.issues.push(...l.ctx.common.issues),l.result;const v=x.map(l=>new Ma(l.ctx.common.issues));return Wt(s,{code:Dt.invalid_union,unionErrors:v}),Cr}if(s.common.async)return Promise.all(u.map(async x=>{const v={...s,common:{...s.common,issues:[]},parent:null};return{result:await x._parseAsync({data:s.data,path:s.path,parent:v}),ctx:v}})).then(m);{let x;const v=[];for(const A of u){const R={...s,common:{...s.common,issues:[]},parent:null},L=A._parseSync({data:s.data,path:s.path,parent:R});if(L.status==="valid")return L;L.status==="dirty"&&!x&&(x={result:L,ctx:R}),R.common.issues.length&&v.push(R.common.issues)}if(x)return s.common.issues.push(...x.ctx.common.issues),x.result;const l=v.map(A=>new Ma(A));return Wt(s,{code:Dt.invalid_union,unionErrors:l}),Cr}}get options(){return this._def.options}}Lg.create=(r,n)=>new Lg({options:r,typeName:Sr.ZodUnion,...Rr(n)});const Qu=r=>r instanceof Og?Qu(r.schema):r instanceof cc?Qu(r.innerType()):r instanceof Ng?[r.value]:r instanceof Ad?r.options:r instanceof jg?on.objectValues(r.enum):r instanceof Bg?Qu(r._def.innerType):r instanceof Dg?[void 0]:r instanceof Rg?[null]:r instanceof Yc?[void 0,...Qu(r.unwrap())]:r instanceof kd?[null,...Qu(r.unwrap())]:r instanceof Fx||r instanceof Ug?Qu(r.unwrap()):r instanceof Vg?Qu(r._def.innerType):[];class f_ extends Nr{_parse(n){const{ctx:s}=this._processInputParams(n);if(s.parsedType!==Yt.object)return Wt(s,{code:Dt.invalid_type,expected:Yt.object,received:s.parsedType}),Cr;const u=this.discriminator,m=s.data[u],x=this.optionsMap.get(m);return x?s.common.async?x._parseAsync({data:s.data,path:s.path,parent:s}):x._parseSync({data:s.data,path:s.path,parent:s}):(Wt(s,{code:Dt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[u]}),Cr)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(n,s,u){const m=new Map;for(const x of s){const v=Qu(x.shape[n]);if(!v.length)throw new Error(`A discriminator value for key \`${n}\` could not be extracted from all schema options`);for(const l of v){if(m.has(l))throw new Error(`Discriminator property ${String(n)} has duplicate value ${String(l)}`);m.set(l,x)}}return new f_({typeName:Sr.ZodDiscriminatedUnion,discriminator:n,options:s,optionsMap:m,...Rr(u)})}}function I1(r,n){const s=Ju(r),u=Ju(n);if(r===n)return{valid:!0,data:r};if(s===Yt.object&&u===Yt.object){const m=on.objectKeys(n),x=on.objectKeys(r).filter(l=>m.indexOf(l)!==-1),v={...r,...n};for(const l of x){const A=I1(r[l],n[l]);if(!A.valid)return{valid:!1};v[l]=A.data}return{valid:!0,data:v}}else if(s===Yt.array&&u===Yt.array){if(r.length!==n.length)return{valid:!1};const m=[];for(let x=0;x<r.length;x++){const v=r[x],l=n[x],A=I1(v,l);if(!A.valid)return{valid:!1};m.push(A.data)}return{valid:!0,data:m}}else return s===Yt.date&&u===Yt.date&&+r==+n?{valid:!0,data:r}:{valid:!1}}class zg extends Nr{_parse(n){const{status:s,ctx:u}=this._processInputParams(n),m=(x,v)=>{if(E1(x)||E1(v))return Cr;const l=I1(x.value,v.value);return l.valid?((M1(x)||M1(v))&&s.dirty(),{status:s.value,value:l.data}):(Wt(u,{code:Dt.invalid_intersection_types}),Cr)};return u.common.async?Promise.all([this._def.left._parseAsync({data:u.data,path:u.path,parent:u}),this._def.right._parseAsync({data:u.data,path:u.path,parent:u})]).then(([x,v])=>m(x,v)):m(this._def.left._parseSync({data:u.data,path:u.path,parent:u}),this._def.right._parseSync({data:u.data,path:u.path,parent:u}))}}zg.create=(r,n,s)=>new zg({left:r,right:n,typeName:Sr.ZodIntersection,...Rr(s)});class ru extends Nr{_parse(n){const{status:s,ctx:u}=this._processInputParams(n);if(u.parsedType!==Yt.array)return Wt(u,{code:Dt.invalid_type,expected:Yt.array,received:u.parsedType}),Cr;if(u.data.length<this._def.items.length)return Wt(u,{code:Dt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Cr;!this._def.rest&&u.data.length>this._def.items.length&&(Wt(u,{code:Dt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.dirty());const x=[...u.data].map((v,l)=>{const A=this._def.items[l]||this._def.rest;return A?A._parse(new tu(u,v,u.path,l)):null}).filter(v=>!!v);return u.common.async?Promise.all(x).then(v=>no.mergeArray(s,v)):no.mergeArray(s,x)}get items(){return this._def.items}rest(n){return new ru({...this._def,rest:n})}}ru.create=(r,n)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ru({items:r,typeName:Sr.ZodTuple,rest:null,...Rr(n)})};class Fg extends Nr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(n){const{status:s,ctx:u}=this._processInputParams(n);if(u.parsedType!==Yt.object)return Wt(u,{code:Dt.invalid_type,expected:Yt.object,received:u.parsedType}),Cr;const m=[],x=this._def.keyType,v=this._def.valueType;for(const l in u.data)m.push({key:x._parse(new tu(u,l,u.path,l)),value:v._parse(new tu(u,u.data[l],u.path,l)),alwaysSet:l in u.data});return u.common.async?no.mergeObjectAsync(s,m):no.mergeObjectSync(s,m)}get element(){return this._def.valueType}static create(n,s,u){return s instanceof Nr?new Fg({keyType:n,valueType:s,typeName:Sr.ZodRecord,...Rr(u)}):new Fg({keyType:sc.create(),valueType:n,typeName:Sr.ZodRecord,...Rr(s)})}}class O0 extends Nr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(n){const{status:s,ctx:u}=this._processInputParams(n);if(u.parsedType!==Yt.map)return Wt(u,{code:Dt.invalid_type,expected:Yt.map,received:u.parsedType}),Cr;const m=this._def.keyType,x=this._def.valueType,v=[...u.data.entries()].map(([l,A],R)=>({key:m._parse(new tu(u,l,u.path,[R,"key"])),value:x._parse(new tu(u,A,u.path,[R,"value"]))}));if(u.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const A of v){const R=await A.key,L=await A.value;if(R.status==="aborted"||L.status==="aborted")return Cr;(R.status==="dirty"||L.status==="dirty")&&s.dirty(),l.set(R.value,L.value)}return{status:s.value,value:l}})}else{const l=new Map;for(const A of v){const R=A.key,L=A.value;if(R.status==="aborted"||L.status==="aborted")return Cr;(R.status==="dirty"||L.status==="dirty")&&s.dirty(),l.set(R.value,L.value)}return{status:s.value,value:l}}}}O0.create=(r,n,s)=>new O0({valueType:n,keyType:r,typeName:Sr.ZodMap,...Rr(s)});class Hf extends Nr{_parse(n){const{status:s,ctx:u}=this._processInputParams(n);if(u.parsedType!==Yt.set)return Wt(u,{code:Dt.invalid_type,expected:Yt.set,received:u.parsedType}),Cr;const m=this._def;m.minSize!==null&&u.data.size<m.minSize.value&&(Wt(u,{code:Dt.too_small,minimum:m.minSize.value,type:"set",inclusive:!0,exact:!1,message:m.minSize.message}),s.dirty()),m.maxSize!==null&&u.data.size>m.maxSize.value&&(Wt(u,{code:Dt.too_big,maximum:m.maxSize.value,type:"set",inclusive:!0,exact:!1,message:m.maxSize.message}),s.dirty());const x=this._def.valueType;function v(A){const R=new Set;for(const L of A){if(L.status==="aborted")return Cr;L.status==="dirty"&&s.dirty(),R.add(L.value)}return{status:s.value,value:R}}const l=[...u.data.values()].map((A,R)=>x._parse(new tu(u,A,u.path,R)));return u.common.async?Promise.all(l).then(A=>v(A)):v(l)}min(n,s){return new Hf({...this._def,minSize:{value:n,message:ar.toString(s)}})}max(n,s){return new Hf({...this._def,maxSize:{value:n,message:ar.toString(s)}})}size(n,s){return this.min(n,s).max(n,s)}nonempty(n){return this.min(1,n)}}Hf.create=(r,n)=>new Hf({valueType:r,minSize:null,maxSize:null,typeName:Sr.ZodSet,...Rr(n)});class am extends Nr{constructor(){super(...arguments),this.validate=this.implement}_parse(n){const{ctx:s}=this._processInputParams(n);if(s.parsedType!==Yt.function)return Wt(s,{code:Dt.invalid_type,expected:Yt.function,received:s.parsedType}),Cr;function u(l,A){return R0({data:l,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,D0(),gm].filter(R=>!!R),issueData:{code:Dt.invalid_arguments,argumentsError:A}})}function m(l,A){return R0({data:l,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,D0(),gm].filter(R=>!!R),issueData:{code:Dt.invalid_return_type,returnTypeError:A}})}const x={errorMap:s.common.contextualErrorMap},v=s.data;if(this._def.returns instanceof _m){const l=this;return Co(async function(...A){const R=new Ma([]),L=await l._def.args.parseAsync(A,x).catch(re=>{throw R.addIssue(u(A,re)),R}),B=await Reflect.apply(v,this,L);return await l._def.returns._def.type.parseAsync(B,x).catch(re=>{throw R.addIssue(m(B,re)),R})})}else{const l=this;return Co(function(...A){const R=l._def.args.safeParse(A,x);if(!R.success)throw new Ma([u(A,R.error)]);const L=Reflect.apply(v,this,R.data),B=l._def.returns.safeParse(L,x);if(!B.success)throw new Ma([m(L,B.error)]);return B.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...n){return new am({...this._def,args:ru.create(n).rest(jf.create())})}returns(n){return new am({...this._def,returns:n})}implement(n){return this.parse(n)}strictImplement(n){return this.parse(n)}static create(n,s,u){return new am({args:n||ru.create([]).rest(jf.create()),returns:s||jf.create(),typeName:Sr.ZodFunction,...Rr(u)})}}class Og extends Nr{get schema(){return this._def.getter()}_parse(n){const{ctx:s}=this._processInputParams(n);return this._def.getter()._parse({data:s.data,path:s.path,parent:s})}}Og.create=(r,n)=>new Og({getter:r,typeName:Sr.ZodLazy,...Rr(n)});class Ng extends Nr{_parse(n){if(n.data!==this._def.value){const s=this._getOrReturnCtx(n);return Wt(s,{received:s.data,code:Dt.invalid_literal,expected:this._def.value}),Cr}return{status:"valid",value:n.data}}get value(){return this._def.value}}Ng.create=(r,n)=>new Ng({value:r,typeName:Sr.ZodLiteral,...Rr(n)});function f5(r,n){return new Ad({values:r,typeName:Sr.ZodEnum,...Rr(n)})}class Ad extends Nr{constructor(){super(...arguments),mg.set(this,void 0)}_parse(n){if(typeof n.data!="string"){const s=this._getOrReturnCtx(n),u=this._def.values;return Wt(s,{expected:on.joinValues(u),received:s.parsedType,code:Dt.invalid_type}),Cr}if(L0(this,mg)||c5(this,mg,new Set(this._def.values)),!L0(this,mg).has(n.data)){const s=this._getOrReturnCtx(n),u=this._def.values;return Wt(s,{received:s.data,code:Dt.invalid_enum_value,options:u}),Cr}return Co(n.data)}get options(){return this._def.values}get enum(){const n={};for(const s of this._def.values)n[s]=s;return n}get Values(){const n={};for(const s of this._def.values)n[s]=s;return n}get Enum(){const n={};for(const s of this._def.values)n[s]=s;return n}extract(n,s=this._def){return Ad.create(n,{...this._def,...s})}exclude(n,s=this._def){return Ad.create(this.options.filter(u=>!n.includes(u)),{...this._def,...s})}}mg=new WeakMap;Ad.create=f5;class jg extends Nr{constructor(){super(...arguments),gg.set(this,void 0)}_parse(n){const s=on.getValidEnumValues(this._def.values),u=this._getOrReturnCtx(n);if(u.parsedType!==Yt.string&&u.parsedType!==Yt.number){const m=on.objectValues(s);return Wt(u,{expected:on.joinValues(m),received:u.parsedType,code:Dt.invalid_type}),Cr}if(L0(this,gg)||c5(this,gg,new Set(on.getValidEnumValues(this._def.values))),!L0(this,gg).has(n.data)){const m=on.objectValues(s);return Wt(u,{received:u.data,code:Dt.invalid_enum_value,options:m}),Cr}return Co(n.data)}get enum(){return this._def.values}}gg=new WeakMap;jg.create=(r,n)=>new jg({values:r,typeName:Sr.ZodNativeEnum,...Rr(n)});class _m extends Nr{unwrap(){return this._def.type}_parse(n){const{ctx:s}=this._processInputParams(n);if(s.parsedType!==Yt.promise&&s.common.async===!1)return Wt(s,{code:Dt.invalid_type,expected:Yt.promise,received:s.parsedType}),Cr;const u=s.parsedType===Yt.promise?s.data:Promise.resolve(s.data);return Co(u.then(m=>this._def.type.parseAsync(m,{path:s.path,errorMap:s.common.contextualErrorMap})))}}_m.create=(r,n)=>new _m({type:r,typeName:Sr.ZodPromise,...Rr(n)});class cc extends Nr{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Sr.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(n){const{status:s,ctx:u}=this._processInputParams(n),m=this._def.effect||null,x={addIssue:v=>{Wt(u,v),v.fatal?s.abort():s.dirty()},get path(){return u.path}};if(x.addIssue=x.addIssue.bind(x),m.type==="preprocess"){const v=m.transform(u.data,x);if(u.common.async)return Promise.resolve(v).then(async l=>{if(s.value==="aborted")return Cr;const A=await this._def.schema._parseAsync({data:l,path:u.path,parent:u});return A.status==="aborted"?Cr:A.status==="dirty"||s.value==="dirty"?Qp(A.value):A});{if(s.value==="aborted")return Cr;const l=this._def.schema._parseSync({data:v,path:u.path,parent:u});return l.status==="aborted"?Cr:l.status==="dirty"||s.value==="dirty"?Qp(l.value):l}}if(m.type==="refinement"){const v=l=>{const A=m.refinement(l,x);if(u.common.async)return Promise.resolve(A);if(A instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(u.common.async===!1){const l=this._def.schema._parseSync({data:u.data,path:u.path,parent:u});return l.status==="aborted"?Cr:(l.status==="dirty"&&s.dirty(),v(l.value),{status:s.value,value:l.value})}else return this._def.schema._parseAsync({data:u.data,path:u.path,parent:u}).then(l=>l.status==="aborted"?Cr:(l.status==="dirty"&&s.dirty(),v(l.value).then(()=>({status:s.value,value:l.value}))))}if(m.type==="transform")if(u.common.async===!1){const v=this._def.schema._parseSync({data:u.data,path:u.path,parent:u});if(!Zf(v))return v;const l=m.transform(v.value,x);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:s.value,value:l}}else return this._def.schema._parseAsync({data:u.data,path:u.path,parent:u}).then(v=>Zf(v)?Promise.resolve(m.transform(v.value,x)).then(l=>({status:s.value,value:l})):v);on.assertNever(m)}}cc.create=(r,n,s)=>new cc({schema:r,typeName:Sr.ZodEffects,effect:n,...Rr(s)});cc.createWithPreprocess=(r,n,s)=>new cc({schema:n,effect:{type:"preprocess",transform:r},typeName:Sr.ZodEffects,...Rr(s)});class Yc extends Nr{_parse(n){return this._getType(n)===Yt.undefined?Co(void 0):this._def.innerType._parse(n)}unwrap(){return this._def.innerType}}Yc.create=(r,n)=>new Yc({innerType:r,typeName:Sr.ZodOptional,...Rr(n)});class kd extends Nr{_parse(n){return this._getType(n)===Yt.null?Co(null):this._def.innerType._parse(n)}unwrap(){return this._def.innerType}}kd.create=(r,n)=>new kd({innerType:r,typeName:Sr.ZodNullable,...Rr(n)});class Bg extends Nr{_parse(n){const{ctx:s}=this._processInputParams(n);let u=s.data;return s.parsedType===Yt.undefined&&(u=this._def.defaultValue()),this._def.innerType._parse({data:u,path:s.path,parent:s})}removeDefault(){return this._def.innerType}}Bg.create=(r,n)=>new Bg({innerType:r,typeName:Sr.ZodDefault,defaultValue:typeof n.default=="function"?n.default:()=>n.default,...Rr(n)});class Vg extends Nr{_parse(n){const{ctx:s}=this._processInputParams(n),u={...s,common:{...s.common,issues:[]}},m=this._def.innerType._parse({data:u.data,path:u.path,parent:{...u}});return Ag(m)?m.then(x=>({status:"valid",value:x.status==="valid"?x.value:this._def.catchValue({get error(){return new Ma(u.common.issues)},input:u.data})})):{status:"valid",value:m.status==="valid"?m.value:this._def.catchValue({get error(){return new Ma(u.common.issues)},input:u.data})}}removeCatch(){return this._def.innerType}}Vg.create=(r,n)=>new Vg({innerType:r,typeName:Sr.ZodCatch,catchValue:typeof n.catch=="function"?n.catch:()=>n.catch,...Rr(n)});class N0 extends Nr{_parse(n){if(this._getType(n)!==Yt.nan){const u=this._getOrReturnCtx(n);return Wt(u,{code:Dt.invalid_type,expected:Yt.nan,received:u.parsedType}),Cr}return{status:"valid",value:n.data}}}N0.create=r=>new N0({typeName:Sr.ZodNaN,...Rr(r)});const TD=Symbol("zod_brand");class Fx extends Nr{_parse(n){const{ctx:s}=this._processInputParams(n),u=s.data;return this._def.type._parse({data:u,path:s.path,parent:s})}unwrap(){return this._def.type}}class ry extends Nr{_parse(n){const{status:s,ctx:u}=this._processInputParams(n);if(u.common.async)return(async()=>{const x=await this._def.in._parseAsync({data:u.data,path:u.path,parent:u});return x.status==="aborted"?Cr:x.status==="dirty"?(s.dirty(),Qp(x.value)):this._def.out._parseAsync({data:x.value,path:u.path,parent:u})})();{const m=this._def.in._parseSync({data:u.data,path:u.path,parent:u});return m.status==="aborted"?Cr:m.status==="dirty"?(s.dirty(),{status:"dirty",value:m.value}):this._def.out._parseSync({data:m.value,path:u.path,parent:u})}}static create(n,s){return new ry({in:n,out:s,typeName:Sr.ZodPipeline})}}class Ug extends Nr{_parse(n){const s=this._def.innerType._parse(n),u=m=>(Zf(m)&&(m.value=Object.freeze(m.value)),m);return Ag(s)?s.then(m=>u(m)):u(s)}unwrap(){return this._def.innerType}}Ug.create=(r,n)=>new Ug({innerType:r,typeName:Sr.ZodReadonly,...Rr(n)});function vw(r,n){const s=typeof r=="function"?r(n):typeof r=="string"?{message:r}:r;return typeof s=="string"?{message:s}:s}function p5(r,n={},s){return r?ym.create().superRefine((u,m)=>{var x,v;const l=r(u);if(l instanceof Promise)return l.then(A=>{var R,L;if(!A){const B=vw(n,u),W=(L=(R=B.fatal)!==null&&R!==void 0?R:s)!==null&&L!==void 0?L:!0;m.addIssue({code:"custom",...B,fatal:W})}});if(!l){const A=vw(n,u),R=(v=(x=A.fatal)!==null&&x!==void 0?x:s)!==null&&v!==void 0?v:!0;m.addIssue({code:"custom",...A,fatal:R})}}):ym.create()}const SD={object:yi.lazycreate};var Sr;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(Sr||(Sr={}));const PD=(r,n={message:`Input not instance of ${r.name}`})=>p5(s=>s instanceof r,n),m5=sc.create,g5=Md.create,CD=N0.create,ED=Id.create,y5=kg.create,MD=Wf.create,ID=z0.create,AD=Dg.create,kD=Rg.create,DD=ym.create,RD=jf.create,LD=oh.create,zD=F0.create,FD=oc.create,OD=yi.create,ND=yi.strictCreate,jD=Lg.create,BD=f_.create,VD=zg.create,UD=ru.create,$D=Fg.create,GD=O0.create,qD=Hf.create,ZD=am.create,WD=Og.create,HD=Ng.create,XD=Ad.create,KD=jg.create,YD=_m.create,xw=cc.create,QD=Yc.create,JD=kd.create,eR=cc.createWithPreprocess,tR=ry.create,rR=()=>m5().optional(),nR=()=>g5().optional(),iR=()=>y5().optional(),sR={string:(r=>sc.create({...r,coerce:!0})),number:(r=>Md.create({...r,coerce:!0})),boolean:(r=>kg.create({...r,coerce:!0})),bigint:(r=>Id.create({...r,coerce:!0})),date:(r=>Wf.create({...r,coerce:!0}))},oR=Cr;var Wn=Object.freeze({__proto__:null,defaultErrorMap:gm,setErrorMap:eD,getErrorMap:D0,makeIssue:R0,EMPTY_PATH:tD,addIssueToContext:Wt,ParseStatus:no,INVALID:Cr,DIRTY:Qp,OK:Co,isAborted:E1,isDirty:M1,isValid:Zf,isAsync:Ag,get util(){return on},get objectUtil(){return C1},ZodParsedType:Yt,getParsedType:Ju,ZodType:Nr,datetimeRegex:d5,ZodString:sc,ZodNumber:Md,ZodBigInt:Id,ZodBoolean:kg,ZodDate:Wf,ZodSymbol:z0,ZodUndefined:Dg,ZodNull:Rg,ZodAny:ym,ZodUnknown:jf,ZodNever:oh,ZodVoid:F0,ZodArray:oc,ZodObject:yi,ZodUnion:Lg,ZodDiscriminatedUnion:f_,ZodIntersection:zg,ZodTuple:ru,ZodRecord:Fg,ZodMap:O0,ZodSet:Hf,ZodFunction:am,ZodLazy:Og,ZodLiteral:Ng,ZodEnum:Ad,ZodNativeEnum:jg,ZodPromise:_m,ZodEffects:cc,ZodTransformer:cc,ZodOptional:Yc,ZodNullable:kd,ZodDefault:Bg,ZodCatch:Vg,ZodNaN:N0,BRAND:TD,ZodBranded:Fx,ZodPipeline:ry,ZodReadonly:Ug,custom:p5,Schema:Nr,ZodSchema:Nr,late:SD,get ZodFirstPartyTypeKind(){return Sr},coerce:sR,any:DD,array:FD,bigint:ED,boolean:y5,date:MD,discriminatedUnion:BD,effect:xw,enum:XD,function:ZD,instanceof:PD,intersection:VD,lazy:WD,literal:HD,map:GD,nan:CD,nativeEnum:KD,never:LD,null:kD,nullable:JD,number:g5,object:OD,oboolean:iR,onumber:nR,optional:QD,ostring:rR,pipeline:tR,preprocess:eR,promise:YD,record:$D,set:qD,strictObject:ND,string:m5,symbol:ID,transformer:xw,tuple:UD,undefined:AD,union:jD,unknown:RD,void:zD,NEVER:oR,ZodIssueCode:Dt,quotelessJson:Jk,ZodError:Ma});const xt=Symbol.for("drizzle:entityKind");function es(r,n){if(!r||typeof r!="object")return!1;if(r instanceof n)return!0;if(!Object.prototype.hasOwnProperty.call(n,xt))throw new Error(`Class "${n.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let s=Object.getPrototypeOf(r).constructor;if(s)for(;s;){if(xt in s&&s[xt]===n[xt])return!0;s=Object.getPrototypeOf(s)}return!1}class $g{constructor(n,s){this.table=n,this.config=s,this.name=s.name,this.keyAsName=s.keyAsName,this.notNull=s.notNull,this.default=s.default,this.defaultFn=s.defaultFn,this.onUpdateFn=s.onUpdateFn,this.hasDefault=s.hasDefault,this.primary=s.primaryKey,this.isUnique=s.isUnique,this.uniqueName=s.uniqueName,this.uniqueType=s.uniqueType,this.dataType=s.dataType,this.columnType=s.columnType,this.generated=s.generated,this.generatedIdentity=s.generatedIdentity}static[xt]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(n){return n}mapToDriverValue(n){return n}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}class aR{static[xt]="ColumnBuilder";config;constructor(n,s,u){this.config={name:n,keyAsName:n==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:s,columnType:u,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(n){return this.config.default=n,this.config.hasDefault=!0,this}$defaultFn(n){return this.config.defaultFn=n,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(n){return this.config.onUpdateFn=n,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(n){this.config.name===""&&(this.config.name=n)}}const lm=Symbol.for("drizzle:Name");class lR{static[xt]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(n,s){this.reference=()=>{const{name:u,columns:m,foreignColumns:x}=n();return{name:u,columns:m,foreignTable:x[0].table,foreignColumns:x}},s&&(this._onUpdate=s.onUpdate,this._onDelete=s.onDelete)}onUpdate(n){return this._onUpdate=n===void 0?"no action":n,this}onDelete(n){return this._onDelete=n===void 0?"no action":n,this}build(n){return new cR(n,this)}}class cR{constructor(n,s){this.table=n,this.reference=s.reference,this.onUpdate=s._onUpdate,this.onDelete=s._onDelete}static[xt]="PgForeignKey";reference;onUpdate;onDelete;getName(){const{name:n,columns:s,foreignColumns:u}=this.reference(),m=s.map(l=>l.name),x=u.map(l=>l.name),v=[this.table[lm],...m,u[0].table[lm],...x];return n??`${v.join("_")}_fk`}}function uR(r,...n){return r(...n)}function hR(r,n){return`${r[lm]}_${n.join("_")}_unique`}function bw(r,n,s){for(let u=n;u<r.length;u++){const m=r[u];if(m==="\\"){u++;continue}if(m==='"')return[r.slice(n,u).replace(/\\/g,""),u+1];if(!s&&(m===","||m==="}"))return[r.slice(n,u).replace(/\\/g,""),u]}return[r.slice(n).replace(/\\/g,""),r.length]}function _5(r,n=0){const s=[];let u=n,m=!1;for(;u<r.length;){const x=r[u];if(x===","){(m||u===n)&&s.push(""),m=!0,u++;continue}if(m=!1,x==="\\"){u+=2;continue}if(x==='"'){const[A,R]=bw(r,u+1,!0);s.push(A),u=R;continue}if(x==="}")return[s,u+1];if(x==="{"){const[A,R]=_5(r,u+1);s.push(A),u=R;continue}const[v,l]=bw(r,u,!1);s.push(v),u=l}return[s,u]}function dR(r){const[n]=_5(r,1);return n}function v5(r){return`{${r.map(n=>Array.isArray(n)?v5(n):typeof n=="string"?`"${n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${n}`).join(",")}}`}class fn extends aR{foreignKeyConfigs=[];static[xt]="PgColumnBuilder";array(n){return new pR(this.config.name,this,n)}references(n,s={}){return this.foreignKeyConfigs.push({ref:n,actions:s}),this}unique(n,s){return this.config.isUnique=!0,this.config.uniqueName=n,this.config.uniqueType=s?.nulls,this}generatedAlwaysAs(n){return this.config.generated={as:n,type:"always",mode:"stored"},this}buildForeignKeys(n,s){return this.foreignKeyConfigs.map(({ref:u,actions:m})=>uR((x,v)=>{const l=new lR(()=>{const A=x();return{columns:[n],foreignColumns:[A]}});return v.onUpdate&&l.onUpdate(v.onUpdate),v.onDelete&&l.onDelete(v.onDelete),l.build(s)},u,m))}buildExtraConfigColumn(n){return new fR(n,this.config)}}class Or extends $g{constructor(n,s){s.uniqueName||(s.uniqueName=hR(n,[s.name])),super(n,s),this.table=n}static[xt]="PgColumn"}class fR extends Or{static[xt]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(n){return this.indexConfig.opClass=n,this}}class Fv{static[xt]="IndexedColumn";constructor(n,s,u,m){this.name=n,this.keyAsName=s,this.type=u,this.indexConfig=m}name;keyAsName;type;indexConfig}class pR extends fn{static[xt]="PgArrayBuilder";constructor(n,s,u){super(n,"array","PgArray"),this.config.baseBuilder=s,this.config.size=u}build(n){const s=this.config.baseBuilder.build(n);return new Ox(n,this.config,s)}}class Ox extends Or{constructor(n,s,u,m){super(n,s),this.baseColumn=u,this.range=m,this.size=s.size}size;static[xt]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(n){return typeof n=="string"&&(n=dR(n)),n.map(s=>this.baseColumn.mapFromDriverValue(s))}mapToDriverValue(n,s=!1){const u=n.map(m=>m===null?null:es(this.baseColumn,Ox)?this.baseColumn.mapToDriverValue(m,!0):this.baseColumn.mapToDriverValue(m));return s?u:v5(u)}}const ww=Symbol.for("drizzle:isPgEnum");function mR(r){return!!r&&typeof r=="function"&&ww in r&&r[ww]===!0}class x5{static[xt]="Subquery";constructor(n,s,u,m=!1){this._={brand:"Subquery",sql:n,selectedFields:s,alias:u,isWith:m}}}const gR={startActiveSpan(r,n){return n()}},cm=Symbol.for("drizzle:ViewBaseConfig"),Ov=Symbol.for("drizzle:Schema"),Tw=Symbol.for("drizzle:Columns"),Sw=Symbol.for("drizzle:ExtraConfigColumns"),Nv=Symbol.for("drizzle:OriginalName"),jv=Symbol.for("drizzle:BaseName"),j0=Symbol.for("drizzle:IsAlias"),Pw=Symbol.for("drizzle:ExtraConfigBuilder"),b5=Symbol.for("drizzle:IsDrizzleTable");let Pa=class{static[xt]="Table";static Symbol={Name:lm,Schema:Ov,OriginalName:Nv,Columns:Tw,ExtraConfigColumns:Sw,BaseName:jv,IsAlias:j0,ExtraConfigBuilder:Pw};[lm];[Nv];[Ov];[Tw];[Sw];[jv];[j0]=!1;[b5]=!0;[Pw]=void 0;constructor(n,s,u){this[lm]=this[Nv]=n,this[Ov]=s,this[jv]=u}};function w5(r){return typeof r=="object"&&r!==null&&b5 in r}function yR(r){return r!=null&&typeof r.getSQL=="function"}function _R(r){const n={sql:"",params:[]};for(const s of r)n.sql+=s.sql,n.params.push(...s.params),s.typings?.length&&(n.typings||(n.typings=[]),n.typings.push(...s.typings));return n}class tc{static[xt]="StringChunk";value;constructor(n){this.value=Array.isArray(n)?n:[n]}getSQL(){return new ri([this])}}class ri{constructor(n){this.queryChunks=n}static[xt]="SQL";decoder=T5;shouldInlineParams=!1;append(n){return this.queryChunks.push(...n.queryChunks),this}toQuery(n){return gR.startActiveSpan("drizzle.buildSQL",s=>{const u=this.buildQueryFromSourceParams(this.queryChunks,n);return s?.setAttributes({"drizzle.query.text":u.sql,"drizzle.query.params":JSON.stringify(u.params)}),u})}buildQueryFromSourceParams(n,s){const u=Object.assign({},s,{inlineParams:s.inlineParams||this.shouldInlineParams,paramStartIndex:s.paramStartIndex||{value:0}}),{casing:m,escapeName:x,escapeParam:v,prepareTyping:l,inlineParams:A,paramStartIndex:R}=u;return _R(n.map(L=>{if(es(L,tc))return{sql:L.value.join(""),params:[]};if(es(L,A1))return{sql:x(L.value),params:[]};if(L===void 0)return{sql:"",params:[]};if(Array.isArray(L)){const B=[new tc("(")];for(const[W,re]of L.entries())B.push(re),W<L.length-1&&B.push(new tc(", "));return B.push(new tc(")")),this.buildQueryFromSourceParams(B,u)}if(es(L,ri))return this.buildQueryFromSourceParams(L.queryChunks,{...u,inlineParams:A||L.shouldInlineParams});if(es(L,Pa)){const B=L[Pa.Symbol.Schema],W=L[Pa.Symbol.Name];return{sql:B===void 0||L[j0]?x(W):x(B)+"."+x(W),params:[]}}if(es(L,$g)){const B=m.getColumnCasing(L);if(s.invokeSource==="indexes")return{sql:x(B),params:[]};const W=L.table[Pa.Symbol.Schema];return{sql:L.table[j0]||W===void 0?x(L.table[Pa.Symbol.Name])+"."+x(B):x(W)+"."+x(L.table[Pa.Symbol.Name])+"."+x(B),params:[]}}if(es(L,vR)){const B=L[cm].schema,W=L[cm].name;return{sql:B===void 0||L[cm].isAlias?x(W):x(B)+"."+x(W),params:[]}}if(es(L,P5)){if(es(L.value,k1))return{sql:v(R.value++,L),params:[L],typings:["none"]};const B=L.value===null?null:L.encoder.mapToDriverValue(L.value);if(es(B,ri))return this.buildQueryFromSourceParams([B],u);if(A)return{sql:this.mapInlineParam(B,u),params:[]};let W=["none"];return l&&(W=[l(L.encoder)]),{sql:v(R.value++,B),params:[B],typings:W}}return es(L,k1)?{sql:v(R.value++,L),params:[L],typings:["none"]}:es(L,ri.Aliased)&&L.fieldAlias!==void 0?{sql:x(L.fieldAlias),params:[]}:es(L,x5)?L._.isWith?{sql:x(L._.alias),params:[]}:this.buildQueryFromSourceParams([new tc("("),L._.sql,new tc(") "),new A1(L._.alias)],u):mR(L)?L.schema?{sql:x(L.schema)+"."+x(L.enumName),params:[]}:{sql:x(L.enumName),params:[]}:yR(L)?L.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([L.getSQL()],u):this.buildQueryFromSourceParams([new tc("("),L.getSQL(),new tc(")")],u):A?{sql:this.mapInlineParam(L,u),params:[]}:{sql:v(R.value++,L),params:[L],typings:["none"]}}))}mapInlineParam(n,{escapeString:s}){if(n===null)return"null";if(typeof n=="number"||typeof n=="boolean")return n.toString();if(typeof n=="string")return s(n);if(typeof n=="object"){const u=n.toString();return s(u==="[object Object]"?JSON.stringify(n):u)}throw new Error("Unexpected param value: "+n)}getSQL(){return this}as(n){return n===void 0?this:new ri.Aliased(this,n)}mapWith(n){return this.decoder=typeof n=="function"?{mapFromDriverValue:n}:n,this}inlineParams(){return this.shouldInlineParams=!0,this}if(n){return n?this:void 0}}class A1{constructor(n){this.value=n}static[xt]="Name";brand;getSQL(){return new ri([this])}}const T5={mapFromDriverValue:r=>r},S5={mapToDriverValue:r=>r};({...T5,...S5});class P5{constructor(n,s=S5){this.value=n,this.encoder=s}static[xt]="Param";brand;getSQL(){return new ri([this])}}function Gg(r,...n){const s=[];(n.length>0||r.length>0&&r[0]!=="")&&s.push(new tc(r[0]));for(const[u,m]of n.entries())s.push(m,new tc(r[u+1]));return new ri(s)}(r=>{function n(){return new ri([])}r.empty=n;function s(A){return new ri(A)}r.fromList=s;function u(A){return new ri([new tc(A)])}r.raw=u;function m(A,R){const L=[];for(const[B,W]of A.entries())B>0&&R!==void 0&&L.push(R),L.push(W);return new ri(L)}r.join=m;function x(A){return new A1(A)}r.identifier=x;function v(A){return new k1(A)}r.placeholder=v;function l(A,R){return new P5(A,R)}r.param=l})(Gg||(Gg={}));(r=>{class n{constructor(u,m){this.sql=u,this.fieldAlias=m}static[xt]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new n(this.sql,this.fieldAlias)}}r.Aliased=n})(ri||(ri={}));class k1{constructor(n){this.name=n}static[xt]="Placeholder";getSQL(){return new ri([this])}}const C5=Symbol.for("drizzle:IsDrizzleView");class vR{static[xt]="View";[cm];[C5]=!0;constructor({name:n,schema:s,selectedFields:u,query:m}){this[cm]={name:n,originalName:n,schema:s,selectedFields:u,query:m,isExisting:!m,isAlias:!1}}getSQL(){return new ri([this])}}function xR(r){return typeof r=="object"&&r!==null&&C5 in r}$g.prototype.getSQL=function(){return new ri([this])};Pa.prototype.getSQL=function(){return new ri([this])};x5.prototype.getSQL=function(){return new ri([this])};function bR(r){return r[Pa.Symbol.Columns]}function wR(r){return r[cm].selectedFields}function Es(r,n){return{name:typeof r=="string"&&r.length>0?r:"",config:typeof r=="object"?r:n}}class p_ extends fn{static[xt]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(n){if(n){const{name:s,...u}=n;this.config.generatedIdentity={type:"always",sequenceName:s,sequenceOptions:u}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(n){if(n){const{name:s,...u}=n;this.config.generatedIdentity={type:"byDefault",sequenceName:s,sequenceOptions:u}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}class TR extends p_{static[xt]="PgBigInt53Builder";constructor(n){super(n,"number","PgBigInt53")}build(n){return new SR(n,this.config)}}class SR extends Or{static[xt]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(n){return typeof n=="number"?n:Number(n)}}class PR extends p_{static[xt]="PgBigInt64Builder";constructor(n){super(n,"bigint","PgBigInt64")}build(n){return new CR(n,this.config)}}class CR extends Or{static[xt]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(n){return BigInt(n)}}function ER(r,n){const{name:s,config:u}=Es(r,n);return u.mode==="number"?new TR(s):new PR(s)}class MR extends fn{static[xt]="PgBigSerial53Builder";constructor(n){super(n,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(n){return new IR(n,this.config)}}class IR extends Or{static[xt]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(n){return typeof n=="number"?n:Number(n)}}class AR extends fn{static[xt]="PgBigSerial64Builder";constructor(n){super(n,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(n){return new kR(n,this.config)}}class kR extends Or{static[xt]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(n){return BigInt(n)}}function DR(r,n){const{name:s,config:u}=Es(r,n);return u.mode==="number"?new MR(s):new AR(s)}class RR extends fn{static[xt]="PgBooleanBuilder";constructor(n){super(n,"boolean","PgBoolean")}build(n){return new LR(n,this.config)}}class LR extends Or{static[xt]="PgBoolean";getSQLType(){return"boolean"}}function zR(r){return new RR(r??"")}class FR extends fn{static[xt]="PgCharBuilder";constructor(n,s){super(n,"string","PgChar"),this.config.length=s.length,this.config.enumValues=s.enum}build(n){return new OR(n,this.config)}}class OR extends Or{static[xt]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}function NR(r,n={}){const{name:s,config:u}=Es(r,n);return new FR(s,u)}class jR extends fn{static[xt]="PgCidrBuilder";constructor(n){super(n,"string","PgCidr")}build(n){return new BR(n,this.config)}}class BR extends Or{static[xt]="PgCidr";getSQLType(){return"cidr"}}function VR(r){return new jR(r??"")}class UR extends fn{static[xt]="PgCustomColumnBuilder";constructor(n,s,u){super(n,"custom","PgCustomColumn"),this.config.fieldConfig=s,this.config.customTypeParams=u}build(n){return new $R(n,this.config)}}class $R extends Or{static[xt]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(n,s){super(n,s),this.sqlName=s.customTypeParams.dataType(s.fieldConfig),this.mapTo=s.customTypeParams.toDriver,this.mapFrom=s.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(n){return typeof this.mapFrom=="function"?this.mapFrom(n):n}mapToDriverValue(n){return typeof this.mapTo=="function"?this.mapTo(n):n}}function GR(r){return(n,s)=>{const{name:u,config:m}=Es(n,s);return new UR(u,m,r)}}class ny extends fn{static[xt]="PgDateColumnBaseBuilder";defaultNow(){return this.default(Gg`now()`)}}class qR extends ny{static[xt]="PgDateBuilder";constructor(n){super(n,"date","PgDate")}build(n){return new ZR(n,this.config)}}class ZR extends Or{static[xt]="PgDate";getSQLType(){return"date"}mapFromDriverValue(n){return new Date(n)}mapToDriverValue(n){return n.toISOString()}}class WR extends ny{static[xt]="PgDateStringBuilder";constructor(n){super(n,"string","PgDateString")}build(n){return new HR(n,this.config)}}class HR extends Or{static[xt]="PgDateString";getSQLType(){return"date"}}function XR(r,n){const{name:s,config:u}=Es(r,n);return u?.mode==="date"?new qR(s):new WR(s)}class KR extends fn{static[xt]="PgDoublePrecisionBuilder";constructor(n){super(n,"number","PgDoublePrecision")}build(n){return new YR(n,this.config)}}class YR extends Or{static[xt]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(n){return typeof n=="string"?Number.parseFloat(n):n}}function D1(r){return new KR(r??"")}class QR extends fn{static[xt]="PgInetBuilder";constructor(n){super(n,"string","PgInet")}build(n){return new JR(n,this.config)}}class JR extends Or{static[xt]="PgInet";getSQLType(){return"inet"}}function eL(r){return new QR(r??"")}class tL extends p_{static[xt]="PgIntegerBuilder";constructor(n){super(n,"number","PgInteger")}build(n){return new rL(n,this.config)}}class rL extends Or{static[xt]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(n){return typeof n=="string"?Number.parseInt(n):n}}function nL(r){return new tL(r??"")}class iL extends fn{static[xt]="PgIntervalBuilder";constructor(n,s){super(n,"string","PgInterval"),this.config.intervalConfig=s}build(n){return new sL(n,this.config)}}class sL extends Or{static[xt]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){const n=this.fields?` ${this.fields}`:"",s=this.precision?`(${this.precision})`:"";return`interval${n}${s}`}}function oL(r,n={}){const{name:s,config:u}=Es(r,n);return new iL(s,u)}class aL extends fn{static[xt]="PgJsonBuilder";constructor(n){super(n,"json","PgJson")}build(n){return new lL(n,this.config)}}class lL extends Or{static[xt]="PgJson";constructor(n,s){super(n,s)}getSQLType(){return"json"}mapToDriverValue(n){return JSON.stringify(n)}mapFromDriverValue(n){if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n}}function cL(r){return new aL(r??"")}class uL extends fn{static[xt]="PgJsonbBuilder";constructor(n){super(n,"json","PgJsonb")}build(n){return new hL(n,this.config)}}class hL extends Or{static[xt]="PgJsonb";constructor(n,s){super(n,s)}getSQLType(){return"jsonb"}mapToDriverValue(n){return JSON.stringify(n)}mapFromDriverValue(n){if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n}}function E5(r){return new uL(r??"")}class dL extends fn{static[xt]="PgLineBuilder";constructor(n){super(n,"array","PgLine")}build(n){return new fL(n,this.config)}}class fL extends Or{static[xt]="PgLine";getSQLType(){return"line"}mapFromDriverValue(n){const[s,u,m]=n.slice(1,-1).split(",");return[Number.parseFloat(s),Number.parseFloat(u),Number.parseFloat(m)]}mapToDriverValue(n){return`{${n[0]},${n[1]},${n[2]}}`}}class pL extends fn{static[xt]="PgLineABCBuilder";constructor(n){super(n,"json","PgLineABC")}build(n){return new mL(n,this.config)}}class mL extends Or{static[xt]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(n){const[s,u,m]=n.slice(1,-1).split(",");return{a:Number.parseFloat(s),b:Number.parseFloat(u),c:Number.parseFloat(m)}}mapToDriverValue(n){return`{${n.a},${n.b},${n.c}}`}}function gL(r,n){const{name:s,config:u}=Es(r,n);return!u?.mode||u.mode==="tuple"?new dL(s):new pL(s)}class yL extends fn{static[xt]="PgMacaddrBuilder";constructor(n){super(n,"string","PgMacaddr")}build(n){return new _L(n,this.config)}}class _L extends Or{static[xt]="PgMacaddr";getSQLType(){return"macaddr"}}function vL(r){return new yL(r??"")}class xL extends fn{static[xt]="PgMacaddr8Builder";constructor(n){super(n,"string","PgMacaddr8")}build(n){return new bL(n,this.config)}}class bL extends Or{static[xt]="PgMacaddr8";getSQLType(){return"macaddr8"}}function wL(r){return new xL(r??"")}class TL extends fn{static[xt]="PgNumericBuilder";constructor(n,s,u){super(n,"string","PgNumeric"),this.config.precision=s,this.config.scale=u}build(n){return new SL(n,this.config)}}class SL extends Or{static[xt]="PgNumeric";precision;scale;constructor(n,s){super(n,s),this.precision=s.precision,this.scale=s.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}function PL(r,n){const{name:s,config:u}=Es(r,n);return new TL(s,u?.precision,u?.scale)}class CL extends fn{static[xt]="PgPointTupleBuilder";constructor(n){super(n,"array","PgPointTuple")}build(n){return new EL(n,this.config)}}class EL extends Or{static[xt]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(n){if(typeof n=="string"){const[s,u]=n.slice(1,-1).split(",");return[Number.parseFloat(s),Number.parseFloat(u)]}return[n.x,n.y]}mapToDriverValue(n){return`(${n[0]},${n[1]})`}}class ML extends fn{static[xt]="PgPointObjectBuilder";constructor(n){super(n,"json","PgPointObject")}build(n){return new IL(n,this.config)}}class IL extends Or{static[xt]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(n){if(typeof n=="string"){const[s,u]=n.slice(1,-1).split(",");return{x:Number.parseFloat(s),y:Number.parseFloat(u)}}return n}mapToDriverValue(n){return`(${n.x},${n.y})`}}function AL(r,n){const{name:s,config:u}=Es(r,n);return!u?.mode||u.mode==="tuple"?new CL(s):new ML(s)}function kL(r){const n=[];for(let s=0;s<r.length;s+=2)n.push(Number.parseInt(r.slice(s,s+2),16));return new Uint8Array(n)}function Cw(r,n){const s=new ArrayBuffer(8),u=new DataView(s);for(let m=0;m<8;m++)u.setUint8(m,r[n+m]);return u.getFloat64(0,!0)}function M5(r){const n=kL(r);let s=0;const u=n[s];s+=1;const m=new DataView(n.buffer),x=m.getUint32(s,u===1);if(s+=4,x&536870912&&(m.getUint32(s,u===1),s+=4),(x&65535)===1){const v=Cw(n,s);s+=8;const l=Cw(n,s);return s+=8,[v,l]}throw new Error("Unsupported geometry type")}class DL extends fn{static[xt]="PgGeometryBuilder";constructor(n){super(n,"array","PgGeometry")}build(n){return new RL(n,this.config)}}class RL extends Or{static[xt]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(n){return M5(n)}mapToDriverValue(n){return`point(${n[0]} ${n[1]})`}}class LL extends fn{static[xt]="PgGeometryObjectBuilder";constructor(n){super(n,"json","PgGeometryObject")}build(n){return new zL(n,this.config)}}class zL extends Or{static[xt]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(n){const s=M5(n);return{x:s[0],y:s[1]}}mapToDriverValue(n){return`point(${n.x} ${n.y})`}}function FL(r,n){const{name:s,config:u}=Es(r,n);return!u?.mode||u.mode==="tuple"?new DL(s):new LL(s)}class OL extends fn{static[xt]="PgRealBuilder";constructor(n,s){super(n,"number","PgReal"),this.config.length=s}build(n){return new NL(n,this.config)}}class NL extends Or{static[xt]="PgReal";constructor(n,s){super(n,s)}getSQLType(){return"real"}mapFromDriverValue=n=>typeof n=="string"?Number.parseFloat(n):n}function jL(r){return new OL(r??"")}class BL extends fn{static[xt]="PgSerialBuilder";constructor(n){super(n,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(n){return new VL(n,this.config)}}class VL extends Or{static[xt]="PgSerial";getSQLType(){return"serial"}}function I5(r){return new BL(r??"")}class UL extends p_{static[xt]="PgSmallIntBuilder";constructor(n){super(n,"number","PgSmallInt")}build(n){return new $L(n,this.config)}}class $L extends Or{static[xt]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=n=>typeof n=="string"?Number(n):n}function GL(r){return new UL(r??"")}class qL extends fn{static[xt]="PgSmallSerialBuilder";constructor(n){super(n,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(n){return new ZL(n,this.config)}}class ZL extends Or{static[xt]="PgSmallSerial";getSQLType(){return"smallserial"}}function WL(r){return new qL(r??"")}class HL extends fn{static[xt]="PgTextBuilder";constructor(n,s){super(n,"string","PgText"),this.config.enumValues=s.enum}build(n){return new XL(n,this.config)}}class XL extends Or{static[xt]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function Zp(r,n={}){const{name:s,config:u}=Es(r,n);return new HL(s,u)}class KL extends ny{constructor(n,s,u){super(n,"string","PgTime"),this.withTimezone=s,this.precision=u,this.config.withTimezone=s,this.config.precision=u}static[xt]="PgTimeBuilder";build(n){return new YL(n,this.config)}}class YL extends Or{static[xt]="PgTime";withTimezone;precision;constructor(n,s){super(n,s),this.withTimezone=s.withTimezone,this.precision=s.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}function QL(r,n={}){const{name:s,config:u}=Es(r,n);return new KL(s,u.withTimezone??!1,u.precision)}class JL extends ny{static[xt]="PgTimestampBuilder";constructor(n,s,u){super(n,"date","PgTimestamp"),this.config.withTimezone=s,this.config.precision=u}build(n){return new ez(n,this.config)}}class ez extends Or{static[xt]="PgTimestamp";withTimezone;precision;constructor(n,s){super(n,s),this.withTimezone=s.withTimezone,this.precision=s.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=n=>new Date(this.withTimezone?n:n+"+0000");mapToDriverValue=n=>n.toISOString()}class tz extends ny{static[xt]="PgTimestampStringBuilder";constructor(n,s,u){super(n,"string","PgTimestampString"),this.config.withTimezone=s,this.config.precision=u}build(n){return new rz(n,this.config)}}class rz extends Or{static[xt]="PgTimestampString";withTimezone;precision;constructor(n,s){super(n,s),this.withTimezone=s.withTimezone,this.precision=s.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}function qg(r,n={}){const{name:s,config:u}=Es(r,n);return u?.mode==="string"?new tz(s,u.withTimezone??!1,u.precision):new JL(s,u?.withTimezone??!1,u?.precision)}class nz extends fn{static[xt]="PgUUIDBuilder";constructor(n){super(n,"string","PgUUID")}defaultRandom(){return this.default(Gg`gen_random_uuid()`)}build(n){return new iz(n,this.config)}}class iz extends Or{static[xt]="PgUUID";getSQLType(){return"uuid"}}function sz(r){return new nz(r??"")}class oz extends fn{static[xt]="PgVarcharBuilder";constructor(n,s){super(n,"string","PgVarchar"),this.config.length=s.length,this.config.enumValues=s.enum}build(n){return new az(n,this.config)}}class az extends Or{static[xt]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}function Ff(r,n={}){const{name:s,config:u}=Es(r,n);return new oz(s,u)}class lz extends fn{static[xt]="PgBinaryVectorBuilder";constructor(n,s){super(n,"string","PgBinaryVector"),this.config.dimensions=s.dimensions}build(n){return new cz(n,this.config)}}class cz extends Or{static[xt]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function uz(r,n){const{name:s,config:u}=Es(r,n);return new lz(s,u)}class hz extends fn{static[xt]="PgHalfVectorBuilder";constructor(n,s){super(n,"array","PgHalfVector"),this.config.dimensions=s.dimensions}build(n){return new dz(n,this.config)}}class dz extends Or{static[xt]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(n){return JSON.stringify(n)}mapFromDriverValue(n){return n.slice(1,-1).split(",").map(s=>Number.parseFloat(s))}}function fz(r,n){const{name:s,config:u}=Es(r,n);return new hz(s,u)}class pz extends fn{static[xt]="PgSparseVectorBuilder";constructor(n,s){super(n,"string","PgSparseVector"),this.config.dimensions=s.dimensions}build(n){return new mz(n,this.config)}}class mz extends Or{static[xt]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function gz(r,n){const{name:s,config:u}=Es(r,n);return new pz(s,u)}class yz extends fn{static[xt]="PgVectorBuilder";constructor(n,s){super(n,"array","PgVector"),this.config.dimensions=s.dimensions}build(n){return new _z(n,this.config)}}class _z extends Or{static[xt]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(n){return JSON.stringify(n)}mapFromDriverValue(n){return n.slice(1,-1).split(",").map(s=>Number.parseFloat(s))}}function vz(r,n){const{name:s,config:u}=Es(r,n);return new yz(s,u)}function xz(){return{bigint:ER,bigserial:DR,boolean:zR,char:NR,cidr:VR,customType:GR,date:XR,doublePrecision:D1,inet:eL,integer:nL,interval:oL,json:cL,jsonb:E5,line:gL,macaddr:vL,macaddr8:wL,numeric:PL,point:AL,geometry:FL,real:jL,serial:I5,smallint:GL,smallserial:WL,text:Zp,time:QL,timestamp:qg,uuid:sz,varchar:Ff,bit:uz,halfvec:fz,sparsevec:gz,vector:vz}}const R1=Symbol.for("drizzle:PgInlineForeignKeys"),Ew=Symbol.for("drizzle:EnableRLS");class Bv extends Pa{static[xt]="PgTable";static Symbol=Object.assign({},Pa.Symbol,{InlineForeignKeys:R1,EnableRLS:Ew});[R1]=[];[Ew]=!1;[Pa.Symbol.ExtraConfigBuilder]=void 0}function bz(r,n,s,u,m=r){const x=new Bv(r,u,m),v=typeof n=="function"?n(xz()):n,l=Object.fromEntries(Object.entries(v).map(([L,B])=>{const W=B;W.setName(L);const re=W.build(x);return x[R1].push(...W.buildForeignKeys(re,x)),[L,re]})),A=Object.fromEntries(Object.entries(v).map(([L,B])=>{const W=B;W.setName(L);const re=W.buildExtraConfigColumn(x);return[L,re]})),R=Object.assign(x,l);return R[Pa.Symbol.Columns]=l,R[Pa.Symbol.ExtraConfigColumns]=A,s&&(R[Bv.Symbol.ExtraConfigBuilder]=s),Object.assign(R,{enableRLS:()=>(R[Bv.Symbol.EnableRLS]=!0,R)})}const Nx=(r,n,s)=>bz(r,n,s,void 0);class wz{constructor(n,s){this.unique=n,this.name=s}static[xt]="PgIndexBuilderOn";on(...n){return new Vv(n.map(s=>{if(es(s,ri))return s;s=s;const u=new Fv(s.name,!!s.keyAsName,s.columnType,s.indexConfig);return s.indexConfig=JSON.parse(JSON.stringify(s.defaultConfig)),u}),this.unique,!1,this.name)}onOnly(...n){return new Vv(n.map(s=>{if(es(s,ri))return s;s=s;const u=new Fv(s.name,!!s.keyAsName,s.columnType,s.indexConfig);return s.indexConfig=s.defaultConfig,u}),this.unique,!0,this.name)}using(n,...s){return new Vv(s.map(u=>{if(es(u,ri))return u;u=u;const m=new Fv(u.name,!!u.keyAsName,u.columnType,u.indexConfig);return u.indexConfig=JSON.parse(JSON.stringify(u.defaultConfig)),m}),this.unique,!0,this.name,n)}}class Vv{static[xt]="PgIndexBuilder";config;constructor(n,s,u,m,x="btree"){this.config={name:m,columns:n,unique:s,only:u,method:x}}concurrently(){return this.config.concurrently=!0,this}with(n){return this.config.with=n,this}where(n){return this.config.where=n,this}build(n){return new Tz(this.config,n)}}class Tz{static[xt]="PgIndex";config;constructor(n,s){this.config={...n,table:s}}}function Sz(r){return new wz(!1,r)}const gi={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function ji(r,n){return n.includes(r.columnType)}function Pz(r){return"enumValues"in r&&Array.isArray(r.enumValues)&&r.enumValues.length>0}const Cz=Wn.union([Wn.string(),Wn.number(),Wn.boolean(),Wn.null()]),Ez=Wn.union([Cz,Wn.record(Wn.any()),Wn.array(Wn.any())]),Mz=Wn.custom(r=>r instanceof Buffer);function A5(r,n){const s=n?.zodInstance??Wn,u=n?.coerce??{};let m;return Pz(r)&&(m=r.enumValues.length?s.enum(r.enumValues):s.string()),m||(ji(r,["PgGeometry","PgPointTuple"])?m=s.tuple([s.number(),s.number()]):ji(r,["PgGeometryObject","PgPointObject"])?m=s.object({x:s.number(),y:s.number()}):ji(r,["PgHalfVector","PgVector"])?(m=s.array(s.number()),m=r.dimensions?m.length(r.dimensions):m):ji(r,["PgLine"])?m=s.tuple([s.number(),s.number(),s.number()]):ji(r,["PgLineABC"])?m=s.object({a:s.number(),b:s.number(),c:s.number()}):ji(r,["PgArray"])?(m=s.array(A5(r.baseColumn,s)),m=r.size?m.length(r.size):m):r.dataType==="array"?m=s.array(s.any()):r.dataType==="number"?m=Iz(r,s,u):r.dataType==="bigint"?m=Az(r,s,u):r.dataType==="boolean"?m=u===!0||u.boolean?s.coerce.boolean():s.boolean():r.dataType==="date"?m=u===!0||u.date?s.coerce.date():s.date():r.dataType==="string"?m=kz(r,s,u):r.dataType==="json"?m=Ez:r.dataType==="custom"?m=s.any():r.dataType==="buffer"&&(m=Mz)),m||(m=s.any()),m}function Iz(r,n,s){let u=r.getSQLType().includes("unsigned"),m,x,v=!1;ji(r,["MySqlTinyInt","SingleStoreTinyInt"])?(m=u?0:gi.INT8_MIN,x=u?gi.INT8_UNSIGNED_MAX:gi.INT8_MAX,v=!0):ji(r,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(m=u?0:gi.INT16_MIN,x=u?gi.INT16_UNSIGNED_MAX:gi.INT16_MAX,v=!0):ji(r,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(m=u?0:gi.INT24_MIN,x=u?gi.INT24_UNSIGNED_MAX:gi.INT24_MAX,v=ji(r,["MySqlMediumInt","SingleStoreMediumInt"])):ji(r,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(m=u?0:gi.INT32_MIN,x=u?gi.INT32_UNSIGNED_MAX:gi.INT32_MAX,v=!0):ji(r,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(m=u?0:gi.INT48_MIN,x=u?gi.INT48_UNSIGNED_MAX:gi.INT48_MAX):ji(r,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(u=u||ji(r,["MySqlSerial","SingleStoreSerial"]),m=u?0:Number.MIN_SAFE_INTEGER,x=Number.MAX_SAFE_INTEGER,v=!0):ji(r,["MySqlYear","SingleStoreYear"])?(m=1901,x=2155,v=!0):(m=Number.MIN_SAFE_INTEGER,x=Number.MAX_SAFE_INTEGER);let l=s===!0||s?.number?n.coerce.number():n.number();return l=l.min(m).max(x),v?l.int():l}function Az(r,n,s){const u=r.getSQLType().includes("unsigned"),m=u?0n:gi.INT64_MIN,x=u?gi.INT64_UNSIGNED_MAX:gi.INT64_MAX;return(s===!0||s?.bigint?n.coerce.bigint():n.bigint()).min(m).max(x)}function kz(r,n,s){if(ji(r,["PgUUID"]))return n.string().uuid();let u,m,x=!1;ji(r,["PgVarchar","SQLiteText"])?u=r.length:ji(r,["MySqlVarChar","SingleStoreVarChar"])?u=r.length??gi.INT16_UNSIGNED_MAX:ji(r,["MySqlText","SingleStoreText"])&&(r.textType==="longtext"?u=gi.INT32_UNSIGNED_MAX:r.textType==="mediumtext"?u=gi.INT24_UNSIGNED_MAX:r.textType==="text"?u=gi.INT16_UNSIGNED_MAX:u=gi.INT8_UNSIGNED_MAX),ji(r,["PgChar","MySqlChar","SingleStoreChar"])&&(u=r.length,x=!0),ji(r,["PgBinaryVector"])&&(m=/^[01]+$/,u=r.dimensions);let v=s===!0||s?.string?n.coerce.string():n.string();return v=m?v.regex(m):v,u&&x?v.length(u):u?v.max(u):v}function k5(r){return w5(r)?bR(r):wR(r)}function D5(r,n,s,u){const m={};for(const[x,v]of Object.entries(r)){if(!es(v,$g)&&!es(v,ri)&&!es(v,ri.Aliased)&&typeof v=="object"){const B=w5(v)||xR(v)?k5(v):v;m[x]=D5(B,n[x]??{},s,u);continue}const l=n[x];if(l!==void 0&&typeof l!="function"){m[x]=l;continue}const A=es(v,$g)?v:void 0,R=A?A5(A,u):Wn.any(),L=typeof l=="function"?l(R):R;s.never(A)||(m[x]=L,A&&(s.nullable(A)&&(m[x]=m[x].nullable()),s.optional(A)&&(m[x]=m[x].optional())))}return Wn.object(m)}const Dz={never:r=>r?.generated?.type==="always"||r?.generatedIdentity?.type==="always",optional:r=>!r.notNull||r.notNull&&r.hasDefault,nullable:r=>!r.notNull},Rz=(r,n)=>{const s=k5(r);return D5(s,{},Dz)};Nx("sessions",{sid:Ff("sid").primaryKey(),sess:E5("sess").notNull(),expire:qg("expire").notNull()},r=>[Sz("IDX_session_expire").on(r.expire)]);Nx("users",{id:Ff("id").primaryKey().default(Gg`gen_random_uuid()`),email:Ff("email").unique(),firstName:Ff("first_name"),lastName:Ff("last_name"),profileImageUrl:Ff("profile_image_url"),createdAt:qg("created_at").defaultNow(),updatedAt:qg("updated_at").defaultNow()});const Lz=Nx("locations",{id:I5("id").primaryKey(),name:Zp("name").notNull(),description:Zp("description"),lat:D1("lat").notNull(),lng:D1("lng").notNull(),imageUrl:Zp("image_url"),videoUrl:Zp("video_url"),locationType:Zp("location_type").default("kmz"),createdAt:qg("created_at").defaultNow()}),R5=Rz(Lz).omit({id:!0,createdAt:!0}),Mw={validation:Wn.object({message:Wn.string(),field:Wn.string().optional()}),notFound:Wn.object({message:Wn.string()}),internal:Wn.object({message:Wn.string()})},Qs={locations:{list:{path:"/api/locations",responses:{200:Wn.array(Wn.custom())}},get:{responses:{200:Wn.custom()}},create:{method:"POST",path:"/api/locations",responses:{201:Wn.custom(),400:Mw.validation}},update:{method:"PUT",path:"/api/locations/:id",input:R5.partial(),responses:{200:Wn.custom(),400:Mw.validation}},delete:{method:"DELETE",path:"/api/locations/:id",responses:{204:Wn.void()}}}};function L5(r,n){let s=r;return n&&Object.entries(n).forEach(([u,m])=>{s.includes(`:${u}`)&&(s=s.replace(`:${u}`,String(m)))}),s}function z5(){return z6({queryKey:[Qs.locations.list.path],queryFn:async()=>{const r=await fetch(Qs.locations.list.path);if(!r.ok)throw new Error("Failed to fetch locations");return Qs.locations.list.responses[200].parse(await r.json())}})}function zz(){const r=Tm();return n_({mutationFn:async n=>{const s=await fetch(Qs.locations.create.path,{method:Qs.locations.create.method,headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"});if(!s.ok){if(s.status===400){const u=Qs.locations.create.responses[400].parse(await s.json());throw new Error(u.message)}throw new Error("Failed to create location")}return Qs.locations.create.responses[201].parse(await s.json())},onSuccess:()=>{r.invalidateQueries({queryKey:[Qs.locations.list.path]})}})}function Fz(){const r=Tm();return n_({mutationFn:async({id:n,...s})=>{const u=L5(Qs.locations.update.path,{id:n}),m=await fetch(u,{method:Qs.locations.update.method,headers:{"Content-Type":"application/json"},body:JSON.stringify(s),credentials:"include"});if(!m.ok){if(m.status===400){const x=Qs.locations.update.responses[400].parse(await m.json());throw new Error(x.message)}throw new Error("Failed to update location")}return Qs.locations.update.responses[200].parse(await m.json())},onSuccess:()=>{r.invalidateQueries({queryKey:[Qs.locations.list.path]})}})}function Oz(){const r=Tm();return n_({mutationFn:async n=>{const s=L5(Qs.locations.delete.path,{id:n});if(!(await fetch(s,{method:Qs.locations.delete.method,credentials:"include"})).ok)throw new Error("Failed to delete location")},onSuccess:()=>{r.invalidateQueries({queryKey:[Qs.locations.list.path]})}})}var Uv="focusScope.autoFocusOnMount",$v="focusScope.autoFocusOnUnmount",Iw={bubbles:!1,cancelable:!0},Nz="FocusScope",m_=j.forwardRef((r,n)=>{const{loop:s=!1,trapped:u=!1,onMountAutoFocus:m,onUnmountAutoFocus:x,...v}=r,[l,A]=j.useState(null),R=to(m),L=to(x),B=j.useRef(null),W=dn(n,Q=>A(Q)),re=j.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;j.useEffect(()=>{if(u){let Q=function(_e){if(re.paused||!l)return;const Ie=_e.target;l.contains(Ie)?B.current=Ie:xd(B.current,{select:!0})},X=function(_e){if(re.paused||!l)return;const Ie=_e.relatedTarget;Ie!==null&&(l.contains(Ie)||xd(B.current,{select:!0}))},le=function(_e){if(document.activeElement===document.body)for(const ke of _e)ke.removedNodes.length>0&&xd(l)};document.addEventListener("focusin",Q),document.addEventListener("focusout",X);const he=new MutationObserver(le);return l&&he.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",Q),document.removeEventListener("focusout",X),he.disconnect()}}},[u,l,re.paused]),j.useEffect(()=>{if(l){kw.add(re);const Q=document.activeElement;if(!l.contains(Q)){const le=new CustomEvent(Uv,Iw);l.addEventListener(Uv,R),l.dispatchEvent(le),le.defaultPrevented||(jz(Gz(F5(l)),{select:!0}),document.activeElement===Q&&xd(l))}return()=>{l.removeEventListener(Uv,R),setTimeout(()=>{const le=new CustomEvent($v,Iw);l.addEventListener($v,L),l.dispatchEvent(le),le.defaultPrevented||xd(Q??document.body,{select:!0}),l.removeEventListener($v,L),kw.remove(re)},0)}}},[l,R,L,re]);const ce=j.useCallback(Q=>{if(!s&&!u||re.paused)return;const X=Q.key==="Tab"&&!Q.altKey&&!Q.ctrlKey&&!Q.metaKey,le=document.activeElement;if(X&&le){const he=Q.currentTarget,[_e,Ie]=Bz(he);_e&&Ie?!Q.shiftKey&&le===Ie?(Q.preventDefault(),s&&xd(_e,{select:!0})):Q.shiftKey&&le===_e&&(Q.preventDefault(),s&&xd(Ie,{select:!0})):le===he&&Q.preventDefault()}},[s,u,re.paused]);return V.jsx(Fr.div,{tabIndex:-1,...v,ref:W,onKeyDown:ce})});m_.displayName=Nz;function jz(r,{select:n=!1}={}){const s=document.activeElement;for(const u of r)if(xd(u,{select:n}),document.activeElement!==s)return}function Bz(r){const n=F5(r),s=Aw(n,r),u=Aw(n.reverse(),r);return[s,u]}function F5(r){const n=[],s=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:u=>{const m=u.tagName==="INPUT"&&u.type==="hidden";return u.disabled||u.hidden||m?NodeFilter.FILTER_SKIP:u.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)n.push(s.currentNode);return n}function Aw(r,n){for(const s of r)if(!Vz(s,{upTo:n}))return s}function Vz(r,{upTo:n}){if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(n!==void 0&&r===n)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}function Uz(r){return r instanceof HTMLInputElement&&"select"in r}function xd(r,{select:n=!1}={}){if(r&&r.focus){const s=document.activeElement;r.focus({preventScroll:!0}),r!==s&&Uz(r)&&n&&r.select()}}var kw=$z();function $z(){let r=[];return{add(n){const s=r[0];n!==s&&s?.pause(),r=Dw(r,n),r.unshift(n)},remove(n){r=Dw(r,n),r[0]?.resume()}}}function Dw(r,n){const s=[...r],u=s.indexOf(n);return u!==-1&&s.splice(u,1),s}function Gz(r){return r.filter(n=>n.tagName!=="A")}var Gv=0;function jx(){j.useEffect(()=>{const r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",r[0]??Rw()),document.body.insertAdjacentElement("beforeend",r[1]??Rw()),Gv++,()=>{Gv===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),Gv--}},[])}function Rw(){const r=document.createElement("span");return r.setAttribute("data-radix-focus-guard",""),r.tabIndex=0,r.style.outline="none",r.style.opacity="0",r.style.position="fixed",r.style.pointerEvents="none",r}var Xc=function(){return Xc=Object.assign||function(n){for(var s,u=1,m=arguments.length;u<m;u++){s=arguments[u];for(var x in s)Object.prototype.hasOwnProperty.call(s,x)&&(n[x]=s[x])}return n},Xc.apply(this,arguments)};function O5(r,n){var s={};for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&n.indexOf(u)<0&&(s[u]=r[u]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var m=0,u=Object.getOwnPropertySymbols(r);m<u.length;m++)n.indexOf(u[m])<0&&Object.prototype.propertyIsEnumerable.call(r,u[m])&&(s[u[m]]=r[u[m]]);return s}function qz(r,n,s){if(s||arguments.length===2)for(var u=0,m=n.length,x;u<m;u++)(x||!(u in n))&&(x||(x=Array.prototype.slice.call(n,0,u)),x[u]=n[u]);return r.concat(x||Array.prototype.slice.call(n))}var y0="right-scroll-bar-position",_0="width-before-scroll-bar",Zz="with-scroll-bars-hidden",Wz="--removed-body-scroll-bar-size";function qv(r,n){return typeof r=="function"?r(n):r&&(r.current=n),r}function Hz(r,n){var s=j.useState(function(){return{value:r,callback:n,facade:{get current(){return s.value},set current(u){var m=s.value;m!==u&&(s.value=u,s.callback(u,m))}}}})[0];return s.callback=n,s.facade}var Xz=typeof window<"u"?j.useLayoutEffect:j.useEffect,Lw=new WeakMap;function Kz(r,n){var s=Hz(null,function(u){return r.forEach(function(m){return qv(m,u)})});return Xz(function(){var u=Lw.get(s);if(u){var m=new Set(u),x=new Set(r),v=s.current;m.forEach(function(l){x.has(l)||qv(l,null)}),x.forEach(function(l){m.has(l)||qv(l,v)})}Lw.set(s,r)},[r]),s}function Yz(r){return r}function Qz(r,n){n===void 0&&(n=Yz);var s=[],u=!1,m={read:function(){if(u)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return s.length?s[s.length-1]:r},useMedium:function(x){var v=n(x,u);return s.push(v),function(){s=s.filter(function(l){return l!==v})}},assignSyncMedium:function(x){for(u=!0;s.length;){var v=s;s=[],v.forEach(x)}s={push:function(l){return x(l)},filter:function(){return s}}},assignMedium:function(x){u=!0;var v=[];if(s.length){var l=s;s=[],l.forEach(x),v=s}var A=function(){var L=v;v=[],L.forEach(x)},R=function(){return Promise.resolve().then(A)};R(),s={push:function(L){v.push(L),R()},filter:function(L){return v=v.filter(L),s}}}};return m}function Jz(r){r===void 0&&(r={});var n=Qz(null);return n.options=Xc({async:!0,ssr:!1},r),n}var N5=function(r){var n=r.sideCar,s=O5(r,["sideCar"]);if(!n)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var u=n.read();if(!u)throw new Error("Sidecar medium not found");return j.createElement(u,Xc({},s))};N5.isSideCarExport=!0;function eF(r,n){return r.useMedium(n),N5}var j5=Jz(),Zv=function(){},g_=j.forwardRef(function(r,n){var s=j.useRef(null),u=j.useState({onScrollCapture:Zv,onWheelCapture:Zv,onTouchMoveCapture:Zv}),m=u[0],x=u[1],v=r.forwardProps,l=r.children,A=r.className,R=r.removeScrollBar,L=r.enabled,B=r.shards,W=r.sideCar,re=r.noIsolation,ce=r.inert,Q=r.allowPinchZoom,X=r.as,le=X===void 0?"div":X,he=r.gapMode,_e=O5(r,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),Ie=W,ke=Kz([s,n]),Je=Xc(Xc({},_e),m);return j.createElement(j.Fragment,null,L&&j.createElement(Ie,{sideCar:j5,removeScrollBar:R,shards:B,noIsolation:re,inert:ce,setCallbacks:x,allowPinchZoom:!!Q,lockRef:s,gapMode:he}),v?j.cloneElement(j.Children.only(l),Xc(Xc({},Je),{ref:ke})):j.createElement(le,Xc({},Je,{className:A,ref:ke}),l))});g_.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};g_.classNames={fullWidth:_0,zeroRight:y0};var tF=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function rF(){if(!document)return null;var r=document.createElement("style");r.type="text/css";var n=tF();return n&&r.setAttribute("nonce",n),r}function nF(r,n){r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n))}function iF(r){var n=document.head||document.getElementsByTagName("head")[0];n.appendChild(r)}var sF=function(){var r=0,n=null;return{add:function(s){r==0&&(n=rF())&&(nF(n,s),iF(n)),r++},remove:function(){r--,!r&&n&&(n.parentNode&&n.parentNode.removeChild(n),n=null)}}},oF=function(){var r=sF();return function(n,s){j.useEffect(function(){return r.add(n),function(){r.remove()}},[n&&s])}},B5=function(){var r=oF(),n=function(s){var u=s.styles,m=s.dynamic;return r(u,m),null};return n},aF={left:0,top:0,right:0,gap:0},Wv=function(r){return parseInt(r||"",10)||0},lF=function(r){var n=window.getComputedStyle(document.body),s=n[r==="padding"?"paddingLeft":"marginLeft"],u=n[r==="padding"?"paddingTop":"marginTop"],m=n[r==="padding"?"paddingRight":"marginRight"];return[Wv(s),Wv(u),Wv(m)]},cF=function(r){if(r===void 0&&(r="margin"),typeof window>"u")return aF;var n=lF(r),s=document.documentElement.clientWidth,u=window.innerWidth;return{left:n[0],top:n[1],right:n[2],gap:Math.max(0,u-s+n[2]-n[0])}},uF=B5(),um="data-scroll-locked",hF=function(r,n,s,u){var m=r.left,x=r.top,v=r.right,l=r.gap;return s===void 0&&(s="margin"),`
  .`.concat(Zz,` {
   overflow: hidden `).concat(u,`;
   padding-right: `).concat(l,"px ").concat(u,`;
  }
  body[`).concat(um,`] {
    overflow: hidden `).concat(u,`;
    overscroll-behavior: contain;
    `).concat([n&&"position: relative ".concat(u,";"),s==="margin"&&`
    padding-left: `.concat(m,`px;
    padding-top: `).concat(x,`px;
    padding-right: `).concat(v,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(u,`;
    `),s==="padding"&&"padding-right: ".concat(l,"px ").concat(u,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(y0,` {
    right: `).concat(l,"px ").concat(u,`;
  }
  
  .`).concat(_0,` {
    margin-right: `).concat(l,"px ").concat(u,`;
  }
  
  .`).concat(y0," .").concat(y0,` {
    right: 0 `).concat(u,`;
  }
  
  .`).concat(_0," .").concat(_0,` {
    margin-right: 0 `).concat(u,`;
  }
  
  body[`).concat(um,`] {
    `).concat(Wz,": ").concat(l,`px;
  }
`)},zw=function(){var r=parseInt(document.body.getAttribute(um)||"0",10);return isFinite(r)?r:0},dF=function(){j.useEffect(function(){return document.body.setAttribute(um,(zw()+1).toString()),function(){var r=zw()-1;r<=0?document.body.removeAttribute(um):document.body.setAttribute(um,r.toString())}},[])},fF=function(r){var n=r.noRelative,s=r.noImportant,u=r.gapMode,m=u===void 0?"margin":u;dF();var x=j.useMemo(function(){return cF(m)},[m]);return j.createElement(uF,{styles:hF(x,!n,m,s?"":"!important")})},L1=!1;if(typeof window<"u")try{var s0=Object.defineProperty({},"passive",{get:function(){return L1=!0,!0}});window.addEventListener("test",s0,s0),window.removeEventListener("test",s0,s0)}catch{L1=!1}var Vp=L1?{passive:!1}:!1,pF=function(r){return r.tagName==="TEXTAREA"},V5=function(r,n){if(!(r instanceof Element))return!1;var s=window.getComputedStyle(r);return s[n]!=="hidden"&&!(s.overflowY===s.overflowX&&!pF(r)&&s[n]==="visible")},mF=function(r){return V5(r,"overflowY")},gF=function(r){return V5(r,"overflowX")},Fw=function(r,n){var s=n.ownerDocument,u=n;do{typeof ShadowRoot<"u"&&u instanceof ShadowRoot&&(u=u.host);var m=U5(r,u);if(m){var x=$5(r,u),v=x[1],l=x[2];if(v>l)return!0}u=u.parentNode}while(u&&u!==s.body);return!1},yF=function(r){var n=r.scrollTop,s=r.scrollHeight,u=r.clientHeight;return[n,s,u]},_F=function(r){var n=r.scrollLeft,s=r.scrollWidth,u=r.clientWidth;return[n,s,u]},U5=function(r,n){return r==="v"?mF(n):gF(n)},$5=function(r,n){return r==="v"?yF(n):_F(n)},vF=function(r,n){return r==="h"&&n==="rtl"?-1:1},xF=function(r,n,s,u,m){var x=vF(r,window.getComputedStyle(n).direction),v=x*u,l=s.target,A=n.contains(l),R=!1,L=v>0,B=0,W=0;do{var re=$5(r,l),ce=re[0],Q=re[1],X=re[2],le=Q-X-x*ce;(ce||le)&&U5(r,l)&&(B+=le,W+=ce),l instanceof ShadowRoot?l=l.host:l=l.parentNode}while(!A&&l!==document.body||A&&(n.contains(l)||n===l));return(L&&Math.abs(B)<1||!L&&Math.abs(W)<1)&&(R=!0),R},o0=function(r){return"changedTouches"in r?[r.changedTouches[0].clientX,r.changedTouches[0].clientY]:[0,0]},Ow=function(r){return[r.deltaX,r.deltaY]},Nw=function(r){return r&&"current"in r?r.current:r},bF=function(r,n){return r[0]===n[0]&&r[1]===n[1]},wF=function(r){return`
  .block-interactivity-`.concat(r,` {pointer-events: none;}
  .allow-interactivity-`).concat(r,` {pointer-events: all;}
`)},TF=0,Up=[];function SF(r){var n=j.useRef([]),s=j.useRef([0,0]),u=j.useRef(),m=j.useState(TF++)[0],x=j.useState(B5)[0],v=j.useRef(r);j.useEffect(function(){v.current=r},[r]),j.useEffect(function(){if(r.inert){document.body.classList.add("block-interactivity-".concat(m));var Q=qz([r.lockRef.current],(r.shards||[]).map(Nw),!0).filter(Boolean);return Q.forEach(function(X){return X.classList.add("allow-interactivity-".concat(m))}),function(){document.body.classList.remove("block-interactivity-".concat(m)),Q.forEach(function(X){return X.classList.remove("allow-interactivity-".concat(m))})}}},[r.inert,r.lockRef.current,r.shards]);var l=j.useCallback(function(Q,X){if("touches"in Q&&Q.touches.length===2||Q.type==="wheel"&&Q.ctrlKey)return!v.current.allowPinchZoom;var le=o0(Q),he=s.current,_e="deltaX"in Q?Q.deltaX:he[0]-le[0],Ie="deltaY"in Q?Q.deltaY:he[1]-le[1],ke,Je=Q.target,He=Math.abs(_e)>Math.abs(Ie)?"h":"v";if("touches"in Q&&He==="h"&&Je.type==="range")return!1;var nt=Fw(He,Je);if(!nt)return!0;if(nt?ke=He:(ke=He==="v"?"h":"v",nt=Fw(He,Je)),!nt)return!1;if(!u.current&&"changedTouches"in Q&&(_e||Ie)&&(u.current=ke),!ke)return!0;var Pt=u.current||ke;return xF(Pt,X,Q,Pt==="h"?_e:Ie)},[]),A=j.useCallback(function(Q){var X=Q;if(!(!Up.length||Up[Up.length-1]!==x)){var le="deltaY"in X?Ow(X):o0(X),he=n.current.filter(function(ke){return ke.name===X.type&&(ke.target===X.target||X.target===ke.shadowParent)&&bF(ke.delta,le)})[0];if(he&&he.should){X.cancelable&&X.preventDefault();return}if(!he){var _e=(v.current.shards||[]).map(Nw).filter(Boolean).filter(function(ke){return ke.contains(X.target)}),Ie=_e.length>0?l(X,_e[0]):!v.current.noIsolation;Ie&&X.cancelable&&X.preventDefault()}}},[]),R=j.useCallback(function(Q,X,le,he){var _e={name:Q,delta:X,target:le,should:he,shadowParent:PF(le)};n.current.push(_e),setTimeout(function(){n.current=n.current.filter(function(Ie){return Ie!==_e})},1)},[]),L=j.useCallback(function(Q){s.current=o0(Q),u.current=void 0},[]),B=j.useCallback(function(Q){R(Q.type,Ow(Q),Q.target,l(Q,r.lockRef.current))},[]),W=j.useCallback(function(Q){R(Q.type,o0(Q),Q.target,l(Q,r.lockRef.current))},[]);j.useEffect(function(){return Up.push(x),r.setCallbacks({onScrollCapture:B,onWheelCapture:B,onTouchMoveCapture:W}),document.addEventListener("wheel",A,Vp),document.addEventListener("touchmove",A,Vp),document.addEventListener("touchstart",L,Vp),function(){Up=Up.filter(function(Q){return Q!==x}),document.removeEventListener("wheel",A,Vp),document.removeEventListener("touchmove",A,Vp),document.removeEventListener("touchstart",L,Vp)}},[]);var re=r.removeScrollBar,ce=r.inert;return j.createElement(j.Fragment,null,ce?j.createElement(x,{styles:wF(m)}):null,re?j.createElement(fF,{gapMode:r.gapMode}):null)}function PF(r){for(var n=null;r!==null;)r instanceof ShadowRoot&&(n=r.host,r=r.host),r=r.parentNode;return n}const CF=eF(j5,SF);var y_=j.forwardRef(function(r,n){return j.createElement(g_,Xc({},r,{ref:n,sideCar:CF}))});y_.classNames=g_.classNames;var EF=function(r){if(typeof document>"u")return null;var n=Array.isArray(r)?r[0]:r;return n.ownerDocument.body},$p=new WeakMap,a0=new WeakMap,l0={},Hv=0,G5=function(r){return r&&(r.host||G5(r.parentNode))},MF=function(r,n){return n.map(function(s){if(r.contains(s))return s;var u=G5(s);return u&&r.contains(u)?u:(console.error("aria-hidden",s,"in not contained inside",r,". Doing nothing"),null)}).filter(function(s){return!!s})},IF=function(r,n,s,u){var m=MF(n,Array.isArray(r)?r:[r]);l0[s]||(l0[s]=new WeakMap);var x=l0[s],v=[],l=new Set,A=new Set(m),R=function(B){!B||l.has(B)||(l.add(B),R(B.parentNode))};m.forEach(R);var L=function(B){!B||A.has(B)||Array.prototype.forEach.call(B.children,function(W){if(l.has(W))L(W);else try{var re=W.getAttribute(u),ce=re!==null&&re!=="false",Q=($p.get(W)||0)+1,X=(x.get(W)||0)+1;$p.set(W,Q),x.set(W,X),v.push(W),Q===1&&ce&&a0.set(W,!0),X===1&&W.setAttribute(s,"true"),ce||W.setAttribute(u,"true")}catch(le){console.error("aria-hidden: cannot operate on ",W,le)}})};return L(n),l.clear(),Hv++,function(){v.forEach(function(B){var W=$p.get(B)-1,re=x.get(B)-1;$p.set(B,W),x.set(B,re),W||(a0.has(B)||B.removeAttribute(u),a0.delete(B)),re||B.removeAttribute(s)}),Hv--,Hv||($p=new WeakMap,$p=new WeakMap,a0=new WeakMap,l0={})}},Bx=function(r,n,s){s===void 0&&(s="data-aria-hidden");var u=Array.from(Array.isArray(r)?r:[r]),m=EF(r);return m?(u.push.apply(u,Array.from(m.querySelectorAll("[aria-live]"))),IF(u,m,s,"aria-hidden")):function(){return null}},Vx="Dialog",[q5,Z5]=nu(Vx),[AF,uc]=q5(Vx),W5=r=>{const{__scopeDialog:n,children:s,open:u,defaultOpen:m,onOpenChange:x,modal:v=!0}=r,l=j.useRef(null),A=j.useRef(null),[R=!1,L]=dm({prop:u,defaultProp:m,onChange:x});return V.jsx(AF,{scope:n,triggerRef:l,contentRef:A,contentId:th(),titleId:th(),descriptionId:th(),open:R,onOpenChange:L,onOpenToggle:j.useCallback(()=>L(B=>!B),[L]),modal:v,children:s})};W5.displayName=Vx;var H5="DialogTrigger",X5=j.forwardRef((r,n)=>{const{__scopeDialog:s,...u}=r,m=uc(H5,s),x=dn(n,m.triggerRef);return V.jsx(Fr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":m.open,"aria-controls":m.contentId,"data-state":Gx(m.open),...u,ref:x,onClick:Ht(r.onClick,m.onOpenToggle)})});X5.displayName=H5;var Ux="DialogPortal",[kF,K5]=q5(Ux,{forceMount:void 0}),Y5=r=>{const{__scopeDialog:n,forceMount:s,children:u,container:m}=r,x=uc(Ux,n);return V.jsx(kF,{scope:n,forceMount:s,children:j.Children.map(u,v=>V.jsx(iu,{present:s||x.open,children:V.jsx(Jg,{asChild:!0,container:m,children:v})}))})};Y5.displayName=Ux;var B0="DialogOverlay",Q5=j.forwardRef((r,n)=>{const s=K5(B0,r.__scopeDialog),{forceMount:u=s.forceMount,...m}=r,x=uc(B0,r.__scopeDialog);return x.modal?V.jsx(iu,{present:u||x.open,children:V.jsx(RF,{...m,ref:n})}):null});Q5.displayName=B0;var DF=Gf("DialogOverlay.RemoveScroll"),RF=j.forwardRef((r,n)=>{const{__scopeDialog:s,...u}=r,m=uc(B0,s);return V.jsx(y_,{as:DF,allowPinchZoom:!0,shards:[m.contentRef],children:V.jsx(Fr.div,{"data-state":Gx(m.open),...u,ref:n,style:{pointerEvents:"auto",...u.style}})})}),Xf="DialogContent",J5=j.forwardRef((r,n)=>{const s=K5(Xf,r.__scopeDialog),{forceMount:u=s.forceMount,...m}=r,x=uc(Xf,r.__scopeDialog);return V.jsx(iu,{present:u||x.open,children:x.modal?V.jsx(LF,{...m,ref:n}):V.jsx(zF,{...m,ref:n})})});J5.displayName=Xf;var LF=j.forwardRef((r,n)=>{const s=uc(Xf,r.__scopeDialog),u=j.useRef(null),m=dn(n,s.contentRef,u);return j.useEffect(()=>{const x=u.current;if(x)return Bx(x)},[]),V.jsx(e9,{...r,ref:m,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ht(r.onCloseAutoFocus,x=>{x.preventDefault(),s.triggerRef.current?.focus()}),onPointerDownOutside:Ht(r.onPointerDownOutside,x=>{const v=x.detail.originalEvent,l=v.button===0&&v.ctrlKey===!0;(v.button===2||l)&&x.preventDefault()}),onFocusOutside:Ht(r.onFocusOutside,x=>x.preventDefault())})}),zF=j.forwardRef((r,n)=>{const s=uc(Xf,r.__scopeDialog),u=j.useRef(!1),m=j.useRef(!1);return V.jsx(e9,{...r,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:x=>{r.onCloseAutoFocus?.(x),x.defaultPrevented||(u.current||s.triggerRef.current?.focus(),x.preventDefault()),u.current=!1,m.current=!1},onInteractOutside:x=>{r.onInteractOutside?.(x),x.defaultPrevented||(u.current=!0,x.detail.originalEvent.type==="pointerdown"&&(m.current=!0));const v=x.target;s.triggerRef.current?.contains(v)&&x.preventDefault(),x.detail.originalEvent.type==="focusin"&&m.current&&x.preventDefault()}})}),e9=j.forwardRef((r,n)=>{const{__scopeDialog:s,trapFocus:u,onOpenAutoFocus:m,onCloseAutoFocus:x,...v}=r,l=uc(Xf,s),A=j.useRef(null),R=dn(n,A);return jx(),V.jsxs(V.Fragment,{children:[V.jsx(m_,{asChild:!0,loop:!0,trapped:u,onMountAutoFocus:m,onUnmountAutoFocus:x,children:V.jsx(Sm,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":Gx(l.open),...v,ref:R,onDismiss:()=>l.onOpenChange(!1)})}),V.jsxs(V.Fragment,{children:[V.jsx(OF,{titleId:l.titleId}),V.jsx(jF,{contentRef:A,descriptionId:l.descriptionId})]})]})}),$x="DialogTitle",t9=j.forwardRef((r,n)=>{const{__scopeDialog:s,...u}=r,m=uc($x,s);return V.jsx(Fr.h2,{id:m.titleId,...u,ref:n})});t9.displayName=$x;var r9="DialogDescription",n9=j.forwardRef((r,n)=>{const{__scopeDialog:s,...u}=r,m=uc(r9,s);return V.jsx(Fr.p,{id:m.descriptionId,...u,ref:n})});n9.displayName=r9;var i9="DialogClose",s9=j.forwardRef((r,n)=>{const{__scopeDialog:s,...u}=r,m=uc(i9,s);return V.jsx(Fr.button,{type:"button",...u,ref:n,onClick:Ht(r.onClick,()=>m.onOpenChange(!1))})});s9.displayName=i9;function Gx(r){return r?"open":"closed"}var o9="DialogTitleWarning",[FF,a9]=jE(o9,{contentName:Xf,titleName:$x,docsSlug:"dialog"}),OF=({titleId:r})=>{const n=a9(o9),s=`\`${n.contentName}\` requires a \`${n.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${n.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${n.docsSlug}`;return j.useEffect(()=>{r&&(document.getElementById(r)||console.error(s))},[s,r]),null},NF="DialogDescriptionWarning",jF=({contentRef:r,descriptionId:n})=>{const u=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${a9(NF).contentName}}.`;return j.useEffect(()=>{const m=r.current?.getAttribute("aria-describedby");n&&m&&(document.getElementById(n)||console.warn(u))},[u,r,n]),null},l9=W5,c9=X5,u9=Y5,qx=Q5,Zx=J5,Wx=t9,Hx=n9,Xx=s9;const h9=l9,BF=c9,VF=u9,d9=j.forwardRef(({className:r,...n},s)=>V.jsx(qx,{ref:s,className:lr("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...n}));d9.displayName=qx.displayName;const Kx=j.forwardRef(({className:r,children:n,...s},u)=>V.jsxs(VF,{children:[V.jsx(d9,{}),V.jsxs(Zx,{ref:u,className:lr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...s,children:[n,V.jsxs(Xx,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[V.jsx(C0,{className:"h-4 w-4"}),V.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Kx.displayName=Zx.displayName;const Yx=({className:r,...n})=>V.jsx("div",{className:lr("flex flex-col space-y-1.5 text-center sm:text-left",r),...n});Yx.displayName="DialogHeader";const Qx=j.forwardRef(({className:r,...n},s)=>V.jsx(Wx,{ref:s,className:lr("text-lg font-semibold leading-none tracking-tight",r),...n}));Qx.displayName=Wx.displayName;const f9=j.forwardRef(({className:r,...n},s)=>V.jsx(Hx,{ref:s,className:lr("text-sm text-muted-foreground",r),...n}));f9.displayName=Hx.displayName;const UF={type:"FeatureCollection",features:[{type:"Feature",properties:{name:"Tajikistan"},geometry:{type:"Polygon",coordinates:[[[67.3332775,39.3042293],[67.3382959,39.2960158],[67.3581222,39.2877682],[67.3560951,39.2788022],[67.358742,39.2647326],[67.3641741,39.2624664],[67.3586317,39.2506495],[67.3515553,39.2468715],[67.3557747,39.243019],[67.3452579,39.2370892],[67.3429526,39.2316728],[67.3554465,39.2279715],[67.3992455,39.2258647],[67.4028369,39.2142367],[67.4395026,39.212373],[67.451854,39.2059282],[67.4613576,39.1938147],[67.4638272,39.1966459],[67.4879553,39.2017583],[67.4927778,39.1943997],[67.4971788,39.1937029],[67.4947186,39.1881617],[67.4992695,39.1865708],[67.5499851,39.1802844],[67.5841824,39.1883386],[67.5985351,39.1815485],[67.6105185,39.1801557],[67.6269662,39.1703941],[67.6260918,39.1520027],[67.635513,39.1445774],[67.6771542,39.1464376],[67.6781564,39.1140722],[67.6728466,39.1096967],[67.6748506,39.1043486],[67.6686359,39.084575],[67.6732203,39.0718247],[67.6707518,39.0658046],[67.6735684,39.0598993],[67.6796205,39.0592023],[67.6836082,39.0537725],[67.6793065,39.0512591],[67.6836337,39.0441974],[67.6790774,39.039972],[67.6851184,39.0292042],[67.6836736,39.0189647],[67.6934034,39.0133506],[67.6912467,39.0070146],[67.7069757,39.0007434],[67.7063521,38.9971835],[67.7214302,38.997155],[67.7388822,39.0061125],[67.7517524,39.001641],[67.7662112,39.0175122],[67.797489,39.0108499],[67.8010777,39.0138781],[67.8061848,39.0111641],[67.8133732,39.0125132],[67.820101,39.016335],[67.8252159,39.012475],[67.869066,39.001359],[67.878843,39.005396],[67.883125,39.013606],[67.890704,39.019181],[67.904022,39.017973],[67.921648,39.026491],[67.9429862,39.0212078],[67.966608,39.023018],[67.9826896,39.0350347],[67.9927721,39.0318087],[67.9951593,39.021953],[68.0023942,39.0165374],[68.0274289,39.0095917],[68.0410496,39.0162339],[68.0606433,39.0167968],[68.0681874,39.0263081],[68.074678,39.023765],[68.0783067,39.0266779],[68.0880854,39.0222502],[68.0945091,39.0229738],[68.1019674,39.0162411],[68.1125991,39.0151469],[68.1186405,39.0089749],[68.1164433,39.0027799],[68.1308478,38.9973737],[68.1294177,38.9926036],[68.14007,38.9779498],[68.1347505,38.9703239],[68.133942,38.9626796],[68.152783,38.951297],[68.194955,38.9398062],[68.2078247,38.9216541],[68.204679,38.9159774],[68.1950037,38.9134332],[68.1966719,38.9059536],[68.1922822,38.8953593],[68.1814334,38.8949312],[68.1775972,38.8910563],[68.1812024,38.8862239],[68.1772961,38.8816524],[68.1800452,38.8758688],[68.2019026,38.8663],[68.2016002,38.8558315],[68.1901976,38.8538865],[68.1748424,38.8453382],[68.170428,38.8309994],[68.153925,38.8259094],[68.1337329,38.8266216],[68.1320972,38.8227563],[68.134606,38.8187963],[68.1319902,38.8174812],[68.1138693,38.818592],[68.0918354,38.8133945],[68.0697398,38.8183381],[68.067398,38.8110675],[68.0694893,38.8039636],[68.0658237,38.8026014],[68.0671247,38.7989222],[68.0935998,38.790319],[68.102114,38.7712586],[68.1167792,38.7540111],[68.122239,38.7517158],[68.1284803,38.732668],[68.109016,38.7279616],[68.0787636,38.7269608],[68.0566902,38.7145692],[68.0582345,38.7076857],[68.0655014,38.6996811],[68.0651502,38.6943658],[68.0729515,38.6899101],[68.0734436,38.6811429],[68.0823856,38.6725591],[68.0775923,38.6666189],[68.0825759,38.6560989],[68.0810797,38.6532733],[68.092832,38.642455],[68.081491,38.631692],[68.078434,38.61189],[68.0746504,38.6064078],[68.0749618,38.5943328],[68.0617154,38.57574],[68.0589644,38.5599123],[68.0651308,38.5403695],[68.06401,38.5322946],[68.0864062,38.5162896],[68.1008916,38.5126391],[68.1040622,38.5031525],[68.0969487,38.4928115],[68.1090855,38.4829498],[68.1164241,38.4681121],[68.0816085,38.4260515],[68.0704418,38.4198896],[68.0647615,38.410141],[68.0619145,38.3927255],[68.0802302,38.3882344],[68.0891354,38.3917848],[68.0926849,38.3893075],[68.1098397,38.4021045],[68.1366035,38.4106066],[68.1410209,38.3997096],[68.1492483,38.3952656],[68.1527585,38.3894073],[68.1569938,38.3741163],[68.1676148,38.3680094],[68.1821287,38.3682634],[68.1927431,38.352631],[68.2078174,38.3436945],[68.210293,38.3361954],[68.2191779,38.3351434],[68.2324371,38.3275853],[68.2451283,38.3286803],[68.263588,38.320312],[68.2732242,38.3207417],[68.2738012,38.3137924],[68.2874721,38.3053045],[68.2868717,38.3019998],[68.292665,38.298308],[68.291258,38.290346],[68.302392,38.255669],[68.31694,38.25069],[68.319096,38.240784],[68.329239,38.234951],[68.344643,38.238147],[68.356031,38.2326423],[68.3647921,38.221939],[68.3734478,38.2257589],[68.3709958,38.2114494],[68.3769116,38.2028922],[68.3969827,38.197573],[68.4039525,38.1989095],[68.4020926,38.192855],[68.405344,38.1807425],[68.3964914,38.1635992],[68.3994874,38.1578625],[68.3945862,38.1540855],[68.395139,38.1441028],[68.3872158,38.1434553],[68.3877271,38.1328855],[68.3777422,38.1183569],[68.3764523,38.1103432],[68.3806723,38.1046486],[68.374137,38.0983116],[68.3730268,38.0926522],[68.377339,38.0854136],[68.3687292,38.0718265],[68.3576079,38.0642955],[68.3450771,38.0616976],[68.3427635,38.0560728],[68.3348052,38.0507536],[68.3325654,38.043173],[68.324152,38.0384991],[68.3222466,38.0325493],[68.3074965,38.0292093],[68.2998445,38.010144],[68.2888332,37.9992869],[68.2856221,37.9884098],[68.2876365,37.9826826],[68.2843889,37.9791159],[68.287025,37.9703161],[68.279777,37.9648341],[68.2845166,37.9551827],[68.2811623,37.950609],[68.2813086,37.9436898],[68.2744115,37.9379982],[68.2759266,37.9312105],[68.2840037,37.9269935],[68.2679524,37.9091187],[68.2600719,37.9097627],[68.2537917,37.9212792],[68.2179168,37.9334205],[68.1923819,37.9324091],[68.1887713,37.9354505],[68.1774508,37.9314409],[68.1650182,37.9359331],[68.1554217,37.9307355],[68.1472868,37.9313402],[68.1348485,37.9266866],[68.1369971,37.9203027],[68.1278282,37.914868],[68.134961,37.9049604],[68.1347734,37.900776],[68.119272,37.8799535],[68.119731,37.8712701],[68.1059563,37.8479887],[68.096411,37.8389555],[68.0798124,37.8051896],[68.0625431,37.7886806],[68.0571634,37.7788489],[68.0560402,37.7686374],[68.0452668,37.7512431],[68.0401536,37.7497471],[68.0407687,37.7445065],[68.0302708,37.7383152],[68.0287766,37.7335598],[68.0209322,37.7334453],[68.0182823,37.7210424],[68.0071635,37.7201195],[68.0167939,37.7110614],[68.013301,37.7040917],[68.0043927,37.6969096],[67.9653021,37.6832464],[67.9580527,37.6780045],[67.9585661,37.6744476],[67.9473463,37.6678059],[67.9477589,37.6653188],[67.9413801,37.6631957],[67.9391937,37.6590872],[67.9314515,37.6580189],[67.9274391,37.6478523],[67.8974801,37.6304276],[67.8894599,37.6284094],[67.8718828,37.6413282],[67.8633877,37.6383448],[67.8673525,37.6313173],[67.8673676,37.619263],[67.8522933,37.6109164],[67.8566089,37.6076213],[67.8622882,37.5923609],[67.8523801,37.5846973],[67.8521777,37.5804004],[67.8413076,37.5682404],[67.837826,37.5540676],[67.830641,37.5440127],[67.8353504,37.5229018],[67.8333317,37.5072799],[67.8088367,37.467302],[67.805555,37.4336221],[67.7901605,37.418203],[67.7915792,37.4114048],[67.8003493,37.3996143],[67.801159,37.3877794],[67.8148658,37.3770694],[67.8203765,37.359077],[67.8310834,37.3483003],[67.8418813,37.3281939],[67.8376582,37.3018504],[67.8250027,37.288111],[67.8229071,37.2763746],[67.8120533,37.2687415],[67.8106577,37.2612454],[67.8148969,37.2459863],[67.7963256,37.2021986],[67.7987979,37.1970097],[67.794964,37.1954648],[67.796323,37.1899501],[67.7809011,37.1816004],[67.7887532,37.1650538],[67.7771904,37.1393737],[67.7924309,37.107239],[67.7919644,37.0919446],[67.7951335,37.0829682],[67.8145443,37.0718608],[67.845139,37.0657626],[67.8784638,37.0649392],[67.8879403,37.0689256],[67.8963121,37.0653598],[67.9006582,37.0601159],[67.890295,37.0375988],[67.8990792,37.0214408],[67.939162,36.9993679],[67.9459698,36.9920747],[67.9509783,36.9745796],[67.9866142,36.9600894],[68.0035777,36.935768],[68.0126374,36.9321066],[68.0137963,36.9276117],[68.0254163,36.92574],[68.0423302,36.9304399],[68.0619529,36.9284714],[68.095278,36.955833],[68.1250121,36.9689505],[68.1451079,36.9901193],[68.1633083,37.0006226],[68.1946676,37.0071583],[68.2136363,37.005013],[68.2216539,36.9987639],[68.2319716,36.9966032],[68.2400487,36.9961306],[68.2544516,37.0010632],[68.2748927,37.0140211],[68.2868501,37.0274544],[68.2874349,37.0774992],[68.2937992,37.1012791],[68.3138812,37.1075163],[68.3378971,37.1078649],[68.3736759,37.0986061],[68.3922813,37.0994671],[68.4682365,37.1499667],[68.4819349,37.1546809],[68.5213405,37.1583477],[68.5684312,37.1786846],[68.5831872,37.1891529],[68.6142777,37.1977789],[68.6281791,37.2070526],[68.6547474,37.2112846],[68.656723,37.2255047],[68.6473986,37.2358783],[68.6452782,37.2427118],[68.6561355,37.2460741],[68.6691301,37.2395527],[68.6740265,37.2433416],[68.6715563,37.2519815],[68.6622222,37.2628888],[68.67147,37.2758795],[68.6866377,37.2777918],[68.7044152,37.2710234],[68.7205004,37.2754402],[68.7281157,37.2723413],[68.7503837,37.2783042],[68.7601837,37.2854343],[68.76227,37.2917281],[68.7695252,37.2934895],[68.788611,37.284641],[68.7983459,37.2867743],[68.798359,37.2946653],[68.8106378,37.3092738],[68.8336808,37.3168882],[68.8417534,37.3168001],[68.8568686,37.3091217],[68.878329,37.3173239],[68.8915326,37.3178228],[68.8935711,37.3220842],[68.8985972,37.323309],[68.9090085,37.3226252],[68.9220472,37.3158213],[68.936865,37.3221315],[68.9450618,37.3198913],[68.957794,37.3226722],[68.9724147,37.3186564],[68.9758219,37.3106695],[68.9974696,37.30218],[69.0003987,37.2985067],[68.9967874,37.2951952],[68.9992756,37.2918189],[69.0162425,37.2835843],[69.0176995,37.2772882],[69.0232924,37.2720534],[69.0226746,37.265327],[69.037778,37.246944],[69.0731906,37.228959],[69.0899956,37.2162162],[69.100833,37.202778],[69.1090806,37.1847082],[69.116958,37.1817289],[69.1288985,37.1703199],[69.1581808,37.1568394],[69.1676632,37.1476115],[69.1753191,37.1478756],[69.2026214,37.131355],[69.2102692,37.1297485],[69.2186562,37.1235552],[69.221159,37.1118785],[69.2271468,37.1047296],[69.2565306,37.0934359],[69.2552096,37.0959925],[69.2609645,37.1034555],[69.2767099,37.1054131],[69.2857656,37.1140402],[69.3225831,37.1177728],[69.3333427,37.1363995],[69.3572681,37.1528313],[69.3701149,37.1657961],[69.3781564,37.1673153],[69.3959141,37.1638096],[69.4037306,37.1680489],[69.4240112,37.1964018],[69.4363189,37.2056881],[69.4526077,37.231503],[69.4704271,37.2507172],[69.4690096,37.2600843],[69.460448,37.2626886],[69.4378753,37.2433137],[69.4251583,37.2458572],[69.4135861,37.2722052],[69.4242602,37.2921018],[69.4101752,37.2994538],[69.4082737,37.310277],[69.3982547,37.3178792],[69.402912,37.32512],[69.4021875,37.3305443],[69.3809983,37.3393967],[69.385169,37.3464638],[69.3949487,37.3511621],[69.396663,37.3563317],[69.3917513,37.3605727],[69.3825996,37.3599033],[69.3829107,37.3682472],[69.3739307,37.374625],[69.3781149,37.3801496],[69.375363,37.3852647],[69.3798637,37.395741],[69.3662918,37.3968064],[69.3643284,37.4004459],[69.375776,37.4075538],[69.3765056,37.4155132],[69.3714523,37.4182229],[69.3733567,37.4228348],[69.3813049,37.4236243],[69.3842232,37.4299462],[69.3900167,37.4312071],[69.3850386,37.4409699],[69.3886005,37.4492153],[69.4027197,37.4483465],[69.4181692,37.4548708],[69.4251579,37.4719077],[69.4246689,37.4791347],[69.4367854,37.478298],[69.4575376,37.4940905],[69.4581703,37.5103022],[69.4611039,37.5139329],[69.4801723,37.5158533],[69.4841309,37.5249221],[69.4907404,37.5281036],[69.4989404,37.5458586],[69.4982135,37.5499108],[69.5036316,37.5521564],[69.500767,37.5614612],[69.5081162,37.5670061],[69.5103586,37.5783964],[69.5297563,37.5914471],[69.5480167,37.5829624],[69.5489249,37.5754671],[69.5576797,37.5734263],[69.5706616,37.5720488],[69.5792232,37.5749569],[69.5895794,37.5711113],[69.6127814,37.5727674],[69.6301675,37.5695317],[69.6682851,37.5837744],[69.6831982,37.5832643],[69.7137164,37.5747008],[69.724107,37.5786328],[69.7379663,37.5896832],[69.755342,37.5922748],[69.786389,37.583333],[69.800949,37.5703652],[69.8118495,37.5670997],[69.8279038,37.5740917],[69.828056,37.590556],[69.8414304,37.6035546],[69.899167,37.615],[69.934968,37.6118542],[69.945089,37.6012606],[69.950008,37.5908561],[69.95,37.573611],[69.958611,37.565],[69.9978103,37.5667513],[70.0023243,37.5547283],[70.0208104,37.5476079],[70.0345693,37.5524421],[70.0433606,37.5489682],[70.0471247,37.543585],[70.0571459,37.5481688],[70.0650596,37.5426732],[70.0734955,37.5419693],[70.0815972,37.5331731],[70.0955995,37.5337448],[70.1122544,37.5244548],[70.1451339,37.5247844],[70.155833,37.536389],[70.1649769,37.530214],[70.1707039,37.5305175],[70.1749912,37.538984],[70.1731661,37.5456305],[70.1822262,37.5602109],[70.1797838,37.5720067],[70.1955119,37.5628647],[70.2026981,37.5688345],[70.2130913,37.5675228],[70.2134352,37.5715193],[70.202462,37.5823819],[70.2091552,37.5855336],[70.2218625,37.5833043],[70.2231235,37.5870709],[70.2155161,37.5956678],[70.2140666,37.6057929],[70.2263536,37.6074041],[70.2340928,37.6120247],[70.2402513,37.610887],[70.2482841,37.6163728],[70.2511321,37.6092576],[70.265853,37.6114002],[70.2690136,37.6210217],[70.2628338,37.6282174],[70.2663545,37.6344241],[70.2608688,37.6393335],[70.2615295,37.6422896],[70.2653229,37.6497358],[70.2725155,37.6497698],[70.2774937,37.6570035],[70.276129,37.6665601],[70.2793133,37.6750388],[70.2879092,37.6783063],[70.2863471,37.6837712],[70.2929177,37.6890221],[70.3026035,37.6908487],[70.3034017,37.6987202],[70.3007195,37.7037388],[70.2908618,37.7078301],[70.2870595,37.7157541],[70.2955353,37.7213927],[70.2998869,37.7300993],[70.298578,37.7358217],[70.2864759,37.7489686],[70.2979429,37.7679246],[70.2795665,37.7789187],[70.2742536,37.7993795],[70.2790429,37.8051541],[70.2794721,37.8159935],[70.2706487,37.8172852],[70.2604348,37.8280652],[70.2527187,37.8315294],[70.2218497,37.8321497],[70.1880624,37.8467705],[70.1789429,37.8659658],[70.1772692,37.8794824],[70.1824748,37.8891357],[70.1777756,37.8982763],[70.1802733,37.9039382],[70.1772585,37.9172008],[70.1710551,37.9302409],[70.1778249,37.9333178],[70.1863351,37.9446477],[70.1925106,37.9432991],[70.2017052,37.9289258],[70.2113311,37.9210958],[70.2144983,37.9215139],[70.2131915,37.9313089],[70.2436507,37.9438067],[70.252959,37.9439438],[70.2618661,37.9376215],[70.2689821,37.9386496],[70.2755453,37.9459439],[70.2690952,37.9494601],[70.266679,37.9622221],[70.2609069,37.9683291],[70.2613356,37.9790751],[70.2690355,37.9735861],[70.2863251,37.9702858],[70.291047,37.9874594],[70.2987411,37.9876635],[70.3177676,37.9989004],[70.3285372,37.9988835],[70.3365302,38.0143047],[70.3626613,38.0320704],[70.3674586,38.043243],[70.3628132,38.0513325],[70.3652583,38.0549917],[70.3804025,38.0561206],[70.382102,38.0608715],[70.39906,38.0675802],[70.4070943,38.0760395],[70.4169132,38.0763523],[70.4202128,38.0889823],[70.4315738,38.0993109],[70.4404223,38.101436],[70.4451551,38.0989449],[70.4677515,38.104161],[70.4924298,38.1216237],[70.5012017,38.1196951],[70.5061531,38.1222905],[70.5000763,38.1459247],[70.5051133,38.1685244],[70.5174916,38.1868155],[70.517502,38.193568],[70.5276193,38.1990824],[70.5374748,38.2111181],[70.5376379,38.2224118],[70.5455708,38.2435598],[70.5563919,38.2522147],[70.5576876,38.2589773],[70.5671728,38.2681158],[70.6056042,38.2827718],[70.6096627,38.2972069],[70.6055965,38.3042205],[70.6079843,38.313513],[70.6156704,38.3228226],[70.6109545,38.3463988],[70.6310545,38.3528393],[70.6425853,38.3485663],[70.6596953,38.3506301],[70.6634807,38.3530314],[70.6637647,38.3577094],[70.6844005,38.3637997],[70.6935416,38.3722121],[70.6938525,38.3826822],[70.6890141,38.3889067],[70.6822714,38.3865307],[70.6731517,38.3890082],[70.6765592,38.3968437],[70.6740857,38.4046169],[70.6784513,38.4091437],[70.6989181,38.4203548],[70.7142174,38.413953],[70.7407517,38.4190377],[70.7566945,38.4278304],[70.771029,38.4562899],[70.7843971,38.4562899],[70.7866716,38.4506648],[70.7978725,38.4490936],[70.8055115,38.4444553],[70.8193931,38.4465476],[70.8253293,38.4536747],[70.8426385,38.4474225],[70.8433004,38.4391019],[70.8509623,38.4385895],[70.8612545,38.4513388],[70.857074,38.4584477],[70.8638871,38.4597302],[70.8732855,38.4691809],[70.8949222,38.4651822],[70.9013951,38.4579912],[70.8994853,38.4480433],[70.906738,38.4437578],[70.9064913,38.4388587],[70.9211147,38.4351274],[70.9247196,38.4300764],[70.9328306,38.4330936],[70.9360063,38.4419512],[70.9426153,38.4427579],[70.9480333,38.4381696],[70.9583652,38.4405982],[70.9577215,38.4475223],[70.9621096,38.4577391],[70.9445786,38.4656696],[70.9456944,38.4762366],[70.9549427,38.4778829],[70.965929,38.4748928],[70.9745004,38.4776576],[70.9883523,38.4910682],[70.9978044,38.4878183],[71.001302,38.4828507],[70.9993708,38.4789579],[71.0066825,38.4725409],[71.0224163,38.4681561],[71.0314715,38.4610744],[71.0293999,38.4523408],[71.0373831,38.4420688],[71.0387132,38.4291535],[71.045579,38.4225747],[71.0464888,38.4105],[71.0570061,38.3983252],[71.0647952,38.398939],[71.0691833,38.402874],[71.0653961,38.411525],[71.0675311,38.4146943],[71.0757601,38.4135931],[71.092937,38.4235289],[71.1050177,38.4222765],[71.1087486,38.4182333],[71.1044532,38.4102974],[71.1082165,38.4059278],[71.1210894,38.4062958],[71.1311765,38.3971184],[71.1443388,38.4026217],[71.1496925,38.398115],[71.1502327,38.3893503],[71.1649263,38.3865942],[71.1868113,38.3439364],[71.1987455,38.3429828],[71.2248051,38.3216681],[71.2434196,38.3189661],[71.2518954,38.3105396],[71.2793612,38.3147488],[71.2988877,38.3129473],[71.3119245,38.30298],[71.3227272,38.3064397],[71.332705,38.3052947],[71.3314061,38.298708],[71.3343004,38.2931996],[71.3271046,38.2857429],[71.3341963,38.2810267],[71.331675,38.2762177],[71.3337886,38.2712651],[71.3563514,38.2710882],[71.3661522,38.2664258],[71.373378,38.2568181],[71.3669193,38.2236844],[71.379613,38.2117361],[71.3642478,38.1977703],[71.3657783,38.1795446],[71.3727401,38.1642881],[71.377103,38.1612694],[71.3637925,38.1494329],[71.3529727,38.1503904],[71.3472103,38.1464652],[71.3386207,38.1291101],[71.3367712,38.1140472],[71.3295293,38.112131],[71.326139,38.1025155],[71.3171697,38.0989231],[71.321944,38.0900616],[71.3205171,38.0670226],[71.3114271,38.0605901],[71.3063764,38.046866],[71.3001001,38.0426413],[71.2931692,38.0452775],[71.2838942,38.0419611],[71.2852406,38.0337097],[71.2955832,38.0316223],[71.2951004,38.0181505],[71.276266,38.00564],[71.2791842,37.9949621],[71.2702256,37.9936262],[71.2673449,37.9833778],[71.2735355,37.9769042],[71.2747589,37.9650526],[71.2627637,37.9528186],[71.2669802,37.9411769],[71.2648129,37.9378093],[71.2526081,37.9331826],[71.2561118,37.9237278],[71.2820062,37.9199351],[71.287601,37.9249465],[71.2892318,37.9323175],[71.2986517,37.9322498],[71.3136502,37.9189555],[71.3266969,37.8891813],[71.3333702,37.8855573],[71.3649344,37.8984438],[71.3794184,37.9082216],[71.4004254,37.9052672],[71.4210248,37.9186074],[71.4446282,37.9201309],[71.4689058,37.9330494],[71.4911189,37.9384627],[71.4981295,37.950588],[71.5047078,37.953248],[71.5219919,37.9529516],[71.5259291,37.9434724],[71.5374399,37.9440711],[71.575681,37.9330813],[71.5900113,37.9222858],[71.5913118,37.9098661],[71.5873698,37.8943675],[71.5893028,37.8854247],[71.598313,37.8741539],[71.5846953,37.8465258],[71.5876791,37.8249901],[71.5956581,37.8066816],[71.5905052,37.7972699],[71.569455,37.7887766],[71.5566182,37.787293],[71.5438326,37.7707218],[71.5311393,37.7655261],[71.5513165,37.7364862],[71.5514079,37.7280283],[71.5402342,37.688923],[71.5293696,37.6756913],[71.5261152,37.6313568],[71.517914,37.6181319],[71.5055521,37.6124458],[71.5048345,37.6038366],[71.5093668,37.598256],[71.5108493,37.5883672],[71.5065275,37.5829059],[71.4949629,37.5386038],[71.4952819,37.5334354],[71.5042274,37.5269523],[71.5101376,37.5020962],[71.5267219,37.4798798],[71.5200412,37.4638862],[71.5043092,37.4532958],[71.5016374,37.4339591],[71.4952324,37.421949],[71.4980018,37.4077449],[71.4796455,37.4067097],[71.47487,37.387917],[71.4790441,37.3831122],[71.4918174,37.3782889],[71.4956933,37.3693534],[71.4905635,37.3589835],[71.4921798,37.3527913],[71.4866279,37.3357656],[71.4882092,37.3304992],[71.5066004,37.3134272],[71.4922567,37.2967292],[71.4948499,37.284235],[71.4883815,37.2752787],[71.4911427,37.2649612],[71.4850549,37.2601649],[71.4825431,37.249138],[71.485341,37.2452773],[71.4787521,37.2339451],[71.4810368,37.2313946],[71.4669074,37.2254063],[71.4554244,37.2141079],[71.4540012,37.2058322],[71.4612001,37.1964835],[71.4624883,37.1862233],[71.449995,37.1814143],[71.4455963,37.1709209],[71.4518268,37.1524147],[71.4447775,37.1437809],[71.4458954,37.1337845],[71.4418912,37.1306389],[71.4445906,37.0991871],[71.4347333,37.0881649],[71.4289536,37.0716062],[71.4315087,37.0569386],[71.4438008,37.0406565],[71.4622072,37.0242958],[71.4611564,37.0134352],[71.4696936,36.9988583],[71.468192,36.9948861],[71.4717446,36.984986],[71.4630221,36.9682982],[71.4681857,36.9512566],[71.4883721,36.9283266],[71.4917224,36.9161431],[71.5014152,36.911257],[71.5130182,36.897921],[71.5191123,36.8799249],[71.5264171,36.8713716],[71.5288581,36.859499],[71.5422843,36.8462239],[71.5429096,36.824901],[71.5534149,36.8156866],[71.5509267,36.8062079],[71.5627332,36.7839185],[71.5630946,36.763797],[71.5879089,36.7349482],[71.6197411,36.7133096],[71.6339397,36.6907382],[71.6543984,36.6868973],[71.6752772,36.6712385],[71.6879396,36.6769022],[71.712792,36.67194],[71.7282944,36.6764866],[71.7488866,36.6751383],[71.7592663,36.6787998],[71.7939803,36.6761768],[71.8188158,36.6829303],[71.8436383,36.6806171],[71.8455808,36.6852799],[71.8645274,36.6949197],[71.8719164,36.7045491],[71.8985467,36.723381],[71.9028659,36.733959],[71.9405672,36.7467795],[71.9581666,36.7562386],[71.9794586,36.7780641],[71.9890669,36.7803878],[71.9959196,36.7903605],[72.0074015,36.7942865],[72.0184876,36.810933],[72.0295288,36.8169461],[72.0379822,36.8161269],[72.0419756,36.8202473],[72.0475013,36.8203545],[72.0505239,36.8303658],[72.054405,36.8298344],[72.0691819,36.840233],[72.0826368,36.8410082],[72.087008,36.8384139],[72.1122634,36.8470228],[72.1222151,36.867787],[72.1492362,36.8846796],[72.1557784,36.8835511],[72.1679663,36.8906562],[72.1818065,36.9053965],[72.1973419,36.9074212],[72.2089783,36.924738],[72.2259534,36.9278771],[72.2447716,36.94437],[72.2849487,36.9566523],[72.3257058,36.9813016],[72.3664351,36.9908843],[72.3996493,36.993671],[72.4274459,37.0062775],[72.4440984,37.0062905],[72.451046,37.0025343],[72.4611051,37.0021479],[72.4735229,36.9942691],[72.5051773,36.9996036],[72.5279365,36.997913],[72.5357793,37.0048378],[72.5476825,37.0024509],[72.5665594,37.0060628],[72.57335,37.011409],[72.5884713,37.0076246],[72.5942836,37.0191153],[72.6219534,37.0290011],[72.6413663,37.0248547],[72.6440087,37.0190077],[72.6625196,37.0176869],[72.6902673,37.0584571],[72.7025409,37.0686226],[72.7036203,37.0742526],[72.699894,37.0750846],[72.7019498,37.0804642],[72.7167095,37.0899526],[72.7270522,37.1083228],[72.739308,37.1189701],[72.7683765,37.1781893],[72.7713197,37.178705],[72.7761941,37.1957661],[72.8152614,37.2311678],[72.836032,37.2347619],[72.8537844,37.2287683],[72.8645704,37.2308971],[72.8722747,37.2371213],[72.8911342,37.2431381],[72.9095334,37.258008],[72.9156764,37.2588686],[72.9223386,37.2678753],[72.9334736,37.2734839],[72.9390745,37.2833373],[72.9510577,37.2876532],[72.9522857,37.2906709],[72.9705693,37.2911718],[72.977363,37.2972796],[73.0200476,37.3063251],[73.038351,37.305108],[73.0617123,37.3112219],[73.0941756,37.3248156],[73.1074669,37.340667],[73.1018815,37.3443183],[73.1040219,37.3489295],[73.1019287,37.3532365],[73.1068948,37.3627376],[73.1152345,37.3676124],[73.1318953,37.3709723],[73.1495583,37.4043116],[73.1662926,37.4096481],[73.1938002,37.4085713],[73.2097605,37.4041001],[73.236259,37.4161266],[73.2547995,37.4365758],[73.2877934,37.4562735],[73.3066472,37.4636108],[73.3347432,37.4665239],[73.3531864,37.4597706],[73.3642727,37.4619503],[73.3686911,37.4545055],[73.3653175,37.4468241],[73.3719663,37.4440445],[73.4030584,37.4548009],[73.414174,37.4649927],[73.4281272,37.4688504],[73.4520914,37.4738668],[73.4944895,37.4744151],[73.4988607,37.4717944],[73.5124716,37.4745299],[73.5323264,37.4720391],[73.5826773,37.4439106],[73.6146931,37.4428366],[73.6404029,37.433525],[73.6661253,37.4409302],[73.719561,37.447008],[73.7758934,37.4400938],[73.7704847,37.4093107],[73.77242,37.3977201],[73.7669631,37.3916815],[73.7705905,37.3824598],[73.7700004,37.3460316],[73.7742983,37.3395847],[73.7509202,37.3315499],[73.7539871,37.3231425],[73.739171,37.3202871],[73.7323511,37.3153272],[73.7118125,37.3157926],[73.7049808,37.3070785],[73.6969646,37.3113192],[73.6828571,37.3111711],[73.6790288,37.3079562],[73.6703147,37.3100819],[73.666571,37.3159406],[73.6567147,37.3148302],[73.6477151,37.2999295],[73.6541661,37.2930767],[73.6502532,37.2836751],[73.6424803,37.2805343],[73.6326346,37.2832733],[73.6172368,37.2705194],[73.6193202,37.2660248],[73.6306993,37.2653057],[73.6278968,37.2604093],[73.6305301,37.2494109],[73.6523471,37.2372175],[73.6594961,37.2379895],[73.6599931,37.2444193],[73.6642444,37.2494109],[73.6824658,37.2491042],[73.6873728,37.2539795],[73.7121297,37.2457518],[73.7241116,37.2468517],[73.7305203,37.2436473],[73.7385788,37.2272026],[73.7502434,37.2268219],[73.7590844,37.2218832],[73.7636001,37.2245799],[73.7642558,37.235113],[73.7819273,37.2388673],[73.7872678,37.2341612],[73.796976,37.2326066],[73.8023483,37.2262614],[73.8149119,37.2322153],[73.8291992,37.2268007],[73.8429578,37.2340449],[73.8437615,37.2491148],[73.8519363,37.2574905],[73.8824881,37.2653244],[73.8854506,37.2672637],[73.8847724,37.2730815],[73.8900846,37.2766982],[73.9241406,37.2854249],[73.9526763,37.2750505],[73.9554602,37.2864302],[73.964056,37.2984882],[73.9699421,37.2996962],[73.9889036,37.2970486],[73.9998863,37.2889645],[74.0131194,37.2908932],[74.0173166,37.2922788],[74.0267965,37.3072208],[74.0345476,37.3091125],[74.0414064,37.2999575],[74.0567598,37.3114027],[74.0626907,37.3110696],[74.0608942,37.3237045],[74.0659089,37.3262981],[74.0760513,37.3207302],[74.0988287,37.318083],[74.1117492,37.3210573],[74.1138074,37.3280173],[74.1249433,37.3283385],[74.1276261,37.3246622],[74.1354427,37.3268573],[74.1416352,37.3349831],[74.1518015,37.3364227],[74.1545854,37.3416813],[74.1765122,37.3406879],[74.1851556,37.3347333],[74.1969696,37.3358338],[74.2082958,37.3410746],[74.2119423,37.3508066],[74.2216624,37.3491469],[74.2281643,37.3549409],[74.238973,37.3742323],[74.2517983,37.3745119],[74.2513403,37.3785451],[74.2432204,37.3828519],[74.2372122,37.3917035],[74.229479,37.3952787],[74.2326734,37.405665],[74.2422805,37.4153851],[74.2555519,37.4082646],[74.2671934,37.4102812],[74.2759736,37.4021851],[74.2848193,37.4038388],[74.3159902,37.3991156],[74.3214868,37.4004302],[74.3237532,37.4073425],[74.3427473,37.406825],[74.3484163,37.422119],[74.3752091,37.4243735],[74.3905268,37.4118635],[74.3857858,37.4031606],[74.3904614,37.3971466],[74.4180988,37.389223],[74.4283008,37.3946719],[74.4331013,37.4102276],[74.4394545,37.4163667],[74.4523571,37.4050166],[74.4678296,37.4069202],[74.4660747,37.4267233],[74.4835043,37.411572],[74.4834329,37.402774],[74.4951993,37.3961829],[74.5059426,37.4012749],[74.5219683,37.4013285],[74.5284761,37.409371],[74.5550072,37.3992082],[74.5578399,37.3960007],[74.5559934,37.388371],[74.5662278,37.3724573],[74.5744503,37.3774063],[74.5900578,37.3770095],[74.6150451,37.3836999],[74.6378721,37.3768],[74.6426888,37.3835236],[74.6738927,37.3892],[74.6831072,37.395152],[74.6903047,37.4058876],[74.7086126,37.3888142],[74.7066066,37.384251],[74.7278023,37.3768662],[74.7384277,37.377759],[74.7716486,37.3634632],[74.8038004,37.355417],[74.8207856,37.3365139],[74.8321164,37.3338906],[74.8547119,37.2949491],[74.8767542,37.2748698],[74.8785199,37.2610999],[74.8880541,37.257132],[74.8879108,37.2353962],[74.8926077,37.2326869],[74.9067493,37.2332797],[74.9153585,37.2373443],[74.917165,37.243159],[74.9118866,37.2475624],[74.918915,37.2602926],[74.9105146,37.2749773],[74.926784,37.2840781],[74.9352407,37.2840781],[74.9519512,37.2920895],[74.9629478,37.2877348],[74.9709368,37.2906797],[74.9787377,37.2854164],[74.9838131,37.2860743],[74.9912068,37.2901158],[75.0156122,37.2931861],[75.0425554,37.3060624],[75.0543665,37.303838],[75.0773935,37.3157744],[75.0959717,37.3182808],[75.1087227,37.3141453],[75.1251392,37.3157118],[75.1286167,37.3229175],[75.121599,37.3311884],[75.121693,37.3408378],[75.1140173,37.3458505],[75.1044306,37.3618911],[75.093559,37.3717857],[75.1116971,37.3770127],[75.112744,37.3841749],[75.1262118,37.3875061],[75.1295192,37.3993558],[75.138347,37.4006169],[75.1539563,37.4095637],[75.1461041,37.4162024],[75.1486739,37.4208423],[75.1415593,37.4309551],[75.1416069,37.4354522],[75.1254028,37.4480872],[75.1252838,37.4660283],[75.1155042,37.4719056],[75.1038924,37.4720008],[75.0945174,37.4853257],[75.0889018,37.484374],[75.0821917,37.4932731],[75.0838574,37.4979607],[75.0795354,37.5056413],[75.0643815,37.5171272],[75.0618593,37.5254791],[75.0549112,37.52191],[75.0467973,37.5071811],[75.0312832,37.5009707],[75.0262863,37.5082756],[75.0194192,37.5092369],[75.0183613,37.5170149],[75.0115931,37.5249676],[75.0018611,37.52492],[74.9881792,37.5350089],[74.9735456,37.5401723],[74.9637801,37.5382926],[74.955624,37.5475205],[74.9551998,37.5545335],[74.9439876,37.5540897],[74.9323315,37.5679648],[74.9347595,37.5770836],[74.9307832,37.5869288],[74.939428,37.6032182],[74.9258693,37.6129287],[74.9264255,37.6237929],[74.9233479,37.6293919],[74.9109264,37.6347683],[74.9076635,37.643964],[74.9026207,37.6471898],[74.8970217,37.6618361],[74.8996914,37.6737014],[74.9026578,37.6781138],[74.9332851,37.6916848],[74.9229401,37.7041805],[74.9340453,37.7178654],[74.9447517,37.7184746],[74.9521529,37.7264965],[74.9591735,37.7281029],[74.9666606,37.7527738],[74.9847141,37.7529577],[74.9881625,37.7605172],[74.9966398,37.7625359],[75.0008275,37.7694103],[75.0105545,37.7700045],[75.0104304,37.7758698],[74.9863607,37.80825],[74.9765952,37.8066177],[74.9636021,37.8112814],[74.9521452,37.8089348],[74.9448388,37.8150311],[74.9445138,37.8244549],[74.9244163,37.8290206],[74.9255976,37.8342009],[74.9127569,37.8569592],[74.9279168,37.8673394],[74.9318154,37.8791441],[74.9372929,37.8806067],[74.938077,37.8944817],[74.9302845,37.8994956],[74.9179479,37.8997489],[74.9126634,37.907286],[74.9198276,37.9173907],[74.916337,37.926722],[74.9214217,37.9368881],[74.9174226,37.9425343],[74.9189142,37.9517159],[74.9135619,37.9557032],[74.9136574,37.9615864],[74.9086119,37.9651953],[74.9077634,37.9703029],[74.9149053,37.9747589],[74.9178122,37.9808333],[74.9130011,37.9970736],[74.918228,38.0058915],[74.9151883,38.0153942],[74.916863,38.0248731],[74.9059746,38.0340453],[74.8982194,38.0327596],[74.8924518,38.0355293],[74.8860566,38.0240635],[74.8676269,38.0253145],[74.8681095,38.0356036],[74.8558837,38.043184],[74.8526834,38.0484685],[74.8513881,38.0580166],[74.8570228,38.0608435],[74.8538495,38.0693442],[74.8423748,38.0741223],[74.834252,38.0727687],[74.8282091,38.0836882],[74.8186213,38.0844125],[74.8209217,38.0899657],[74.8170995,38.1004735],[74.8181684,38.1292142],[74.8053816,38.1385069],[74.8027688,38.1510779],[74.7960667,38.1560199],[74.8011784,38.16093],[74.8014201,38.1682242],[74.8048778,38.1721842],[74.7996464,38.2033701],[74.7713374,38.1972546],[74.7616082,38.2035929],[74.7582126,38.2148995],[74.7062783,38.2132429],[74.705579,38.2209543],[74.6987237,38.2284351],[74.695971,38.265043],[74.704801,38.2814412],[74.7049727,38.2901594],[74.6901487,38.3144081],[74.6891833,38.3399175],[74.6750472,38.3513263],[74.6723729,38.3607406],[74.6759582,38.3703081],[74.6662799,38.3766845],[74.6650089,38.3817341],[74.6699795,38.3862613],[74.6774603,38.4032351],[74.6896474,38.4080975],[74.6953783,38.4207329],[74.6932427,38.4272935],[74.6842044,38.4324296],[74.6738839,38.4320399],[74.6558765,38.4391752],[74.6444587,38.4522228],[74.6226532,38.4463275],[74.5063549,38.4714714],[74.276793,38.5991171],[74.2575329,38.6008712],[74.2376959,38.6147871],[74.121067,38.6411313],[74.1175785,38.6295473],[74.1193551,38.6197604],[74.1152828,38.6154556],[74.1154279,38.6104411],[74.0950709,38.6141249],[74.0902061,38.6103116],[74.0764221,38.6104887],[74.0756714,38.5875321],[74.062119,38.5783725],[74.0711782,38.5671098],[74.0773663,38.5525324],[74.0874776,38.5501249],[74.0861936,38.5366431],[74.0752798,38.5321491],[74.0393283,38.5441865],[74.0094757,38.5348776],[74.0070682,38.5321491],[74.0085127,38.5249267],[74.0028798,38.5221858],[73.9891775,38.5238409],[73.9765736,38.5366431],[73.9673326,38.5330525],[73.9506946,38.5344676],[73.9391777,38.5377666],[73.9366217,38.5413671],[73.9236094,38.5425815],[73.9192759,38.5538163],[73.9046706,38.5652117],[73.8987322,38.5809405],[73.8935963,38.5839899],[73.8765835,38.5844714],[73.8605337,38.578533],[73.8510644,38.5870394],[73.8420816,38.5894623],[73.8288071,38.6016213],[73.8014705,38.6138425],[73.8000261,38.6217069],[73.8090139,38.6345467],[73.8092985,38.6410953],[73.8006681,38.648831],[73.8059645,38.6587819],[73.805162,38.6639178],[73.7962114,38.6670506],[73.7953716,38.6732267],[73.7800051,38.6801697],[73.7799634,38.690561],[73.7706008,38.6945546],[73.7743002,38.7016127],[73.7649031,38.7051885],[73.7697787,38.7172479],[73.7644085,38.7231601],[73.7546052,38.7247465],[73.7438518,38.7318084],[73.7472223,38.7419198],[73.7526062,38.746298],[73.7526792,38.761982],[73.7558193,38.7693708],[73.7676184,38.770719],[73.7678162,38.7782113],[73.7525187,38.7966495],[73.735506,38.8274651],[73.7297406,38.8299111],[73.7298122,38.8438058],[73.7070963,38.8461342],[73.6945568,38.8528902],[73.7041861,38.8610286],[73.703451,38.8714715],[73.6992213,38.8777721],[73.7119512,38.8884862],[73.7090246,38.8954636],[73.7107779,38.9002653],[73.7170114,38.9074315],[73.7339752,38.9105644],[73.7390815,38.926242],[73.7554649,38.941908],[73.7672082,38.9372947],[73.7804453,38.9420605],[73.7844578,38.9354801],[73.7948779,38.9288679],[73.8094541,38.9331379],[73.8241244,38.9174228],[73.8354072,38.9215223],[73.8386834,38.9338808],[73.8458507,38.9402988],[73.8469694,38.9485924],[73.8540169,38.952357],[73.8433605,38.9841109],[73.8441725,38.9996377],[73.8281529,39.0199786],[73.8208512,39.0225548],[73.8216187,39.0282025],[73.8124236,39.0428208],[73.7904738,39.0418881],[73.7871281,39.0310854],[73.7787864,39.0278946],[73.7715884,39.0278778],[73.7652653,39.0318523],[73.7512347,39.0253589],[73.7425346,39.0311536],[73.7367559,39.036535],[73.7386459,39.0531164],[73.7322125,39.0673193],[73.7207742,39.0687502],[73.7104683,39.0759157],[73.7172092,39.0954964],[73.7141835,39.1026405],[73.7207398,39.111942],[73.70656,39.1216388],[73.7065352,39.1366546],[73.6781422,39.1466088],[73.6890577,39.1600407],[73.6734734,39.1672514],[73.6618235,39.16497],[73.661356,39.1771898],[73.6573435,39.1848937],[73.6607132,39.1926457],[73.6530101,39.2017459],[73.6409388,39.2036145],[73.6435503,39.2123007],[73.6342318,39.2187587],[73.6352205,39.2274496],[73.6135482,39.2476424],[73.5880652,39.23946],[73.5690704,39.243868],[73.5650904,39.2500558],[73.5592849,39.2493876],[73.5637884,39.2537701],[73.5630092,39.2713444],[73.5550415,39.2700673],[73.5379428,39.2777956],[73.5561226,39.2966791],[73.5270309,39.3112242],[73.5353994,39.3140798],[73.5355281,39.3253015],[73.5506342,39.3344685],[73.5538668,39.3434102],[73.5661323,39.345873],[73.5585686,39.3547675],[73.545112,39.3561608],[73.5403526,39.3664772],[73.5324762,39.3660957],[73.5239603,39.3741705],[73.5051916,39.3762071],[73.4997347,39.3817402],[73.5207059,39.386021],[73.5262168,39.3914543],[73.5707187,39.3971705],[73.5748477,39.4049362],[73.5921814,39.4113561],[73.5913789,39.4188995],[73.5970688,39.4257682],[73.5904159,39.4346283],[73.5968359,39.4426531],[73.5950704,39.4530855],[73.6002746,39.4596729],[73.5903311,39.4681705],[73.5790929,39.4650323],[73.567406,39.4561142],[73.5553121,39.4573528],[73.5400665,39.4624637],[73.5295952,39.4698187],[73.521173,39.4679054],[73.5140812,39.4742909],[73.5076439,39.4740508],[73.4929508,39.4681374],[73.4794593,39.4706883],[73.4664774,39.4645427],[73.4491474,39.4633603],[73.4414072,39.4515589],[73.4322972,39.4485211],[73.3932836,39.45273],[73.3925342,39.4463015],[73.3708378,39.4325991],[73.3571052,39.4349658],[73.3515441,39.4309336],[73.3530195,39.4252354],[73.360283,39.4217286],[73.3632668,39.4083866],[73.3572793,39.3988287],[73.35336,39.3979655],[73.3532063,39.3933427],[73.3264062,39.3904311],[73.3198785,39.3822786],[73.2986784,39.3866403],[73.2757401,39.3812005],[73.262093,39.3847995],[73.252579,39.381037],[73.2436131,39.3612966],[73.2306616,39.3577103],[73.2189846,39.3637669],[73.2015006,39.353574],[73.190792,39.3518058],[73.1784296,39.3545756],[73.1587744,39.352651],[73.1277121,39.3709699],[73.1181397,39.3705375],[73.1063103,39.3756773],[73.0969548,39.3707011],[73.0707121,39.3678147],[73.0689954,39.3601503],[73.0477399,39.3534029],[73.0228614,39.356633],[73.0077982,39.3645964],[72.9854286,39.3573879],[72.9711056,39.3577114],[72.9567075,39.3492163],[72.9436996,39.3588354],[72.9393014,39.3707751],[72.9323328,39.3718099],[72.9266941,39.3687952],[72.9071424,39.3676485],[72.8882846,39.3576855],[72.879123,39.3470691],[72.8679229,39.3468038],[72.8573405,39.3519175],[72.8473807,39.3521904],[72.8329984,39.3630674],[72.8242073,39.3643137],[72.7906261,39.3466104],[72.7838015,39.3464949],[72.7819022,39.3628416],[72.7650904,39.3647623],[72.7542114,39.3711489],[72.7306,39.37655],[72.7049587,39.3874999],[72.6973229,39.39556],[72.6711369,39.3874741],[72.6599792,39.3940069],[72.6381683,39.3918144],[72.6211602,39.3991562],[72.613213,39.3945671],[72.6097844,39.3837116],[72.6035345,39.3801582],[72.5992386,39.3661189],[72.5887892,39.3596422],[72.5767994,39.3583751],[72.5668859,39.3513899],[72.5616932,39.3594867],[72.5540224,39.3638336],[72.5487327,39.3781487],[72.5305629,39.3811156],[72.5004315,39.3765149],[72.4932969,39.3798405],[72.4861926,39.3781292],[72.4759912,39.3662885],[72.474575,39.3618425],[72.4804115,39.3525846],[72.4777507,39.348901],[72.4380004,39.3472002],[72.4338562,39.3433343],[72.4226598,39.3419196],[72.4000204,39.3419149],[72.3789575,39.3294803],[72.3478648,39.3332819],[72.3373538,39.3277237],[72.3320532,39.317483],[72.3128164,39.3162628],[72.3153376,39.3069408],[72.3082643,39.296791],[72.299779,39.292354],[72.3030424,39.2838087],[72.301594,39.274391],[72.2886183,39.260281],[72.2861552,39.2473599],[72.2765379,39.2266922],[72.269429,39.2252887],[72.2634552,39.2152952],[72.2440613,39.2091916],[72.2422372,39.2022068],[72.2473084,39.1940816],[72.2451132,39.1866834],[72.2220964,39.1822561],[72.2170287,39.1912845],[72.2175542,39.2032395],[72.2134098,39.2156835],[72.2080587,39.2241931],[72.2116542,39.2336825],[72.2018266,39.2414439],[72.1847033,39.241045],[72.1802529,39.2532558],[72.1821928,39.2588914],[72.1739441,39.2695043],[72.1615041,39.2677533],[72.1534684,39.2734009],[72.1056577,39.2664321],[72.0887661,39.2780536],[72.0741212,39.3066751],[72.0815992,39.3216165],[72.0697546,39.3331855],[72.0727801,39.3367537],[72.0672226,39.3462129],[72.070527,39.3531487],[72.043715,39.3679349],[72.0257878,39.3544429],[72.0088362,39.3514895],[71.99536,39.35326],[71.98079,39.34916],[71.9777,39.33914],[71.9586897,39.3386622],[71.9478321,39.3251023],[71.9467167,39.3191056],[71.9354972,39.3214639],[71.9301509,39.3187613],[71.929357,39.2987383],[71.9034576,39.2856191],[71.8810987,39.2873463],[71.8748331,39.2849049],[71.8702556,39.2878664],[71.8420243,39.2899205],[71.8362522,39.2853866],[71.8276047,39.2844233],[71.8174552,39.2763179],[71.8073272,39.2767497],[71.8030812,39.2713248],[71.7935943,39.278909],[71.789689,39.2909003],[71.7513656,39.3345962],[71.7739606,39.3560855],[71.7720508,39.3615936],[71.767931,39.3623568],[71.794753,39.3733883],[71.8087863,39.3901727],[71.8082284,39.3990277],[71.8016624,39.4118936],[71.804409,39.4233316],[71.7975855,39.4329779],[71.7776997,39.4442393],[71.7748385,39.4503581],[71.7812673,39.4529373],[71.7758788,39.4639727],[71.7348003,39.4542215],[71.7277622,39.4567398],[71.7229557,39.4541884],[71.7114114,39.4581646],[71.7025387,39.4550665],[71.690855,39.4563422],[71.6818857,39.4508084],[71.6378116,39.4476934],[71.6327476,39.4444456],[71.6237354,39.4558783],[71.6231346,39.4616768],[71.6104316,39.457502],[71.5976429,39.446898],[71.58082,39.4578333],[71.5664219,39.4570215],[71.5600061,39.4603184],[71.5507793,39.4729742],[71.5568733,39.4788706],[71.5546417,39.4839054],[71.5468526,39.488592],[71.538248,39.5137752],[71.5469599,39.531767],[71.5544271,39.5350024],[71.5512085,39.5427799],[71.557517,39.5434997],[71.5574741,39.5510448],[71.5697264,39.5627411],[71.5664649,39.5674059],[71.5667584,39.5749968],[71.5430975,39.5999513],[71.525073,39.5997695],[71.5147733,39.6114907],[71.5091729,39.6091681],[71.5035724,39.6109122],[71.4929938,39.605308],[71.4760852,39.6061511],[71.4570093,39.6009764],[71.4605391,39.5888151],[71.4427614,39.5812495],[71.4266796,39.583703],[71.4124631,39.5709291],[71.3970136,39.5739063],[71.3879585,39.5689111],[71.3754272,39.5767841],[71.3605785,39.5732116],[71.3379192,39.5735424],[71.3395285,39.5681502],[71.3322973,39.5516404],[71.3352582,39.5436683],[71.3274478,39.5356561],[71.3082164,39.5282915],[71.2950262,39.5137511],[71.2855732,39.515745],[71.2808847,39.5242861],[71.2738573,39.5289783],[71.2663257,39.548141],[71.2482662,39.5527611],[71.242454,39.5491999],[71.2365317,39.5388334],[71.2265324,39.5348617],[71.2203205,39.5279356],[71.2062549,39.5232434],[71.2009227,39.5147518],[71.1912562,39.5087911],[71.1588979,39.5090074],[71.1282992,39.5181122],[71.0969862,39.5188511],[71.0927439,39.5171107],[71.0972071,39.5107294],[71.0968648,39.4998298],[71.0818648,39.4978815],[71.0867572,39.4909435],[71.0850405,39.478059],[71.079762,39.4718478],[71.0827778,39.4487856],[71.0758137,39.4435839],[71.0722518,39.4249063],[71.062156,39.4183671],[71.06353,39.412207],[71.0582828,39.4088928],[71.0441637,39.4125484],[71.0199594,39.4010174],[70.9873652,39.415723],[70.9626889,39.4172481],[70.9434628,39.424409],[70.9249663,39.3944179],[70.9135015,39.3896906],[70.904088,39.393821],[70.8908701,39.4118604],[70.8774805,39.4162701],[70.8737897,39.4162369],[70.8742618,39.4080473],[70.857954,39.4044661],[70.8567094,39.3955455],[70.839672,39.3941858],[70.8295011,39.3885807],[70.7981086,39.3944677],[70.7914352,39.40115],[70.7741125,39.4002648],[70.7666945,39.4039024],[70.7486486,39.4264146],[70.7499944,39.4347167],[70.7647848,39.4479585],[70.7627802,39.4602649],[70.7654285,39.466249],[70.7594633,39.4794668],[70.7614081,39.4856924],[70.7535839,39.4863232],[70.7445716,39.4921854],[70.7425546,39.4971861],[70.7155073,39.5044877],[70.703845,39.5113251],[70.6982446,39.5187577],[70.6931805,39.5192543],[70.6930733,39.5254282],[70.6832456,39.5354244],[70.6838143,39.5472641],[70.6734609,39.5608387],[70.656445,39.5715245],[70.6505012,39.5840609],[70.6281841,39.5857992],[70.6185937,39.5903282],[70.6031871,39.5860619],[70.5882899,39.5894794],[70.5742399,39.5970454],[70.5658417,39.5945],[70.5611944,39.5972563],[70.5564952,39.6128627],[70.5471074,39.6112097],[70.5364108,39.6178217],[70.5331707,39.6235736],[70.5237508,39.6212927],[70.5175983,39.6053557],[70.5034733,39.6082506],[70.48306,39.6016119],[70.4644953,39.5832252],[70.439051,39.6045494],[70.4295158,39.5956264],[70.4314694,39.5905806],[70.4236936,39.5747994],[70.4076218,39.5752956],[70.3986691,39.5813096],[70.3838506,39.5845091],[70.3774053,39.5954615],[70.3708756,39.5949994],[70.3607649,39.5889488],[70.3550533,39.5719785],[70.3396868,39.5635682],[70.3292584,39.5626253],[70.3288638,39.552002],[70.3152251,39.5414313],[70.3132722,39.5342878],[70.3011274,39.5264212],[70.2967286,39.5288376],[70.2727497,39.5271495],[70.2546233,39.5326616],[70.2468824,39.5374433],[70.2402627,39.5522277],[70.2439153,39.5593876],[70.2195282,39.5654629],[70.2191121,39.5722352],[70.2101362,39.5790665],[70.2011346,39.5754001],[70.1945257,39.5659172],[70.1778531,39.5547342],[70.1688731,39.5536919],[70.1492248,39.5596225],[70.1427912,39.5724012],[70.1378774,39.5718223],[70.1286185,39.5847389],[70.1172183,39.5902208],[70.1042318,39.5878974],[70.0909495,39.5779253],[70.0768304,39.5752294],[70.0704833,39.5705494],[70.0680167,39.5639548],[70.0536561,39.5709952],[70.0384855,39.5712433],[70.0376615,39.5622909],[70.0313364,39.5514791],[69.9950734,39.5364446],[69.9879527,39.5458494],[69.9903559,39.5569676],[69.979198,39.5581918],[69.9796915,39.5665623],[69.9557501,39.566219],[69.9437928,39.5623441],[69.9260902,39.5719752],[69.9236425,39.5777463],[69.9022988,39.5733244],[69.8932171,39.5685803],[69.8989033,39.5571661],[69.8849488,39.5460838],[69.889183,39.5419443],[69.8680258,39.5286887],[69.8578548,39.5352754],[69.8528552,39.5451048],[69.8388684,39.5486722],[69.8274223,39.5612367],[69.8222565,39.5575136],[69.8145532,39.5580926],[69.8096295,39.5678024],[69.7970438,39.5703832],[69.793117,39.5780576],[69.7446743,39.5871629],[69.738636,39.5943463],[69.7160411,39.5930235],[69.7000852,39.5994008],[69.6823162,39.5915894],[69.6770954,39.5799761],[69.6609986,39.5782505],[69.6553159,39.5810014],[69.6435571,39.5804887],[69.639802,39.587699],[69.6294151,39.5929759],[69.6193528,39.5886911],[69.6020203,39.5920146],[69.5993111,39.5882344],[69.6022725,39.5819606],[69.5845485,39.575031],[69.585793,39.5699036],[69.580324,39.5672373],[69.5801496,39.5594161],[69.5739731,39.5531179],[69.5557258,39.5582237],[69.5437553,39.5415732],[69.5377599,39.5381006],[69.5299137,39.5447977],[69.5236099,39.5438151],[69.5140593,39.5363722],[69.4951343,39.5398593],[69.4857359,39.525693],[69.4751358,39.5332068],[69.4718903,39.5393844],[69.4465112,39.5281094],[69.4152474,39.5462796],[69.4090032,39.5465774],[69.4068146,39.551326],[69.4085955,39.5603259],[69.4043898,39.5619636],[69.396708,39.556918],[69.3770457,39.5231018],[69.3632125,39.5198006],[69.3526768,39.5272488],[69.3393731,39.5412328],[69.3376212,39.5478584],[69.3472411,39.5543201],[69.3557592,39.5688576],[69.3535137,39.575461],[69.3598878,39.5956949],[69.3398452,39.6006788],[69.3382787,39.6036051],[69.3442869,39.6167803],[69.3442225,39.6239372],[69.3331718,39.6289614],[69.3294811,39.6350099],[69.3313589,39.6435326],[69.3290949,39.654358],[69.321413,39.6603877],[69.3183781,39.6708959],[69.3199539,39.6821563],[69.336937,39.6971952],[69.3370548,39.7006585],[69.3211444,39.7267358],[69.3103671,39.7326962],[69.2890852,39.755031],[69.2909724,39.7666026],[69.285614,39.772252],[69.2946712,39.7804885],[69.2831482,39.7812538],[69.2822946,39.7891612],[69.2791829,39.78986],[69.2799729,39.8029924],[69.2649523,39.8060382],[69.2697382,39.8291216],[69.277112,39.8233676],[69.2835512,39.825753],[69.2854717,39.830378],[69.2822654,39.8361311],[69.3036555,39.8468769],[69.2999339,39.8625232],[69.3032531,39.8721525],[69.3173696,39.870943],[69.3188022,39.8751113],[69.3295762,39.8780537],[69.3249668,39.8786048],[69.3128913,39.8916009],[69.3023787,39.9103474],[69.2990756,39.9104752],[69.2968843,39.9204575],[69.3105185,39.9364762],[69.316041,39.938429],[69.3174636,39.9498446],[69.3316895,39.951226],[69.3368261,39.9603308],[69.3439713,39.9562422],[69.3442395,39.9684046],[69.356047,39.9690588],[69.3576119,39.9716027],[69.3563587,39.9840355],[69.3591293,39.990025],[69.3469424,40.0176673],[69.3509731,40.0210446],[69.361121,40.0192289],[69.3721698,39.995983],[69.3875401,39.9937507],[69.3946468,40.002558],[69.4175131,39.9912042],[69.4319188,39.9882811],[69.4280303,39.98076],[69.4347639,39.9738194],[69.4312075,39.9641524],[69.4350959,39.9521576],[69.4270345,39.9294344],[69.4305049,39.9221861],[69.4512186,39.9375429],[69.4573832,39.9349614],[69.4595426,39.9186623],[69.4626565,39.9158175],[69.4751824,39.9228162],[69.4801484,39.9298815],[69.4887658,39.9274901],[69.4935819,39.9309753],[69.4970091,39.9277582],[69.5025436,39.9301189],[69.498084,39.9391948],[69.5015386,39.9432497],[69.520957,39.9437218],[69.529286,39.9389454],[69.5424169,39.9391503],[69.5260615,39.9695316],[69.5309457,39.9943172],[69.5070581,40.0338442],[69.51371,40.0456592],[69.5107503,40.0459396],[69.5121254,40.050594],[69.520018,40.053816],[69.524565,40.0606023],[69.5221982,40.0714354],[69.5122293,40.0821751],[69.5247627,40.0945088],[69.5385164,40.0976089],[69.5524222,40.0962146],[69.5733607,40.1034411],[69.5902504,40.0994315],[69.596235,40.1080459],[69.6098479,40.1130692],[69.6505906,40.1227165],[69.6651945,40.1229761],[69.6772907,40.1214653],[69.6822803,40.1148666],[69.6821666,40.1089502],[69.6923254,40.0968864],[69.6851475,40.111932],[69.6840911,40.1245316],[69.6885874,40.1243768],[69.700792,40.1313732],[69.7077052,40.1369615],[69.7064062,40.1386972],[69.7455906,40.1575422],[69.7434002,40.1616163],[69.7491285,40.171256],[69.7573668,40.1760978],[69.7999668,40.1818586],[69.9101598,40.2075077],[69.9237194,40.2090237],[69.9331993,40.2064761],[69.9389983,40.2111413],[69.9584407,40.2135701],[69.974229,40.2228612],[69.9960035,40.2260088],[70.0049058,40.2325469],[70.0053212,40.2288608],[70.009575,40.2295474],[70.009597,40.232233],[70.0179588,40.2316209],[70.0321068,40.2234655],[70.0315058,40.2092334],[70.0443338,40.2080648],[70.1228735,40.1729833],[70.1597348,40.1505479],[70.1937607,40.1350282],[70.2066831,40.1322367],[70.2068228,40.1293222],[70.2411622,40.1240056],[70.265447,40.123966],[70.2822814,40.1295872],[70.2919611,40.1293557],[70.3053488,40.1196539],[70.3516023,40.1021412],[70.3577889,40.081064],[70.3849358,40.0811089],[70.4045899,40.0770525],[70.4196871,40.0677391],[70.4174483,40.0608473],[70.4393524,40.053007],[70.4646312,40.0574759],[70.4721721,40.0490869],[70.4803555,40.0523402],[70.5090481,40.0512748],[70.5155016,40.0479296],[70.5113991,40.0360135],[70.524523,40.0258377],[70.5437144,40.035528],[70.5481354,40.0347162],[70.5557807,40.0260883],[70.5680713,40.0226761],[70.5812279,40.0025043],[70.5751838,39.9933445],[70.5569302,39.9939338],[70.5452712,39.990687],[70.5436977,39.9881527],[70.548544,39.9863353],[70.5467295,39.9791263],[70.5150736,39.969753],[70.511409,39.9605068],[70.526864,39.9508622],[70.5417523,39.9553242],[70.5382357,39.9512231],[70.5468021,39.948309],[70.5994455,39.9704127],[70.6209801,39.9855416],[70.6182499,40.002039],[70.6451344,40.0251373],[70.6414438,40.0329489],[70.6344702,40.0354267],[70.6355647,40.0518472],[70.6395627,40.052223],[70.6392219,40.0559933],[70.6296262,40.0599825],[70.6623848,40.0579893],[70.6569214,40.1003229],[70.755972,40.1169976],[70.7667995,40.1157166],[70.782979,40.124132],[70.7874191,40.131692],[70.78778,40.1413107],[70.799683,40.147491],[70.8030633,40.1722566],[70.840053,40.1729152],[70.8386464,40.1649141],[70.8479164,40.1649362],[70.8686349,40.1732902],[70.8779316,40.1833161],[70.8757688,40.1845616],[70.8812599,40.1966486],[70.8861788,40.1960172],[70.8896075,40.1892239],[70.9855543,40.2209372],[70.8630143,40.2207393],[70.8509733,40.2146299],[70.8486641,40.2100544],[70.8176259,40.2018069],[70.7901826,40.201986],[70.759905,40.188189],[70.713954,40.189862],[70.63233,40.177295],[70.611733,40.20109],[70.585122,40.223871],[70.579474,40.234353],[70.598314,40.2419576],[70.5757348,40.2642835],[70.5754385,40.2890516],[70.5693411,40.2937697],[70.566131,40.3045285],[70.5597973,40.3120592],[70.5623235,40.320891],[70.5819695,40.338905],[70.5736317,40.3408078],[70.5518598,40.3547797],[70.5256262,40.3565823],[70.5253156,40.3531571],[70.5048254,40.3534498],[70.4963595,40.3481103],[70.4766677,40.3519554],[70.4542038,40.3620307],[70.4560341,40.3645129],[70.4499707,40.3671184],[70.432759,40.36937],[70.422067,40.378314],[70.3789526,40.38652],[70.3504713,40.4086976],[70.3480227,40.4255297],[70.3305754,40.4404032],[70.3292021,40.4567322],[70.3460249,40.4602588],[70.352548,40.4669196],[70.3935751,40.4782805],[70.4145178,40.4872896],[70.4328855,40.4900312],[70.4455429,40.496815],[70.4830107,40.5015188],[70.5018934,40.5267062],[70.5058416,40.5402748],[70.5139097,40.5495364],[70.5305609,40.554884],[70.5532202,40.5543623],[70.5880674,40.5664909],[70.6087446,40.5838667],[70.6361326,40.6237133],[70.6400808,40.6265796],[70.65496,40.6267018],[70.6748001,40.6449944],[70.70494,40.6629995],[70.7168135,40.662659],[70.7261443,40.655319],[70.7332455,40.6563311],[70.7375845,40.6640914],[70.7304763,40.6740781],[70.7307472,40.6860374],[70.7605294,40.6835232],[70.7684488,40.6917427],[70.7689985,40.7004108],[70.7764393,40.7162154],[70.7973438,40.7198182],[70.7948138,40.7345647],[70.7789127,40.7496315],[70.7535702,40.7625926],[70.7276738,40.7692148],[70.7033868,40.8005063],[70.7134544,40.7999071],[70.7238827,40.8061323],[70.7282108,40.8092792],[70.7234428,40.8143777],[70.6989631,40.834422],[70.6868906,40.838218],[70.6712534,40.850601],[70.6517924,40.8582913],[70.6452639,40.8648355],[70.6407917,40.8826624],[70.6339177,40.8858329],[70.629227,40.8948385],[70.614581,40.901199],[70.607757,40.90793],[70.597375,40.927042],[70.5983897,40.9321121],[70.5684471,40.960845],[70.5658507,40.9688169],[70.5562108,40.9788896],[70.5337071,40.9800763],[70.5212022,40.987233],[70.5203082,40.9978728],[70.5130512,41.0072921],[70.5144548,41.010482],[70.4889569,41.0237494],[70.4834197,41.0337318],[70.4763119,41.0359505],[70.4725404,41.0413097],[70.4586576,41.0367855],[70.451633,41.0385526],[70.4449451,41.0450935],[70.4275523,41.0361595],[70.4138457,41.0344619],[70.3957205,41.0268585],[70.3907991,41.0149969],[70.3746187,41.0029397],[70.388872,40.9671064],[70.3872504,40.9514526],[70.3816288,40.9463006],[70.3706023,40.9432649],[70.3792527,40.9181412],[70.3718228,40.8979968],[70.3351018,40.8819886],[70.3263661,40.8864945],[70.302532,40.8770283],[70.2863537,40.8747347],[70.2743734,40.8667817],[70.266365,40.8501598],[70.2012639,40.8222158],[70.1811771,40.833773],[70.1627133,40.83423],[70.1423507,40.8244211],[70.1273858,40.8220623],[70.1201017,40.8152579],[70.1243853,40.8073988],[70.1137115,40.7871151],[70.0984073,40.7815852],[70.0681728,40.755183],[70.0391369,40.7531698],[70.0321341,40.7448575],[70.0191545,40.7426217],[70.0065143,40.7360093],[69.9739261,40.7389148],[69.9634873,40.7320208],[69.961456,40.725829],[69.9509974,40.725791],[69.931455,40.7165853],[69.9173631,40.7204313],[69.8956147,40.7198456],[69.8899187,40.7255604],[69.8726712,40.715202],[69.8414094,40.7066051],[69.8350883,40.6996686],[69.8249083,40.7006747],[69.8159518,40.707322],[69.7931644,40.7015934],[69.7896437,40.6895212],[69.7748788,40.674966],[69.7702442,40.6644241],[69.7616907,40.6592546],[69.7648903,40.6515754],[69.7582514,40.6452328],[69.7423322,40.6423275],[69.7348518,40.6351387],[69.7204874,40.6286889],[69.7120501,40.6304859],[69.6984293,40.6274767],[69.685285,40.632711],[69.6692671,40.6341375],[69.6665358,40.6489738],[69.6612645,40.657996],[69.6633366,40.6597973],[69.6532026,40.6657264],[69.6516941,40.6710895],[69.643268,40.6748242],[69.6365813,40.6732035],[69.625336,40.6762627],[69.6171218,40.6897413],[69.593442,40.6972646],[69.5837513,40.7040953],[69.5825748,40.7109669],[69.5743437,40.7203169],[69.5725376,40.7286229],[69.5756524,40.7324507],[69.5716377,40.7436629],[69.5596993,40.7571202],[69.5580172,40.7642764],[69.5451452,40.7725626],[69.5369032,40.771382],[69.5347158,40.7770518],[69.5241544,40.7756395],[69.5185651,40.7825298],[69.5149722,40.7771914],[69.5024409,40.7796667],[69.4974067,40.7872654],[69.4968862,40.7974442],[69.4799194,40.7916679],[69.4743585,40.7807296],[69.4705577,40.7840687],[69.4553448,40.7841504],[69.4442184,40.7893925],[69.4376888,40.7888601],[69.4285122,40.7835084],[69.4201142,40.759067],[69.4078326,40.7522279],[69.3955952,40.766384],[69.3886311,40.7842273],[69.3745171,40.7904072],[69.3476609,40.7749138],[69.3596261,40.7603178],[69.3576354,40.755861],[69.3617945,40.7533957],[69.3592329,40.7499911],[69.3645017,40.7440485],[69.3596909,40.739659],[69.3629231,40.734391],[69.3511338,40.7321151],[69.355893,40.7266933],[69.3467643,40.7243955],[69.3461971,40.712271],[69.3396048,40.7125169],[69.3285514,40.7039545],[69.3425378,40.6851351],[69.3370613,40.6586167],[69.3475834,40.6146475],[69.3470781,40.5853186],[69.3403987,40.5804984],[69.3270117,40.5816848],[69.3196767,40.5786389],[69.2842512,40.5818777],[69.2781383,40.5745437],[69.262298,40.5763465],[69.2267724,40.5499375],[69.2110309,40.5467856],[69.2119356,40.5407923],[69.2212012,40.5364079],[69.2203949,40.5311971],[69.2308738,40.5226758],[69.240464,40.5199204],[69.2479682,40.5102331],[69.2564244,40.50704],[69.2627941,40.4999791],[69.2798596,40.4928554],[69.2786462,40.4894521],[69.2716269,40.4879042],[69.2697482,40.4843616],[69.2724938,40.4795836],[69.2664257,40.4759476],[69.2717881,40.4682743],[69.2677196,40.4597181],[69.2793254,40.451884],[69.2839318,40.4434292],[69.2859791,40.4236111],[69.2833969,40.4200006],[69.2984432,40.411835],[69.2911155,40.4023807],[69.2929431,40.3949576],[69.3065043,40.3867854],[69.3071662,40.3799935],[69.3033492,40.3757943],[69.3026136,40.3681354],[69.3161832,40.3566645],[69.3362895,40.3487557],[69.3405083,40.3390216],[69.3380353,40.3213484],[69.3277126,40.3082749],[69.3282873,40.2972119],[69.3227427,40.2927099],[69.3116378,40.2903322],[69.3072914,40.2861836],[69.30743,40.2818881],[69.2598658,40.2972148],[69.2491996,40.3034926],[69.2466118,40.2954433],[69.2525223,40.291329],[69.2546688,40.2837093],[69.2490595,40.2810251],[69.2477846,40.2748134],[69.2611703,40.2638247],[69.2626938,40.2582801],[69.3014549,40.2448134],[69.2971302,40.2338033],[69.2886373,40.2256852],[69.2904817,40.217441],[69.2989793,40.2072579],[69.300419,40.1966526],[69.3055068,40.1950935],[69.3043122,40.1884416],[69.2740159,40.2019893],[69.2611718,40.200725],[69.2465129,40.2082559],[69.2300606,40.2082541],[69.1977366,40.2150728],[69.1652807,40.2105766],[69.1534695,40.2154374],[69.0611995,40.2227742],[69.0357496,40.2287339],[68.8627616,40.2100349],[68.8515196,40.2034869],[68.8519595,40.1977775],[68.840952,40.1938809],[68.8436124,40.1832761],[68.8118444,40.1783944],[68.7972997,40.1726025],[68.7795653,40.2039258],[68.6884397,40.1783063],[68.6536453,40.1729517],[68.5979452,40.1571307],[68.5547714,40.1510065],[68.5328606,40.1438209],[68.531026,40.1177702],[68.6332364,40.0766773],[68.6940954,40.0950429],[68.7503405,40.1013355],[68.7658304,40.0979678],[68.7731355,40.0993793],[68.782419,40.1071691],[68.8112238,40.1166294],[68.847767,40.1213788],[68.931753,40.1459947],[68.9669454,40.1442605],[68.9706372,40.1470323],[68.9807186,40.1427813],[69.0004406,40.1527163],[69.0200197,40.1542295],[69.0239259,40.1455781],[69.0241002,40.1260372],[69.0084534,40.0991327],[68.9952732,40.0932537],[68.9707414,40.0926774],[68.9568639,40.0836218],[68.96843,40.0648225],[68.9723293,40.0655797],[68.9771898,40.0577639],[68.9795932,40.0430707],[68.9774732,40.041974],[68.9730059,40.0420686],[68.9671254,40.0552122],[68.9552258,40.0627611],[68.9161877,40.0613308],[68.9066278,40.0680652],[68.9009634,40.0662286],[68.8972251,40.0497852],[68.8933371,40.0482142],[68.8885693,40.0549794],[68.8672779,40.0558351],[68.8569289,40.0505704],[68.8565201,40.0469704],[68.8752947,40.0192508],[68.8813711,40.0171066],[68.8995272,39.9931005],[68.9014864,39.9816254],[68.9108241,39.9740097],[68.9282463,39.9302734],[68.9432584,39.9191959],[68.9237149,39.9115004],[68.9173687,39.8912786],[68.9062827,39.8807014],[68.8966128,39.8790226],[68.8946974,39.869627],[68.8895031,39.8649055],[68.8725551,39.8637178],[68.8641568,39.8667968],[68.8623062,39.8612479],[68.8547503,39.8631395],[68.8527203,39.8884949],[68.8445918,39.8906719],[68.8542667,39.9064067],[68.8552001,39.9213021],[68.847234,39.9291584],[68.8447911,39.941577],[68.8280967,39.9710169],[68.824398,39.9867011],[68.8202857,39.9858716],[68.8197072,39.978431],[68.8006752,39.9699642],[68.8165775,39.96805],[68.822711,39.9496383],[68.8282329,39.9469324],[68.8300113,39.9212552],[68.8273295,39.9163485],[68.8278201,39.9036504],[68.82113,39.8951863],[68.8316656,39.8937834],[68.8311102,39.8909623],[68.8217016,39.8827688],[68.8226107,39.8704954],[68.8067013,39.8751342],[68.7963566,39.8674197],[68.7853719,39.8398204],[68.7785039,39.8398834],[68.7701974,39.8594976],[68.7725252,39.8749941],[68.7605749,39.8746864],[68.7498833,39.867397],[68.759121,39.8447188],[68.752613,39.8477321],[68.7461363,39.845786],[68.7204999,39.8596697],[68.6987274,39.8481329],[68.6368678,39.8549058],[68.633615,39.8389366],[68.6382007,39.8186562],[68.6374264,39.7870702],[68.6432206,39.7773236],[68.6325101,39.7712136],[68.624041,39.7714564],[68.6198766,39.7620612],[68.6254649,39.7560191],[68.6190266,39.7471224],[68.6095029,39.7416247],[68.5895368,39.7374646],[68.5867497,39.7244517],[68.6035116,39.7110545],[68.6029244,39.7068026],[68.6262006,39.6957039],[68.629862,39.6838572],[68.6205196,39.6652111],[68.6172456,39.6379904],[68.5992153,39.6244907],[68.5798091,39.6213116],[68.5701543,39.6014164],[68.5524456,39.5997864],[68.5465765,39.5903199],[68.5380778,39.5845219],[68.5397744,39.5817498],[68.536191,39.5691675],[68.5469091,39.5583779],[68.5416525,39.5496288],[68.5314175,39.5451816],[68.5242081,39.5321256],[68.5110334,39.5305001],[68.5104461,39.534049],[68.5015017,39.5400188],[68.4909715,39.5423266],[68.4792228,39.5355916],[68.4643028,39.5389116],[68.4563175,39.5336491],[68.4435225,39.5400196],[68.4243518,39.5377157],[68.4153295,39.5422927],[68.4070507,39.5409006],[68.392083,39.5447052],[68.3772365,39.5380385],[68.369169,39.5299878],[68.3572501,39.5313863],[68.3473098,39.5401655],[68.3095763,39.5541255],[68.2981233,39.54972],[68.286301,39.5596775],[68.2670205,39.5578577],[68.250737,39.5626811],[68.2399729,39.5560902],[68.2006573,39.5535595],[68.1926064,39.5562373],[68.1769048,39.5691761],[68.1566266,39.5627349],[68.1447544,39.568164],[68.1374967,39.5614591],[68.1148195,39.5602562],[68.0811596,39.5775614],[68.0616285,39.5741055],[68.0383067,39.5773112],[68.0271291,39.5827048],[68.0274725,39.5861776],[68.0189037,39.5852636],[68.0114007,39.5909235],[67.9991111,39.5909693],[67.9791283,39.6008276],[67.9771869,39.6054766],[67.9490728,39.6035308],[67.9389204,39.5988392],[67.8999028,39.6107341],[67.8750795,39.627375],[67.8619105,39.6238382],[67.8358748,39.6306767],[67.8290148,39.6392408],[67.8171669,39.6437133],[67.8057368,39.6530837],[67.7931366,39.6569586],[67.7818447,39.6468261],[67.7607889,39.6399175],[67.707976,39.6596577],[67.6836891,39.6387253],[67.664609,39.6416424],[67.6597844,39.6367199],[67.651498,39.6353773],[67.6473336,39.6251377],[67.6345075,39.6199283],[67.628974,39.6133675],[67.6304532,39.6043026],[67.6275609,39.6008106],[67.5920009,39.5973312],[67.5824345,39.599957],[67.5757174,39.5947088],[67.5655186,39.5945434],[67.557467,39.5884214],[67.5343548,39.5898805],[67.5323259,39.5855544],[67.5193348,39.5791788],[67.5088904,39.5789266],[67.4994348,39.5839004],[67.4827512,39.5764455],[67.4628008,39.5747205],[67.452171,39.5786181],[67.4558571,39.5730305],[67.4500309,39.5671935],[67.4439284,39.5502319],[67.4557944,39.5468954],[67.4605105,39.5421027],[67.4705805,39.5416302],[67.4687107,39.5313071],[67.4636269,39.5335611],[67.4322512,39.5298139],[67.4163093,39.5384869],[67.4078092,39.537485],[67.4100043,39.5327308],[67.4019225,39.5334349],[67.3945589,39.5231411],[67.3981743,39.5216483],[67.3982245,39.5156492],[67.4032903,39.5144704],[67.4033448,39.5099937],[67.4090989,39.5065077],[67.4366134,39.4983539],[67.4472606,39.4893077],[67.4645431,39.4627212],[67.4636471,39.4520259],[67.4557017,39.4411038],[67.4516048,39.4406416],[67.4514464,39.4209122],[67.4533405,39.4150796],[67.478308,39.3992237],[67.4766256,39.3785107],[67.4832398,39.3774292],[67.4696535,39.3394721],[67.4757462,39.3299669],[67.4740242,39.3229484],[67.45468,39.3137417],[67.4332934,39.3099],[67.413495,39.3136635],[67.4000529,39.3104951],[67.3867527,39.3144068],[67.3615658,39.3088758],[67.3440055,39.3085386],[67.3332775,39.3042293]]]}}]},Jx=xx("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground border border-destructive-border",outline:" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Qo=j.forwardRef(({className:r,variant:n,size:s,asChild:u=!1,...m},x)=>{const v=u?O6:"button";return V.jsx(v,{className:lr(Jx({variant:n,size:s,className:r})),ref:x,...m})});Qo.displayName="Button";var $F=j.createContext(void 0);function e2(r){const n=j.useContext($F);return r||n||"ltr"}var Xv="rovingFocusGroup.onEntryFocus",GF={bubbles:!1,cancelable:!0},__="RovingFocusGroup",[z1,p9,qF]=s_(__),[ZF,m9]=nu(__,[qF]),[WF,HF]=ZF(__),g9=j.forwardRef((r,n)=>V.jsx(z1.Provider,{scope:r.__scopeRovingFocusGroup,children:V.jsx(z1.Slot,{scope:r.__scopeRovingFocusGroup,children:V.jsx(XF,{...r,ref:n})})}));g9.displayName=__;var XF=j.forwardRef((r,n)=>{const{__scopeRovingFocusGroup:s,orientation:u,loop:m=!1,dir:x,currentTabStopId:v,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:A,onEntryFocus:R,preventScrollOnEntryFocus:L=!1,...B}=r,W=j.useRef(null),re=dn(n,W),ce=e2(x),[Q=null,X]=dm({prop:v,defaultProp:l,onChange:A}),[le,he]=j.useState(!1),_e=to(R),Ie=p9(s),ke=j.useRef(!1),[Je,He]=j.useState(0);return j.useEffect(()=>{const nt=W.current;if(nt)return nt.addEventListener(Xv,_e),()=>nt.removeEventListener(Xv,_e)},[_e]),V.jsx(WF,{scope:s,orientation:u,dir:ce,loop:m,currentTabStopId:Q,onItemFocus:j.useCallback(nt=>X(nt),[X]),onItemShiftTab:j.useCallback(()=>he(!0),[]),onFocusableItemAdd:j.useCallback(()=>He(nt=>nt+1),[]),onFocusableItemRemove:j.useCallback(()=>He(nt=>nt-1),[]),children:V.jsx(Fr.div,{tabIndex:le||Je===0?-1:0,"data-orientation":u,...B,ref:re,style:{outline:"none",...r.style},onMouseDown:Ht(r.onMouseDown,()=>{ke.current=!0}),onFocus:Ht(r.onFocus,nt=>{const Pt=!ke.current;if(nt.target===nt.currentTarget&&Pt&&!le){const Ct=new CustomEvent(Xv,GF);if(nt.currentTarget.dispatchEvent(Ct),!Ct.defaultPrevented){const Zt=Ie().filter(dt=>dt.focusable),lt=Zt.find(dt=>dt.active),Et=Zt.find(dt=>dt.id===Q),gt=[lt,Et,...Zt].filter(Boolean).map(dt=>dt.ref.current);v9(gt,L)}}ke.current=!1}),onBlur:Ht(r.onBlur,()=>he(!1))})})}),y9="RovingFocusGroupItem",_9=j.forwardRef((r,n)=>{const{__scopeRovingFocusGroup:s,focusable:u=!0,active:m=!1,tabStopId:x,...v}=r,l=th(),A=x||l,R=HF(y9,s),L=R.currentTabStopId===A,B=p9(s),{onFocusableItemAdd:W,onFocusableItemRemove:re}=R;return j.useEffect(()=>{if(u)return W(),()=>re()},[u,W,re]),V.jsx(z1.ItemSlot,{scope:s,id:A,focusable:u,active:m,children:V.jsx(Fr.span,{tabIndex:L?0:-1,"data-orientation":R.orientation,...v,ref:n,onMouseDown:Ht(r.onMouseDown,ce=>{u?R.onItemFocus(A):ce.preventDefault()}),onFocus:Ht(r.onFocus,()=>R.onItemFocus(A)),onKeyDown:Ht(r.onKeyDown,ce=>{if(ce.key==="Tab"&&ce.shiftKey){R.onItemShiftTab();return}if(ce.target!==ce.currentTarget)return;const Q=QF(ce,R.orientation,R.dir);if(Q!==void 0){if(ce.metaKey||ce.ctrlKey||ce.altKey||ce.shiftKey)return;ce.preventDefault();let le=B().filter(he=>he.focusable).map(he=>he.ref.current);if(Q==="last")le.reverse();else if(Q==="prev"||Q==="next"){Q==="prev"&&le.reverse();const he=le.indexOf(ce.currentTarget);le=R.loop?JF(le,he+1):le.slice(he+1)}setTimeout(()=>v9(le))}})})})});_9.displayName=y9;var KF={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function YF(r,n){return n!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function QF(r,n,s){const u=YF(r.key,s);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(u))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(u)))return KF[u]}function v9(r,n=!1){const s=document.activeElement;for(const u of r)if(u===s||(u.focus({preventScroll:n}),document.activeElement!==s))return}function JF(r,n){return r.map((s,u)=>r[(n+u)%r.length])}var eO=g9,tO=_9,F1=["Enter"," "],rO=["ArrowDown","PageUp","Home"],x9=["ArrowUp","PageDown","End"],nO=[...rO,...x9],iO={ltr:[...F1,"ArrowRight"],rtl:[...F1,"ArrowLeft"]},sO={ltr:["ArrowLeft"],rtl:["ArrowRight"]},iy="Menu",[Zg,oO,aO]=s_(iy),[Qf,b9]=nu(iy,[aO,Mm,m9]),v_=Mm(),w9=m9(),[lO,Jf]=Qf(iy),[cO,sy]=Qf(iy),T9=r=>{const{__scopeMenu:n,open:s=!1,children:u,dir:m,onOpenChange:x,modal:v=!0}=r,l=v_(n),[A,R]=j.useState(null),L=j.useRef(!1),B=to(x),W=e2(m);return j.useEffect(()=>{const re=()=>{L.current=!0,document.addEventListener("pointerdown",ce,{capture:!0,once:!0}),document.addEventListener("pointermove",ce,{capture:!0,once:!0})},ce=()=>L.current=!1;return document.addEventListener("keydown",re,{capture:!0}),()=>{document.removeEventListener("keydown",re,{capture:!0}),document.removeEventListener("pointerdown",ce,{capture:!0}),document.removeEventListener("pointermove",ce,{capture:!0})}},[]),V.jsx(q4,{...l,children:V.jsx(lO,{scope:n,open:s,onOpenChange:B,content:A,onContentChange:R,children:V.jsx(cO,{scope:n,onClose:j.useCallback(()=>B(!1),[B]),isUsingKeyboardRef:L,dir:W,modal:v,children:u})})})};T9.displayName=iy;var uO="MenuAnchor",t2=j.forwardRef((r,n)=>{const{__scopeMenu:s,...u}=r,m=v_(s);return V.jsx(Dx,{...m,...u,ref:n})});t2.displayName=uO;var r2="MenuPortal",[hO,S9]=Qf(r2,{forceMount:void 0}),P9=r=>{const{__scopeMenu:n,forceMount:s,children:u,container:m}=r,x=Jf(r2,n);return V.jsx(hO,{scope:n,forceMount:s,children:V.jsx(iu,{present:s||x.open,children:V.jsx(Jg,{asChild:!0,container:m,children:u})})})};P9.displayName=r2;var al="MenuContent",[dO,n2]=Qf(al),C9=j.forwardRef((r,n)=>{const s=S9(al,r.__scopeMenu),{forceMount:u=s.forceMount,...m}=r,x=Jf(al,r.__scopeMenu),v=sy(al,r.__scopeMenu);return V.jsx(Zg.Provider,{scope:r.__scopeMenu,children:V.jsx(iu,{present:u||x.open,children:V.jsx(Zg.Slot,{scope:r.__scopeMenu,children:v.modal?V.jsx(fO,{...m,ref:n}):V.jsx(pO,{...m,ref:n})})})})}),fO=j.forwardRef((r,n)=>{const s=Jf(al,r.__scopeMenu),u=j.useRef(null),m=dn(n,u);return j.useEffect(()=>{const x=u.current;if(x)return Bx(x)},[]),V.jsx(i2,{...r,ref:m,trapFocus:s.open,disableOutsidePointerEvents:s.open,disableOutsideScroll:!0,onFocusOutside:Ht(r.onFocusOutside,x=>x.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>s.onOpenChange(!1)})}),pO=j.forwardRef((r,n)=>{const s=Jf(al,r.__scopeMenu);return V.jsx(i2,{...r,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>s.onOpenChange(!1)})}),mO=Gf("MenuContent.ScrollLock"),i2=j.forwardRef((r,n)=>{const{__scopeMenu:s,loop:u=!1,trapFocus:m,onOpenAutoFocus:x,onCloseAutoFocus:v,disableOutsidePointerEvents:l,onEntryFocus:A,onEscapeKeyDown:R,onPointerDownOutside:L,onFocusOutside:B,onInteractOutside:W,onDismiss:re,disableOutsideScroll:ce,...Q}=r,X=Jf(al,s),le=sy(al,s),he=v_(s),_e=w9(s),Ie=oO(s),[ke,Je]=j.useState(null),He=j.useRef(null),nt=dn(n,He,X.onContentChange),Pt=j.useRef(0),Ct=j.useRef(""),Zt=j.useRef(0),lt=j.useRef(null),Et=j.useRef("right"),ft=j.useRef(0),gt=ce?y_:j.Fragment,dt=ce?{as:mO,allowPinchZoom:!0}:void 0,mt=Be=>{const _t=Ct.current+Be,Re=Ie().filter(St=>!St.disabled),at=document.activeElement,nr=Re.find(St=>St.ref.current===at)?.textValue,er=Re.map(St=>St.textValue),ir=EO(er,_t,nr),sr=Re.find(St=>St.textValue===ir)?.ref.current;(function St(Gt){Ct.current=Gt,window.clearTimeout(Pt.current),Gt!==""&&(Pt.current=window.setTimeout(()=>St(""),1e3))})(_t),sr&&setTimeout(()=>sr.focus())};j.useEffect(()=>()=>window.clearTimeout(Pt.current),[]),jx();const Xe=j.useCallback(Be=>Et.current===lt.current?.side&&IO(Be,lt.current?.area),[]);return V.jsx(dO,{scope:s,searchRef:Ct,onItemEnter:j.useCallback(Be=>{Xe(Be)&&Be.preventDefault()},[Xe]),onItemLeave:j.useCallback(Be=>{Xe(Be)||(He.current?.focus(),Je(null))},[Xe]),onTriggerLeave:j.useCallback(Be=>{Xe(Be)&&Be.preventDefault()},[Xe]),pointerGraceTimerRef:Zt,onPointerGraceIntentChange:j.useCallback(Be=>{lt.current=Be},[]),children:V.jsx(gt,{...dt,children:V.jsx(m_,{asChild:!0,trapped:m,onMountAutoFocus:Ht(x,Be=>{Be.preventDefault(),He.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:v,children:V.jsx(Sm,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:R,onPointerDownOutside:L,onFocusOutside:B,onInteractOutside:W,onDismiss:re,children:V.jsx(eO,{asChild:!0,..._e,dir:le.dir,orientation:"vertical",loop:u,currentTabStopId:ke,onCurrentTabStopIdChange:Je,onEntryFocus:Ht(A,Be=>{le.isUsingKeyboardRef.current||Be.preventDefault()}),preventScrollOnEntryFocus:!0,children:V.jsx(Rx,{role:"menu","aria-orientation":"vertical","data-state":U9(X.open),"data-radix-menu-content":"",dir:le.dir,...he,...Q,ref:nt,style:{outline:"none",...Q.style},onKeyDown:Ht(Q.onKeyDown,Be=>{const Re=Be.target.closest("[data-radix-menu-content]")===Be.currentTarget,at=Be.ctrlKey||Be.altKey||Be.metaKey,nr=Be.key.length===1;Re&&(Be.key==="Tab"&&Be.preventDefault(),!at&&nr&&mt(Be.key));const er=He.current;if(Be.target!==er||!nO.includes(Be.key))return;Be.preventDefault();const sr=Ie().filter(St=>!St.disabled).map(St=>St.ref.current);x9.includes(Be.key)&&sr.reverse(),PO(sr)}),onBlur:Ht(r.onBlur,Be=>{Be.currentTarget.contains(Be.target)||(window.clearTimeout(Pt.current),Ct.current="")}),onPointerMove:Ht(r.onPointerMove,Wg(Be=>{const _t=Be.target,Re=ft.current!==Be.clientX;if(Be.currentTarget.contains(_t)&&Re){const at=Be.clientX>ft.current?"right":"left";Et.current=at,ft.current=Be.clientX}}))})})})})})})});C9.displayName=al;var gO="MenuGroup",s2=j.forwardRef((r,n)=>{const{__scopeMenu:s,...u}=r;return V.jsx(Fr.div,{role:"group",...u,ref:n})});s2.displayName=gO;var yO="MenuLabel",E9=j.forwardRef((r,n)=>{const{__scopeMenu:s,...u}=r;return V.jsx(Fr.div,{...u,ref:n})});E9.displayName=yO;var V0="MenuItem",jw="menu.itemSelect",x_=j.forwardRef((r,n)=>{const{disabled:s=!1,onSelect:u,...m}=r,x=j.useRef(null),v=sy(V0,r.__scopeMenu),l=n2(V0,r.__scopeMenu),A=dn(n,x),R=j.useRef(!1),L=()=>{const B=x.current;if(!s&&B){const W=new CustomEvent(jw,{bubbles:!0,cancelable:!0});B.addEventListener(jw,re=>u?.(re),{once:!0}),gx(B,W),W.defaultPrevented?R.current=!1:v.onClose()}};return V.jsx(M9,{...m,ref:A,disabled:s,onClick:Ht(r.onClick,L),onPointerDown:B=>{r.onPointerDown?.(B),R.current=!0},onPointerUp:Ht(r.onPointerUp,B=>{R.current||B.currentTarget?.click()}),onKeyDown:Ht(r.onKeyDown,B=>{const W=l.searchRef.current!=="";s||W&&B.key===" "||F1.includes(B.key)&&(B.currentTarget.click(),B.preventDefault())})})});x_.displayName=V0;var M9=j.forwardRef((r,n)=>{const{__scopeMenu:s,disabled:u=!1,textValue:m,...x}=r,v=n2(V0,s),l=w9(s),A=j.useRef(null),R=dn(n,A),[L,B]=j.useState(!1),[W,re]=j.useState("");return j.useEffect(()=>{const ce=A.current;ce&&re((ce.textContent??"").trim())},[x.children]),V.jsx(Zg.ItemSlot,{scope:s,disabled:u,textValue:m??W,children:V.jsx(tO,{asChild:!0,...l,focusable:!u,children:V.jsx(Fr.div,{role:"menuitem","data-highlighted":L?"":void 0,"aria-disabled":u||void 0,"data-disabled":u?"":void 0,...x,ref:R,onPointerMove:Ht(r.onPointerMove,Wg(ce=>{u?v.onItemLeave(ce):(v.onItemEnter(ce),ce.defaultPrevented||ce.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Ht(r.onPointerLeave,Wg(ce=>v.onItemLeave(ce))),onFocus:Ht(r.onFocus,()=>B(!0)),onBlur:Ht(r.onBlur,()=>B(!1))})})})}),_O="MenuCheckboxItem",I9=j.forwardRef((r,n)=>{const{checked:s=!1,onCheckedChange:u,...m}=r;return V.jsx(L9,{scope:r.__scopeMenu,checked:s,children:V.jsx(x_,{role:"menuitemcheckbox","aria-checked":U0(s)?"mixed":s,...m,ref:n,"data-state":a2(s),onSelect:Ht(m.onSelect,()=>u?.(U0(s)?!0:!s),{checkForDefaultPrevented:!1})})})});I9.displayName=_O;var A9="MenuRadioGroup",[vO,xO]=Qf(A9,{value:void 0,onValueChange:()=>{}}),k9=j.forwardRef((r,n)=>{const{value:s,onValueChange:u,...m}=r,x=to(u);return V.jsx(vO,{scope:r.__scopeMenu,value:s,onValueChange:x,children:V.jsx(s2,{...m,ref:n})})});k9.displayName=A9;var D9="MenuRadioItem",R9=j.forwardRef((r,n)=>{const{value:s,...u}=r,m=xO(D9,r.__scopeMenu),x=s===m.value;return V.jsx(L9,{scope:r.__scopeMenu,checked:x,children:V.jsx(x_,{role:"menuitemradio","aria-checked":x,...u,ref:n,"data-state":a2(x),onSelect:Ht(u.onSelect,()=>m.onValueChange?.(s),{checkForDefaultPrevented:!1})})})});R9.displayName=D9;var o2="MenuItemIndicator",[L9,bO]=Qf(o2,{checked:!1}),z9=j.forwardRef((r,n)=>{const{__scopeMenu:s,forceMount:u,...m}=r,x=bO(o2,s);return V.jsx(iu,{present:u||U0(x.checked)||x.checked===!0,children:V.jsx(Fr.span,{...m,ref:n,"data-state":a2(x.checked)})})});z9.displayName=o2;var wO="MenuSeparator",F9=j.forwardRef((r,n)=>{const{__scopeMenu:s,...u}=r;return V.jsx(Fr.div,{role:"separator","aria-orientation":"horizontal",...u,ref:n})});F9.displayName=wO;var TO="MenuArrow",O9=j.forwardRef((r,n)=>{const{__scopeMenu:s,...u}=r,m=v_(s);return V.jsx(Lx,{...m,...u,ref:n})});O9.displayName=TO;var SO="MenuSub",[RG,N9]=Qf(SO),yg="MenuSubTrigger",j9=j.forwardRef((r,n)=>{const s=Jf(yg,r.__scopeMenu),u=sy(yg,r.__scopeMenu),m=N9(yg,r.__scopeMenu),x=n2(yg,r.__scopeMenu),v=j.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:A}=x,R={__scopeMenu:r.__scopeMenu},L=j.useCallback(()=>{v.current&&window.clearTimeout(v.current),v.current=null},[]);return j.useEffect(()=>L,[L]),j.useEffect(()=>{const B=l.current;return()=>{window.clearTimeout(B),A(null)}},[l,A]),V.jsx(t2,{asChild:!0,...R,children:V.jsx(M9,{id:m.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":m.contentId,"data-state":U9(s.open),...r,ref:i_(n,m.onTriggerChange),onClick:B=>{r.onClick?.(B),!(r.disabled||B.defaultPrevented)&&(B.currentTarget.focus(),s.open||s.onOpenChange(!0))},onPointerMove:Ht(r.onPointerMove,Wg(B=>{x.onItemEnter(B),!B.defaultPrevented&&!r.disabled&&!s.open&&!v.current&&(x.onPointerGraceIntentChange(null),v.current=window.setTimeout(()=>{s.onOpenChange(!0),L()},100))})),onPointerLeave:Ht(r.onPointerLeave,Wg(B=>{L();const W=s.content?.getBoundingClientRect();if(W){const re=s.content?.dataset.side,ce=re==="right",Q=ce?-5:5,X=W[ce?"left":"right"],le=W[ce?"right":"left"];x.onPointerGraceIntentChange({area:[{x:B.clientX+Q,y:B.clientY},{x:X,y:W.top},{x:le,y:W.top},{x:le,y:W.bottom},{x:X,y:W.bottom}],side:re}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>x.onPointerGraceIntentChange(null),300)}else{if(x.onTriggerLeave(B),B.defaultPrevented)return;x.onPointerGraceIntentChange(null)}})),onKeyDown:Ht(r.onKeyDown,B=>{const W=x.searchRef.current!=="";r.disabled||W&&B.key===" "||iO[u.dir].includes(B.key)&&(s.onOpenChange(!0),s.content?.focus(),B.preventDefault())})})})});j9.displayName=yg;var B9="MenuSubContent",V9=j.forwardRef((r,n)=>{const s=S9(al,r.__scopeMenu),{forceMount:u=s.forceMount,...m}=r,x=Jf(al,r.__scopeMenu),v=sy(al,r.__scopeMenu),l=N9(B9,r.__scopeMenu),A=j.useRef(null),R=dn(n,A);return V.jsx(Zg.Provider,{scope:r.__scopeMenu,children:V.jsx(iu,{present:u||x.open,children:V.jsx(Zg.Slot,{scope:r.__scopeMenu,children:V.jsx(i2,{id:l.contentId,"aria-labelledby":l.triggerId,...m,ref:R,align:"start",side:v.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:L=>{v.isUsingKeyboardRef.current&&A.current?.focus(),L.preventDefault()},onCloseAutoFocus:L=>L.preventDefault(),onFocusOutside:Ht(r.onFocusOutside,L=>{L.target!==l.trigger&&x.onOpenChange(!1)}),onEscapeKeyDown:Ht(r.onEscapeKeyDown,L=>{v.onClose(),L.preventDefault()}),onKeyDown:Ht(r.onKeyDown,L=>{const B=L.currentTarget.contains(L.target),W=sO[v.dir].includes(L.key);B&&W&&(x.onOpenChange(!1),l.trigger?.focus(),L.preventDefault())})})})})})});V9.displayName=B9;function U9(r){return r?"open":"closed"}function U0(r){return r==="indeterminate"}function a2(r){return U0(r)?"indeterminate":r?"checked":"unchecked"}function PO(r){const n=document.activeElement;for(const s of r)if(s===n||(s.focus(),document.activeElement!==n))return}function CO(r,n){return r.map((s,u)=>r[(n+u)%r.length])}function EO(r,n,s){const m=n.length>1&&Array.from(n).every(R=>R===n[0])?n[0]:n,x=s?r.indexOf(s):-1;let v=CO(r,Math.max(x,0));m.length===1&&(v=v.filter(R=>R!==s));const A=v.find(R=>R.toLowerCase().startsWith(m.toLowerCase()));return A!==s?A:void 0}function MO(r,n){const{x:s,y:u}=r;let m=!1;for(let x=0,v=n.length-1;x<n.length;v=x++){const l=n[x].x,A=n[x].y,R=n[v].x,L=n[v].y;A>u!=L>u&&s<(R-l)*(u-A)/(L-A)+l&&(m=!m)}return m}function IO(r,n){if(!n)return!1;const s={x:r.clientX,y:r.clientY};return MO(s,n)}function Wg(r){return n=>n.pointerType==="mouse"?r(n):void 0}var AO=T9,kO=t2,DO=P9,RO=C9,LO=s2,zO=E9,FO=x_,OO=I9,NO=k9,jO=R9,BO=z9,VO=F9,UO=O9,$O=j9,GO=V9,l2="DropdownMenu",[qO]=nu(l2,[b9]),Eo=b9(),[ZO,$9]=qO(l2),G9=r=>{const{__scopeDropdownMenu:n,children:s,dir:u,open:m,defaultOpen:x,onOpenChange:v,modal:l=!0}=r,A=Eo(n),R=j.useRef(null),[L=!1,B]=dm({prop:m,defaultProp:x,onChange:v});return V.jsx(ZO,{scope:n,triggerId:th(),triggerRef:R,contentId:th(),open:L,onOpenChange:B,onOpenToggle:j.useCallback(()=>B(W=>!W),[B]),modal:l,children:V.jsx(AO,{...A,open:L,onOpenChange:B,dir:u,modal:l,children:s})})};G9.displayName=l2;var q9="DropdownMenuTrigger",Z9=j.forwardRef((r,n)=>{const{__scopeDropdownMenu:s,disabled:u=!1,...m}=r,x=$9(q9,s),v=Eo(s);return V.jsx(kO,{asChild:!0,...v,children:V.jsx(Fr.button,{type:"button",id:x.triggerId,"aria-haspopup":"menu","aria-expanded":x.open,"aria-controls":x.open?x.contentId:void 0,"data-state":x.open?"open":"closed","data-disabled":u?"":void 0,disabled:u,...m,ref:i_(n,x.triggerRef),onPointerDown:Ht(r.onPointerDown,l=>{!u&&l.button===0&&l.ctrlKey===!1&&(x.onOpenToggle(),x.open||l.preventDefault())}),onKeyDown:Ht(r.onKeyDown,l=>{u||(["Enter"," "].includes(l.key)&&x.onOpenToggle(),l.key==="ArrowDown"&&x.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});Z9.displayName=q9;var WO="DropdownMenuPortal",W9=r=>{const{__scopeDropdownMenu:n,...s}=r,u=Eo(n);return V.jsx(DO,{...u,...s})};W9.displayName=WO;var H9="DropdownMenuContent",X9=j.forwardRef((r,n)=>{const{__scopeDropdownMenu:s,...u}=r,m=$9(H9,s),x=Eo(s),v=j.useRef(!1);return V.jsx(RO,{id:m.contentId,"aria-labelledby":m.triggerId,...x,...u,ref:n,onCloseAutoFocus:Ht(r.onCloseAutoFocus,l=>{v.current||m.triggerRef.current?.focus(),v.current=!1,l.preventDefault()}),onInteractOutside:Ht(r.onInteractOutside,l=>{const A=l.detail.originalEvent,R=A.button===0&&A.ctrlKey===!0,L=A.button===2||R;(!m.modal||L)&&(v.current=!0)}),style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});X9.displayName=H9;var HO="DropdownMenuGroup",XO=j.forwardRef((r,n)=>{const{__scopeDropdownMenu:s,...u}=r,m=Eo(s);return V.jsx(LO,{...m,...u,ref:n})});XO.displayName=HO;var KO="DropdownMenuLabel",K9=j.forwardRef((r,n)=>{const{__scopeDropdownMenu:s,...u}=r,m=Eo(s);return V.jsx(zO,{...m,...u,ref:n})});K9.displayName=KO;var YO="DropdownMenuItem",Y9=j.forwardRef((r,n)=>{const{__scopeDropdownMenu:s,...u}=r,m=Eo(s);return V.jsx(FO,{...m,...u,ref:n})});Y9.displayName=YO;var QO="DropdownMenuCheckboxItem",Q9=j.forwardRef((r,n)=>{const{__scopeDropdownMenu:s,...u}=r,m=Eo(s);return V.jsx(OO,{...m,...u,ref:n})});Q9.displayName=QO;var JO="DropdownMenuRadioGroup",eN=j.forwardRef((r,n)=>{const{__scopeDropdownMenu:s,...u}=r,m=Eo(s);return V.jsx(NO,{...m,...u,ref:n})});eN.displayName=JO;var tN="DropdownMenuRadioItem",J9=j.forwardRef((r,n)=>{const{__scopeDropdownMenu:s,...u}=r,m=Eo(s);return V.jsx(jO,{...m,...u,ref:n})});J9.displayName=tN;var rN="DropdownMenuItemIndicator",e8=j.forwardRef((r,n)=>{const{__scopeDropdownMenu:s,...u}=r,m=Eo(s);return V.jsx(BO,{...m,...u,ref:n})});e8.displayName=rN;var nN="DropdownMenuSeparator",t8=j.forwardRef((r,n)=>{const{__scopeDropdownMenu:s,...u}=r,m=Eo(s);return V.jsx(VO,{...m,...u,ref:n})});t8.displayName=nN;var iN="DropdownMenuArrow",sN=j.forwardRef((r,n)=>{const{__scopeDropdownMenu:s,...u}=r,m=Eo(s);return V.jsx(UO,{...m,...u,ref:n})});sN.displayName=iN;var oN="DropdownMenuSubTrigger",r8=j.forwardRef((r,n)=>{const{__scopeDropdownMenu:s,...u}=r,m=Eo(s);return V.jsx($O,{...m,...u,ref:n})});r8.displayName=oN;var aN="DropdownMenuSubContent",n8=j.forwardRef((r,n)=>{const{__scopeDropdownMenu:s,...u}=r,m=Eo(s);return V.jsx(GO,{...m,...u,ref:n,style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});n8.displayName=aN;var lN=G9,cN=Z9,uN=W9,i8=X9,s8=K9,o8=Y9,a8=Q9,l8=J9,c8=e8,u8=t8,h8=r8,d8=n8;const hN=lN,dN=cN,fN=j.forwardRef(({className:r,inset:n,children:s,...u},m)=>V.jsxs(h8,{ref:m,className:lr("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",r),...u,children:[s,V.jsx(kM,{className:"ml-auto"})]}));fN.displayName=h8.displayName;const pN=j.forwardRef(({className:r,...n},s)=>V.jsx(d8,{ref:s,className:lr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",r),...n}));pN.displayName=d8.displayName;const f8=j.forwardRef(({className:r,sideOffset:n=4,...s},u)=>V.jsx(uN,{children:V.jsx(i8,{ref:u,sideOffset:n,className:lr("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",r),...s})}));f8.displayName=i8.displayName;const p8=j.forwardRef(({className:r,inset:n,...s},u)=>V.jsx(o8,{ref:u,className:lr("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",r),...s}));p8.displayName=o8.displayName;const mN=j.forwardRef(({className:r,children:n,checked:s,...u},m)=>V.jsxs(a8,{ref:m,className:lr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:s,...u,children:[V.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:V.jsx(c8,{children:V.jsx(h4,{className:"h-4 w-4"})})}),n]}));mN.displayName=a8.displayName;const gN=j.forwardRef(({className:r,children:n,...s},u)=>V.jsxs(l8,{ref:u,className:lr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...s,children:[V.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:V.jsx(c8,{children:V.jsx(RM,{className:"h-2 w-2 fill-current"})})}),n]}));gN.displayName=l8.displayName;const yN=j.forwardRef(({className:r,inset:n,...s},u)=>V.jsx(s8,{ref:u,className:lr("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",r),...s}));yN.displayName=s8.displayName;const _N=j.forwardRef(({className:r,...n},s)=>V.jsx(u8,{ref:s,className:lr("-mx-1 my-1 h-px bg-muted",r),...n}));_N.displayName=u8.displayName;const Kv=[{code:"ru",label:"",flag:""},{code:"tj",label:"",flag:""},{code:"en",label:"English",flag:""}];function vN(){const{language:r,setLanguage:n}=t5(),s=Kv.find(u=>u.code===r)||Kv[0];return V.jsxs(hN,{children:[V.jsx(dN,{asChild:!0,children:V.jsxs(Qo,{variant:"outline",size:"sm",className:"bg-white/90 backdrop-blur-sm border-gray-200 text-black hover:bg-gray-100 gap-2","data-testid":"button-language-switcher",children:[V.jsx(NM,{className:"h-4 w-4"}),V.jsx("span",{className:"hidden sm:inline",children:s.label})]})}),V.jsx(f8,{align:"end",className:"bg-white",children:Kv.map(u=>V.jsxs(p8,{onClick:()=>n(u.code),className:`cursor-pointer text-black ${r===u.code?"bg-gray-100":""}`,"data-testid":`menu-item-lang-${u.code}`,children:[V.jsx("span",{className:"mr-2",children:u.flag}),u.label]},u.code))})]})}const ah={kmz:{icon:IM,color:"text-green-600",bgColor:"bg-green-100",borderColor:"border-green-500",pulseClass:"marker-pulse-kmz",labelRu:" ( )",labelTj:" ( )",labelEn:"CEP (Headquarters)"},branch:{icon:AM,color:"text-gray-500",bgColor:"bg-gray-100",borderColor:"border-gray-400",pulseClass:"marker-pulse-branch",labelRu:"",labelTj:"",labelEn:"Branch offices"},reserve:{icon:XM,color:"text-emerald-600",bgColor:"bg-emerald-100",borderColor:"border-emerald-500",pulseClass:"marker-pulse-reserve",labelRu:"",labelTj:"",labelEn:"Nature reserves"},glacier:{icon:WM,color:"text-cyan-500",bgColor:"bg-cyan-100",borderColor:"border-cyan-400",pulseClass:"marker-pulse-glacier",labelRu:"",labelTj:"",labelEn:"Glaciers"},fishery:{icon:OM,color:"text-blue-500",bgColor:"bg-blue-100",borderColor:"border-blue-400",pulseClass:"marker-pulse-fishery",labelRu:"",labelTj:"",labelEn:"Fish farms"},nursery:{icon:VM,color:"text-lime-600",bgColor:"bg-lime-100",borderColor:"border-lime-500",pulseClass:"marker-pulse-nursery",labelRu:"",labelTj:"",labelEn:"Tree nurseries"}};function O1({locationType:r="kmz",size:n="md",showPulse:s=!1}){const u=ah[r||"kmz"]||ah.kmz,m=u.icon,x={sm:"h-6 w-6",md:"h-8 w-8",lg:"h-10 w-10"},v={sm:"h-3 w-3",md:"h-4 w-4",lg:"h-5 w-5"};return V.jsxs("div",{className:"relative",children:[s&&V.jsx("div",{className:`absolute inset-0 ${u.pulseClass}`}),V.jsx("div",{className:`relative z-10 flex ${x[n]} items-center justify-center rounded-full ${u.bgColor} shadow-lg border-2 ${u.borderColor} transition-transform group-hover:scale-110`,children:V.jsx(m,{className:`${v[n]} ${u.color}`})})]})}function xN(r){return(ah[r||"kmz"]||ah.kmz).pulseClass}function bN(r,n="ru"){const s=ah[r||"kmz"]||ah.kmz;switch(n){case"tj":return s.labelTj;case"en":return s.labelEn;default:return s.labelRu}}const wN={osm:{style:{version:8,sources:{osm:{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:" OpenStreetMap contributors"}},layers:[{id:"osm-layer",type:"raster",source:"osm",minzoom:0,maxzoom:19}]}},minimal:{style:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json"}},TN={longitude:71.2761,latitude:38.861,zoom:6.5,pitch:45,bearing:0},SN={id:"tajikistan-border-line",type:"line",source:"tajikistan-border",paint:{"line-color":"#dc2626","line-width":3,"line-opacity":1}};function PN(){const{data:r,isLoading:n}=z5(),[s,u]=j.useState(null),[m,x]=j.useState(null),[v,l]=j.useState("osm"),[A,R]=j.useState({kmz:!0,branch:!0,reserve:!0,glacier:!0,fishery:!0,nursery:!0}),[L,B]=j.useState(!1),{t:W,language:re}=t5(),ce=le=>{R(he=>({...he,[le]:!he[le]}))},Q=j.useMemo(()=>r?.filter(le=>A[le.locationType||"kmz"])||[],[r,A]),X=j.useMemo(()=>Q.map(le=>V.jsx(Ak,{longitude:le.lng,latitude:le.lat,anchor:"bottom",onClick:he=>{he.originalEvent.stopPropagation(),x(le),u(null)},children:V.jsxs("div",{className:"group relative cursor-pointer",onMouseEnter:()=>u(le),onMouseLeave:()=>u(null),children:[V.jsx("div",{className:`absolute -inset-4 z-0 ${xN(le.locationType)}`}),V.jsx(O1,{locationType:le.locationType,size:"md"})]})},le.id)),[Q]);return n?V.jsx("div",{className:"flex h-screen items-center justify-center bg-black text-white",children:V.jsxs("div",{className:"flex flex-col items-center gap-4",children:[V.jsx(P0,{className:"h-12 w-12 animate-spin text-primary"}),V.jsx("h2",{className:"text-xl font-display tracking-widest",children:W("map.loading")})]})}):V.jsxs("div",{className:"relative h-screen w-full overflow-hidden bg-black",children:[V.jsxs("div",{className:"pointer-events-none absolute left-0 top-0 z-50 flex w-full items-center justify-between p-6 bg-gradient-to-b from-black/80 to-transparent",children:[V.jsxs("div",{className:"pointer-events-auto",children:[V.jsx("h1",{className:"font-display text-4xl font-bold text-white tracking-wider drop-shadow-lg",children:"TAJIKISTAN"}),V.jsx("p",{className:"text-white/60 text-sm font-light tracking-widest mt-1",children:W("map.title")})]}),V.jsx("div",{className:"pointer-events-auto",children:V.jsx(vN,{})})]}),V.jsxs("div",{className:"absolute left-4 top-20 z-50",children:[V.jsxs("button",{onClick:()=>B(!L),className:"flex items-center gap-2 rounded-lg bg-background/90 backdrop-blur-sm px-3 py-2 shadow-lg border border-border hover:bg-muted/50 transition-colors","data-testid":"button-toggle-filters",children:[V.jsx(FM,{className:"h-4 w-4 text-foreground"}),V.jsx("span",{className:"text-sm font-medium text-foreground",children:W("filter.title")}),L?V.jsx(d4,{className:"h-4 w-4 text-muted-foreground"}):V.jsx(bx,{className:"h-4 w-4 text-muted-foreground"})]}),L&&V.jsx("div",{className:"mt-2 rounded-lg bg-background/90 backdrop-blur-sm p-3 shadow-lg border border-border max-w-[220px]",children:V.jsx("div",{className:"space-y-2",children:Object.entries(ah).map(([le,he])=>{const _e=he.icon,Ie=r?.filter(ke=>ke.locationType===le).length||0;return V.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-muted/50 rounded p-1.5 transition-colors","data-testid":`filter-${le}`,children:[V.jsx("input",{type:"checkbox",checked:A[le],onChange:()=>ce(le),className:"h-4 w-4 rounded border-muted-foreground accent-primary cursor-pointer"}),V.jsx("div",{className:`flex h-5 w-5 items-center justify-center rounded-full ${he.bgColor} border ${he.borderColor}`,children:V.jsx(_e,{className:`h-3 w-3 ${he.color}`})}),V.jsx("span",{className:"text-xs text-foreground flex-1 truncate",children:re==="ru"?he.labelRu.split(" (")[0]:re==="tj"?he.labelTj.split(" (")[0]:he.labelEn.split(" (")[0]}),V.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",Ie,")"]})]},le)})})})]}),V.jsxs("div",{className:"absolute right-4 top-24 z-50 flex flex-col gap-1 rounded-lg bg-background/90 backdrop-blur-sm p-1 shadow-lg border border-border",children:[V.jsxs("button",{onClick:()=>l("osm"),className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${v==="osm"?"bg-primary text-primary-foreground":"hover:bg-muted text-foreground"}`,"data-testid":"button-style-osm",children:[V.jsx(p4,{className:"h-4 w-4"}),W("map.colorful")]}),V.jsxs("button",{onClick:()=>l("minimal"),className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${v==="minimal"?"bg-primary text-primary-foreground":"hover:bg-muted text-foreground"}`,"data-testid":"button-style-minimal",children:[V.jsx(BM,{className:"h-4 w-4"}),W("map.minimal")]})]}),V.jsxs(Mk,{initialViewState:TN,style:{width:"100%",height:"100%"},mapStyle:wN[v].style,mapLib:a5,terrain:{source:"terrain",exaggeration:1.5},children:[V.jsx(Ok,{position:"bottom-right"}),V.jsx(Lk,{position:"bottom-right"}),V.jsx(jk,{position:"bottom-left"}),V.jsx(qk,{id:"tajikistan-border",type:"geojson",data:UF,children:V.jsx(Xk,{...SN})}),X,s&&V.jsx(kk,{anchor:"top",longitude:s.lng,latitude:s.lat,closeButton:!1,closeOnClick:!1,offset:40,className:"z-50",children:V.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded shadow-xl border border-border max-w-[280px] overflow-hidden",children:[s.imageUrl&&V.jsx("img",{src:s.imageUrl,alt:s.name,className:"w-full h-32 object-cover"}),V.jsxs("div",{className:"px-3 py-2",children:[V.jsx("p",{className:"font-bold text-sm text-foreground",children:s.name}),s.description&&V.jsx("p",{className:"text-xs text-foreground/80 mt-1 line-clamp-2",children:s.description})]})]})})]}),V.jsx(h9,{open:!!m,onOpenChange:le=>!le&&x(null),children:V.jsxs(Kx,{className:"max-w-3xl bg-background/95 backdrop-blur-xl border-white/10 text-foreground",children:[V.jsx(Yx,{children:V.jsxs("div",{className:"flex items-center gap-3",children:[V.jsx(O1,{locationType:m?.locationType,size:"lg"}),V.jsxs("div",{children:[V.jsx(Qx,{className:"font-display text-3xl tracking-wide",children:m?.name}),V.jsxs(f9,{className:"text-base text-muted-foreground/80",children:[bN(m?.locationType,re)," | ",W("map.coordinates"),": ",m?.lat.toFixed(4)," N, ",m?.lng.toFixed(4)," E"]})]})]})}),V.jsxs("div",{className:"mt-4 space-y-6",children:[m?.imageUrl&&V.jsx("div",{className:"overflow-hidden rounded-lg border border-white/10 shadow-2xl",children:V.jsx("img",{src:(m.imageUrl.startsWith("/objects/"),m.imageUrl),alt:m.name,className:"w-full h-[300px] object-cover hover:scale-105 transition-transform duration-700"})}),m?.videoUrl&&V.jsx("div",{className:"aspect-video w-full overflow-hidden rounded-lg border border-white/10 shadow-2xl bg-black",children:m.videoUrl.includes("youtube")||m.videoUrl.includes("youtu.be")?V.jsx("iframe",{src:m.videoUrl.replace("watch?v=","embed/"),className:"w-full h-full",allowFullScreen:!0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"}):V.jsx("video",{controls:!0,className:"w-full h-full",src:(m.videoUrl.startsWith("/objects/"),m.videoUrl),children:"Your browser does not support the video tag."})}),V.jsxs("div",{className:"prose prose-invert max-w-none",children:[V.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:W("map.description")}),V.jsx("p",{className:"text-base leading-relaxed text-muted-foreground",children:m?.description||W("map.noLocations")})]}),V.jsxs("a",{href:`https://www.google.com/maps/dir/?api=1&destination=${m?.lat},${m?.lng}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full py-3 px-4 bg-primary text-primary-foreground rounded-lg font-medium hover:bg-primary/90 transition-colors","data-testid":"button-route",children:[V.jsx($M,{className:"h-5 w-5"}),re==="ru"?" ":re==="tj"?" ":"Get directions"]})]})]})})]})}async function CN(){return(await fetch("/api/admin/session",{credentials:"include"})).json()}async function EN(){await fetch("/api/admin/logout",{method:"POST",credentials:"include"})}function MN(){const r=Tm(),{data:n,isLoading:s}=z6({queryKey:["/api/admin/session"],queryFn:CN,staleTime:1e3*60*5}),u=n_({mutationFn:EN,onSuccess:()=>{r.setQueryData(["/api/admin/session"],{isAdmin:!1})}});return{isAdmin:n?.isAdmin??!1,user:n?.user,isLoading:s,logout:u.mutate,isLoggingOut:u.isPending}}var oy=r=>r.type==="checkbox",Of=r=>r instanceof Date,Ko=r=>r==null;const m8=r=>typeof r=="object";var ts=r=>!Ko(r)&&!Array.isArray(r)&&m8(r)&&!Of(r),g8=r=>ts(r)&&r.target?oy(r.target)?r.target.checked:r.target.value:r,IN=r=>r.substring(0,r.search(/\.\d+(\.|$)/))||r,y8=(r,n)=>r.has(IN(n)),AN=r=>{const n=r.constructor&&r.constructor.prototype;return ts(n)&&n.hasOwnProperty("isPrototypeOf")},c2=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Qi(r){if(r instanceof Date)return new Date(r);const n=typeof FileList<"u"&&r instanceof FileList;if(c2&&(r instanceof Blob||n))return r;const s=Array.isArray(r);if(!s&&!(ts(r)&&AN(r)))return r;const u=s?[]:Object.create(Object.getPrototypeOf(r));for(const m in r)Object.prototype.hasOwnProperty.call(r,m)&&(u[m]=Qi(r[m]));return u}var b_=r=>/^\w*$/.test(r),ui=r=>r===void 0,u2=r=>Array.isArray(r)?r.filter(Boolean):[],h2=r=>u2(r.replace(/["|']|\]/g,"").split(/\.|\[/)),qt=(r,n,s)=>{if(!n||!ts(r))return s;const u=(b_(n)?[n]:h2(n)).reduce((m,x)=>Ko(m)?m:m[x],r);return ui(u)||u===r?ui(r[n])?s:r[n]:u},Ta=r=>typeof r=="boolean",Po=r=>typeof r=="function",zn=(r,n,s)=>{let u=-1;const m=b_(n)?[n]:h2(n),x=m.length,v=x-1;for(;++u<x;){const l=m[u];let A=s;if(u!==v){const R=r[l];A=ts(R)||Array.isArray(R)?R:isNaN(+m[u+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;r[l]=A,r=r[l]}};const $0={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},nc={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Yu={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},d2=gr.createContext(null);d2.displayName="HookFormControlContext";const f2=()=>gr.useContext(d2);var _8=(r,n,s,u=!0)=>{const m={defaultValues:n._defaultValues};for(const x in r)Object.defineProperty(m,x,{get:()=>{const v=x;return n._proxyFormState[v]!==nc.all&&(n._proxyFormState[v]=!u||nc.all),s&&(s[v]=!0),r[v]}});return m};const p2=typeof window<"u"?gr.useLayoutEffect:gr.useEffect;function kN(r){const n=f2(),{control:s=n,disabled:u,name:m,exact:x}=r||{},[v,l]=gr.useState(s._formState),A=gr.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return p2(()=>s._subscribe({name:m,formState:A.current,exact:x,callback:R=>{!u&&l({...s._formState,...R})}}),[m,u,x]),gr.useEffect(()=>{A.current.isValid&&s._setValid(!0)},[s]),gr.useMemo(()=>_8(v,s,A.current,!1),[v,s])}var Ca=r=>typeof r=="string",N1=(r,n,s,u,m)=>Ca(r)?(u&&n.watch.add(r),qt(s,r,m)):Array.isArray(r)?r.map(x=>(u&&n.watch.add(x),qt(s,x))):(u&&(n.watchAll=!0),s),j1=r=>Ko(r)||!m8(r);function ic(r,n,s=new WeakSet){if(j1(r)||j1(n))return Object.is(r,n);if(Of(r)&&Of(n))return Object.is(r.getTime(),n.getTime());const u=Object.keys(r),m=Object.keys(n);if(u.length!==m.length)return!1;if(s.has(r)||s.has(n))return!0;s.add(r),s.add(n);for(const x of u){const v=r[x];if(!m.includes(x))return!1;if(x!=="ref"){const l=n[x];if(Of(v)&&Of(l)||ts(v)&&ts(l)||Array.isArray(v)&&Array.isArray(l)?!ic(v,l,s):!Object.is(v,l))return!1}}return!0}function DN(r){const n=f2(),{control:s=n,name:u,defaultValue:m,disabled:x,exact:v,compute:l}=r||{},A=gr.useRef(m),R=gr.useRef(l),L=gr.useRef(void 0),B=gr.useRef(s),W=gr.useRef(u);R.current=l;const[re,ce]=gr.useState(()=>{const Ie=s._getWatch(u,A.current);return R.current?R.current(Ie):Ie}),Q=gr.useCallback(Ie=>{const ke=N1(u,s._names,Ie||s._formValues,!1,A.current);return R.current?R.current(ke):ke},[s._formValues,s._names,u]),X=gr.useCallback(Ie=>{if(!x){const ke=N1(u,s._names,Ie||s._formValues,!1,A.current);if(R.current){const Je=R.current(ke);ic(Je,L.current)||(ce(Je),L.current=Je)}else ce(ke)}},[s._formValues,s._names,x,u]);p2(()=>((B.current!==s||!ic(W.current,u))&&(B.current=s,W.current=u,X()),s._subscribe({name:u,formState:{values:!0},exact:v,callback:Ie=>{X(Ie.values)}})),[s,v,u,X]),gr.useEffect(()=>s._removeUnmounted());const le=B.current!==s,he=W.current,_e=gr.useMemo(()=>{if(x)return null;const Ie=!le&&!ic(he,u);return le||Ie?Q():null},[x,le,u,he,Q]);return _e!==null?_e:re}function RN(r){const n=f2(),{name:s,disabled:u,control:m=n,shouldUnregister:x,defaultValue:v,exact:l=!0}=r,A=y8(m._names.array,s),R=gr.useMemo(()=>qt(m._formValues,s,qt(m._defaultValues,s,v)),[m,s,v]),L=DN({control:m,name:s,defaultValue:R,exact:l}),B=kN({control:m,name:s,exact:l}),W=gr.useRef(r),re=gr.useRef(void 0),ce=gr.useRef(m.register(s,{...r.rules,value:L,...Ta(r.disabled)?{disabled:r.disabled}:{}}));W.current=r;const Q=gr.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!qt(B.errors,s)},isDirty:{enumerable:!0,get:()=>!!qt(B.dirtyFields,s)},isTouched:{enumerable:!0,get:()=>!!qt(B.touchedFields,s)},isValidating:{enumerable:!0,get:()=>!!qt(B.validatingFields,s)},error:{enumerable:!0,get:()=>qt(B.errors,s)}}),[B,s]),X=gr.useCallback(Ie=>ce.current.onChange({target:{value:g8(Ie),name:s},type:$0.CHANGE}),[s]),le=gr.useCallback(()=>ce.current.onBlur({target:{value:qt(m._formValues,s),name:s},type:$0.BLUR}),[s,m._formValues]),he=gr.useCallback(Ie=>{const ke=qt(m._fields,s);ke&&ke._f&&Ie&&(ke._f.ref={focus:()=>Po(Ie.focus)&&Ie.focus(),select:()=>Po(Ie.select)&&Ie.select(),setCustomValidity:Je=>Po(Ie.setCustomValidity)&&Ie.setCustomValidity(Je),reportValidity:()=>Po(Ie.reportValidity)&&Ie.reportValidity()})},[m._fields,s]),_e=gr.useMemo(()=>({name:s,value:L,...Ta(u)||B.disabled?{disabled:B.disabled||u}:{},onChange:X,onBlur:le,ref:he}),[s,u,B.disabled,X,le,he,L]);return gr.useEffect(()=>{const Ie=m._options.shouldUnregister||x,ke=re.current;ke&&ke!==s&&!A&&m.unregister(ke),m.register(s,{...W.current.rules,...Ta(W.current.disabled)?{disabled:W.current.disabled}:{}});const Je=(He,nt)=>{const Pt=qt(m._fields,He);Pt&&Pt._f&&(Pt._f.mount=nt)};if(Je(s,!0),Ie){const He=Qi(qt(m._options.defaultValues,s,W.current.defaultValue));zn(m._defaultValues,s,He),ui(qt(m._formValues,s))&&zn(m._formValues,s,He)}return!A&&m.register(s),re.current=s,()=>{(A?Ie&&!m._state.action:Ie)?m.unregister(s):Je(s,!1)}},[s,m,A,x]),gr.useEffect(()=>{m._setDisabledField({disabled:u,name:s})},[u,s,m]),gr.useMemo(()=>({field:_e,formState:B,fieldState:Q}),[_e,B,Q])}const LN=r=>r.render(RN(r)),m2=gr.createContext(null);m2.displayName="HookFormContext";const zN=()=>gr.useContext(m2),FN=r=>{const{children:n,watch:s,getValues:u,getFieldState:m,setError:x,clearErrors:v,setValue:l,trigger:A,formState:R,resetField:L,reset:B,handleSubmit:W,unregister:re,control:ce,register:Q,setFocus:X,subscribe:le}=r;return gr.createElement(m2.Provider,{value:gr.useMemo(()=>({watch:s,getValues:u,getFieldState:m,setError:x,clearErrors:v,setValue:l,trigger:A,formState:R,resetField:L,reset:B,handleSubmit:W,unregister:re,control:ce,register:Q,setFocus:X,subscribe:le}),[v,ce,R,m,u,W,Q,B,L,x,X,l,le,A,re,s])},gr.createElement(d2.Provider,{value:ce},n))};var v8=(r,n,s,u,m)=>n?{...s[r],types:{...s[r]&&s[r].types?s[r].types:{},[u]:m||!0}}:{},wg=r=>Array.isArray(r)?r:[r],Bw=()=>{let r=[];return{get observers(){return r},next:m=>{for(const x of r)x.next&&x.next(m)},subscribe:m=>(r.push(m),{unsubscribe:()=>{r=r.filter(x=>x!==m)}}),unsubscribe:()=>{r=[]}}};function x8(r,n){const s={};for(const u in r)if(r.hasOwnProperty(u)){const m=r[u],x=n[u];if(m&&ts(m)&&x){const v=x8(m,x);ts(v)&&(s[u]=v)}else r[u]&&(s[u]=x)}return s}var So=r=>ts(r)&&!Object.keys(r).length,g2=r=>r.type==="file",G0=r=>{if(!c2)return!1;const n=r?r.ownerDocument:0;return r instanceof(n&&n.defaultView?n.defaultView.HTMLElement:HTMLElement)},b8=r=>r.type==="select-multiple",y2=r=>r.type==="radio",ON=r=>y2(r)||oy(r),Yv=r=>G0(r)&&r.isConnected;function NN(r,n){const s=n.slice(0,-1).length;let u=0;for(;u<s;)r=ui(r)?u++:r[n[u++]];return r}function jN(r){for(const n in r)if(r.hasOwnProperty(n)&&!ui(r[n]))return!1;return!0}function Ji(r,n){const s=Array.isArray(n)?n:b_(n)?[n]:h2(n),u=s.length===1?r:NN(r,s),m=s.length-1,x=s[m];return u&&delete u[x],m!==0&&(ts(u)&&So(u)||Array.isArray(u)&&jN(u))&&Ji(r,s.slice(0,-1)),r}var BN=r=>{for(const n in r)if(Po(r[n]))return!0;return!1};function w8(r){return Array.isArray(r)||ts(r)&&!BN(r)}function B1(r,n={}){for(const s in r){const u=r[s];w8(u)?(n[s]=Array.isArray(u)?[]:{},B1(u,n[s])):ui(u)||(n[s]=!0)}return n}function Wp(r,n,s){s||(s=B1(n));for(const u in r){const m=r[u];if(w8(m))ui(n)||j1(s[u])?s[u]=B1(m,Array.isArray(m)?[]:{}):Wp(m,Ko(n)?{}:n[u],s[u]);else{const x=n[u];s[u]=!ic(m,x)}}return s}const Vw={value:!1,isValid:!1},Uw={value:!0,isValid:!0};var T8=r=>{if(Array.isArray(r)){if(r.length>1){const n=r.filter(s=>s&&s.checked&&!s.disabled).map(s=>s.value);return{value:n,isValid:!!n.length}}return r[0].checked&&!r[0].disabled?r[0].attributes&&!ui(r[0].attributes.value)?ui(r[0].value)||r[0].value===""?Uw:{value:r[0].value,isValid:!0}:Uw:Vw}return Vw},S8=(r,{valueAsNumber:n,valueAsDate:s,setValueAs:u})=>ui(r)?r:n?r===""?NaN:r&&+r:s&&Ca(r)?new Date(r):u?u(r):r;const $w={isValid:!1,value:null};var P8=r=>Array.isArray(r)?r.reduce((n,s)=>s&&s.checked&&!s.disabled?{isValid:!0,value:s.value}:n,$w):$w;function Gw(r){const n=r.ref;return g2(n)?n.files:y2(n)?P8(r.refs).value:b8(n)?[...n.selectedOptions].map(({value:s})=>s):oy(n)?T8(r.refs).value:S8(ui(n.value)?r.ref.value:n.value,r)}var VN=(r,n,s,u)=>{const m={};for(const x of r){const v=qt(n,x);v&&zn(m,x,v._f)}return{criteriaMode:s,names:[...r],fields:m,shouldUseNativeValidation:u}},q0=r=>r instanceof RegExp,dg=r=>ui(r)?r:q0(r)?r.source:ts(r)?q0(r.value)?r.value.source:r.value:r,qw=r=>({isOnSubmit:!r||r===nc.onSubmit,isOnBlur:r===nc.onBlur,isOnChange:r===nc.onChange,isOnAll:r===nc.all,isOnTouch:r===nc.onTouched});const Zw="AsyncFunction";var UN=r=>!!r&&!!r.validate&&!!(Po(r.validate)&&r.validate.constructor.name===Zw||ts(r.validate)&&Object.values(r.validate).find(n=>n.constructor.name===Zw)),$N=r=>r.mount&&(r.required||r.min||r.max||r.maxLength||r.minLength||r.pattern||r.validate),Ww=(r,n,s)=>!s&&(n.watchAll||n.watch.has(r)||[...n.watch].some(u=>r.startsWith(u)&&/^\.\w+/.test(r.slice(u.length))));const Tg=(r,n,s,u)=>{for(const m of s||Object.keys(r)){const x=qt(r,m);if(x){const{_f:v,...l}=x;if(v){if(v.refs&&v.refs[0]&&n(v.refs[0],m)&&!u)return!0;if(v.ref&&n(v.ref,v.name)&&!u)return!0;if(Tg(l,n))break}else if(ts(l)&&Tg(l,n))break}}};function Hw(r,n,s){const u=qt(r,s);if(u||b_(s))return{error:u,name:s};const m=s.split(".");for(;m.length;){const x=m.join("."),v=qt(n,x),l=qt(r,x);if(v&&!Array.isArray(v)&&s!==x)return{name:s};if(l&&l.type)return{name:x,error:l};if(l&&l.root&&l.root.type)return{name:`${x}.root`,error:l.root};m.pop()}return{name:s}}var GN=(r,n,s,u)=>{s(r);const{name:m,...x}=r;return So(x)||Object.keys(x).length>=Object.keys(n).length||Object.keys(x).find(v=>n[v]===(!u||nc.all))},qN=(r,n,s)=>!r||!n||r===n||wg(r).some(u=>u&&(s?u===n:u.startsWith(n)||n.startsWith(u))),ZN=(r,n,s,u,m)=>m.isOnAll?!1:!s&&m.isOnTouch?!(n||r):(s?u.isOnBlur:m.isOnBlur)?!r:(s?u.isOnChange:m.isOnChange)?r:!0,WN=(r,n)=>!u2(qt(r,n)).length&&Ji(r,n),HN=(r,n,s)=>{const u=wg(qt(r,s));return zn(u,"root",n[s]),zn(r,s,u),r};function Xw(r,n,s="validate"){if(Ca(r)||Array.isArray(r)&&r.every(Ca)||Ta(r)&&!r)return{type:s,message:Ca(r)?r:"",ref:n}}var Gp=r=>ts(r)&&!q0(r)?r:{value:r,message:""},Kw=async(r,n,s,u,m,x)=>{const{ref:v,refs:l,required:A,maxLength:R,minLength:L,min:B,max:W,pattern:re,validate:ce,name:Q,valueAsNumber:X,mount:le}=r._f,he=qt(s,Q);if(!le||n.has(Q))return{};const _e=l?l[0]:v,Ie=lt=>{m&&_e.reportValidity&&(_e.setCustomValidity(Ta(lt)?"":lt||""),_e.reportValidity())},ke={},Je=y2(v),He=oy(v),nt=Je||He,Pt=(X||g2(v))&&ui(v.value)&&ui(he)||G0(v)&&v.value===""||he===""||Array.isArray(he)&&!he.length,Ct=v8.bind(null,Q,u,ke),Zt=(lt,Et,ft,gt=Yu.maxLength,dt=Yu.minLength)=>{const mt=lt?Et:ft;ke[Q]={type:lt?gt:dt,message:mt,ref:v,...Ct(lt?gt:dt,mt)}};if(x?!Array.isArray(he)||!he.length:A&&(!nt&&(Pt||Ko(he))||Ta(he)&&!he||He&&!T8(l).isValid||Je&&!P8(l).isValid)){const{value:lt,message:Et}=Ca(A)?{value:!!A,message:A}:Gp(A);if(lt&&(ke[Q]={type:Yu.required,message:Et,ref:_e,...Ct(Yu.required,Et)},!u))return Ie(Et),ke}if(!Pt&&(!Ko(B)||!Ko(W))){let lt,Et;const ft=Gp(W),gt=Gp(B);if(!Ko(he)&&!isNaN(he)){const dt=v.valueAsNumber||he&&+he;Ko(ft.value)||(lt=dt>ft.value),Ko(gt.value)||(Et=dt<gt.value)}else{const dt=v.valueAsDate||new Date(he),mt=_t=>new Date(new Date().toDateString()+" "+_t),Xe=v.type=="time",Be=v.type=="week";Ca(ft.value)&&he&&(lt=Xe?mt(he)>mt(ft.value):Be?he>ft.value:dt>new Date(ft.value)),Ca(gt.value)&&he&&(Et=Xe?mt(he)<mt(gt.value):Be?he<gt.value:dt<new Date(gt.value))}if((lt||Et)&&(Zt(!!lt,ft.message,gt.message,Yu.max,Yu.min),!u))return Ie(ke[Q].message),ke}if((R||L)&&!Pt&&(Ca(he)||x&&Array.isArray(he))){const lt=Gp(R),Et=Gp(L),ft=!Ko(lt.value)&&he.length>+lt.value,gt=!Ko(Et.value)&&he.length<+Et.value;if((ft||gt)&&(Zt(ft,lt.message,Et.message),!u))return Ie(ke[Q].message),ke}if(re&&!Pt&&Ca(he)){const{value:lt,message:Et}=Gp(re);if(q0(lt)&&!he.match(lt)&&(ke[Q]={type:Yu.pattern,message:Et,ref:v,...Ct(Yu.pattern,Et)},!u))return Ie(Et),ke}if(ce){if(Po(ce)){const lt=await ce(he,s),Et=Xw(lt,_e);if(Et&&(ke[Q]={...Et,...Ct(Yu.validate,Et.message)},!u))return Ie(Et.message),ke}else if(ts(ce)){let lt={};for(const Et in ce){if(!So(lt)&&!u)break;const ft=Xw(await ce[Et](he,s),_e,Et);ft&&(lt={...ft,...Ct(Et,ft.message)},Ie(ft.message),u&&(ke[Q]=lt))}if(!So(lt)&&(ke[Q]={ref:_e,...lt},!u))return ke}}return Ie(!0),ke};const XN={mode:nc.onSubmit,reValidateMode:nc.onChange,shouldFocusError:!0};function KN(r={}){let n={...XN,...r},s={submitCount:0,isDirty:!1,isReady:!1,isLoading:Po(n.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1},u={},m=ts(n.defaultValues)||ts(n.values)?Qi(n.defaultValues||n.values)||{}:{},x=n.shouldUnregister?{}:Qi(m),v={action:!1,mount:!1,watch:!1,keepIsValid:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},A,R=0;const L={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},B={...L};let W={...B};const re={array:Bw(),state:Bw()},ce=n.criteriaMode===nc.all,Q=Ae=>Ue=>{clearTimeout(R),R=setTimeout(Ae,Ue)},X=async Ae=>{if(!v.keepIsValid&&!n.disabled&&(B.isValid||W.isValid||Ae)){let Ue;n.resolver?(Ue=So((await nt()).errors),le()):Ue=await Ct(u,!0),Ue!==s.isValid&&re.state.next({isValid:Ue})}},le=(Ae,Ue)=>{!n.disabled&&(B.isValidating||B.validatingFields||W.isValidating||W.validatingFields)&&((Ae||Array.from(l.mount)).forEach(it=>{it&&(Ue?zn(s.validatingFields,it,Ue):Ji(s.validatingFields,it))}),re.state.next({validatingFields:s.validatingFields,isValidating:!So(s.validatingFields)}))},he=(Ae,Ue=[],it,Vt,Mt=!0,xe=!0)=>{if(Vt&&it&&!n.disabled){if(v.action=!0,xe&&Array.isArray(qt(u,Ae))){const ee=it(qt(u,Ae),Vt.argA,Vt.argB);Mt&&zn(u,Ae,ee)}if(xe&&Array.isArray(qt(s.errors,Ae))){const ee=it(qt(s.errors,Ae),Vt.argA,Vt.argB);Mt&&zn(s.errors,Ae,ee),WN(s.errors,Ae)}if((B.touchedFields||W.touchedFields)&&xe&&Array.isArray(qt(s.touchedFields,Ae))){const ee=it(qt(s.touchedFields,Ae),Vt.argA,Vt.argB);Mt&&zn(s.touchedFields,Ae,ee)}(B.dirtyFields||W.dirtyFields)&&(s.dirtyFields=Wp(m,x)),re.state.next({name:Ae,isDirty:lt(Ae,Ue),dirtyFields:s.dirtyFields,errors:s.errors,isValid:s.isValid})}else zn(x,Ae,Ue)},_e=(Ae,Ue)=>{zn(s.errors,Ae,Ue),re.state.next({errors:s.errors})},Ie=Ae=>{s.errors=Ae,re.state.next({errors:s.errors,isValid:!1})},ke=(Ae,Ue,it,Vt)=>{const Mt=qt(u,Ae);if(Mt){const xe=qt(x,Ae,ui(it)?qt(m,Ae):it);ui(xe)||Vt&&Vt.defaultChecked||Ue?zn(x,Ae,Ue?xe:Gw(Mt._f)):gt(Ae,xe),v.mount&&!v.action&&X()}},Je=(Ae,Ue,it,Vt,Mt)=>{let xe=!1,ee=!1;const te={name:Ae};if(!n.disabled){if(!it||Vt){(B.isDirty||W.isDirty)&&(ee=s.isDirty,s.isDirty=te.isDirty=lt(),xe=ee!==te.isDirty);const oe=ic(qt(m,Ae),Ue);ee=!!qt(s.dirtyFields,Ae),oe?Ji(s.dirtyFields,Ae):zn(s.dirtyFields,Ae,!0),te.dirtyFields=s.dirtyFields,xe=xe||(B.dirtyFields||W.dirtyFields)&&ee!==!oe}if(it){const oe=qt(s.touchedFields,Ae);oe||(zn(s.touchedFields,Ae,it),te.touchedFields=s.touchedFields,xe=xe||(B.touchedFields||W.touchedFields)&&oe!==it)}xe&&Mt&&re.state.next(te)}return xe?te:{}},He=(Ae,Ue,it,Vt)=>{const Mt=qt(s.errors,Ae),xe=(B.isValid||W.isValid)&&Ta(Ue)&&s.isValid!==Ue;if(n.delayError&&it?(A=Q(()=>_e(Ae,it)),A(n.delayError)):(clearTimeout(R),A=null,it?zn(s.errors,Ae,it):Ji(s.errors,Ae)),(it?!ic(Mt,it):Mt)||!So(Vt)||xe){const ee={...Vt,...xe&&Ta(Ue)?{isValid:Ue}:{},errors:s.errors,name:Ae};s={...s,...ee},re.state.next(ee)}},nt=async Ae=>(le(Ae,!0),await n.resolver(x,n.context,VN(Ae||l.mount,u,n.criteriaMode,n.shouldUseNativeValidation))),Pt=async Ae=>{const{errors:Ue}=await nt(Ae);if(le(Ae),Ae)for(const it of Ae){const Vt=qt(Ue,it);Vt?zn(s.errors,it,Vt):Ji(s.errors,it)}else s.errors=Ue;return Ue},Ct=async(Ae,Ue,it={valid:!0})=>{for(const Vt in Ae){const Mt=Ae[Vt];if(Mt){const{_f:xe,...ee}=Mt;if(xe){const te=l.array.has(xe.name),oe=Mt._f&&UN(Mt._f);oe&&B.validatingFields&&le([xe.name],!0);const we=await Kw(Mt,l.disabled,x,ce,n.shouldUseNativeValidation&&!Ue,te);if(oe&&B.validatingFields&&le([xe.name]),we[xe.name]&&(it.valid=!1,Ue||r.shouldUseNativeValidation))break;!Ue&&(qt(we,xe.name)?te?HN(s.errors,we,xe.name):zn(s.errors,xe.name,we[xe.name]):Ji(s.errors,xe.name))}!So(ee)&&await Ct(ee,Ue,it)}}return it.valid},Zt=()=>{for(const Ae of l.unMount){const Ue=qt(u,Ae);Ue&&(Ue._f.refs?Ue._f.refs.every(it=>!Yv(it)):!Yv(Ue._f.ref))&&Gt(Ae)}l.unMount=new Set},lt=(Ae,Ue)=>!n.disabled&&(Ae&&Ue&&zn(x,Ae,Ue),!ic(Re(),m)),Et=(Ae,Ue,it)=>N1(Ae,l,{...v.mount?x:ui(Ue)?m:Ca(Ae)?{[Ae]:Ue}:Ue},it,Ue),ft=Ae=>u2(qt(v.mount?x:m,Ae,n.shouldUnregister?qt(m,Ae,[]):[])),gt=(Ae,Ue,it={})=>{const Vt=qt(u,Ae);let Mt=Ue;if(Vt){const xe=Vt._f;xe&&(!xe.disabled&&zn(x,Ae,S8(Ue,xe)),Mt=G0(xe.ref)&&Ko(Ue)?"":Ue,b8(xe.ref)?[...xe.ref.options].forEach(ee=>ee.selected=Mt.includes(ee.value)):xe.refs?oy(xe.ref)?xe.refs.forEach(ee=>{(!ee.defaultChecked||!ee.disabled)&&(Array.isArray(Mt)?ee.checked=!!Mt.find(te=>te===ee.value):ee.checked=Mt===ee.value||!!Mt)}):xe.refs.forEach(ee=>ee.checked=ee.value===Mt):g2(xe.ref)?xe.ref.value="":(xe.ref.value=Mt,xe.ref.type||re.state.next({name:Ae,values:Qi(x)})))}(it.shouldDirty||it.shouldTouch)&&Je(Ae,Mt,it.shouldTouch,it.shouldDirty,!0),it.shouldValidate&&_t(Ae)},dt=(Ae,Ue,it)=>{for(const Vt in Ue){if(!Ue.hasOwnProperty(Vt))return;const Mt=Ue[Vt],xe=Ae+"."+Vt,ee=qt(u,xe);(l.array.has(Ae)||ts(Mt)||ee&&!ee._f)&&!Of(Mt)?dt(xe,Mt,it):gt(xe,Mt,it)}},mt=(Ae,Ue,it={})=>{const Vt=qt(u,Ae),Mt=l.array.has(Ae),xe=Qi(Ue);zn(x,Ae,xe),Mt?(re.array.next({name:Ae,values:Qi(x)}),(B.isDirty||B.dirtyFields||W.isDirty||W.dirtyFields)&&it.shouldDirty&&re.state.next({name:Ae,dirtyFields:Wp(m,x),isDirty:lt(Ae,xe)})):Vt&&!Vt._f&&!Ko(xe)?dt(Ae,xe,it):gt(Ae,xe,it),Ww(Ae,l)?re.state.next({...s,name:Ae,values:Qi(x)}):re.state.next({name:v.mount?Ae:void 0,values:Qi(x)})},Xe=async Ae=>{v.mount=!0;const Ue=Ae.target;let it=Ue.name,Vt=!0;const Mt=qt(u,it),xe=oe=>{Vt=Number.isNaN(oe)||Of(oe)&&isNaN(oe.getTime())||ic(oe,qt(x,it,oe))},ee=qw(n.mode),te=qw(n.reValidateMode);if(Mt){let oe,we;const Ee=Ue.type?Gw(Mt._f):g8(Ae),Ne=Ae.type===$0.BLUR||Ae.type===$0.FOCUS_OUT,Oe=!$N(Mt._f)&&!n.resolver&&!qt(s.errors,it)&&!Mt._f.deps||ZN(Ne,qt(s.touchedFields,it),s.isSubmitted,te,ee),De=Ww(it,l,Ne);zn(x,it,Ee),Ne?(!Ue||!Ue.readOnly)&&(Mt._f.onBlur&&Mt._f.onBlur(Ae),A&&A(0)):Mt._f.onChange&&Mt._f.onChange(Ae);const Ze=Je(it,Ee,Ne),ut=!So(Ze)||De;if(!Ne&&re.state.next({name:it,type:Ae.type,values:Qi(x)}),Oe)return(B.isValid||W.isValid)&&(n.mode==="onBlur"?Ne&&X():Ne||X()),ut&&re.state.next({name:it,...De?{}:Ze});if(!Ne&&De&&re.state.next({...s}),n.resolver){const{errors:st}=await nt([it]);if(le([it]),xe(Ee),Vt){const Ot=Hw(s.errors,u,it),$t=Hw(st,u,Ot.name||it);oe=$t.error,it=$t.name,we=So(st)}}else le([it],!0),oe=(await Kw(Mt,l.disabled,x,ce,n.shouldUseNativeValidation))[it],le([it]),xe(Ee),Vt&&(oe?we=!1:(B.isValid||W.isValid)&&(we=await Ct(u,!0)));Vt&&(Mt._f.deps&&(!Array.isArray(Mt._f.deps)||Mt._f.deps.length>0)&&_t(Mt._f.deps),He(it,we,oe,Ze))}},Be=(Ae,Ue)=>{if(qt(s.errors,Ue)&&Ae.focus)return Ae.focus(),1},_t=async(Ae,Ue={})=>{let it,Vt;const Mt=wg(Ae);if(n.resolver){const xe=await Pt(ui(Ae)?Ae:Mt);it=So(xe),Vt=Ae?!Mt.some(ee=>qt(xe,ee)):it}else Ae?(Vt=(await Promise.all(Mt.map(async xe=>{const ee=qt(u,xe);return await Ct(ee&&ee._f?{[xe]:ee}:ee)}))).every(Boolean),!(!Vt&&!s.isValid)&&X()):Vt=it=await Ct(u);return re.state.next({...!Ca(Ae)||(B.isValid||W.isValid)&&it!==s.isValid?{}:{name:Ae},...n.resolver||!Ae?{isValid:it}:{},errors:s.errors}),Ue.shouldFocus&&!Vt&&Tg(u,Be,Ae?Mt:l.mount),Vt},Re=(Ae,Ue)=>{let it={...v.mount?x:m};return Ue&&(it=x8(Ue.dirtyFields?s.dirtyFields:s.touchedFields,it)),ui(Ae)?it:Ca(Ae)?qt(it,Ae):Ae.map(Vt=>qt(it,Vt))},at=(Ae,Ue)=>({invalid:!!qt((Ue||s).errors,Ae),isDirty:!!qt((Ue||s).dirtyFields,Ae),error:qt((Ue||s).errors,Ae),isValidating:!!qt(s.validatingFields,Ae),isTouched:!!qt((Ue||s).touchedFields,Ae)}),nr=Ae=>{Ae&&wg(Ae).forEach(Ue=>Ji(s.errors,Ue)),re.state.next({errors:Ae?s.errors:{}})},er=(Ae,Ue,it)=>{const Vt=(qt(u,Ae,{_f:{}})._f||{}).ref,Mt=qt(s.errors,Ae)||{},{ref:xe,message:ee,type:te,...oe}=Mt;zn(s.errors,Ae,{...oe,...Ue,ref:Vt}),re.state.next({name:Ae,errors:s.errors,isValid:!1}),it&&it.shouldFocus&&Vt&&Vt.focus&&Vt.focus()},ir=(Ae,Ue)=>Po(Ae)?re.state.subscribe({next:it=>"values"in it&&Ae(Et(void 0,Ue),it)}):Et(Ae,Ue,!0),sr=Ae=>re.state.subscribe({next:Ue=>{qN(Ae.name,Ue.name,Ae.exact)&&GN(Ue,Ae.formState||B,io,Ae.reRenderRoot)&&Ae.callback({values:{...x},...s,...Ue,defaultValues:m})}}).unsubscribe,St=Ae=>(v.mount=!0,W={...W,...Ae.formState},sr({...Ae,formState:{...L,...Ae.formState}})),Gt=(Ae,Ue={})=>{for(const it of Ae?wg(Ae):l.mount)l.mount.delete(it),l.array.delete(it),Ue.keepValue||(Ji(u,it),Ji(x,it)),!Ue.keepError&&Ji(s.errors,it),!Ue.keepDirty&&Ji(s.dirtyFields,it),!Ue.keepTouched&&Ji(s.touchedFields,it),!Ue.keepIsValidating&&Ji(s.validatingFields,it),!n.shouldUnregister&&!Ue.keepDefaultValue&&Ji(m,it);re.state.next({values:Qi(x)}),re.state.next({...s,...Ue.keepDirty?{isDirty:lt()}:{}}),!Ue.keepIsValid&&X()},yr=({disabled:Ae,name:Ue})=>{if(Ta(Ae)&&v.mount||Ae||l.disabled.has(Ue)){const Mt=l.disabled.has(Ue)!==!!Ae;Ae?l.disabled.add(Ue):l.disabled.delete(Ue),Mt&&v.mount&&!v.action&&X()}},cr=(Ae,Ue={})=>{let it=qt(u,Ae);const Vt=Ta(Ue.disabled)||Ta(n.disabled);return zn(u,Ae,{...it||{},_f:{...it&&it._f?it._f:{ref:{name:Ae}},name:Ae,mount:!0,...Ue}}),l.mount.add(Ae),it?yr({disabled:Ta(Ue.disabled)?Ue.disabled:n.disabled,name:Ae}):ke(Ae,!0,Ue.value),{...Vt?{disabled:Ue.disabled||n.disabled}:{},...n.progressive?{required:!!Ue.required,min:dg(Ue.min),max:dg(Ue.max),minLength:dg(Ue.minLength),maxLength:dg(Ue.maxLength),pattern:dg(Ue.pattern)}:{},name:Ae,onChange:Xe,onBlur:Xe,ref:Mt=>{if(Mt){cr(Ae,Ue),it=qt(u,Ae);const xe=ui(Mt.value)&&Mt.querySelectorAll&&Mt.querySelectorAll("input,select,textarea")[0]||Mt,ee=ON(xe),te=it._f.refs||[];if(ee?te.find(oe=>oe===xe):xe===it._f.ref)return;zn(u,Ae,{_f:{...it._f,...ee?{refs:[...te.filter(Yv),xe,...Array.isArray(qt(m,Ae))?[{}]:[]],ref:{type:xe.type,name:Ae}}:{ref:xe}}}),ke(Ae,!1,void 0,xe)}else it=qt(u,Ae,{}),it._f&&(it._f.mount=!1),(n.shouldUnregister||Ue.shouldUnregister)&&!(y8(l.array,Ae)&&v.action)&&l.unMount.add(Ae)}}},Lr=()=>n.shouldFocusError&&Tg(u,Be,l.mount),jr=Ae=>{Ta(Ae)&&(re.state.next({disabled:Ae}),Tg(u,(Ue,it)=>{const Vt=qt(u,it);Vt&&(Ue.disabled=Vt._f.disabled||Ae,Array.isArray(Vt._f.refs)&&Vt._f.refs.forEach(Mt=>{Mt.disabled=Vt._f.disabled||Ae}))},0,!1))},Fn=(Ae,Ue)=>async it=>{let Vt;it&&(it.preventDefault&&it.preventDefault(),it.persist&&it.persist());let Mt=Qi(x);if(re.state.next({isSubmitting:!0}),n.resolver){const{errors:xe,values:ee}=await nt();le(),s.errors=xe,Mt=Qi(ee)}else await Ct(u);if(l.disabled.size)for(const xe of l.disabled)Ji(Mt,xe);if(Ji(s.errors,"root"),So(s.errors)){re.state.next({errors:{}});try{await Ae(Mt,it)}catch(xe){Vt=xe}}else Ue&&await Ue({...s.errors},it),Lr(),setTimeout(Lr);if(re.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:So(s.errors)&&!Vt,submitCount:s.submitCount+1,errors:s.errors}),Vt)throw Vt},en=(Ae,Ue={})=>{qt(u,Ae)&&(ui(Ue.defaultValue)?mt(Ae,Qi(qt(m,Ae))):(mt(Ae,Ue.defaultValue),zn(m,Ae,Qi(Ue.defaultValue))),Ue.keepTouched||Ji(s.touchedFields,Ae),Ue.keepDirty||(Ji(s.dirtyFields,Ae),s.isDirty=Ue.defaultValue?lt(Ae,Qi(qt(m,Ae))):lt()),Ue.keepError||(Ji(s.errors,Ae),B.isValid&&X()),re.state.next({...s}))},ni=(Ae,Ue={})=>{const it=Ae?Qi(Ae):m,Vt=Qi(it),Mt=So(Ae),xe=Mt?m:Vt;if(Ue.keepDefaultValues||(m=it),!Ue.keepValues){if(Ue.keepDirtyValues){const ee=new Set([...l.mount,...Object.keys(Wp(m,x))]);for(const te of Array.from(ee)){const oe=qt(s.dirtyFields,te),we=qt(x,te),Ee=qt(xe,te);oe&&!ui(we)?zn(xe,te,we):!oe&&!ui(Ee)&&mt(te,Ee)}}else{if(c2&&ui(Ae))for(const ee of l.mount){const te=qt(u,ee);if(te&&te._f){const oe=Array.isArray(te._f.refs)?te._f.refs[0]:te._f.ref;if(G0(oe)){const we=oe.closest("form");if(we){we.reset();break}}}}if(Ue.keepFieldsRef)for(const ee of l.mount)mt(ee,qt(xe,ee));else u={}}x=n.shouldUnregister?Ue.keepDefaultValues?Qi(m):{}:Qi(xe),re.array.next({values:{...xe}}),re.state.next({values:{...xe}})}l={mount:Ue.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},v.mount=!B.isValid||!!Ue.keepIsValid||!!Ue.keepDirtyValues||!n.shouldUnregister&&!So(xe),v.watch=!!n.shouldUnregister,v.keepIsValid=!!Ue.keepIsValid,v.action=!1,Ue.keepErrors||(s.errors={}),re.state.next({submitCount:Ue.keepSubmitCount?s.submitCount:0,isDirty:Mt?!1:Ue.keepDirty?s.isDirty:!!(Ue.keepDefaultValues&&!ic(Ae,m)),isSubmitted:Ue.keepIsSubmitted?s.isSubmitted:!1,dirtyFields:Mt?{}:Ue.keepDirtyValues?Ue.keepDefaultValues&&x?Wp(m,x):s.dirtyFields:Ue.keepDefaultValues&&Ae?Wp(m,Ae):Ue.keepDirty?s.dirtyFields:{},touchedFields:Ue.keepTouched?s.touchedFields:{},errors:Ue.keepErrors?s.errors:{},isSubmitSuccessful:Ue.keepIsSubmitSuccessful?s.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:m})},vi=(Ae,Ue)=>ni(Po(Ae)?Ae(x):Ae,{...n.resetOptions,...Ue}),Xr=(Ae,Ue={})=>{const it=qt(u,Ae),Vt=it&&it._f;if(Vt){const Mt=Vt.refs?Vt.refs[0]:Vt.ref;Mt.focus&&setTimeout(()=>{Mt.focus(),Ue.shouldSelect&&Po(Mt.select)&&Mt.select()})}},io=Ae=>{s={...s,...Ae}},Ms={control:{register:cr,unregister:Gt,getFieldState:at,handleSubmit:Fn,setError:er,_subscribe:sr,_runSchema:nt,_updateIsValidating:le,_focusError:Lr,_getWatch:Et,_getDirty:lt,_setValid:X,_setFieldArray:he,_setDisabledField:yr,_setErrors:Ie,_getFieldArray:ft,_reset:ni,_resetDefaultValues:()=>Po(n.defaultValues)&&n.defaultValues().then(Ae=>{vi(Ae,n.resetOptions),re.state.next({isLoading:!1})}),_removeUnmounted:Zt,_disableForm:jr,_subjects:re,_proxyFormState:B,get _fields(){return u},get _formValues(){return x},get _state(){return v},set _state(Ae){v=Ae},get _defaultValues(){return m},get _names(){return l},set _names(Ae){l=Ae},get _formState(){return s},get _options(){return n},set _options(Ae){n={...n,...Ae}}},subscribe:St,trigger:_t,register:cr,handleSubmit:Fn,watch:ir,setValue:mt,getValues:Re,reset:vi,resetField:en,clearErrors:nr,unregister:Gt,setError:er,setFocus:Xr,getFieldState:at};return{...Ms,formControl:Ms}}function YN(r={}){const n=gr.useRef(void 0),s=gr.useRef(void 0),[u,m]=gr.useState({isDirty:!1,isValidating:!1,isLoading:Po(r.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1,isReady:!1,defaultValues:Po(r.defaultValues)?void 0:r.defaultValues});if(!n.current)if(r.formControl)n.current={...r.formControl,formState:u},r.defaultValues&&!Po(r.defaultValues)&&r.formControl.reset(r.defaultValues,r.resetOptions);else{const{formControl:v,...l}=KN(r);n.current={...l,formState:u}}const x=n.current.control;return x._options=r,p2(()=>{const v=x._subscribe({formState:x._proxyFormState,callback:()=>m({...x._formState}),reRenderRoot:!0});return m(l=>({...l,isReady:!0})),x._formState.isReady=!0,v},[x]),gr.useEffect(()=>x._disableForm(r.disabled),[x,r.disabled]),gr.useEffect(()=>{r.mode&&(x._options.mode=r.mode),r.reValidateMode&&(x._options.reValidateMode=r.reValidateMode)},[x,r.mode,r.reValidateMode]),gr.useEffect(()=>{r.errors&&(x._setErrors(r.errors),x._focusError())},[x,r.errors]),gr.useEffect(()=>{r.shouldUnregister&&x._subjects.state.next({values:x._getWatch()})},[x,r.shouldUnregister]),gr.useEffect(()=>{if(x._proxyFormState.isDirty){const v=x._getDirty();v!==u.isDirty&&x._subjects.state.next({isDirty:v})}},[x,u.isDirty]),gr.useEffect(()=>{var v;r.values&&!ic(r.values,s.current)?(x._reset(r.values,{keepFieldsRef:!0,...x._options.resetOptions}),!((v=x._options.resetOptions)===null||v===void 0)&&v.keepIsValid||x._setValid(),s.current=r.values,m(l=>({...l}))):x._resetDefaultValues()},[x,r.values]),gr.useEffect(()=>{x._state.mount||(x._setValid(),x._state.mount=!0),x._state.watch&&(x._state.watch=!1,x._subjects.state.next({...x._formState})),x._removeUnmounted()}),n.current.formState=gr.useMemo(()=>_8(u,x),[x,u]),n.current}const Yw=(r,n,s)=>{if(r&&"reportValidity"in r){const u=qt(s,n);r.setCustomValidity(u&&u.message||""),r.reportValidity()}},C8=(r,n)=>{for(const s in n.fields){const u=n.fields[s];u&&u.ref&&"reportValidity"in u.ref?Yw(u.ref,s,r):u.refs&&u.refs.forEach(m=>Yw(m,s,r))}},QN=(r,n)=>{n.shouldUseNativeValidation&&C8(r,n);const s={};for(const u in r){const m=qt(n.fields,u),x=Object.assign(r[u]||{},{ref:m&&m.ref});if(JN(n.names||Object.keys(r),u)){const v=Object.assign({},qt(s,u));zn(v,"root",x),zn(s,u,v)}else zn(s,u,x)}return s},JN=(r,n)=>r.some(s=>s.startsWith(n+"."));var ej=function(r,n){for(var s={};r.length;){var u=r[0],m=u.code,x=u.message,v=u.path.join(".");if(!s[v])if("unionErrors"in u){var l=u.unionErrors[0].errors[0];s[v]={message:l.message,type:l.code}}else s[v]={message:x,type:m};if("unionErrors"in u&&u.unionErrors.forEach(function(L){return L.errors.forEach(function(B){return r.push(B)})}),n){var A=s[v].types,R=A&&A[u.code];s[v]=v8(v,n,s,m,R?[].concat(R,u.message):u.message)}r.shift()}return s},tj=function(r,n,s){return s===void 0&&(s={}),function(u,m,x){try{return Promise.resolve((function(v,l){try{var A=Promise.resolve(r[s.mode==="sync"?"parse":"parseAsync"](u,n)).then(function(R){return x.shouldUseNativeValidation&&C8({},x),{errors:{},values:s.raw?u:R}})}catch(R){return l(R)}return A&&A.then?A.then(void 0,l):A})(0,function(v){if((function(l){return Array.isArray(l?.errors)})(v))return{values:{},errors:QN(ej(v.errors,!x.shouldUseNativeValidation&&x.criteriaMode==="all"),x)};throw v}))}catch(v){return Promise.reject(v)}}},rj="Label",E8=j.forwardRef((r,n)=>V.jsx(Fr.label,{...r,ref:n,onMouseDown:s=>{s.target.closest("button, input, select, textarea")||(r.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));E8.displayName=rj;var M8=E8;const nj=xx("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Z0=j.forwardRef(({className:r,...n},s)=>V.jsx(M8,{ref:s,className:lr(nj(),r),...n}));Z0.displayName=M8.displayName;const ij=FN,I8=j.createContext({}),fg=({...r})=>V.jsx(I8.Provider,{value:{name:r.name},children:V.jsx(LN,{...r})}),w_=()=>{const r=j.useContext(I8),n=j.useContext(A8),{getFieldState:s,formState:u}=zN(),m=s(r.name,u);if(!r)throw new Error("useFormField should be used within <FormField>");const{id:x}=n;return{id:x,name:r.name,formItemId:`${x}-form-item`,formDescriptionId:`${x}-form-item-description`,formMessageId:`${x}-form-item-message`,...m}},A8=j.createContext({}),Hp=j.forwardRef(({className:r,...n},s)=>{const u=j.useId();return V.jsx(A8.Provider,{value:{id:u},children:V.jsx("div",{ref:s,className:lr("space-y-2",r),...n})})});Hp.displayName="FormItem";const bd=j.forwardRef(({className:r,...n},s)=>{const{error:u,formItemId:m}=w_();return V.jsx(Z0,{ref:s,className:lr(u&&"text-destructive",r),htmlFor:m,...n})});bd.displayName="FormLabel";const Xp=j.forwardRef(({...r},n)=>{const{error:s,formItemId:u,formDescriptionId:m,formMessageId:x}=w_();return V.jsx(O6,{ref:n,id:u,"aria-describedby":s?`${m} ${x}`:`${m}`,"aria-invalid":!!s,...r})});Xp.displayName="FormControl";const sj=j.forwardRef(({className:r,...n},s)=>{const{formDescriptionId:u}=w_();return V.jsx("p",{ref:s,id:u,className:lr("text-sm text-muted-foreground",r),...n})});sj.displayName="FormDescription";const Kp=j.forwardRef(({className:r,children:n,...s},u)=>{const{error:m,formMessageId:x}=w_(),v=m?String(m?.message??""):n;return v?V.jsx("p",{ref:u,id:x,className:lr("text-sm font-medium text-destructive",r),...s,children:v}):null});Kp.displayName="FormMessage";const Bf=j.forwardRef(({className:r,type:n,...s},u)=>V.jsx("input",{type:n,className:lr("flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:u,...s}));Bf.displayName="Input";const k8=j.forwardRef(({className:r,...n},s)=>V.jsx("textarea",{className:lr("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...n}));k8.displayName="Textarea";function Qw(r,[n,s]){return Math.min(s,Math.max(n,r))}function oj(r){const n=j.useRef({value:r,previous:r});return j.useMemo(()=>(n.current.value!==r&&(n.current.previous=n.current.value,n.current.value=r),n.current.previous),[r])}var aj=[" ","Enter","ArrowUp","ArrowDown"],lj=[" ","Enter"],ay="Select",[T_,S_,cj]=s_(ay),[Am]=nu(ay,[cj,Mm]),P_=Mm(),[uj,zd]=Am(ay),[hj,dj]=Am(ay),D8=r=>{const{__scopeSelect:n,children:s,open:u,defaultOpen:m,onOpenChange:x,value:v,defaultValue:l,onValueChange:A,dir:R,name:L,autoComplete:B,disabled:W,required:re,form:ce}=r,Q=P_(n),[X,le]=j.useState(null),[he,_e]=j.useState(null),[Ie,ke]=j.useState(!1),Je=e2(R),[He=!1,nt]=dm({prop:u,defaultProp:m,onChange:x}),[Pt,Ct]=dm({prop:v,defaultProp:l,onChange:A}),Zt=j.useRef(null),lt=X?ce||!!X.closest("form"):!0,[Et,ft]=j.useState(new Set),gt=Array.from(Et).map(dt=>dt.props.value).join(";");return V.jsx(q4,{...Q,children:V.jsxs(uj,{required:re,scope:n,trigger:X,onTriggerChange:le,valueNode:he,onValueNodeChange:_e,valueNodeHasChildren:Ie,onValueNodeHasChildrenChange:ke,contentId:th(),value:Pt,onValueChange:Ct,open:He,onOpenChange:nt,dir:Je,triggerPointerDownPosRef:Zt,disabled:W,children:[V.jsx(T_.Provider,{scope:n,children:V.jsx(hj,{scope:r.__scopeSelect,onNativeOptionAdd:j.useCallback(dt=>{ft(mt=>new Set(mt).add(dt))},[]),onNativeOptionRemove:j.useCallback(dt=>{ft(mt=>{const Xe=new Set(mt);return Xe.delete(dt),Xe})},[]),children:s})}),lt?V.jsxs(nT,{"aria-hidden":!0,required:re,tabIndex:-1,name:L,autoComplete:B,value:Pt,onChange:dt=>Ct(dt.target.value),disabled:W,form:ce,children:[Pt===void 0?V.jsx("option",{value:""}):null,Array.from(Et)]},gt):null]})})};D8.displayName=ay;var R8="SelectTrigger",L8=j.forwardRef((r,n)=>{const{__scopeSelect:s,disabled:u=!1,...m}=r,x=P_(s),v=zd(R8,s),l=v.disabled||u,A=dn(n,v.onTriggerChange),R=S_(s),L=j.useRef("touch"),[B,W,re]=iT(Q=>{const X=R().filter(_e=>!_e.disabled),le=X.find(_e=>_e.value===v.value),he=sT(X,Q,le);he!==void 0&&v.onValueChange(he.value)}),ce=Q=>{l||(v.onOpenChange(!0),re()),Q&&(v.triggerPointerDownPosRef.current={x:Math.round(Q.pageX),y:Math.round(Q.pageY)})};return V.jsx(Dx,{asChild:!0,...x,children:V.jsx(Fr.button,{type:"button",role:"combobox","aria-controls":v.contentId,"aria-expanded":v.open,"aria-required":v.required,"aria-autocomplete":"none",dir:v.dir,"data-state":v.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":rT(v.value)?"":void 0,...m,ref:A,onClick:Ht(m.onClick,Q=>{Q.currentTarget.focus(),L.current!=="mouse"&&ce(Q)}),onPointerDown:Ht(m.onPointerDown,Q=>{L.current=Q.pointerType;const X=Q.target;X.hasPointerCapture(Q.pointerId)&&X.releasePointerCapture(Q.pointerId),Q.button===0&&Q.ctrlKey===!1&&Q.pointerType==="mouse"&&(ce(Q),Q.preventDefault())}),onKeyDown:Ht(m.onKeyDown,Q=>{const X=B.current!=="";!(Q.ctrlKey||Q.altKey||Q.metaKey)&&Q.key.length===1&&W(Q.key),!(X&&Q.key===" ")&&aj.includes(Q.key)&&(ce(),Q.preventDefault())})})})});L8.displayName=R8;var z8="SelectValue",F8=j.forwardRef((r,n)=>{const{__scopeSelect:s,className:u,style:m,children:x,placeholder:v="",...l}=r,A=zd(z8,s),{onValueNodeHasChildrenChange:R}=A,L=x!==void 0,B=dn(n,A.onValueNodeChange);return ro(()=>{R(L)},[R,L]),V.jsx(Fr.span,{...l,ref:B,style:{pointerEvents:"none"},children:rT(A.value)?V.jsx(V.Fragment,{children:v}):x})});F8.displayName=z8;var fj="SelectIcon",O8=j.forwardRef((r,n)=>{const{__scopeSelect:s,children:u,...m}=r;return V.jsx(Fr.span,{"aria-hidden":!0,...m,ref:n,children:u||""})});O8.displayName=fj;var pj="SelectPortal",N8=r=>V.jsx(Jg,{asChild:!0,...r});N8.displayName=pj;var Kf="SelectContent",j8=j.forwardRef((r,n)=>{const s=zd(Kf,r.__scopeSelect),[u,m]=j.useState();if(ro(()=>{m(new DocumentFragment)},[]),!s.open){const x=u;return x?Ld.createPortal(V.jsx(B8,{scope:r.__scopeSelect,children:V.jsx(T_.Slot,{scope:r.__scopeSelect,children:V.jsx("div",{children:r.children})})}),x):null}return V.jsx(V8,{...r,ref:n})});j8.displayName=Kf;var Jl=10,[B8,Fd]=Am(Kf),mj="SelectContentImpl",gj=Gf("SelectContent.RemoveScroll"),V8=j.forwardRef((r,n)=>{const{__scopeSelect:s,position:u="item-aligned",onCloseAutoFocus:m,onEscapeKeyDown:x,onPointerDownOutside:v,side:l,sideOffset:A,align:R,alignOffset:L,arrowPadding:B,collisionBoundary:W,collisionPadding:re,sticky:ce,hideWhenDetached:Q,avoidCollisions:X,...le}=r,he=zd(Kf,s),[_e,Ie]=j.useState(null),[ke,Je]=j.useState(null),He=dn(n,St=>Ie(St)),[nt,Pt]=j.useState(null),[Ct,Zt]=j.useState(null),lt=S_(s),[Et,ft]=j.useState(!1),gt=j.useRef(!1);j.useEffect(()=>{if(_e)return Bx(_e)},[_e]),jx();const dt=j.useCallback(St=>{const[Gt,...yr]=lt().map(jr=>jr.ref.current),[cr]=yr.slice(-1),Lr=document.activeElement;for(const jr of St)if(jr===Lr||(jr?.scrollIntoView({block:"nearest"}),jr===Gt&&ke&&(ke.scrollTop=0),jr===cr&&ke&&(ke.scrollTop=ke.scrollHeight),jr?.focus(),document.activeElement!==Lr))return},[lt,ke]),mt=j.useCallback(()=>dt([nt,_e]),[dt,nt,_e]);j.useEffect(()=>{Et&&mt()},[Et,mt]);const{onOpenChange:Xe,triggerPointerDownPosRef:Be}=he;j.useEffect(()=>{if(_e){let St={x:0,y:0};const Gt=cr=>{St={x:Math.abs(Math.round(cr.pageX)-(Be.current?.x??0)),y:Math.abs(Math.round(cr.pageY)-(Be.current?.y??0))}},yr=cr=>{St.x<=10&&St.y<=10?cr.preventDefault():_e.contains(cr.target)||Xe(!1),document.removeEventListener("pointermove",Gt),Be.current=null};return Be.current!==null&&(document.addEventListener("pointermove",Gt),document.addEventListener("pointerup",yr,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Gt),document.removeEventListener("pointerup",yr,{capture:!0})}}},[_e,Xe,Be]),j.useEffect(()=>{const St=()=>Xe(!1);return window.addEventListener("blur",St),window.addEventListener("resize",St),()=>{window.removeEventListener("blur",St),window.removeEventListener("resize",St)}},[Xe]);const[_t,Re]=iT(St=>{const Gt=lt().filter(Lr=>!Lr.disabled),yr=Gt.find(Lr=>Lr.ref.current===document.activeElement),cr=sT(Gt,St,yr);cr&&setTimeout(()=>cr.ref.current.focus())}),at=j.useCallback((St,Gt,yr)=>{const cr=!gt.current&&!yr;(he.value!==void 0&&he.value===Gt||cr)&&(Pt(St),cr&&(gt.current=!0))},[he.value]),nr=j.useCallback(()=>_e?.focus(),[_e]),er=j.useCallback((St,Gt,yr)=>{const cr=!gt.current&&!yr;(he.value!==void 0&&he.value===Gt||cr)&&Zt(St)},[he.value]),ir=u==="popper"?V1:U8,sr=ir===V1?{side:l,sideOffset:A,align:R,alignOffset:L,arrowPadding:B,collisionBoundary:W,collisionPadding:re,sticky:ce,hideWhenDetached:Q,avoidCollisions:X}:{};return V.jsx(B8,{scope:s,content:_e,viewport:ke,onViewportChange:Je,itemRefCallback:at,selectedItem:nt,onItemLeave:nr,itemTextRefCallback:er,focusSelectedItem:mt,selectedItemText:Ct,position:u,isPositioned:Et,searchRef:_t,children:V.jsx(y_,{as:gj,allowPinchZoom:!0,children:V.jsx(m_,{asChild:!0,trapped:he.open,onMountAutoFocus:St=>{St.preventDefault()},onUnmountAutoFocus:Ht(m,St=>{he.trigger?.focus({preventScroll:!0}),St.preventDefault()}),children:V.jsx(Sm,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:x,onPointerDownOutside:v,onFocusOutside:St=>St.preventDefault(),onDismiss:()=>he.onOpenChange(!1),children:V.jsx(ir,{role:"listbox",id:he.contentId,"data-state":he.open?"open":"closed",dir:he.dir,onContextMenu:St=>St.preventDefault(),...le,...sr,onPlaced:()=>ft(!0),ref:He,style:{display:"flex",flexDirection:"column",outline:"none",...le.style},onKeyDown:Ht(le.onKeyDown,St=>{const Gt=St.ctrlKey||St.altKey||St.metaKey;if(St.key==="Tab"&&St.preventDefault(),!Gt&&St.key.length===1&&Re(St.key),["ArrowUp","ArrowDown","Home","End"].includes(St.key)){let cr=lt().filter(Lr=>!Lr.disabled).map(Lr=>Lr.ref.current);if(["ArrowUp","End"].includes(St.key)&&(cr=cr.slice().reverse()),["ArrowUp","ArrowDown"].includes(St.key)){const Lr=St.target,jr=cr.indexOf(Lr);cr=cr.slice(jr+1)}setTimeout(()=>dt(cr)),St.preventDefault()}})})})})})})});V8.displayName=mj;var yj="SelectItemAlignedPosition",U8=j.forwardRef((r,n)=>{const{__scopeSelect:s,onPlaced:u,...m}=r,x=zd(Kf,s),v=Fd(Kf,s),[l,A]=j.useState(null),[R,L]=j.useState(null),B=dn(n,He=>L(He)),W=S_(s),re=j.useRef(!1),ce=j.useRef(!0),{viewport:Q,selectedItem:X,selectedItemText:le,focusSelectedItem:he}=v,_e=j.useCallback(()=>{if(x.trigger&&x.valueNode&&l&&R&&Q&&X&&le){const He=x.trigger.getBoundingClientRect(),nt=R.getBoundingClientRect(),Pt=x.valueNode.getBoundingClientRect(),Ct=le.getBoundingClientRect();if(x.dir!=="rtl"){const Lr=Ct.left-nt.left,jr=Pt.left-Lr,Fn=He.left-jr,en=He.width+Fn,ni=Math.max(en,nt.width),vi=window.innerWidth-Jl,Xr=Qw(jr,[Jl,Math.max(Jl,vi-ni)]);l.style.minWidth=en+"px",l.style.left=Xr+"px"}else{const Lr=nt.right-Ct.right,jr=window.innerWidth-Pt.right-Lr,Fn=window.innerWidth-He.right-jr,en=He.width+Fn,ni=Math.max(en,nt.width),vi=window.innerWidth-Jl,Xr=Qw(jr,[Jl,Math.max(Jl,vi-ni)]);l.style.minWidth=en+"px",l.style.right=Xr+"px"}const Zt=W(),lt=window.innerHeight-Jl*2,Et=Q.scrollHeight,ft=window.getComputedStyle(R),gt=parseInt(ft.borderTopWidth,10),dt=parseInt(ft.paddingTop,10),mt=parseInt(ft.borderBottomWidth,10),Xe=parseInt(ft.paddingBottom,10),Be=gt+dt+Et+Xe+mt,_t=Math.min(X.offsetHeight*5,Be),Re=window.getComputedStyle(Q),at=parseInt(Re.paddingTop,10),nr=parseInt(Re.paddingBottom,10),er=He.top+He.height/2-Jl,ir=lt-er,sr=X.offsetHeight/2,St=X.offsetTop+sr,Gt=gt+dt+St,yr=Be-Gt;if(Gt<=er){const Lr=Zt.length>0&&X===Zt[Zt.length-1].ref.current;l.style.bottom="0px";const jr=R.clientHeight-Q.offsetTop-Q.offsetHeight,Fn=Math.max(ir,sr+(Lr?nr:0)+jr+mt),en=Gt+Fn;l.style.height=en+"px"}else{const Lr=Zt.length>0&&X===Zt[0].ref.current;l.style.top="0px";const Fn=Math.max(er,gt+Q.offsetTop+(Lr?at:0)+sr)+yr;l.style.height=Fn+"px",Q.scrollTop=Gt-er+Q.offsetTop}l.style.margin=`${Jl}px 0`,l.style.minHeight=_t+"px",l.style.maxHeight=lt+"px",u?.(),requestAnimationFrame(()=>re.current=!0)}},[W,x.trigger,x.valueNode,l,R,Q,X,le,x.dir,u]);ro(()=>_e(),[_e]);const[Ie,ke]=j.useState();ro(()=>{R&&ke(window.getComputedStyle(R).zIndex)},[R]);const Je=j.useCallback(He=>{He&&ce.current===!0&&(_e(),he?.(),ce.current=!1)},[_e,he]);return V.jsx(vj,{scope:s,contentWrapper:l,shouldExpandOnScrollRef:re,onScrollButtonChange:Je,children:V.jsx("div",{ref:A,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:Ie},children:V.jsx(Fr.div,{...m,ref:B,style:{boxSizing:"border-box",maxHeight:"100%",...m.style}})})})});U8.displayName=yj;var _j="SelectPopperPosition",V1=j.forwardRef((r,n)=>{const{__scopeSelect:s,align:u="start",collisionPadding:m=Jl,...x}=r,v=P_(s);return V.jsx(Rx,{...v,...x,ref:n,align:u,collisionPadding:m,style:{boxSizing:"border-box",...x.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});V1.displayName=_j;var[vj,_2]=Am(Kf,{}),U1="SelectViewport",$8=j.forwardRef((r,n)=>{const{__scopeSelect:s,nonce:u,...m}=r,x=Fd(U1,s),v=_2(U1,s),l=dn(n,x.onViewportChange),A=j.useRef(0);return V.jsxs(V.Fragment,{children:[V.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:u}),V.jsx(T_.Slot,{scope:s,children:V.jsx(Fr.div,{"data-radix-select-viewport":"",role:"presentation",...m,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...m.style},onScroll:Ht(m.onScroll,R=>{const L=R.currentTarget,{contentWrapper:B,shouldExpandOnScrollRef:W}=v;if(W?.current&&B){const re=Math.abs(A.current-L.scrollTop);if(re>0){const ce=window.innerHeight-Jl*2,Q=parseFloat(B.style.minHeight),X=parseFloat(B.style.height),le=Math.max(Q,X);if(le<ce){const he=le+re,_e=Math.min(ce,he),Ie=he-_e;B.style.height=_e+"px",B.style.bottom==="0px"&&(L.scrollTop=Ie>0?Ie:0,B.style.justifyContent="flex-end")}}}A.current=L.scrollTop})})})]})});$8.displayName=U1;var G8="SelectGroup",[xj,bj]=Am(G8),wj=j.forwardRef((r,n)=>{const{__scopeSelect:s,...u}=r,m=th();return V.jsx(xj,{scope:s,id:m,children:V.jsx(Fr.div,{role:"group","aria-labelledby":m,...u,ref:n})})});wj.displayName=G8;var q8="SelectLabel",Z8=j.forwardRef((r,n)=>{const{__scopeSelect:s,...u}=r,m=bj(q8,s);return V.jsx(Fr.div,{id:m.id,...u,ref:n})});Z8.displayName=q8;var W0="SelectItem",[Tj,W8]=Am(W0),H8=j.forwardRef((r,n)=>{const{__scopeSelect:s,value:u,disabled:m=!1,textValue:x,...v}=r,l=zd(W0,s),A=Fd(W0,s),R=l.value===u,[L,B]=j.useState(x??""),[W,re]=j.useState(!1),ce=dn(n,he=>A.itemRefCallback?.(he,u,m)),Q=th(),X=j.useRef("touch"),le=()=>{m||(l.onValueChange(u),l.onOpenChange(!1))};if(u==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return V.jsx(Tj,{scope:s,value:u,disabled:m,textId:Q,isSelected:R,onItemTextChange:j.useCallback(he=>{B(_e=>_e||(he?.textContent??"").trim())},[]),children:V.jsx(T_.ItemSlot,{scope:s,value:u,disabled:m,textValue:L,children:V.jsx(Fr.div,{role:"option","aria-labelledby":Q,"data-highlighted":W?"":void 0,"aria-selected":R&&W,"data-state":R?"checked":"unchecked","aria-disabled":m||void 0,"data-disabled":m?"":void 0,tabIndex:m?void 0:-1,...v,ref:ce,onFocus:Ht(v.onFocus,()=>re(!0)),onBlur:Ht(v.onBlur,()=>re(!1)),onClick:Ht(v.onClick,()=>{X.current!=="mouse"&&le()}),onPointerUp:Ht(v.onPointerUp,()=>{X.current==="mouse"&&le()}),onPointerDown:Ht(v.onPointerDown,he=>{X.current=he.pointerType}),onPointerMove:Ht(v.onPointerMove,he=>{X.current=he.pointerType,m?A.onItemLeave?.():X.current==="mouse"&&he.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ht(v.onPointerLeave,he=>{he.currentTarget===document.activeElement&&A.onItemLeave?.()}),onKeyDown:Ht(v.onKeyDown,he=>{A.searchRef?.current!==""&&he.key===" "||(lj.includes(he.key)&&le(),he.key===" "&&he.preventDefault())})})})})});H8.displayName=W0;var _g="SelectItemText",X8=j.forwardRef((r,n)=>{const{__scopeSelect:s,className:u,style:m,...x}=r,v=zd(_g,s),l=Fd(_g,s),A=W8(_g,s),R=dj(_g,s),[L,B]=j.useState(null),W=dn(n,le=>B(le),A.onItemTextChange,le=>l.itemTextRefCallback?.(le,A.value,A.disabled)),re=L?.textContent,ce=j.useMemo(()=>V.jsx("option",{value:A.value,disabled:A.disabled,children:re},A.value),[A.disabled,A.value,re]),{onNativeOptionAdd:Q,onNativeOptionRemove:X}=R;return ro(()=>(Q(ce),()=>X(ce)),[Q,X,ce]),V.jsxs(V.Fragment,{children:[V.jsx(Fr.span,{id:A.textId,...x,ref:W}),A.isSelected&&v.valueNode&&!v.valueNodeHasChildren?Ld.createPortal(x.children,v.valueNode):null]})});X8.displayName=_g;var K8="SelectItemIndicator",Y8=j.forwardRef((r,n)=>{const{__scopeSelect:s,...u}=r;return W8(K8,s).isSelected?V.jsx(Fr.span,{"aria-hidden":!0,...u,ref:n}):null});Y8.displayName=K8;var $1="SelectScrollUpButton",Q8=j.forwardRef((r,n)=>{const s=Fd($1,r.__scopeSelect),u=_2($1,r.__scopeSelect),[m,x]=j.useState(!1),v=dn(n,u.onScrollButtonChange);return ro(()=>{if(s.viewport&&s.isPositioned){let l=function(){const R=A.scrollTop>0;x(R)};const A=s.viewport;return l(),A.addEventListener("scroll",l),()=>A.removeEventListener("scroll",l)}},[s.viewport,s.isPositioned]),m?V.jsx(eT,{...r,ref:v,onAutoScroll:()=>{const{viewport:l,selectedItem:A}=s;l&&A&&(l.scrollTop=l.scrollTop-A.offsetHeight)}}):null});Q8.displayName=$1;var G1="SelectScrollDownButton",J8=j.forwardRef((r,n)=>{const s=Fd(G1,r.__scopeSelect),u=_2(G1,r.__scopeSelect),[m,x]=j.useState(!1),v=dn(n,u.onScrollButtonChange);return ro(()=>{if(s.viewport&&s.isPositioned){let l=function(){const R=A.scrollHeight-A.clientHeight,L=Math.ceil(A.scrollTop)<R;x(L)};const A=s.viewport;return l(),A.addEventListener("scroll",l),()=>A.removeEventListener("scroll",l)}},[s.viewport,s.isPositioned]),m?V.jsx(eT,{...r,ref:v,onAutoScroll:()=>{const{viewport:l,selectedItem:A}=s;l&&A&&(l.scrollTop=l.scrollTop+A.offsetHeight)}}):null});J8.displayName=G1;var eT=j.forwardRef((r,n)=>{const{__scopeSelect:s,onAutoScroll:u,...m}=r,x=Fd("SelectScrollButton",s),v=j.useRef(null),l=S_(s),A=j.useCallback(()=>{v.current!==null&&(window.clearInterval(v.current),v.current=null)},[]);return j.useEffect(()=>()=>A(),[A]),ro(()=>{l().find(L=>L.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[l]),V.jsx(Fr.div,{"aria-hidden":!0,...m,ref:n,style:{flexShrink:0,...m.style},onPointerDown:Ht(m.onPointerDown,()=>{v.current===null&&(v.current=window.setInterval(u,50))}),onPointerMove:Ht(m.onPointerMove,()=>{x.onItemLeave?.(),v.current===null&&(v.current=window.setInterval(u,50))}),onPointerLeave:Ht(m.onPointerLeave,()=>{A()})})}),Sj="SelectSeparator",tT=j.forwardRef((r,n)=>{const{__scopeSelect:s,...u}=r;return V.jsx(Fr.div,{"aria-hidden":!0,...u,ref:n})});tT.displayName=Sj;var q1="SelectArrow",Pj=j.forwardRef((r,n)=>{const{__scopeSelect:s,...u}=r,m=P_(s),x=zd(q1,s),v=Fd(q1,s);return x.open&&v.position==="popper"?V.jsx(Lx,{...m,...u,ref:n}):null});Pj.displayName=q1;function rT(r){return r===""||r===void 0}var nT=j.forwardRef((r,n)=>{const{value:s,...u}=r,m=j.useRef(null),x=dn(n,m),v=oj(s);return j.useEffect(()=>{const l=m.current,A=window.HTMLSelectElement.prototype,L=Object.getOwnPropertyDescriptor(A,"value").set;if(v!==s&&L){const B=new Event("change",{bubbles:!0});L.call(l,s),l.dispatchEvent(B)}},[v,s]),V.jsx(ey,{asChild:!0,children:V.jsx("select",{...u,ref:x,defaultValue:s})})});nT.displayName="BubbleSelect";function iT(r){const n=to(r),s=j.useRef(""),u=j.useRef(0),m=j.useCallback(v=>{const l=s.current+v;n(l),(function A(R){s.current=R,window.clearTimeout(u.current),R!==""&&(u.current=window.setTimeout(()=>A(""),1e3))})(l)},[n]),x=j.useCallback(()=>{s.current="",window.clearTimeout(u.current)},[]);return j.useEffect(()=>()=>window.clearTimeout(u.current),[]),[s,m,x]}function sT(r,n,s){const m=n.length>1&&Array.from(n).every(R=>R===n[0])?n[0]:n,x=s?r.indexOf(s):-1;let v=Cj(r,Math.max(x,0));m.length===1&&(v=v.filter(R=>R!==s));const A=v.find(R=>R.textValue.toLowerCase().startsWith(m.toLowerCase()));return A!==s?A:void 0}function Cj(r,n){return r.map((s,u)=>r[(n+u)%r.length])}var Ej=D8,oT=L8,Mj=F8,Ij=O8,Aj=N8,aT=j8,kj=$8,lT=Z8,cT=H8,Dj=X8,Rj=Y8,uT=Q8,hT=J8,dT=tT;const Lj=Ej,zj=Mj,fT=j.forwardRef(({className:r,children:n,...s},u)=>V.jsxs(oT,{ref:u,className:lr("flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...s,children:[n,V.jsx(Ij,{asChild:!0,children:V.jsx(bx,{className:"h-4 w-4 opacity-50"})})]}));fT.displayName=oT.displayName;const pT=j.forwardRef(({className:r,...n},s)=>V.jsx(uT,{ref:s,className:lr("flex cursor-default items-center justify-center py-1",r),...n,children:V.jsx(d4,{className:"h-4 w-4"})}));pT.displayName=uT.displayName;const mT=j.forwardRef(({className:r,...n},s)=>V.jsx(hT,{ref:s,className:lr("flex cursor-default items-center justify-center py-1",r),...n,children:V.jsx(bx,{className:"h-4 w-4"})}));mT.displayName=hT.displayName;const gT=j.forwardRef(({className:r,children:n,position:s="popper",...u},m)=>V.jsx(Aj,{children:V.jsxs(aT,{ref:m,className:lr("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:s,...u,children:[V.jsx(pT,{}),V.jsx(kj,{className:lr("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),V.jsx(mT,{})]})}));gT.displayName=aT.displayName;const Fj=j.forwardRef(({className:r,...n},s)=>V.jsx(lT,{ref:s,className:lr("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...n}));Fj.displayName=lT.displayName;const yT=j.forwardRef(({className:r,children:n,...s},u)=>V.jsxs(cT,{ref:u,className:lr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...s,children:[V.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:V.jsx(Rj,{children:V.jsx(h4,{className:"h-4 w-4"})})}),V.jsx(Dj,{children:n})]}));yT.displayName=cT.displayName;const Oj=j.forwardRef(({className:r,...n},s)=>V.jsx(dT,{ref:s,className:lr("-mx-1 my-1 h-px bg-muted",r),...n}));Oj.displayName=dT.displayName;function Nj({location:r,onSuccess:n}){const{toast:s}=mx(),u=zz(),m=Fz(),[x,v]=j.useState(null),[l,A]=j.useState(null),[R,L]=j.useState(r?.imageUrl||null),[B,W]=j.useState(r?.videoUrl||null),[re,ce]=j.useState(!1),[Q,X]=j.useState(!1),[le,he]=j.useState(!1),_e=j.useRef(null),Ie=j.useRef(null),ke=!!r,Je=YN({resolver:tj(R5),defaultValues:{name:r?.name??"",description:r?.description??"",lat:r?.lat??38.861,lng:r?.lng??71.2761,imageUrl:r?.imageUrl??"",videoUrl:r?.videoUrl??"",locationType:r?.locationType??"kmz"}}),He=async gt=>{const dt=new FormData;dt.append("file",gt);const mt=await fetch("/api/upload",{method:"POST",body:dt});if(!mt.ok){const Be=await mt.json().catch(()=>({}));throw new Error(Be.error||"   ")}const{url:Xe}=await mt.json();return Xe},nt=gt=>{const dt=gt.target.files?.[0];dt&&(v(dt),L(URL.createObjectURL(dt)))},Pt=gt=>{const dt=gt.target.files?.[0];dt&&(A(dt),W(URL.createObjectURL(dt)))},Ct=()=>{v(null),L(null),Je.setValue("imageUrl",""),_e.current&&(_e.current.value="")},Zt=()=>{A(null),W(null),Je.setValue("videoUrl",""),Ie.current&&(Ie.current.value="")},lt=()=>{if(!navigator.geolocation){s({title:"",description:"    ",variant:"destructive"});return}he(!0),navigator.geolocation.getCurrentPosition(gt=>{Je.setValue("lat",gt.coords.latitude),Je.setValue("lng",gt.coords.longitude),he(!1),s({title:"",description:" "})},gt=>{he(!1);let dt="   ";gt.code===gt.PERMISSION_DENIED?dt="   ":gt.code===gt.POSITION_UNAVAILABLE?dt="   ":gt.code===gt.TIMEOUT&&(dt="  "),s({title:"",description:dt,variant:"destructive"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},Et=async gt=>{try{let dt=gt.imageUrl,mt=gt.videoUrl;x&&(ce(!0),dt=await He(x),ce(!1)),l&&(X(!0),mt=await He(l),X(!1));const Xe={...gt,imageUrl:dt,videoUrl:mt};ke&&r?(await m.mutateAsync({id:r.id,...Xe}),s({title:"",description:" "})):(await u.mutateAsync(Xe),s({title:"",description:" "})),n?.()}catch(dt){ce(!1),X(!1),s({title:"",description:dt instanceof Error?dt.message:"-   ",variant:"destructive"})}},ft=u.isPending||m.isPending||re||Q;return V.jsx(ij,{...Je,children:V.jsxs("form",{onSubmit:Je.handleSubmit(Et),className:"space-y-4",children:[V.jsx(fg,{control:Je.control,name:"name",render:({field:gt})=>V.jsxs(Hp,{children:[V.jsx(bd,{className:"text-black",children:""}),V.jsx(Xp,{children:V.jsx(Bf,{placeholder:" ",...gt,className:"bg-white border-gray-300 text-black placeholder:text-gray-400"})}),V.jsx(Kp,{})]})}),V.jsx(fg,{control:Je.control,name:"locationType",render:({field:gt})=>V.jsxs(Hp,{children:[V.jsx(bd,{className:"text-black",children:" "}),V.jsxs(Lj,{onValueChange:gt.onChange,value:gt.value||"kmz",children:[V.jsx(Xp,{children:V.jsx(fT,{className:"bg-white border-gray-300 text-black","data-testid":"select-location-type",children:V.jsx(zj,{placeholder:" "})})}),V.jsx(gT,{children:Object.entries(ah).map(([dt,mt])=>{const Xe=mt.icon;return V.jsx(yT,{value:dt,"data-testid":`option-type-${dt}`,children:V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx(Xe,{className:`h-4 w-4 ${mt.color}`}),V.jsx("span",{children:mt.labelRu})]})},dt)})})]}),V.jsx(Kp,{})]})}),V.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[V.jsx(fg,{control:Je.control,name:"lat",render:({field:gt})=>V.jsxs(Hp,{children:[V.jsx(bd,{className:"text-black",children:""}),V.jsx(Xp,{children:V.jsx(Bf,{type:"number",step:"any",placeholder:"38.8610",...gt,onChange:dt=>gt.onChange(parseFloat(dt.target.value)),className:"bg-white border-gray-300 text-black placeholder:text-gray-400"})}),V.jsx(Kp,{})]})}),V.jsx(fg,{control:Je.control,name:"lng",render:({field:gt})=>V.jsxs(Hp,{children:[V.jsx(bd,{className:"text-black",children:""}),V.jsx(Xp,{children:V.jsx(Bf,{type:"number",step:"any",placeholder:"71.2761",...gt,onChange:dt=>gt.onChange(parseFloat(dt.target.value)),className:"bg-white border-gray-300 text-black placeholder:text-gray-400"})}),V.jsx(Kp,{})]})})]}),V.jsxs(Qo,{type:"button",variant:"outline",onClick:lt,disabled:le,className:"w-full","data-testid":"button-get-location",children:[le?V.jsx(P0,{className:"h-4 w-4 mr-2 animate-spin"}):V.jsx(f4,{className:"h-4 w-4 mr-2"}),"  "]}),V.jsx(fg,{control:Je.control,name:"description",render:({field:gt})=>V.jsxs(Hp,{children:[V.jsx(bd,{className:"text-black",children:""}),V.jsx(Xp,{children:V.jsx(k8,{placeholder:"  ...",className:"resize-none bg-white border-gray-300 text-black placeholder:text-gray-400",...gt,value:gt.value||""})}),V.jsx(Kp,{})]})}),V.jsxs("div",{className:"space-y-2",children:[V.jsx(bd,{className:"text-black",children:""}),V.jsx("input",{ref:_e,type:"file",accept:"image/*",onChange:nt,className:"hidden"}),R?V.jsxs("div",{className:"relative",children:[V.jsx("img",{src:R,alt:"",className:"w-full h-32 object-cover rounded-lg border border-gray-300"}),V.jsx(Qo,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 h-6 w-6",onClick:Ct,children:V.jsx(C0,{className:"h-4 w-4"})})]}):V.jsx(Qo,{type:"button",variant:"outline",className:"w-full h-24 border-dashed border-gray-300 bg-white text-gray-600 hover:bg-gray-50",onClick:()=>_e.current?.click(),children:V.jsxs("div",{className:"flex flex-col items-center gap-2",children:[V.jsx(jM,{className:"h-6 w-6"}),V.jsx("span",{children:" "})]})})]}),V.jsxs("div",{className:"space-y-2",children:[V.jsx(bd,{className:"text-black",children:""}),V.jsx("input",{ref:Ie,type:"file",accept:"video/*",onChange:Pt,className:"hidden"}),B?V.jsxs("div",{className:"relative",children:[V.jsx("video",{src:B,className:"w-full h-32 object-cover rounded-lg border border-gray-300",controls:!0}),V.jsx(Qo,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 h-6 w-6",onClick:Zt,children:V.jsx(C0,{className:"h-4 w-4"})})]}):V.jsx(Qo,{type:"button",variant:"outline",className:"w-full h-24 border-dashed border-gray-300 bg-white text-gray-600 hover:bg-gray-50",onClick:()=>Ie.current?.click(),children:V.jsxs("div",{className:"flex flex-col items-center gap-2",children:[V.jsx(YM,{className:"h-6 w-6"}),V.jsx("span",{children:" "})]})})]}),V.jsxs(Qo,{type:"submit",className:"w-full bg-gray-700 hover:bg-gray-800 text-white",disabled:ft,children:[ft&&V.jsx(P0,{className:"mr-2 h-4 w-4 animate-spin"}),re?" ...":Q?" ...":ke?"":" "]})]})})}const _T=j.forwardRef(({className:r,...n},s)=>V.jsx("div",{className:"relative w-full overflow-auto",children:V.jsx("table",{ref:s,className:lr("w-full caption-bottom text-sm",r),...n})}));_T.displayName="Table";const vT=j.forwardRef(({className:r,...n},s)=>V.jsx("thead",{ref:s,className:lr("[&_tr]:border-b",r),...n}));vT.displayName="TableHeader";const xT=j.forwardRef(({className:r,...n},s)=>V.jsx("tbody",{ref:s,className:lr("[&_tr:last-child]:border-0",r),...n}));xT.displayName="TableBody";const jj=j.forwardRef(({className:r,...n},s)=>V.jsx("tfoot",{ref:s,className:lr("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...n}));jj.displayName="TableFooter";const v0=j.forwardRef(({className:r,...n},s)=>V.jsx("tr",{ref:s,className:lr("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...n}));v0.displayName="TableRow";const Yp=j.forwardRef(({className:r,...n},s)=>V.jsx("th",{ref:s,className:lr("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...n}));Yp.displayName="TableHead";const Rf=j.forwardRef(({className:r,...n},s)=>V.jsx("td",{ref:s,className:lr("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...n}));Rf.displayName="TableCell";const Bj=j.forwardRef(({className:r,...n},s)=>V.jsx("caption",{ref:s,className:lr("mt-4 text-sm text-muted-foreground",r),...n}));Bj.displayName="TableCaption";var bT="AlertDialog",[Vj]=nu(bT,[Z5]),uh=Z5(),wT=r=>{const{__scopeAlertDialog:n,...s}=r,u=uh(n);return V.jsx(l9,{...u,...s,modal:!0})};wT.displayName=bT;var Uj="AlertDialogTrigger",TT=j.forwardRef((r,n)=>{const{__scopeAlertDialog:s,...u}=r,m=uh(s);return V.jsx(c9,{...m,...u,ref:n})});TT.displayName=Uj;var $j="AlertDialogPortal",ST=r=>{const{__scopeAlertDialog:n,...s}=r,u=uh(n);return V.jsx(u9,{...u,...s})};ST.displayName=$j;var Gj="AlertDialogOverlay",PT=j.forwardRef((r,n)=>{const{__scopeAlertDialog:s,...u}=r,m=uh(s);return V.jsx(qx,{...m,...u,ref:n})});PT.displayName=Gj;var hm="AlertDialogContent",[qj,Zj]=Vj(hm),Wj=j6("AlertDialogContent"),CT=j.forwardRef((r,n)=>{const{__scopeAlertDialog:s,children:u,...m}=r,x=uh(s),v=j.useRef(null),l=dn(n,v),A=j.useRef(null);return V.jsx(FF,{contentName:hm,titleName:ET,docsSlug:"alert-dialog",children:V.jsx(qj,{scope:s,cancelRef:A,children:V.jsxs(Zx,{role:"alertdialog",...x,...m,ref:l,onOpenAutoFocus:Ht(m.onOpenAutoFocus,R=>{R.preventDefault(),A.current?.focus({preventScroll:!0})}),onPointerDownOutside:R=>R.preventDefault(),onInteractOutside:R=>R.preventDefault(),children:[V.jsx(Wj,{children:u}),V.jsx(Xj,{contentRef:v})]})})})});CT.displayName=hm;var ET="AlertDialogTitle",MT=j.forwardRef((r,n)=>{const{__scopeAlertDialog:s,...u}=r,m=uh(s);return V.jsx(Wx,{...m,...u,ref:n})});MT.displayName=ET;var IT="AlertDialogDescription",AT=j.forwardRef((r,n)=>{const{__scopeAlertDialog:s,...u}=r,m=uh(s);return V.jsx(Hx,{...m,...u,ref:n})});AT.displayName=IT;var Hj="AlertDialogAction",kT=j.forwardRef((r,n)=>{const{__scopeAlertDialog:s,...u}=r,m=uh(s);return V.jsx(Xx,{...m,...u,ref:n})});kT.displayName=Hj;var DT="AlertDialogCancel",RT=j.forwardRef((r,n)=>{const{__scopeAlertDialog:s,...u}=r,{cancelRef:m}=Zj(DT,s),x=uh(s),v=dn(n,m);return V.jsx(Xx,{...x,...u,ref:v})});RT.displayName=DT;var Xj=({contentRef:r})=>{const n=`\`${hm}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${hm}\` by passing a \`${IT}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${hm}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return j.useEffect(()=>{document.getElementById(r.current?.getAttribute("aria-describedby"))||console.warn(n)},[n,r]),null},Kj=wT,Yj=TT,Qj=ST,LT=PT,zT=CT,FT=kT,OT=RT,NT=MT,jT=AT;const Jj=Kj,eB=Yj,tB=Qj,BT=j.forwardRef(({className:r,...n},s)=>V.jsx(LT,{className:lr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...n,ref:s}));BT.displayName=LT.displayName;const VT=j.forwardRef(({className:r,...n},s)=>V.jsxs(tB,{children:[V.jsx(BT,{}),V.jsx(zT,{ref:s,className:lr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...n})]}));VT.displayName=zT.displayName;const UT=({className:r,...n})=>V.jsx("div",{className:lr("flex flex-col space-y-2 text-center sm:text-left",r),...n});UT.displayName="AlertDialogHeader";const $T=({className:r,...n})=>V.jsx("div",{className:lr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...n});$T.displayName="AlertDialogFooter";const GT=j.forwardRef(({className:r,...n},s)=>V.jsx(NT,{ref:s,className:lr("text-lg font-semibold",r),...n}));GT.displayName=NT.displayName;const qT=j.forwardRef(({className:r,...n},s)=>V.jsx(jT,{ref:s,className:lr("text-sm text-muted-foreground",r),...n}));qT.displayName=jT.displayName;const ZT=j.forwardRef(({className:r,...n},s)=>V.jsx(FT,{ref:s,className:lr(Jx(),r),...n}));ZT.displayName=FT.displayName;const WT=j.forwardRef(({className:r,...n},s)=>V.jsx(OT,{ref:s,className:lr(Jx({variant:"outline"}),"mt-2 sm:mt-0",r),...n}));WT.displayName=OT.displayName;function rB(){const{isAdmin:r,user:n,isLoading:s,logout:u}=MN(),{data:m,isLoading:x}=z5(),v=Oz(),[l,A]=j.useState(!1),[R,L]=j.useState(null),[B,W]=j.useState(""),[,re]=x6();if(j.useEffect(()=>{!s&&!r&&re("/admin/login")},[s,r,re]),s||x)return V.jsx("div",{className:"flex h-screen items-center justify-center bg-gradient-to-br from-gray-100 via-gray-200 to-gray-300",children:V.jsx(P0,{className:"h-8 w-8 animate-spin text-gray-600"})});if(!r)return null;const ce=m?.filter(le=>le.name.toLowerCase().includes(B.toLowerCase())),Q=le=>{L(le),A(!0)},X=()=>{L(null),A(!0)};return V.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-100 via-gray-200 to-gray-300 flex",children:[V.jsxs("aside",{className:"w-64 bg-white shadow-xl hidden md:flex flex-col",children:[V.jsxs("div",{className:"p-6 border-b border-gray-100",children:[V.jsx(Lb,{href:"/",children:V.jsx("h1",{className:"text-2xl font-bold text-black cursor-pointer hover:text-gray-600 transition-colors tracking-wide",children:"ADMIN"})}),V.jsx("p",{className:"text-xs text-gray-500 mt-1 font-medium",children:" "})]}),V.jsx("nav",{className:"flex-1 p-4 space-y-2",children:V.jsx(Lb,{href:"/",children:V.jsxs(Qo,{variant:"ghost",className:"w-full justify-start text-black hover:bg-gray-100 hover:text-gray-700",children:[V.jsx(p4,{className:"mr-2 h-4 w-4"})," "]})})}),V.jsxs("div",{className:"p-4 border-t border-gray-100 bg-gray-50",children:[V.jsxs("div",{className:"flex items-center gap-3 mb-4 px-2",children:[V.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-gray-500 to-gray-600 shadow-lg shadow-gray-300",children:V.jsx(KM,{className:"h-5 w-5 text-white"})}),V.jsxs("div",{className:"flex flex-col overflow-hidden",children:[V.jsx("span",{className:"text-sm font-semibold text-black truncate",children:n?.username||"Admin"}),V.jsx("span",{className:"text-xs text-gray-500",children:""})]})]}),V.jsxs(Qo,{variant:"outline",className:"w-full border-gray-200 text-black hover:bg-red-50 hover:text-red-600 hover:border-red-200",onClick:()=>u(),"data-testid":"button-logout",children:[V.jsx(UM,{className:"mr-2 h-4 w-4"}),""]})]})]}),V.jsx("main",{className:"flex-1 p-6 md:p-8 lg:p-12 overflow-auto",children:V.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[V.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[V.jsxs("div",{children:[V.jsx("h2",{className:"text-3xl font-bold text-black",children:""}),V.jsx("p",{className:"text-gray-600",children:"   3D "})]}),V.jsxs(h9,{open:l,onOpenChange:A,children:[V.jsx(BF,{asChild:!0,children:V.jsxs(Qo,{onClick:X,className:"bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white shadow-lg shadow-gray-400/50",children:[V.jsx(qM,{className:"mr-2 h-4 w-4"})," "]})}),V.jsxs(Kx,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto bg-white",children:[V.jsx(Yx,{children:V.jsx(Qx,{className:"text-black",children:R?"":" "})}),V.jsx(Nj,{location:R||void 0,onSuccess:()=>A(!1)})]})]})]}),V.jsxs("div",{className:"bg-white rounded-xl shadow-xl shadow-gray-200/50 overflow-hidden",children:[V.jsx("div",{className:"p-6 border-b border-gray-100",children:V.jsx("div",{className:"flex items-center gap-4",children:V.jsxs("div",{className:"relative flex-1",children:[V.jsx(ZM,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),V.jsx(Bf,{placeholder:" ...",className:"pl-10 h-11 bg-gray-50 border-gray-200 text-black placeholder:text-gray-400 focus:border-gray-500 focus:ring-gray-500",value:B,onChange:le=>W(le.target.value)})]})})}),V.jsx("div",{className:"overflow-hidden",children:V.jsxs(_T,{children:[V.jsx(vT,{children:V.jsxs(v0,{className:"bg-gray-50 hover:bg-gray-50",children:[V.jsx(Yp,{className:"text-black font-semibold",children:""}),V.jsx(Yp,{className:"hidden lg:table-cell text-black font-semibold",children:""}),V.jsx(Yp,{className:"hidden md:table-cell text-black font-semibold",children:""}),V.jsx(Yp,{className:"hidden sm:table-cell text-black font-semibold",children:""}),V.jsx(Yp,{className:"text-right text-black font-semibold",children:""})]})}),V.jsx(xT,{children:ce?.length===0?V.jsx(v0,{children:V.jsx(Rf,{colSpan:5,className:"h-24 text-center text-gray-500",children:"  "})}):ce?.map(le=>V.jsxs(v0,{className:"hover:bg-gray-50",children:[V.jsx(Rf,{className:"font-medium text-black",children:V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx(O1,{locationType:le.locationType,size:"sm"}),V.jsxs("div",{className:"flex flex-col",children:[V.jsx("span",{children:le.name}),V.jsxs("span",{className:"md:hidden text-xs text-gray-500 mt-0.5",children:[le.lat.toFixed(4),", ",le.lng.toFixed(4)]})]})]})}),V.jsx(Rf,{className:"hidden lg:table-cell text-gray-600",children:V.jsx("span",{className:"text-xs",children:ah[le.locationType||"kmz"]?.labelRu||""})}),V.jsxs(Rf,{className:"hidden md:table-cell text-gray-600",children:[le.lat.toFixed(4),", ",le.lng.toFixed(4)]}),V.jsx(Rf,{className:"hidden sm:table-cell",children:V.jsxs("div",{className:"flex gap-2",children:[le.imageUrl&&V.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full font-medium",children:"IMG"}),le.videoUrl&&V.jsx("span",{className:"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded-full font-medium",children:"VID"})]})}),V.jsx(Rf,{className:"text-right",children:V.jsxs("div",{className:"flex justify-end gap-1",children:[V.jsx(Qo,{variant:"ghost",size:"icon",onClick:()=>Q(le),className:"text-gray-600 hover:text-gray-800 hover:bg-gray-100",children:V.jsx(GM,{className:"h-4 w-4"})}),V.jsxs(Jj,{children:[V.jsx(eB,{asChild:!0,children:V.jsx(Qo,{variant:"ghost",size:"icon",className:"text-gray-600 hover:text-red-600 hover:bg-red-50",children:V.jsx(HM,{className:"h-4 w-4"})})}),V.jsxs(VT,{className:"bg-white",children:[V.jsxs(UT,{children:[V.jsx(GT,{className:"text-black",children:" ?"}),V.jsxs(qT,{className:"text-gray-600",children:[' "',le.name,'"     .']})]}),V.jsxs($T,{children:[V.jsx(WT,{className:"text-black",children:""}),V.jsx(ZT,{onClick:()=>v.mutate(le.id),className:"bg-red-600 hover:bg-red-700 text-white",children:""})]})]})]})]})})]},le.id))})]})})]})]})})]})}function nB(r){if(typeof Proxy>"u")return r;const n=new Map,s=(...u)=>r(...u);return new Proxy(s,{get:(u,m)=>m==="create"?r:(n.has(m)||n.set(m,r(m)),n.get(m))})}function C_(r){return r!==null&&typeof r=="object"&&typeof r.start=="function"}const Z1=r=>Array.isArray(r);function HT(r,n){if(!Array.isArray(n))return!1;const s=n.length;if(s!==r.length)return!1;for(let u=0;u<s;u++)if(n[u]!==r[u])return!1;return!0}function Hg(r){return typeof r=="string"||Array.isArray(r)}function Jw(r){const n=[{},{}];return r?.values.forEach((s,u)=>{n[0][u]=s.get(),n[1][u]=s.getVelocity()}),n}function v2(r,n,s,u){if(typeof n=="function"){const[m,x]=Jw(u);n=n(s!==void 0?s:r.custom,m,x)}if(typeof n=="string"&&(n=r.variants&&r.variants[n]),typeof n=="function"){const[m,x]=Jw(u);n=n(s!==void 0?s:r.custom,m,x)}return n}function E_(r,n,s){const u=r.getProps();return v2(u,n,s!==void 0?s:u.custom,r)}const x2=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],b2=["initial",...x2],ly=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ep=new Set(ly),rh=r=>r*1e3,nh=r=>r/1e3,iB={type:"spring",stiffness:500,damping:25,restSpeed:10},sB=r=>({type:"spring",stiffness:550,damping:r===0?2*Math.sqrt(550):30,restSpeed:10}),oB={type:"keyframes",duration:.8},aB={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},lB=(r,{keyframes:n})=>n.length>2?oB:ep.has(r)?r.startsWith("scale")?sB(n[1]):iB:aB;function w2(r,n){return r?r[n]||r.default||r:void 0}const cB={useManualTiming:!1},uB=r=>r!==null;function M_(r,{repeat:n,repeatType:s="loop"},u){const m=r.filter(uB),x=n&&s!=="loop"&&n%2===1?0:m.length-1;return!x||u===void 0?m[x]:u}const eo=r=>r;let XT=eo;function hB(r){let n=new Set,s=new Set,u=!1,m=!1;const x=new WeakSet;let v={delta:0,timestamp:0,isProcessing:!1};function l(R){x.has(R)&&(A.schedule(R),r()),R(v)}const A={schedule:(R,L=!1,B=!1)=>{const re=B&&u?n:s;return L&&x.add(R),re.has(R)||re.add(R),R},cancel:R=>{s.delete(R),x.delete(R)},process:R=>{if(v=R,u){m=!0;return}u=!0,[n,s]=[s,n],s.clear(),n.forEach(l),u=!1,m&&(m=!1,A.process(R))}};return A}const c0=["read","resolveKeyframes","update","preRender","render","postRender"],dB=40;function KT(r,n){let s=!1,u=!0;const m={delta:0,timestamp:0,isProcessing:!1},x=()=>s=!0,v=c0.reduce((le,he)=>(le[he]=hB(x),le),{}),{read:l,resolveKeyframes:A,update:R,preRender:L,render:B,postRender:W}=v,re=()=>{const le=performance.now();s=!1,m.delta=u?1e3/60:Math.max(Math.min(le-m.timestamp,dB),1),m.timestamp=le,m.isProcessing=!0,l.process(m),A.process(m),R.process(m),L.process(m),B.process(m),W.process(m),m.isProcessing=!1,s&&n&&(u=!1,r(re))},ce=()=>{s=!0,u=!0,m.isProcessing||r(re)};return{schedule:c0.reduce((le,he)=>{const _e=v[he];return le[he]=(Ie,ke=!1,Je=!1)=>(s||ce(),_e.schedule(Ie,ke,Je)),le},{}),cancel:le=>{for(let he=0;he<c0.length;he++)v[c0[he]].cancel(le)},state:m,steps:v}}const{schedule:Bn,cancel:Dd,state:Rs,steps:Qv}=KT(typeof requestAnimationFrame<"u"?requestAnimationFrame:eo,!0),YT=(r,n,s)=>(((1-3*s+3*n)*r+(3*s-6*n))*r+3*n)*r,fB=1e-7,pB=12;function mB(r,n,s,u,m){let x,v,l=0;do v=n+(s-n)/2,x=YT(v,u,m)-r,x>0?s=v:n=v;while(Math.abs(x)>fB&&++l<pB);return v}function cy(r,n,s,u){if(r===n&&s===u)return eo;const m=x=>mB(x,0,1,r,s);return x=>x===0||x===1?x:YT(m(x),n,u)}const QT=r=>n=>n<=.5?r(2*n)/2:(2-r(2*(1-n)))/2,JT=r=>n=>1-r(1-n),eS=cy(.33,1.53,.69,.99),T2=JT(eS),tS=QT(T2),rS=r=>(r*=2)<1?.5*T2(r):.5*(2-Math.pow(2,-10*(r-1))),S2=r=>1-Math.sin(Math.acos(r)),nS=JT(S2),iS=QT(S2),sS=r=>/^0[^.\s]+$/u.test(r);function gB(r){return typeof r=="number"?r===0:r!==null?r==="none"||r==="0"||sS(r):!0}const oS=r=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(r),aS=r=>n=>typeof n=="string"&&n.startsWith(r),lS=aS("--"),yB=aS("var(--"),P2=r=>yB(r)?_B.test(r.split("/*")[0].trim()):!1,_B=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,vB=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function xB(r){const n=vB.exec(r);if(!n)return[,];const[,s,u,m]=n;return[`--${s??u}`,m]}function cS(r,n,s=1){const[u,m]=xB(r);if(!u)return;const x=window.getComputedStyle(n).getPropertyValue(u);if(x){const v=x.trim();return oS(v)?parseFloat(v):v}return P2(m)?cS(m,n,s+1):m}const lh=(r,n,s)=>s>n?n:s<r?r:s,km={test:r=>typeof r=="number",parse:parseFloat,transform:r=>r},Xg={...km,transform:r=>lh(0,1,r)},u0={...km,default:1},uy=r=>({test:n=>typeof n=="string"&&n.endsWith(r)&&n.split(" ").length===1,parse:parseFloat,transform:n=>`${n}${r}`}),wd=uy("deg"),Qc=uy("%"),wr=uy("px"),bB=uy("vh"),wB=uy("vw"),e7={...Qc,parse:r=>Qc.parse(r)/100,transform:r=>Qc.transform(r*100)},TB=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),t7=r=>r===km||r===wr,r7=(r,n)=>parseFloat(r.split(", ")[n]),n7=(r,n)=>(s,{transform:u})=>{if(u==="none"||!u)return 0;const m=u.match(/^matrix3d\((.+)\)$/u);if(m)return r7(m[1],n);{const x=u.match(/^matrix\((.+)\)$/u);return x?r7(x[1],r):0}},SB=new Set(["x","y","z"]),PB=ly.filter(r=>!SB.has(r));function CB(r){const n=[];return PB.forEach(s=>{const u=r.getValue(s);u!==void 0&&(n.push([s,u.get()]),u.set(s.startsWith("scale")?1:0))}),n}const vm={width:({x:r},{paddingLeft:n="0",paddingRight:s="0"})=>r.max-r.min-parseFloat(n)-parseFloat(s),height:({y:r},{paddingTop:n="0",paddingBottom:s="0"})=>r.max-r.min-parseFloat(n)-parseFloat(s),top:(r,{top:n})=>parseFloat(n),left:(r,{left:n})=>parseFloat(n),bottom:({y:r},{top:n})=>parseFloat(n)+(r.max-r.min),right:({x:r},{left:n})=>parseFloat(n)+(r.max-r.min),x:n7(4,13),y:n7(5,14)};vm.translateX=vm.x;vm.translateY=vm.y;const uS=r=>n=>n.test(r),EB={test:r=>r==="auto",parse:r=>r},hS=[km,wr,Qc,wd,wB,bB,EB],i7=r=>hS.find(uS(r)),Vf=new Set;let W1=!1,H1=!1;function dS(){if(H1){const r=Array.from(Vf).filter(u=>u.needsMeasurement),n=new Set(r.map(u=>u.element)),s=new Map;n.forEach(u=>{const m=CB(u);m.length&&(s.set(u,m),u.render())}),r.forEach(u=>u.measureInitialState()),n.forEach(u=>{u.render();const m=s.get(u);m&&m.forEach(([x,v])=>{var l;(l=u.getValue(x))===null||l===void 0||l.set(v)})}),r.forEach(u=>u.measureEndState()),r.forEach(u=>{u.suspendedScrollY!==void 0&&window.scrollTo(0,u.suspendedScrollY)})}H1=!1,W1=!1,Vf.forEach(r=>r.complete()),Vf.clear()}function fS(){Vf.forEach(r=>{r.readKeyframes(),r.needsMeasurement&&(H1=!0)})}function MB(){fS(),dS()}class C2{constructor(n,s,u,m,x,v=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...n],this.onComplete=s,this.name=u,this.motionValue=m,this.element=x,this.isAsync=v}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Vf.add(this),W1||(W1=!0,Bn.read(fS),Bn.resolveKeyframes(dS))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:n,name:s,element:u,motionValue:m}=this;for(let x=0;x<n.length;x++)if(n[x]===null)if(x===0){const v=m?.get(),l=n[n.length-1];if(v!==void 0)n[0]=v;else if(u&&s){const A=u.readValue(s,l);A!=null&&(n[0]=A)}n[0]===void 0&&(n[0]=l),m&&v===void 0&&m.set(n[0])}else n[x]=n[x-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Vf.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Vf.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Sg=r=>Math.round(r*1e5)/1e5,E2=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function IB(r){return r==null}const AB=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,M2=(r,n)=>s=>!!(typeof s=="string"&&AB.test(s)&&s.startsWith(r)||n&&!IB(s)&&Object.prototype.hasOwnProperty.call(s,n)),pS=(r,n,s)=>u=>{if(typeof u!="string")return u;const[m,x,v,l]=u.match(E2);return{[r]:parseFloat(m),[n]:parseFloat(x),[s]:parseFloat(v),alpha:l!==void 0?parseFloat(l):1}},kB=r=>lh(0,255,r),Jv={...km,transform:r=>Math.round(kB(r))},Nf={test:M2("rgb","red"),parse:pS("red","green","blue"),transform:({red:r,green:n,blue:s,alpha:u=1})=>"rgba("+Jv.transform(r)+", "+Jv.transform(n)+", "+Jv.transform(s)+", "+Sg(Xg.transform(u))+")"};function DB(r){let n="",s="",u="",m="";return r.length>5?(n=r.substring(1,3),s=r.substring(3,5),u=r.substring(5,7),m=r.substring(7,9)):(n=r.substring(1,2),s=r.substring(2,3),u=r.substring(3,4),m=r.substring(4,5),n+=n,s+=s,u+=u,m+=m),{red:parseInt(n,16),green:parseInt(s,16),blue:parseInt(u,16),alpha:m?parseInt(m,16)/255:1}}const X1={test:M2("#"),parse:DB,transform:Nf.transform},Jp={test:M2("hsl","hue"),parse:pS("hue","saturation","lightness"),transform:({hue:r,saturation:n,lightness:s,alpha:u=1})=>"hsla("+Math.round(r)+", "+Qc.transform(Sg(n))+", "+Qc.transform(Sg(s))+", "+Sg(Xg.transform(u))+")"},Ys={test:r=>Nf.test(r)||X1.test(r)||Jp.test(r),parse:r=>Nf.test(r)?Nf.parse(r):Jp.test(r)?Jp.parse(r):X1.parse(r),transform:r=>typeof r=="string"?r:r.hasOwnProperty("red")?Nf.transform(r):Jp.transform(r)},RB=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function LB(r){var n,s;return isNaN(r)&&typeof r=="string"&&(((n=r.match(E2))===null||n===void 0?void 0:n.length)||0)+(((s=r.match(RB))===null||s===void 0?void 0:s.length)||0)>0}const mS="number",gS="color",zB="var",FB="var(",s7="${}",OB=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Kg(r){const n=r.toString(),s=[],u={color:[],number:[],var:[]},m=[];let x=0;const l=n.replace(OB,A=>(Ys.test(A)?(u.color.push(x),m.push(gS),s.push(Ys.parse(A))):A.startsWith(FB)?(u.var.push(x),m.push(zB),s.push(A)):(u.number.push(x),m.push(mS),s.push(parseFloat(A))),++x,s7)).split(s7);return{values:s,split:l,indexes:u,types:m}}function yS(r){return Kg(r).values}function _S(r){const{split:n,types:s}=Kg(r),u=n.length;return m=>{let x="";for(let v=0;v<u;v++)if(x+=n[v],m[v]!==void 0){const l=s[v];l===mS?x+=Sg(m[v]):l===gS?x+=Ys.transform(m[v]):x+=m[v]}return x}}const NB=r=>typeof r=="number"?0:r;function jB(r){const n=yS(r);return _S(r)(n.map(NB))}const Rd={test:LB,parse:yS,createTransformer:_S,getAnimatableNone:jB},BB=new Set(["brightness","contrast","saturate","opacity"]);function VB(r){const[n,s]=r.slice(0,-1).split("(");if(n==="drop-shadow")return r;const[u]=s.match(E2)||[];if(!u)return r;const m=s.replace(u,"");let x=BB.has(n)?1:0;return u!==s&&(x*=100),n+"("+x+m+")"}const UB=/\b([a-z-]*)\(.*?\)/gu,K1={...Rd,getAnimatableNone:r=>{const n=r.match(UB);return n?n.map(VB).join(" "):r}},$B={borderWidth:wr,borderTopWidth:wr,borderRightWidth:wr,borderBottomWidth:wr,borderLeftWidth:wr,borderRadius:wr,radius:wr,borderTopLeftRadius:wr,borderTopRightRadius:wr,borderBottomRightRadius:wr,borderBottomLeftRadius:wr,width:wr,maxWidth:wr,height:wr,maxHeight:wr,top:wr,right:wr,bottom:wr,left:wr,padding:wr,paddingTop:wr,paddingRight:wr,paddingBottom:wr,paddingLeft:wr,margin:wr,marginTop:wr,marginRight:wr,marginBottom:wr,marginLeft:wr,backgroundPositionX:wr,backgroundPositionY:wr},GB={rotate:wd,rotateX:wd,rotateY:wd,rotateZ:wd,scale:u0,scaleX:u0,scaleY:u0,scaleZ:u0,skew:wd,skewX:wd,skewY:wd,distance:wr,translateX:wr,translateY:wr,translateZ:wr,x:wr,y:wr,z:wr,perspective:wr,transformPerspective:wr,opacity:Xg,originX:e7,originY:e7,originZ:wr},o7={...km,transform:Math.round},I2={...$B,...GB,zIndex:o7,size:wr,fillOpacity:Xg,strokeOpacity:Xg,numOctaves:o7},qB={...I2,color:Ys,backgroundColor:Ys,outlineColor:Ys,fill:Ys,stroke:Ys,borderColor:Ys,borderTopColor:Ys,borderRightColor:Ys,borderBottomColor:Ys,borderLeftColor:Ys,filter:K1,WebkitFilter:K1},A2=r=>qB[r];function vS(r,n){let s=A2(r);return s!==K1&&(s=Rd),s.getAnimatableNone?s.getAnimatableNone(n):void 0}const ZB=new Set(["auto","none","0"]);function WB(r,n,s){let u=0,m;for(;u<r.length&&!m;){const x=r[u];typeof x=="string"&&!ZB.has(x)&&Kg(x).values.length&&(m=r[u]),u++}if(m&&s)for(const x of n)r[x]=vS(s,m)}class xS extends C2{constructor(n,s,u,m,x){super(n,s,u,m,x,!0)}readKeyframes(){const{unresolvedKeyframes:n,element:s,name:u}=this;if(!s||!s.current)return;super.readKeyframes();for(let A=0;A<n.length;A++){let R=n[A];if(typeof R=="string"&&(R=R.trim(),P2(R))){const L=cS(R,s.current);L!==void 0&&(n[A]=L),A===n.length-1&&(this.finalKeyframe=R)}}if(this.resolveNoneKeyframes(),!TB.has(u)||n.length!==2)return;const[m,x]=n,v=i7(m),l=i7(x);if(v!==l)if(t7(v)&&t7(l))for(let A=0;A<n.length;A++){const R=n[A];typeof R=="string"&&(n[A]=parseFloat(R))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:n,name:s}=this,u=[];for(let m=0;m<n.length;m++)gB(n[m])&&u.push(m);u.length&&WB(n,u,s)}measureInitialState(){const{element:n,unresolvedKeyframes:s,name:u}=this;if(!n||!n.current)return;u==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=vm[u](n.measureViewportBox(),window.getComputedStyle(n.current)),s[0]=this.measuredOrigin;const m=s[s.length-1];m!==void 0&&n.getValue(u,m).jump(m,!1)}measureEndState(){var n;const{element:s,name:u,unresolvedKeyframes:m}=this;if(!s||!s.current)return;const x=s.getValue(u);x&&x.jump(this.measuredOrigin,!1);const v=m.length-1,l=m[v];m[v]=vm[u](s.measureViewportBox(),window.getComputedStyle(s.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((n=this.removedTransforms)===null||n===void 0)&&n.length&&this.removedTransforms.forEach(([A,R])=>{s.getValue(A).set(R)}),this.resolveNoneKeyframes()}}function k2(r){return typeof r=="function"}let x0;function HB(){x0=void 0}const Jc={now:()=>(x0===void 0&&Jc.set(Rs.isProcessing||cB.useManualTiming?Rs.timestamp:performance.now()),x0),set:r=>{x0=r,queueMicrotask(HB)}},a7=(r,n)=>n==="zIndex"?!1:!!(typeof r=="number"||Array.isArray(r)||typeof r=="string"&&(Rd.test(r)||r==="0")&&!r.startsWith("url("));function XB(r){const n=r[0];if(r.length===1)return!0;for(let s=0;s<r.length;s++)if(r[s]!==n)return!0}function KB(r,n,s,u){const m=r[0];if(m===null)return!1;if(n==="display"||n==="visibility")return!0;const x=r[r.length-1],v=a7(m,n),l=a7(x,n);return!v||!l?!1:XB(r)||(s==="spring"||k2(s))&&u}const YB=40;class bS{constructor({autoplay:n=!0,delay:s=0,type:u="keyframes",repeat:m=0,repeatDelay:x=0,repeatType:v="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Jc.now(),this.options={autoplay:n,delay:s,type:u,repeat:m,repeatDelay:x,repeatType:v,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>YB?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&MB(),this._resolved}onKeyframesResolved(n,s){this.resolvedAt=Jc.now(),this.hasAttemptedResolve=!0;const{name:u,type:m,velocity:x,delay:v,onComplete:l,onUpdate:A,isGenerator:R}=this.options;if(!R&&!KB(n,u,m,x))if(v)this.options.duration=0;else{A?.(M_(n,this.options,s)),l?.(),this.resolveFinishedPromise();return}const L=this.initPlayback(n,s);L!==!1&&(this._resolved={keyframes:n,finalKeyframe:s,...L},this.onPostResolved())}onPostResolved(){}then(n,s){return this.currentFinishedPromise.then(n,s)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(n=>{this.resolveFinishedPromise=n})}}const xm=(r,n,s)=>{const u=n-r;return u===0?1:(s-r)/u},wS=(r,n,s=10)=>{let u="";const m=Math.max(Math.round(n/s),2);for(let x=0;x<m;x++)u+=r(xm(0,m-1,x))+", ";return`linear(${u.substring(0,u.length-2)})`};function TS(r,n){return n?r*(1e3/n):0}const QB=5;function SS(r,n,s){const u=Math.max(n-QB,0);return TS(s-r(u),n-u)}const Di={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},e1=.001;function JB({duration:r=Di.duration,bounce:n=Di.bounce,velocity:s=Di.velocity,mass:u=Di.mass}){let m,x,v=1-n;v=lh(Di.minDamping,Di.maxDamping,v),r=lh(Di.minDuration,Di.maxDuration,nh(r)),v<1?(m=R=>{const L=R*v,B=L*r,W=L-s,re=Y1(R,v),ce=Math.exp(-B);return e1-W/re*ce},x=R=>{const B=R*v*r,W=B*s+s,re=Math.pow(v,2)*Math.pow(R,2)*r,ce=Math.exp(-B),Q=Y1(Math.pow(R,2),v);return(-m(R)+e1>0?-1:1)*((W-re)*ce)/Q}):(m=R=>{const L=Math.exp(-R*r),B=(R-s)*r+1;return-e1+L*B},x=R=>{const L=Math.exp(-R*r),B=(s-R)*(r*r);return L*B});const l=5/r,A=tV(m,x,l);if(r=rh(r),isNaN(A))return{stiffness:Di.stiffness,damping:Di.damping,duration:r};{const R=Math.pow(A,2)*u;return{stiffness:R,damping:v*2*Math.sqrt(u*R),duration:r}}}const eV=12;function tV(r,n,s){let u=s;for(let m=1;m<eV;m++)u=u-r(u)/n(u);return u}function Y1(r,n){return r*Math.sqrt(1-n*n)}const Q1=2e4;function PS(r){let n=0;const s=50;let u=r.next(n);for(;!u.done&&n<Q1;)n+=s,u=r.next(n);return n>=Q1?1/0:n}const rV=["duration","bounce"],nV=["stiffness","damping","mass"];function l7(r,n){return n.some(s=>r[s]!==void 0)}function iV(r){let n={velocity:Di.velocity,stiffness:Di.stiffness,damping:Di.damping,mass:Di.mass,isResolvedFromDuration:!1,...r};if(!l7(r,nV)&&l7(r,rV))if(r.visualDuration){const s=r.visualDuration,u=2*Math.PI/(s*1.2),m=u*u,x=2*lh(.05,1,1-r.bounce)*Math.sqrt(m);n={...n,mass:Di.mass,stiffness:m,damping:x}}else{const s=JB(r);n={...n,...s,mass:Di.mass},n.isResolvedFromDuration=!0}return n}function CS(r=Di.visualDuration,n=Di.bounce){const s=typeof r!="object"?{visualDuration:r,keyframes:[0,1],bounce:n}:r;let{restSpeed:u,restDelta:m}=s;const x=s.keyframes[0],v=s.keyframes[s.keyframes.length-1],l={done:!1,value:x},{stiffness:A,damping:R,mass:L,duration:B,velocity:W,isResolvedFromDuration:re}=iV({...s,velocity:-nh(s.velocity||0)}),ce=W||0,Q=R/(2*Math.sqrt(A*L)),X=v-x,le=nh(Math.sqrt(A/L)),he=Math.abs(X)<5;u||(u=he?Di.restSpeed.granular:Di.restSpeed.default),m||(m=he?Di.restDelta.granular:Di.restDelta.default);let _e;if(Q<1){const ke=Y1(le,Q);_e=Je=>{const He=Math.exp(-Q*le*Je);return v-He*((ce+Q*le*X)/ke*Math.sin(ke*Je)+X*Math.cos(ke*Je))}}else if(Q===1)_e=ke=>v-Math.exp(-le*ke)*(X+(ce+le*X)*ke);else{const ke=le*Math.sqrt(Q*Q-1);_e=Je=>{const He=Math.exp(-Q*le*Je),nt=Math.min(ke*Je,300);return v-He*((ce+Q*le*X)*Math.sinh(nt)+ke*X*Math.cosh(nt))/ke}}const Ie={calculatedDuration:re&&B||null,next:ke=>{const Je=_e(ke);if(re)l.done=ke>=B;else{let He=0;Q<1&&(He=ke===0?rh(ce):SS(_e,ke,Je));const nt=Math.abs(He)<=u,Pt=Math.abs(v-Je)<=m;l.done=nt&&Pt}return l.value=l.done?v:Je,l},toString:()=>{const ke=Math.min(PS(Ie),Q1),Je=wS(He=>Ie.next(ke*He).value,ke,30);return ke+"ms "+Je}};return Ie}function c7({keyframes:r,velocity:n=0,power:s=.8,timeConstant:u=325,bounceDamping:m=10,bounceStiffness:x=500,modifyTarget:v,min:l,max:A,restDelta:R=.5,restSpeed:L}){const B=r[0],W={done:!1,value:B},re=nt=>l!==void 0&&nt<l||A!==void 0&&nt>A,ce=nt=>l===void 0?A:A===void 0||Math.abs(l-nt)<Math.abs(A-nt)?l:A;let Q=s*n;const X=B+Q,le=v===void 0?X:v(X);le!==X&&(Q=le-B);const he=nt=>-Q*Math.exp(-nt/u),_e=nt=>le+he(nt),Ie=nt=>{const Pt=he(nt),Ct=_e(nt);W.done=Math.abs(Pt)<=R,W.value=W.done?le:Ct};let ke,Je;const He=nt=>{re(W.value)&&(ke=nt,Je=CS({keyframes:[W.value,ce(W.value)],velocity:SS(_e,nt,W.value),damping:m,stiffness:x,restDelta:R,restSpeed:L}))};return He(0),{calculatedDuration:null,next:nt=>{let Pt=!1;return!Je&&ke===void 0&&(Pt=!0,Ie(nt),He(nt)),ke!==void 0&&nt>=ke?Je.next(nt-ke):(!Pt&&Ie(nt),W)}}}const sV=cy(.42,0,1,1),oV=cy(0,0,.58,1),ES=cy(.42,0,.58,1),aV=r=>Array.isArray(r)&&typeof r[0]!="number",D2=r=>Array.isArray(r)&&typeof r[0]=="number",lV={linear:eo,easeIn:sV,easeInOut:ES,easeOut:oV,circIn:S2,circInOut:iS,circOut:nS,backIn:T2,backInOut:tS,backOut:eS,anticipate:rS},u7=r=>{if(D2(r)){XT(r.length===4);const[n,s,u,m]=r;return cy(n,s,u,m)}else if(typeof r=="string")return lV[r];return r},cV=(r,n)=>s=>n(r(s)),Td=(...r)=>r.reduce(cV),_i=(r,n,s)=>r+(n-r)*s;function t1(r,n,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?r+(n-r)*6*s:s<1/2?n:s<2/3?r+(n-r)*(2/3-s)*6:r}function uV({hue:r,saturation:n,lightness:s,alpha:u}){r/=360,n/=100,s/=100;let m=0,x=0,v=0;if(!n)m=x=v=s;else{const l=s<.5?s*(1+n):s+n-s*n,A=2*s-l;m=t1(A,l,r+1/3),x=t1(A,l,r),v=t1(A,l,r-1/3)}return{red:Math.round(m*255),green:Math.round(x*255),blue:Math.round(v*255),alpha:u}}function H0(r,n){return s=>s>0?n:r}const r1=(r,n,s)=>{const u=r*r,m=s*(n*n-u)+u;return m<0?0:Math.sqrt(m)},hV=[X1,Nf,Jp],dV=r=>hV.find(n=>n.test(r));function h7(r){const n=dV(r);if(!n)return!1;let s=n.parse(r);return n===Jp&&(s=uV(s)),s}const d7=(r,n)=>{const s=h7(r),u=h7(n);if(!s||!u)return H0(r,n);const m={...s};return x=>(m.red=r1(s.red,u.red,x),m.green=r1(s.green,u.green,x),m.blue=r1(s.blue,u.blue,x),m.alpha=_i(s.alpha,u.alpha,x),Nf.transform(m))},J1=new Set(["none","hidden"]);function fV(r,n){return J1.has(r)?s=>s<=0?r:n:s=>s>=1?n:r}function pV(r,n){return s=>_i(r,n,s)}function R2(r){return typeof r=="number"?pV:typeof r=="string"?P2(r)?H0:Ys.test(r)?d7:yV:Array.isArray(r)?MS:typeof r=="object"?Ys.test(r)?d7:mV:H0}function MS(r,n){const s=[...r],u=s.length,m=r.map((x,v)=>R2(x)(x,n[v]));return x=>{for(let v=0;v<u;v++)s[v]=m[v](x);return s}}function mV(r,n){const s={...r,...n},u={};for(const m in s)r[m]!==void 0&&n[m]!==void 0&&(u[m]=R2(r[m])(r[m],n[m]));return m=>{for(const x in u)s[x]=u[x](m);return s}}function gV(r,n){var s;const u=[],m={color:0,var:0,number:0};for(let x=0;x<n.values.length;x++){const v=n.types[x],l=r.indexes[v][m[v]],A=(s=r.values[l])!==null&&s!==void 0?s:0;u[x]=A,m[v]++}return u}const yV=(r,n)=>{const s=Rd.createTransformer(n),u=Kg(r),m=Kg(n);return u.indexes.var.length===m.indexes.var.length&&u.indexes.color.length===m.indexes.color.length&&u.indexes.number.length>=m.indexes.number.length?J1.has(r)&&!m.values.length||J1.has(n)&&!u.values.length?fV(r,n):Td(MS(gV(u,m),m.values),s):H0(r,n)};function IS(r,n,s){return typeof r=="number"&&typeof n=="number"&&typeof s=="number"?_i(r,n,s):R2(r)(r,n)}function _V(r,n,s){const u=[],m=s||IS,x=r.length-1;for(let v=0;v<x;v++){let l=m(r[v],r[v+1]);if(n){const A=Array.isArray(n)?n[v]||eo:n;l=Td(A,l)}u.push(l)}return u}function vV(r,n,{clamp:s=!0,ease:u,mixer:m}={}){const x=r.length;if(XT(x===n.length),x===1)return()=>n[0];if(x===2&&r[0]===r[1])return()=>n[1];r[0]>r[x-1]&&(r=[...r].reverse(),n=[...n].reverse());const v=_V(n,u,m),l=v.length,A=R=>{let L=0;if(l>1)for(;L<r.length-2&&!(R<r[L+1]);L++);const B=xm(r[L],r[L+1],R);return v[L](B)};return s?R=>A(lh(r[0],r[x-1],R)):A}function xV(r,n){const s=r[r.length-1];for(let u=1;u<=n;u++){const m=xm(0,n,u);r.push(_i(s,1,m))}}function bV(r){const n=[0];return xV(n,r.length-1),n}function wV(r,n){return r.map(s=>s*n)}function TV(r,n){return r.map(()=>n||ES).splice(0,r.length-1)}function X0({duration:r=300,keyframes:n,times:s,ease:u="easeInOut"}){const m=aV(u)?u.map(u7):u7(u),x={done:!1,value:n[0]},v=wV(s&&s.length===n.length?s:bV(n),r),l=vV(v,n,{ease:Array.isArray(m)?m:TV(n,m)});return{calculatedDuration:r,next:A=>(x.value=l(A),x.done=A>=r,x)}}const SV=r=>{const n=({timestamp:s})=>r(s);return{start:()=>Bn.update(n,!0),stop:()=>Dd(n),now:()=>Rs.isProcessing?Rs.timestamp:Jc.now()}},PV={decay:c7,inertia:c7,tween:X0,keyframes:X0,spring:CS},CV=r=>r/100;class L2 extends bS{constructor(n){super(n),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:A}=this.options;A&&A()};const{name:s,motionValue:u,element:m,keyframes:x}=this.options,v=m?.KeyframeResolver||C2,l=(A,R)=>this.onKeyframesResolved(A,R);this.resolver=new v(x,l,s,u,m),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(n){const{type:s="keyframes",repeat:u=0,repeatDelay:m=0,repeatType:x,velocity:v=0}=this.options,l=k2(s)?s:PV[s]||X0;let A,R;l!==X0&&typeof n[0]!="number"&&(A=Td(CV,IS(n[0],n[1])),n=[0,100]);const L=l({...this.options,keyframes:n});x==="mirror"&&(R=l({...this.options,keyframes:[...n].reverse(),velocity:-v})),L.calculatedDuration===null&&(L.calculatedDuration=PS(L));const{calculatedDuration:B}=L,W=B+m,re=W*(u+1)-m;return{generator:L,mirroredGenerator:R,mapPercentToKeyframes:A,calculatedDuration:B,resolvedDuration:W,totalDuration:re}}onPostResolved(){const{autoplay:n=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!n?this.pause():this.state=this.pendingPlayState}tick(n,s=!1){const{resolved:u}=this;if(!u){const{keyframes:nt}=this.options;return{done:!0,value:nt[nt.length-1]}}const{finalKeyframe:m,generator:x,mirroredGenerator:v,mapPercentToKeyframes:l,keyframes:A,calculatedDuration:R,totalDuration:L,resolvedDuration:B}=u;if(this.startTime===null)return x.next(0);const{delay:W,repeat:re,repeatType:ce,repeatDelay:Q,onUpdate:X}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,n):this.speed<0&&(this.startTime=Math.min(n-L/this.speed,this.startTime)),s?this.currentTime=n:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(n-this.startTime)*this.speed;const le=this.currentTime-W*(this.speed>=0?1:-1),he=this.speed>=0?le<0:le>L;this.currentTime=Math.max(le,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=L);let _e=this.currentTime,Ie=x;if(re){const nt=Math.min(this.currentTime,L)/B;let Pt=Math.floor(nt),Ct=nt%1;!Ct&&nt>=1&&(Ct=1),Ct===1&&Pt--,Pt=Math.min(Pt,re+1),Pt%2&&(ce==="reverse"?(Ct=1-Ct,Q&&(Ct-=Q/B)):ce==="mirror"&&(Ie=v)),_e=lh(0,1,Ct)*B}const ke=he?{done:!1,value:A[0]}:Ie.next(_e);l&&(ke.value=l(ke.value));let{done:Je}=ke;!he&&R!==null&&(Je=this.speed>=0?this.currentTime>=L:this.currentTime<=0);const He=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&Je);return He&&m!==void 0&&(ke.value=M_(A,this.options,m)),X&&X(ke.value),He&&this.finish(),ke}get duration(){const{resolved:n}=this;return n?nh(n.calculatedDuration):0}get time(){return nh(this.currentTime)}set time(n){n=rh(n),this.currentTime=n,this.holdTime!==null||this.speed===0?this.holdTime=n:this.driver&&(this.startTime=this.driver.now()-n/this.speed)}get speed(){return this.playbackSpeed}set speed(n){const s=this.playbackSpeed!==n;this.playbackSpeed=n,s&&(this.time=nh(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:n=SV,onPlay:s,startTime:u}=this.options;this.driver||(this.driver=n(x=>this.tick(x))),s&&s();const m=this.driver.now();this.holdTime!==null?this.startTime=m-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=m):this.startTime=u??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var n;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(n=this.currentTime)!==null&&n!==void 0?n:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:n}=this.options;n&&n()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(n){return this.startTime=0,this.tick(n,!0)}}const EV=new Set(["opacity","clipPath","filter","transform"]);function z2(r){let n;return()=>(n===void 0&&(n=r()),n)}const MV={linearEasing:void 0};function IV(r,n){const s=z2(r);return()=>{var u;return(u=MV[n])!==null&&u!==void 0?u:s()}}const K0=IV(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing");function AS(r){return!!(typeof r=="function"&&K0()||!r||typeof r=="string"&&(r in ex||K0())||D2(r)||Array.isArray(r)&&r.every(AS))}const vg=([r,n,s,u])=>`cubic-bezier(${r}, ${n}, ${s}, ${u})`,ex={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:vg([0,.65,.55,1]),circOut:vg([.55,0,1,.45]),backIn:vg([.31,.01,.66,-.59]),backOut:vg([.33,1.53,.69,.99])};function kS(r,n){if(r)return typeof r=="function"&&K0()?wS(r,n):D2(r)?vg(r):Array.isArray(r)?r.map(s=>kS(s,n)||ex.easeOut):ex[r]}function AV(r,n,s,{delay:u=0,duration:m=300,repeat:x=0,repeatType:v="loop",ease:l="easeInOut",times:A}={}){const R={[n]:s};A&&(R.offset=A);const L=kS(l,m);return Array.isArray(L)&&(R.easing=L),r.animate(R,{delay:u,duration:m,easing:Array.isArray(L)?"linear":L,fill:"both",iterations:x+1,direction:v==="reverse"?"alternate":"normal"})}function f7(r,n){r.timeline=n,r.onfinish=null}const kV=z2(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Y0=10,DV=2e4;function RV(r){return k2(r.type)||r.type==="spring"||!AS(r.ease)}function LV(r,n){const s=new L2({...n,keyframes:r,repeat:0,delay:0,isGenerator:!0});let u={done:!1,value:r[0]};const m=[];let x=0;for(;!u.done&&x<DV;)u=s.sample(x),m.push(u.value),x+=Y0;return{times:void 0,keyframes:m,duration:x-Y0,ease:"linear"}}const DS={anticipate:rS,backInOut:tS,circInOut:iS};function zV(r){return r in DS}class p7 extends bS{constructor(n){super(n);const{name:s,motionValue:u,element:m,keyframes:x}=this.options;this.resolver=new xS(x,(v,l)=>this.onKeyframesResolved(v,l),s,u,m),this.resolver.scheduleResolve()}initPlayback(n,s){var u;let{duration:m=300,times:x,ease:v,type:l,motionValue:A,name:R,startTime:L}=this.options;if(!(!((u=A.owner)===null||u===void 0)&&u.current))return!1;if(typeof v=="string"&&K0()&&zV(v)&&(v=DS[v]),RV(this.options)){const{onComplete:W,onUpdate:re,motionValue:ce,element:Q,...X}=this.options,le=LV(n,X);n=le.keyframes,n.length===1&&(n[1]=n[0]),m=le.duration,x=le.times,v=le.ease,l="keyframes"}const B=AV(A.owner.current,R,n,{...this.options,duration:m,times:x,ease:v});return B.startTime=L??this.calcStartTime(),this.pendingTimeline?(f7(B,this.pendingTimeline),this.pendingTimeline=void 0):B.onfinish=()=>{const{onComplete:W}=this.options;A.set(M_(n,this.options,s)),W&&W(),this.cancel(),this.resolveFinishedPromise()},{animation:B,duration:m,times:x,type:l,ease:v,keyframes:n}}get duration(){const{resolved:n}=this;if(!n)return 0;const{duration:s}=n;return nh(s)}get time(){const{resolved:n}=this;if(!n)return 0;const{animation:s}=n;return nh(s.currentTime||0)}set time(n){const{resolved:s}=this;if(!s)return;const{animation:u}=s;u.currentTime=rh(n)}get speed(){const{resolved:n}=this;if(!n)return 1;const{animation:s}=n;return s.playbackRate}set speed(n){const{resolved:s}=this;if(!s)return;const{animation:u}=s;u.playbackRate=n}get state(){const{resolved:n}=this;if(!n)return"idle";const{animation:s}=n;return s.playState}get startTime(){const{resolved:n}=this;if(!n)return null;const{animation:s}=n;return s.startTime}attachTimeline(n){if(!this._resolved)this.pendingTimeline=n;else{const{resolved:s}=this;if(!s)return eo;const{animation:u}=s;f7(u,n)}return eo}play(){if(this.isStopped)return;const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.playState==="finished"&&this.updateFinishedPromise(),s.play()}pause(){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:n}=this;if(!n)return;const{animation:s,keyframes:u,duration:m,type:x,ease:v,times:l}=n;if(s.playState==="idle"||s.playState==="finished")return;if(this.time){const{motionValue:R,onUpdate:L,onComplete:B,element:W,...re}=this.options,ce=new L2({...re,keyframes:u,duration:m,type:x,ease:v,times:l,isGenerator:!0}),Q=rh(this.time);R.setWithVelocity(ce.sample(Q-Y0).value,ce.sample(Q).value,Y0)}const{onStop:A}=this.options;A&&A(),this.cancel()}complete(){const{resolved:n}=this;n&&n.animation.finish()}cancel(){const{resolved:n}=this;n&&n.animation.cancel()}static supports(n){const{motionValue:s,name:u,repeatDelay:m,repeatType:x,damping:v,type:l}=n;return kV()&&u&&EV.has(u)&&s&&s.owner&&s.owner.current instanceof HTMLElement&&!s.owner.getProps().onUpdate&&!m&&x!=="mirror"&&v!==0&&l!=="inertia"}}const FV=z2(()=>window.ScrollTimeline!==void 0);class OV{constructor(n){this.stop=()=>this.runAll("stop"),this.animations=n.filter(Boolean)}then(n,s){return Promise.all(this.animations).then(n).catch(s)}getAll(n){return this.animations[0][n]}setAll(n,s){for(let u=0;u<this.animations.length;u++)this.animations[u][n]=s}attachTimeline(n,s){const u=this.animations.map(m=>FV()&&m.attachTimeline?m.attachTimeline(n):s(m));return()=>{u.forEach((m,x)=>{m&&m(),this.animations[x].stop()})}}get time(){return this.getAll("time")}set time(n){this.setAll("time",n)}get speed(){return this.getAll("speed")}set speed(n){this.setAll("speed",n)}get startTime(){return this.getAll("startTime")}get duration(){let n=0;for(let s=0;s<this.animations.length;s++)n=Math.max(n,this.animations[s].duration);return n}runAll(n){this.animations.forEach(s=>s[n]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}function NV({when:r,delay:n,delayChildren:s,staggerChildren:u,staggerDirection:m,repeat:x,repeatType:v,repeatDelay:l,from:A,elapsed:R,...L}){return!!Object.keys(L).length}const F2=(r,n,s,u={},m,x)=>v=>{const l=w2(u,r)||{},A=l.delay||u.delay||0;let{elapsed:R=0}=u;R=R-rh(A);let L={keyframes:Array.isArray(s)?s:[null,s],ease:"easeOut",velocity:n.getVelocity(),...l,delay:-R,onUpdate:W=>{n.set(W),l.onUpdate&&l.onUpdate(W)},onComplete:()=>{v(),l.onComplete&&l.onComplete()},name:r,motionValue:n,element:x?void 0:m};NV(l)||(L={...L,...lB(r,L)}),L.duration&&(L.duration=rh(L.duration)),L.repeatDelay&&(L.repeatDelay=rh(L.repeatDelay)),L.from!==void 0&&(L.keyframes[0]=L.from);let B=!1;if((L.type===!1||L.duration===0&&!L.repeatDelay)&&(L.duration=0,L.delay===0&&(B=!0)),B&&!x&&n.get()!==void 0){const W=M_(L.keyframes,l);if(W!==void 0)return Bn.update(()=>{L.onUpdate(W),L.onComplete()}),new OV([])}return!x&&p7.supports(L)?new p7(L):new L2(L)},jV=r=>!!(r&&typeof r=="object"&&r.mix&&r.toValue),BV=r=>Z1(r)?r[r.length-1]||0:r;function O2(r,n){r.indexOf(n)===-1&&r.push(n)}function N2(r,n){const s=r.indexOf(n);s>-1&&r.splice(s,1)}class j2{constructor(){this.subscriptions=[]}add(n){return O2(this.subscriptions,n),()=>N2(this.subscriptions,n)}notify(n,s,u){const m=this.subscriptions.length;if(m)if(m===1)this.subscriptions[0](n,s,u);else for(let x=0;x<m;x++){const v=this.subscriptions[x];v&&v(n,s,u)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const m7=30,VV=r=>!isNaN(parseFloat(r));class UV{constructor(n,s={}){this.version="11.13.1",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(u,m=!0)=>{const x=Jc.now();this.updatedAt!==x&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(u),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),m&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(n),this.owner=s.owner}setCurrent(n){this.current=n,this.updatedAt=Jc.now(),this.canTrackVelocity===null&&n!==void 0&&(this.canTrackVelocity=VV(this.current))}setPrevFrameValue(n=this.current){this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt}onChange(n){return this.on("change",n)}on(n,s){this.events[n]||(this.events[n]=new j2);const u=this.events[n].add(s);return n==="change"?()=>{u(),Bn.read(()=>{this.events.change.getSize()||this.stop()})}:u}clearListeners(){for(const n in this.events)this.events[n].clear()}attach(n,s){this.passiveEffect=n,this.stopPassiveEffect=s}set(n,s=!0){!s||!this.passiveEffect?this.updateAndNotify(n,s):this.passiveEffect(n,this.updateAndNotify)}setWithVelocity(n,s,u){this.set(s),this.prev=void 0,this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt-u}jump(n,s=!0){this.updateAndNotify(n),this.prev=n,this.prevUpdatedAt=this.prevFrameValue=void 0,s&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const n=Jc.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||n-this.updatedAt>m7)return 0;const s=Math.min(this.updatedAt-this.prevUpdatedAt,m7);return TS(parseFloat(this.current)-parseFloat(this.prevFrameValue),s)}start(n){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=n(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Yg(r,n){return new UV(r,n)}function $V(r,n,s){r.hasValue(n)?r.getValue(n).set(s):r.addValue(n,Yg(s))}function GV(r,n){const s=E_(r,n);let{transitionEnd:u={},transition:m={},...x}=s||{};x={...x,...u};for(const v in x){const l=BV(x[v]);$V(r,v,l)}}const B2=r=>r.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),qV="framerAppearId",RS="data-"+B2(qV);function LS(r){return r.props[RS]}const Js=r=>!!(r&&r.getVelocity);function ZV(r){return!!(Js(r)&&r.add)}function tx(r,n){const s=r.getValue("willChange");if(ZV(s))return s.add(n)}function WV({protectedKeys:r,needsAnimating:n},s){const u=r.hasOwnProperty(s)&&n[s]!==!0;return n[s]=!1,u}function zS(r,n,{delay:s=0,transitionOverride:u,type:m}={}){var x;let{transition:v=r.getDefaultTransition(),transitionEnd:l,...A}=n;u&&(v=u);const R=[],L=m&&r.animationState&&r.animationState.getState()[m];for(const B in A){const W=r.getValue(B,(x=r.latestValues[B])!==null&&x!==void 0?x:null),re=A[B];if(re===void 0||L&&WV(L,B))continue;const ce={delay:s,...w2(v||{},B)};let Q=!1;if(window.MotionHandoffAnimation){const le=LS(r);if(le){const he=window.MotionHandoffAnimation(le,B,Bn);he!==null&&(ce.startTime=he,Q=!0)}}tx(r,B),W.start(F2(B,W,re,r.shouldReduceMotion&&ep.has(B)?{type:!1}:ce,r,Q));const X=W.animation;X&&R.push(X)}return l&&Promise.all(R).then(()=>{Bn.update(()=>{l&&GV(r,l)})}),R}function rx(r,n,s={}){var u;const m=E_(r,n,s.type==="exit"?(u=r.presenceContext)===null||u===void 0?void 0:u.custom:void 0);let{transition:x=r.getDefaultTransition()||{}}=m||{};s.transitionOverride&&(x=s.transitionOverride);const v=m?()=>Promise.all(zS(r,m,s)):()=>Promise.resolve(),l=r.variantChildren&&r.variantChildren.size?(R=0)=>{const{delayChildren:L=0,staggerChildren:B,staggerDirection:W}=x;return HV(r,n,L+R,B,W,s)}:()=>Promise.resolve(),{when:A}=x;if(A){const[R,L]=A==="beforeChildren"?[v,l]:[l,v];return R().then(()=>L())}else return Promise.all([v(),l(s.delay)])}function HV(r,n,s=0,u=0,m=1,x){const v=[],l=(r.variantChildren.size-1)*u,A=m===1?(R=0)=>R*u:(R=0)=>l-R*u;return Array.from(r.variantChildren).sort(XV).forEach((R,L)=>{R.notify("AnimationStart",n),v.push(rx(R,n,{...x,delay:s+A(L)}).then(()=>R.notify("AnimationComplete",n)))}),Promise.all(v)}function XV(r,n){return r.sortNodePosition(n)}function KV(r,n,s={}){r.notify("AnimationStart",n);let u;if(Array.isArray(n)){const m=n.map(x=>rx(r,x,s));u=Promise.all(m)}else if(typeof n=="string")u=rx(r,n,s);else{const m=typeof n=="function"?E_(r,n,s.custom):n;u=Promise.all(zS(r,m,s))}return u.then(()=>{r.notify("AnimationComplete",n)})}const YV=b2.length;function FS(r){if(!r)return;if(!r.isControllingVariants){const s=r.parent?FS(r.parent)||{}:{};return r.props.initial!==void 0&&(s.initial=r.props.initial),s}const n={};for(let s=0;s<YV;s++){const u=b2[s],m=r.props[u];(Hg(m)||m===!1)&&(n[u]=m)}return n}const QV=[...x2].reverse(),JV=x2.length;function eU(r){return n=>Promise.all(n.map(({animation:s,options:u})=>KV(r,s,u)))}function tU(r){let n=eU(r),s=g7(),u=!0;const m=A=>(R,L)=>{var B;const W=E_(r,L,A==="exit"?(B=r.presenceContext)===null||B===void 0?void 0:B.custom:void 0);if(W){const{transition:re,transitionEnd:ce,...Q}=W;R={...R,...Q,...ce}}return R};function x(A){n=A(r)}function v(A){const{props:R}=r,L=FS(r.parent)||{},B=[],W=new Set;let re={},ce=1/0;for(let X=0;X<JV;X++){const le=QV[X],he=s[le],_e=R[le]!==void 0?R[le]:L[le],Ie=Hg(_e),ke=le===A?he.isActive:null;ke===!1&&(ce=X);let Je=_e===L[le]&&_e!==R[le]&&Ie;if(Je&&u&&r.manuallyAnimateOnMount&&(Je=!1),he.protectedKeys={...re},!he.isActive&&ke===null||!_e&&!he.prevProp||C_(_e)||typeof _e=="boolean")continue;const He=rU(he.prevProp,_e);let nt=He||le===A&&he.isActive&&!Je&&Ie||X>ce&&Ie,Pt=!1;const Ct=Array.isArray(_e)?_e:[_e];let Zt=Ct.reduce(m(le),{});ke===!1&&(Zt={});const{prevResolvedValues:lt={}}=he,Et={...lt,...Zt},ft=mt=>{nt=!0,W.has(mt)&&(Pt=!0,W.delete(mt)),he.needsAnimating[mt]=!0;const Xe=r.getValue(mt);Xe&&(Xe.liveStyle=!1)};for(const mt in Et){const Xe=Zt[mt],Be=lt[mt];if(re.hasOwnProperty(mt))continue;let _t=!1;Z1(Xe)&&Z1(Be)?_t=!HT(Xe,Be):_t=Xe!==Be,_t?Xe!=null?ft(mt):W.add(mt):Xe!==void 0&&W.has(mt)?ft(mt):he.protectedKeys[mt]=!0}he.prevProp=_e,he.prevResolvedValues=Zt,he.isActive&&(re={...re,...Zt}),u&&r.blockInitialAnimation&&(nt=!1),nt&&(!(Je&&He)||Pt)&&B.push(...Ct.map(mt=>({animation:mt,options:{type:le}})))}if(W.size){const X={};W.forEach(le=>{const he=r.getBaseTarget(le),_e=r.getValue(le);_e&&(_e.liveStyle=!0),X[le]=he??null}),B.push({animation:X})}let Q=!!B.length;return u&&(R.initial===!1||R.initial===R.animate)&&!r.manuallyAnimateOnMount&&(Q=!1),u=!1,Q?n(B):Promise.resolve()}function l(A,R){var L;if(s[A].isActive===R)return Promise.resolve();(L=r.variantChildren)===null||L===void 0||L.forEach(W=>{var re;return(re=W.animationState)===null||re===void 0?void 0:re.setActive(A,R)}),s[A].isActive=R;const B=v(A);for(const W in s)s[W].protectedKeys={};return B}return{animateChanges:v,setActive:l,setAnimateFunction:x,getState:()=>s,reset:()=>{s=g7(),u=!0}}}function rU(r,n){return typeof n=="string"?n!==r:Array.isArray(n)?!HT(n,r):!1}function Df(r=!1){return{isActive:r,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function g7(){return{animate:Df(!0),whileInView:Df(),whileHover:Df(),whileTap:Df(),whileDrag:Df(),whileFocus:Df(),exit:Df()}}class Od{constructor(n){this.isMounted=!1,this.node=n}update(){}}class nU extends Od{constructor(n){super(n),n.animationState||(n.animationState=tU(n))}updateAnimationControlsSubscription(){const{animate:n}=this.node.getProps();C_(n)&&(this.unmountControls=n.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:n}=this.node.getProps(),{animate:s}=this.node.prevProps||{};n!==s&&this.updateAnimationControlsSubscription()}unmount(){var n;this.node.animationState.reset(),(n=this.unmountControls)===null||n===void 0||n.call(this)}}let iU=0;class sU extends Od{constructor(){super(...arguments),this.id=iU++}update(){if(!this.node.presenceContext)return;const{isPresent:n,onExitComplete:s}=this.node.presenceContext,{isPresent:u}=this.node.prevPresenceContext||{};if(!this.node.animationState||n===u)return;const m=this.node.animationState.setActive("exit",!n);s&&!n&&m.then(()=>s(this.id))}mount(){const{register:n}=this.node.presenceContext||{};n&&(this.unmount=n(this.id))}unmount(){}}const oU={animation:{Feature:nU},exit:{Feature:sU}};function aU(r,n,s){var u;if(r instanceof Element)return[r];if(typeof r=="string"){let m=document;const x=(u=void 0)!==null&&u!==void 0?u:m.querySelectorAll(r);return x?Array.from(x):[]}return Array.from(r)}const ec={x:!1,y:!1};function OS(){return ec.x||ec.y}function y7(r){return n=>{n.pointerType==="touch"||OS()||r(n)}}function lU(r,n,s={}){const u=new AbortController,m={passive:!0,...s,signal:u.signal},x=y7(v=>{const{target:l}=v,A=n(v);if(!A||!l)return;const R=y7(L=>{A(L),l.removeEventListener("pointerleave",R)});l.addEventListener("pointerleave",R,m)});return aU(r).forEach(v=>{v.addEventListener("pointerenter",x,m)}),()=>u.abort()}function cU(r){return r==="x"||r==="y"?ec[r]?null:(ec[r]=!0,()=>{ec[r]=!1}):ec.x||ec.y?null:(ec.x=ec.y=!0,()=>{ec.x=ec.y=!1})}const NS=r=>r.pointerType==="mouse"?typeof r.button!="number"||r.button<=0:r.isPrimary!==!1;function hy(r){return{point:{x:r.pageX,y:r.pageY}}}const uU=r=>n=>NS(n)&&r(n,hy(n));function eh(r,n,s,u={passive:!0}){return r.addEventListener(n,s,u),()=>r.removeEventListener(n,s)}function Sd(r,n,s,u){return eh(r,n,uU(s),u)}const _7=(r,n)=>Math.abs(r-n);function hU(r,n){const s=_7(r.x,n.x),u=_7(r.y,n.y);return Math.sqrt(s**2+u**2)}class jS{constructor(n,s,{transformPagePoint:u,contextWindow:m,dragSnapToOrigin:x=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const B=i1(this.lastMoveEventInfo,this.history),W=this.startEvent!==null,re=hU(B.offset,{x:0,y:0})>=3;if(!W&&!re)return;const{point:ce}=B,{timestamp:Q}=Rs;this.history.push({...ce,timestamp:Q});const{onStart:X,onMove:le}=this.handlers;W||(X&&X(this.lastMoveEvent,B),this.startEvent=this.lastMoveEvent),le&&le(this.lastMoveEvent,B)},this.handlePointerMove=(B,W)=>{this.lastMoveEvent=B,this.lastMoveEventInfo=n1(W,this.transformPagePoint),Bn.update(this.updatePoint,!0)},this.handlePointerUp=(B,W)=>{this.end();const{onEnd:re,onSessionEnd:ce,resumeAnimation:Q}=this.handlers;if(this.dragSnapToOrigin&&Q&&Q(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const X=i1(B.type==="pointercancel"?this.lastMoveEventInfo:n1(W,this.transformPagePoint),this.history);this.startEvent&&re&&re(B,X),ce&&ce(B,X)},!NS(n))return;this.dragSnapToOrigin=x,this.handlers=s,this.transformPagePoint=u,this.contextWindow=m||window;const v=hy(n),l=n1(v,this.transformPagePoint),{point:A}=l,{timestamp:R}=Rs;this.history=[{...A,timestamp:R}];const{onSessionStart:L}=s;L&&L(n,i1(l,this.history)),this.removeListeners=Td(Sd(this.contextWindow,"pointermove",this.handlePointerMove),Sd(this.contextWindow,"pointerup",this.handlePointerUp),Sd(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(n){this.handlers=n}end(){this.removeListeners&&this.removeListeners(),Dd(this.updatePoint)}}function n1(r,n){return n?{point:n(r.point)}:r}function v7(r,n){return{x:r.x-n.x,y:r.y-n.y}}function i1({point:r},n){return{point:r,delta:v7(r,BS(n)),offset:v7(r,dU(n)),velocity:fU(n,.1)}}function dU(r){return r[0]}function BS(r){return r[r.length-1]}function fU(r,n){if(r.length<2)return{x:0,y:0};let s=r.length-1,u=null;const m=BS(r);for(;s>=0&&(u=r[s],!(m.timestamp-u.timestamp>rh(n)));)s--;if(!u)return{x:0,y:0};const x=nh(m.timestamp-u.timestamp);if(x===0)return{x:0,y:0};const v={x:(m.x-u.x)/x,y:(m.y-u.y)/x};return v.x===1/0&&(v.x=0),v.y===1/0&&(v.y=0),v}function em(r){return r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"current")}const VS=1e-4,pU=1-VS,mU=1+VS,US=.01,gU=0-US,yU=0+US;function Ia(r){return r.max-r.min}function _U(r,n,s){return Math.abs(r-n)<=s}function x7(r,n,s,u=.5){r.origin=u,r.originPoint=_i(n.min,n.max,r.origin),r.scale=Ia(s)/Ia(n),r.translate=_i(s.min,s.max,r.origin)-r.originPoint,(r.scale>=pU&&r.scale<=mU||isNaN(r.scale))&&(r.scale=1),(r.translate>=gU&&r.translate<=yU||isNaN(r.translate))&&(r.translate=0)}function Pg(r,n,s,u){x7(r.x,n.x,s.x,u?u.originX:void 0),x7(r.y,n.y,s.y,u?u.originY:void 0)}function b7(r,n,s){r.min=s.min+n.min,r.max=r.min+Ia(n)}function vU(r,n,s){b7(r.x,n.x,s.x),b7(r.y,n.y,s.y)}function w7(r,n,s){r.min=n.min-s.min,r.max=r.min+Ia(n)}function Cg(r,n,s){w7(r.x,n.x,s.x),w7(r.y,n.y,s.y)}function xU(r,{min:n,max:s},u){return n!==void 0&&r<n?r=u?_i(n,r,u.min):Math.max(r,n):s!==void 0&&r>s&&(r=u?_i(s,r,u.max):Math.min(r,s)),r}function T7(r,n,s){return{min:n!==void 0?r.min+n:void 0,max:s!==void 0?r.max+s-(r.max-r.min):void 0}}function bU(r,{top:n,left:s,bottom:u,right:m}){return{x:T7(r.x,s,m),y:T7(r.y,n,u)}}function S7(r,n){let s=n.min-r.min,u=n.max-r.max;return n.max-n.min<r.max-r.min&&([s,u]=[u,s]),{min:s,max:u}}function wU(r,n){return{x:S7(r.x,n.x),y:S7(r.y,n.y)}}function TU(r,n){let s=.5;const u=Ia(r),m=Ia(n);return m>u?s=xm(n.min,n.max-u,r.min):u>m&&(s=xm(r.min,r.max-m,n.min)),lh(0,1,s)}function SU(r,n){const s={};return n.min!==void 0&&(s.min=n.min-r.min),n.max!==void 0&&(s.max=n.max-r.min),s}const nx=.35;function PU(r=nx){return r===!1?r=0:r===!0&&(r=nx),{x:P7(r,"left","right"),y:P7(r,"top","bottom")}}function P7(r,n,s){return{min:C7(r,n),max:C7(r,s)}}function C7(r,n){return typeof r=="number"?r:r[n]||0}const E7=()=>({translate:0,scale:1,origin:0,originPoint:0}),tm=()=>({x:E7(),y:E7()}),M7=()=>({min:0,max:0}),Ni=()=>({x:M7(),y:M7()});function sl(r){return[r("x"),r("y")]}function $S({top:r,left:n,right:s,bottom:u}){return{x:{min:n,max:s},y:{min:r,max:u}}}function CU({x:r,y:n}){return{top:n.min,right:r.max,bottom:n.max,left:r.min}}function EU(r,n){if(!n)return r;const s=n({x:r.left,y:r.top}),u=n({x:r.right,y:r.bottom});return{top:s.y,left:s.x,bottom:u.y,right:u.x}}function s1(r){return r===void 0||r===1}function ix({scale:r,scaleX:n,scaleY:s}){return!s1(r)||!s1(n)||!s1(s)}function Lf(r){return ix(r)||GS(r)||r.z||r.rotate||r.rotateX||r.rotateY||r.skewX||r.skewY}function GS(r){return I7(r.x)||I7(r.y)}function I7(r){return r&&r!=="0%"}function Q0(r,n,s){const u=r-s,m=n*u;return s+m}function A7(r,n,s,u,m){return m!==void 0&&(r=Q0(r,m,u)),Q0(r,s,u)+n}function sx(r,n=0,s=1,u,m){r.min=A7(r.min,n,s,u,m),r.max=A7(r.max,n,s,u,m)}function qS(r,{x:n,y:s}){sx(r.x,n.translate,n.scale,n.originPoint),sx(r.y,s.translate,s.scale,s.originPoint)}const k7=.999999999999,D7=1.0000000000001;function MU(r,n,s,u=!1){const m=s.length;if(!m)return;n.x=n.y=1;let x,v;for(let l=0;l<m;l++){x=s[l],v=x.projectionDelta;const{visualElement:A}=x.options;A&&A.props.style&&A.props.style.display==="contents"||(u&&x.options.layoutScroll&&x.scroll&&x!==x.root&&nm(r,{x:-x.scroll.offset.x,y:-x.scroll.offset.y}),v&&(n.x*=v.x.scale,n.y*=v.y.scale,qS(r,v)),u&&Lf(x.latestValues)&&nm(r,x.latestValues))}n.x<D7&&n.x>k7&&(n.x=1),n.y<D7&&n.y>k7&&(n.y=1)}function rm(r,n){r.min=r.min+n,r.max=r.max+n}function R7(r,n,s,u,m=.5){const x=_i(r.min,r.max,m);sx(r,n,s,x,u)}function nm(r,n){R7(r.x,n.x,n.scaleX,n.scale,n.originX),R7(r.y,n.y,n.scaleY,n.scale,n.originY)}function ZS(r,n){return $S(EU(r.getBoundingClientRect(),n))}function IU(r,n,s){const u=ZS(r,s),{scroll:m}=n;return m&&(rm(u.x,m.offset.x),rm(u.y,m.offset.y)),u}const WS=({current:r})=>r?r.ownerDocument.defaultView:null,AU=new WeakMap;class kU{constructor(n){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ni(),this.visualElement=n}start(n,{snapToCursor:s=!1}={}){const{presenceContext:u}=this.visualElement;if(u&&u.isPresent===!1)return;const m=L=>{const{dragSnapToOrigin:B}=this.getProps();B?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(hy(L).point)},x=(L,B)=>{const{drag:W,dragPropagation:re,onDragStart:ce}=this.getProps();if(W&&!re&&(this.openDragLock&&this.openDragLock(),this.openDragLock=cU(W),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),sl(X=>{let le=this.getAxisMotionValue(X).get()||0;if(Qc.test(le)){const{projection:he}=this.visualElement;if(he&&he.layout){const _e=he.layout.layoutBox[X];_e&&(le=Ia(_e)*(parseFloat(le)/100))}}this.originPoint[X]=le}),ce&&Bn.postRender(()=>ce(L,B)),tx(this.visualElement,"transform");const{animationState:Q}=this.visualElement;Q&&Q.setActive("whileDrag",!0)},v=(L,B)=>{const{dragPropagation:W,dragDirectionLock:re,onDirectionLock:ce,onDrag:Q}=this.getProps();if(!W&&!this.openDragLock)return;const{offset:X}=B;if(re&&this.currentDirection===null){this.currentDirection=DU(X),this.currentDirection!==null&&ce&&ce(this.currentDirection);return}this.updateAxis("x",B.point,X),this.updateAxis("y",B.point,X),this.visualElement.render(),Q&&Q(L,B)},l=(L,B)=>this.stop(L,B),A=()=>sl(L=>{var B;return this.getAnimationState(L)==="paused"&&((B=this.getAxisMotionValue(L).animation)===null||B===void 0?void 0:B.play())}),{dragSnapToOrigin:R}=this.getProps();this.panSession=new jS(n,{onSessionStart:m,onStart:x,onMove:v,onSessionEnd:l,resumeAnimation:A},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:R,contextWindow:WS(this.visualElement)})}stop(n,s){const u=this.isDragging;if(this.cancel(),!u)return;const{velocity:m}=s;this.startAnimation(m);const{onDragEnd:x}=this.getProps();x&&Bn.postRender(()=>x(n,s))}cancel(){this.isDragging=!1;const{projection:n,animationState:s}=this.visualElement;n&&(n.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:u}=this.getProps();!u&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(n,s,u){const{drag:m}=this.getProps();if(!u||!h0(n,m,this.currentDirection))return;const x=this.getAxisMotionValue(n);let v=this.originPoint[n]+u[n];this.constraints&&this.constraints[n]&&(v=xU(v,this.constraints[n],this.elastic[n])),x.set(v)}resolveConstraints(){var n;const{dragConstraints:s,dragElastic:u}=this.getProps(),m=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(n=this.visualElement.projection)===null||n===void 0?void 0:n.layout,x=this.constraints;s&&em(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&m?this.constraints=bU(m.layoutBox,s):this.constraints=!1,this.elastic=PU(u),x!==this.constraints&&m&&this.constraints&&!this.hasMutatedConstraints&&sl(v=>{this.constraints!==!1&&this.getAxisMotionValue(v)&&(this.constraints[v]=SU(m.layoutBox[v],this.constraints[v]))})}resolveRefConstraints(){const{dragConstraints:n,onMeasureDragConstraints:s}=this.getProps();if(!n||!em(n))return!1;const u=n.current,{projection:m}=this.visualElement;if(!m||!m.layout)return!1;const x=IU(u,m.root,this.visualElement.getTransformPagePoint());let v=wU(m.layout.layoutBox,x);if(s){const l=s(CU(v));this.hasMutatedConstraints=!!l,l&&(v=$S(l))}return v}startAnimation(n){const{drag:s,dragMomentum:u,dragElastic:m,dragTransition:x,dragSnapToOrigin:v,onDragTransitionEnd:l}=this.getProps(),A=this.constraints||{},R=sl(L=>{if(!h0(L,s,this.currentDirection))return;let B=A&&A[L]||{};v&&(B={min:0,max:0});const W=m?200:1e6,re=m?40:1e7,ce={type:"inertia",velocity:u?n[L]:0,bounceStiffness:W,bounceDamping:re,timeConstant:750,restDelta:1,restSpeed:10,...x,...B};return this.startAxisValueAnimation(L,ce)});return Promise.all(R).then(l)}startAxisValueAnimation(n,s){const u=this.getAxisMotionValue(n);return tx(this.visualElement,n),u.start(F2(n,u,0,s,this.visualElement,!1))}stopAnimation(){sl(n=>this.getAxisMotionValue(n).stop())}pauseAnimation(){sl(n=>{var s;return(s=this.getAxisMotionValue(n).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(n){var s;return(s=this.getAxisMotionValue(n).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(n){const s=`_drag${n.toUpperCase()}`,u=this.visualElement.getProps(),m=u[s];return m||this.visualElement.getValue(n,(u.initial?u.initial[n]:void 0)||0)}snapToCursor(n){sl(s=>{const{drag:u}=this.getProps();if(!h0(s,u,this.currentDirection))return;const{projection:m}=this.visualElement,x=this.getAxisMotionValue(s);if(m&&m.layout){const{min:v,max:l}=m.layout.layoutBox[s];x.set(n[s]-_i(v,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:n,dragConstraints:s}=this.getProps(),{projection:u}=this.visualElement;if(!em(s)||!u||!this.constraints)return;this.stopAnimation();const m={x:0,y:0};sl(v=>{const l=this.getAxisMotionValue(v);if(l&&this.constraints!==!1){const A=l.get();m[v]=TU({min:A,max:A},this.constraints[v])}});const{transformTemplate:x}=this.visualElement.getProps();this.visualElement.current.style.transform=x?x({},""):"none",u.root&&u.root.updateScroll(),u.updateLayout(),this.resolveConstraints(),sl(v=>{if(!h0(v,n,null))return;const l=this.getAxisMotionValue(v),{min:A,max:R}=this.constraints[v];l.set(_i(A,R,m[v]))})}addListeners(){if(!this.visualElement.current)return;AU.set(this.visualElement,this);const n=this.visualElement.current,s=Sd(n,"pointerdown",A=>{const{drag:R,dragListener:L=!0}=this.getProps();R&&L&&this.start(A)}),u=()=>{const{dragConstraints:A}=this.getProps();em(A)&&A.current&&(this.constraints=this.resolveRefConstraints())},{projection:m}=this.visualElement,x=m.addEventListener("measure",u);m&&!m.layout&&(m.root&&m.root.updateScroll(),m.updateLayout()),Bn.read(u);const v=eh(window,"resize",()=>this.scalePositionWithinConstraints()),l=m.addEventListener("didUpdate",(({delta:A,hasLayoutChanged:R})=>{this.isDragging&&R&&(sl(L=>{const B=this.getAxisMotionValue(L);B&&(this.originPoint[L]+=A[L].translate,B.set(B.get()+A[L].translate))}),this.visualElement.render())}));return()=>{v(),s(),x(),l&&l()}}getProps(){const n=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:u=!1,dragPropagation:m=!1,dragConstraints:x=!1,dragElastic:v=nx,dragMomentum:l=!0}=n;return{...n,drag:s,dragDirectionLock:u,dragPropagation:m,dragConstraints:x,dragElastic:v,dragMomentum:l}}}function h0(r,n,s){return(n===!0||n===r)&&(s===null||s===r)}function DU(r,n=10){let s=null;return Math.abs(r.y)>n?s="y":Math.abs(r.x)>n&&(s="x"),s}class RU extends Od{constructor(n){super(n),this.removeGroupControls=eo,this.removeListeners=eo,this.controls=new kU(n)}mount(){const{dragControls:n}=this.node.getProps();n&&(this.removeGroupControls=n.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||eo}unmount(){this.removeGroupControls(),this.removeListeners()}}const L7=r=>(n,s)=>{r&&Bn.postRender(()=>r(n,s))};class LU extends Od{constructor(){super(...arguments),this.removePointerDownListener=eo}onPointerDown(n){this.session=new jS(n,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:WS(this.node)})}createPanHandlers(){const{onPanSessionStart:n,onPanStart:s,onPan:u,onPanEnd:m}=this.node.getProps();return{onSessionStart:L7(n),onStart:L7(s),onMove:u,onEnd:(x,v)=>{delete this.session,m&&Bn.postRender(()=>m(x,v))}}}mount(){this.removePointerDownListener=Sd(this.node.current,"pointerdown",n=>this.onPointerDown(n))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const I_=j.createContext(null);function zU(){const r=j.useContext(I_);if(r===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:u}=r,m=j.useId();j.useEffect(()=>u(m),[]);const x=j.useCallback(()=>s&&s(m),[m,s]);return!n&&s?[!1,x]:[!0]}const V2=j.createContext({}),HS=j.createContext({}),b0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function z7(r,n){return n.max===n.min?0:r/(n.max-n.min)*100}const pg={correct:(r,n)=>{if(!n.target)return r;if(typeof r=="string")if(wr.test(r))r=parseFloat(r);else return r;const s=z7(r,n.target.x),u=z7(r,n.target.y);return`${s}% ${u}%`}},FU={correct:(r,{treeScale:n,projectionDelta:s})=>{const u=r,m=Rd.parse(r);if(m.length>5)return u;const x=Rd.createTransformer(r),v=typeof m[0]!="number"?1:0,l=s.x.scale*n.x,A=s.y.scale*n.y;m[0+v]/=l,m[1+v]/=A;const R=_i(l,A,.5);return typeof m[2+v]=="number"&&(m[2+v]/=R),typeof m[3+v]=="number"&&(m[3+v]/=R),x(m)}},J0={};function OU(r){Object.assign(J0,r)}const{schedule:U2}=KT(queueMicrotask,!1);class NU extends j.Component{componentDidMount(){const{visualElement:n,layoutGroup:s,switchLayoutGroup:u,layoutId:m}=this.props,{projection:x}=n;OU(jU),x&&(s.group&&s.group.add(x),u&&u.register&&m&&u.register(x),x.root.didUpdate(),x.addEventListener("animationComplete",()=>{this.safeToRemove()}),x.setOptions({...x.options,onExitComplete:()=>this.safeToRemove()})),b0.hasEverUpdated=!0}getSnapshotBeforeUpdate(n){const{layoutDependency:s,visualElement:u,drag:m,isPresent:x}=this.props,v=u.projection;return v&&(v.isPresent=x,m||n.layoutDependency!==s||s===void 0?v.willUpdate():this.safeToRemove(),n.isPresent!==x&&(x?v.promote():v.relegate()||Bn.postRender(()=>{const l=v.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:n}=this.props.visualElement;n&&(n.root.didUpdate(),U2.postRender(()=>{!n.currentAnimation&&n.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:n,layoutGroup:s,switchLayoutGroup:u}=this.props,{projection:m}=n;m&&(m.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(m),u&&u.deregister&&u.deregister(m))}safeToRemove(){const{safeToRemove:n}=this.props;n&&n()}render(){return null}}function XS(r){const[n,s]=zU(),u=j.useContext(V2);return V.jsx(NU,{...r,layoutGroup:u,switchLayoutGroup:j.useContext(HS),isPresent:n,safeToRemove:s})}const jU={borderRadius:{...pg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:pg,borderTopRightRadius:pg,borderBottomLeftRadius:pg,borderBottomRightRadius:pg,boxShadow:FU},KS=["TopLeft","TopRight","BottomLeft","BottomRight"],BU=KS.length,F7=r=>typeof r=="string"?parseFloat(r):r,O7=r=>typeof r=="number"||wr.test(r);function VU(r,n,s,u,m,x){m?(r.opacity=_i(0,s.opacity!==void 0?s.opacity:1,UU(u)),r.opacityExit=_i(n.opacity!==void 0?n.opacity:1,0,$U(u))):x&&(r.opacity=_i(n.opacity!==void 0?n.opacity:1,s.opacity!==void 0?s.opacity:1,u));for(let v=0;v<BU;v++){const l=`border${KS[v]}Radius`;let A=N7(n,l),R=N7(s,l);if(A===void 0&&R===void 0)continue;A||(A=0),R||(R=0),A===0||R===0||O7(A)===O7(R)?(r[l]=Math.max(_i(F7(A),F7(R),u),0),(Qc.test(R)||Qc.test(A))&&(r[l]+="%")):r[l]=R}(n.rotate||s.rotate)&&(r.rotate=_i(n.rotate||0,s.rotate||0,u))}function N7(r,n){return r[n]!==void 0?r[n]:r.borderRadius}const UU=YS(0,.5,nS),$U=YS(.5,.95,eo);function YS(r,n,s){return u=>u<r?0:u>n?1:s(xm(r,n,u))}function j7(r,n){r.min=n.min,r.max=n.max}function il(r,n){j7(r.x,n.x),j7(r.y,n.y)}function B7(r,n){r.translate=n.translate,r.scale=n.scale,r.originPoint=n.originPoint,r.origin=n.origin}function V7(r,n,s,u,m){return r-=n,r=Q0(r,1/s,u),m!==void 0&&(r=Q0(r,1/m,u)),r}function GU(r,n=0,s=1,u=.5,m,x=r,v=r){if(Qc.test(n)&&(n=parseFloat(n),n=_i(v.min,v.max,n/100)-v.min),typeof n!="number")return;let l=_i(x.min,x.max,u);r===x&&(l-=n),r.min=V7(r.min,n,s,l,m),r.max=V7(r.max,n,s,l,m)}function U7(r,n,[s,u,m],x,v){GU(r,n[s],n[u],n[m],n.scale,x,v)}const qU=["x","scaleX","originX"],ZU=["y","scaleY","originY"];function $7(r,n,s,u){U7(r.x,n,qU,s?s.x:void 0,u?u.x:void 0),U7(r.y,n,ZU,s?s.y:void 0,u?u.y:void 0)}function G7(r){return r.translate===0&&r.scale===1}function QS(r){return G7(r.x)&&G7(r.y)}function q7(r,n){return r.min===n.min&&r.max===n.max}function WU(r,n){return q7(r.x,n.x)&&q7(r.y,n.y)}function Z7(r,n){return Math.round(r.min)===Math.round(n.min)&&Math.round(r.max)===Math.round(n.max)}function JS(r,n){return Z7(r.x,n.x)&&Z7(r.y,n.y)}function W7(r){return Ia(r.x)/Ia(r.y)}function H7(r,n){return r.translate===n.translate&&r.scale===n.scale&&r.originPoint===n.originPoint}class HU{constructor(){this.members=[]}add(n){O2(this.members,n),n.scheduleRender()}remove(n){if(N2(this.members,n),n===this.prevLead&&(this.prevLead=void 0),n===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(n){const s=this.members.findIndex(m=>n===m);if(s===0)return!1;let u;for(let m=s;m>=0;m--){const x=this.members[m];if(x.isPresent!==!1){u=x;break}}return u?(this.promote(u),!0):!1}promote(n,s){const u=this.lead;if(n!==u&&(this.prevLead=u,this.lead=n,n.show(),u)){u.instance&&u.scheduleRender(),n.scheduleRender(),n.resumeFrom=u,s&&(n.resumeFrom.preserveOpacity=!0),u.snapshot&&(n.snapshot=u.snapshot,n.snapshot.latestValues=u.animationValues||u.latestValues),n.root&&n.root.isUpdating&&(n.isLayoutDirty=!0);const{crossfade:m}=n.options;m===!1&&u.hide()}}exitAnimationComplete(){this.members.forEach(n=>{const{options:s,resumingFrom:u}=n;s.onExitComplete&&s.onExitComplete(),u&&u.options.onExitComplete&&u.options.onExitComplete()})}scheduleRender(){this.members.forEach(n=>{n.instance&&n.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function XU(r,n,s){let u="";const m=r.x.translate/n.x,x=r.y.translate/n.y,v=s?.z||0;if((m||x||v)&&(u=`translate3d(${m}px, ${x}px, ${v}px) `),(n.x!==1||n.y!==1)&&(u+=`scale(${1/n.x}, ${1/n.y}) `),s){const{transformPerspective:R,rotate:L,rotateX:B,rotateY:W,skewX:re,skewY:ce}=s;R&&(u=`perspective(${R}px) ${u}`),L&&(u+=`rotate(${L}deg) `),B&&(u+=`rotateX(${B}deg) `),W&&(u+=`rotateY(${W}deg) `),re&&(u+=`skewX(${re}deg) `),ce&&(u+=`skewY(${ce}deg) `)}const l=r.x.scale*n.x,A=r.y.scale*n.y;return(l!==1||A!==1)&&(u+=`scale(${l}, ${A})`),u||"none"}const KU=(r,n)=>r.depth-n.depth;class YU{constructor(){this.children=[],this.isDirty=!1}add(n){O2(this.children,n),this.isDirty=!0}remove(n){N2(this.children,n),this.isDirty=!0}forEach(n){this.isDirty&&this.children.sort(KU),this.isDirty=!1,this.children.forEach(n)}}function w0(r){const n=Js(r)?r.get():r;return jV(n)?n.toValue():n}function QU(r,n){const s=Jc.now(),u=({timestamp:m})=>{const x=m-s;x>=n&&(Dd(u),r(x-n))};return Bn.read(u,!0),()=>Dd(u)}function JU(r){return r instanceof SVGElement&&r.tagName!=="svg"}function e$(r,n,s){const u=Js(r)?r:Yg(r);return u.start(F2("",u,n,s)),u.animation}const zf={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},xg=typeof window<"u"&&window.MotionDebug!==void 0,o1=["","X","Y","Z"],t$={visibility:"hidden"},X7=1e3;let r$=0;function a1(r,n,s,u){const{latestValues:m}=n;m[r]&&(s[r]=m[r],n.setStaticValue(r,0),u&&(u[r]=0))}function eP(r){if(r.hasCheckedOptimisedAppear=!0,r.root===r)return;const{visualElement:n}=r.options;if(!n)return;const s=LS(n);if(window.MotionHasOptimisedAnimation(s,"transform")){const{layout:m,layoutId:x}=r.options;window.MotionCancelOptimisedAnimation(s,"transform",Bn,!(m||x))}const{parent:u}=r;u&&!u.hasCheckedOptimisedAppear&&eP(u)}function tP({attachResizeListener:r,defaultParent:n,measureScroll:s,checkIsScrollRoot:u,resetTransform:m}){return class{constructor(v={},l=n?.()){this.id=r$++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,xg&&(zf.totalNodes=zf.resolvedTargetDeltas=zf.recalculatedProjection=0),this.nodes.forEach(s$),this.nodes.forEach(u$),this.nodes.forEach(h$),this.nodes.forEach(o$),xg&&window.MotionDebug.record(zf)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=v,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let A=0;A<this.path.length;A++)this.path[A].shouldResetTransform=!0;this.root===this&&(this.nodes=new YU)}addEventListener(v,l){return this.eventHandlers.has(v)||this.eventHandlers.set(v,new j2),this.eventHandlers.get(v).add(l)}notifyListeners(v,...l){const A=this.eventHandlers.get(v);A&&A.notify(...l)}hasListeners(v){return this.eventHandlers.has(v)}mount(v,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=JU(v),this.instance=v;const{layoutId:A,layout:R,visualElement:L}=this.options;if(L&&!L.current&&L.mount(v),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(R||A)&&(this.isLayoutDirty=!0),r){let B;const W=()=>this.root.updateBlockedByResize=!1;r(v,()=>{this.root.updateBlockedByResize=!0,B&&B(),B=QU(W,250),b0.hasAnimatedSinceResize&&(b0.hasAnimatedSinceResize=!1,this.nodes.forEach(Y7))})}A&&this.root.registerSharedNode(A,this),this.options.animate!==!1&&L&&(A||R)&&this.addEventListener("didUpdate",({delta:B,hasLayoutChanged:W,hasRelativeTargetChanged:re,layout:ce})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const Q=this.options.transition||L.getDefaultTransition()||g$,{onLayoutAnimationStart:X,onLayoutAnimationComplete:le}=L.getProps(),he=!this.targetLayout||!JS(this.targetLayout,ce)||re,_e=!W&&re;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||_e||W&&(he||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(B,_e);const Ie={...w2(Q,"layout"),onPlay:X,onComplete:le};(L.shouldReduceMotion||this.options.layoutRoot)&&(Ie.delay=0,Ie.type=!1),this.startAnimation(Ie)}else W||Y7(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=ce})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const v=this.getStack();v&&v.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Dd(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(d$),this.animationId++)}getTransformTemplate(){const{visualElement:v}=this.options;return v&&v.getProps().transformTemplate}willUpdate(v=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&eP(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let L=0;L<this.path.length;L++){const B=this.path[L];B.shouldResetTransform=!0,B.updateScroll("snapshot"),B.options.layoutRoot&&B.willUpdate(!1)}const{layoutId:l,layout:A}=this.options;if(l===void 0&&!A)return;const R=this.getTransformTemplate();this.prevTransformTemplateValue=R?R(this.latestValues,""):void 0,this.updateSnapshot(),v&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(K7);return}this.isUpdating||this.nodes.forEach(l$),this.isUpdating=!1,this.nodes.forEach(c$),this.nodes.forEach(n$),this.nodes.forEach(i$),this.clearAllSnapshots();const l=Jc.now();Rs.delta=lh(0,1e3/60,l-Rs.timestamp),Rs.timestamp=l,Rs.isProcessing=!0,Qv.update.process(Rs),Qv.preRender.process(Rs),Qv.render.process(Rs),Rs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,U2.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(a$),this.sharedNodes.forEach(f$)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Bn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Bn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let A=0;A<this.path.length;A++)this.path[A].updateScroll();const v=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ni(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,v?v.layoutBox:void 0)}updateScroll(v="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===v&&(l=!1),l){const A=u(this.instance);this.scroll={animationId:this.root.animationId,phase:v,isRoot:A,offset:s(this.instance),wasRoot:this.scroll?this.scroll.isRoot:A}}}resetTransform(){if(!m)return;const v=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!QS(this.projectionDelta),A=this.getTransformTemplate(),R=A?A(this.latestValues,""):void 0,L=R!==this.prevTransformTemplateValue;v&&(l||Lf(this.latestValues)||L)&&(m(this.instance,R),this.shouldResetTransform=!1,this.scheduleRender())}measure(v=!0){const l=this.measurePageBox();let A=this.removeElementScroll(l);return v&&(A=this.removeTransform(A)),y$(A),{animationId:this.root.animationId,measuredBox:l,layoutBox:A,latestValues:{},source:this.id}}measurePageBox(){var v;const{visualElement:l}=this.options;if(!l)return Ni();const A=l.measureViewportBox();if(!(((v=this.scroll)===null||v===void 0?void 0:v.wasRoot)||this.path.some(_$))){const{scroll:L}=this.root;L&&(rm(A.x,L.offset.x),rm(A.y,L.offset.y))}return A}removeElementScroll(v){var l;const A=Ni();if(il(A,v),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return A;for(let R=0;R<this.path.length;R++){const L=this.path[R],{scroll:B,options:W}=L;L!==this.root&&B&&W.layoutScroll&&(B.wasRoot&&il(A,v),rm(A.x,B.offset.x),rm(A.y,B.offset.y))}return A}applyTransform(v,l=!1){const A=Ni();il(A,v);for(let R=0;R<this.path.length;R++){const L=this.path[R];!l&&L.options.layoutScroll&&L.scroll&&L!==L.root&&nm(A,{x:-L.scroll.offset.x,y:-L.scroll.offset.y}),Lf(L.latestValues)&&nm(A,L.latestValues)}return Lf(this.latestValues)&&nm(A,this.latestValues),A}removeTransform(v){const l=Ni();il(l,v);for(let A=0;A<this.path.length;A++){const R=this.path[A];if(!R.instance||!Lf(R.latestValues))continue;ix(R.latestValues)&&R.updateSnapshot();const L=Ni(),B=R.measurePageBox();il(L,B),$7(l,R.latestValues,R.snapshot?R.snapshot.layoutBox:void 0,L)}return Lf(this.latestValues)&&$7(l,this.latestValues),l}setTargetDelta(v){this.targetDelta=v,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(v){this.options={...this.options,...v,crossfade:v.crossfade!==void 0?v.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Rs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(v=!1){var l;const A=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=A.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=A.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=A.isSharedProjectionDirty);const R=!!this.resumingFrom||this!==A;if(!(v||R&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:B,layoutId:W}=this.options;if(!(!this.layout||!(B||W))){if(this.resolvedRelativeTargetAt=Rs.timestamp,!this.targetDelta&&!this.relativeTarget){const re=this.getClosestProjectingParent();re&&re.layout&&this.animationProgress!==1?(this.relativeParent=re,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ni(),this.relativeTargetOrigin=Ni(),Cg(this.relativeTargetOrigin,this.layout.layoutBox,re.layout.layoutBox),il(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ni(),this.targetWithTransforms=Ni()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),vU(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):il(this.target,this.layout.layoutBox),qS(this.target,this.targetDelta)):il(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const re=this.getClosestProjectingParent();re&&!!re.resumingFrom==!!this.resumingFrom&&!re.options.layoutScroll&&re.target&&this.animationProgress!==1?(this.relativeParent=re,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ni(),this.relativeTargetOrigin=Ni(),Cg(this.relativeTargetOrigin,this.target,re.target),il(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}xg&&zf.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||ix(this.parent.latestValues)||GS(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var v;const l=this.getLead(),A=!!this.resumingFrom||this!==l;let R=!0;if((this.isProjectionDirty||!((v=this.parent)===null||v===void 0)&&v.isProjectionDirty)&&(R=!1),A&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(R=!1),this.resolvedRelativeTargetAt===Rs.timestamp&&(R=!1),R)return;const{layout:L,layoutId:B}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(L||B))return;il(this.layoutCorrected,this.layout.layoutBox);const W=this.treeScale.x,re=this.treeScale.y;MU(this.layoutCorrected,this.treeScale,this.path,A),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ni());const{target:ce}=l;if(!ce){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(B7(this.prevProjectionDelta.x,this.projectionDelta.x),B7(this.prevProjectionDelta.y,this.projectionDelta.y)),Pg(this.projectionDelta,this.layoutCorrected,ce,this.latestValues),(this.treeScale.x!==W||this.treeScale.y!==re||!H7(this.projectionDelta.x,this.prevProjectionDelta.x)||!H7(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",ce)),xg&&zf.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(v=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),v){const A=this.getStack();A&&A.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=tm(),this.projectionDelta=tm(),this.projectionDeltaWithTransform=tm()}setAnimationOrigin(v,l=!1){const A=this.snapshot,R=A?A.latestValues:{},L={...this.latestValues},B=tm();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const W=Ni(),re=A?A.source:void 0,ce=this.layout?this.layout.source:void 0,Q=re!==ce,X=this.getStack(),le=!X||X.members.length<=1,he=!!(Q&&!le&&this.options.crossfade===!0&&!this.path.some(m$));this.animationProgress=0;let _e;this.mixTargetDelta=Ie=>{const ke=Ie/1e3;Q7(B.x,v.x,ke),Q7(B.y,v.y,ke),this.setTargetDelta(B),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Cg(W,this.layout.layoutBox,this.relativeParent.layout.layoutBox),p$(this.relativeTarget,this.relativeTargetOrigin,W,ke),_e&&WU(this.relativeTarget,_e)&&(this.isProjectionDirty=!1),_e||(_e=Ni()),il(_e,this.relativeTarget)),Q&&(this.animationValues=L,VU(L,R,this.latestValues,ke,he,le)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=ke},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(v){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Dd(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Bn.update(()=>{b0.hasAnimatedSinceResize=!0,this.currentAnimation=e$(0,X7,{...v,onUpdate:l=>{this.mixTargetDelta(l),v.onUpdate&&v.onUpdate(l)},onComplete:()=>{v.onComplete&&v.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const v=this.getStack();v&&v.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(X7),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const v=this.getLead();let{targetWithTransforms:l,target:A,layout:R,latestValues:L}=v;if(!(!l||!A||!R)){if(this!==v&&this.layout&&R&&rP(this.options.animationType,this.layout.layoutBox,R.layoutBox)){A=this.target||Ni();const B=Ia(this.layout.layoutBox.x);A.x.min=v.target.x.min,A.x.max=A.x.min+B;const W=Ia(this.layout.layoutBox.y);A.y.min=v.target.y.min,A.y.max=A.y.min+W}il(l,A),nm(l,L),Pg(this.projectionDeltaWithTransform,this.layoutCorrected,l,L)}}registerSharedNode(v,l){this.sharedNodes.has(v)||this.sharedNodes.set(v,new HU),this.sharedNodes.get(v).add(l);const R=l.options.initialPromotionConfig;l.promote({transition:R?R.transition:void 0,preserveFollowOpacity:R&&R.shouldPreserveFollowOpacity?R.shouldPreserveFollowOpacity(l):void 0})}isLead(){const v=this.getStack();return v?v.lead===this:!0}getLead(){var v;const{layoutId:l}=this.options;return l?((v=this.getStack())===null||v===void 0?void 0:v.lead)||this:this}getPrevLead(){var v;const{layoutId:l}=this.options;return l?(v=this.getStack())===null||v===void 0?void 0:v.prevLead:void 0}getStack(){const{layoutId:v}=this.options;if(v)return this.root.sharedNodes.get(v)}promote({needsReset:v,transition:l,preserveFollowOpacity:A}={}){const R=this.getStack();R&&R.promote(this,A),v&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const v=this.getStack();return v?v.relegate(this):!1}resetSkewAndRotation(){const{visualElement:v}=this.options;if(!v)return;let l=!1;const{latestValues:A}=v;if((A.z||A.rotate||A.rotateX||A.rotateY||A.rotateZ||A.skewX||A.skewY)&&(l=!0),!l)return;const R={};A.z&&a1("z",v,R,this.animationValues);for(let L=0;L<o1.length;L++)a1(`rotate${o1[L]}`,v,R,this.animationValues),a1(`skew${o1[L]}`,v,R,this.animationValues);v.render();for(const L in R)v.setStaticValue(L,R[L]),this.animationValues&&(this.animationValues[L]=R[L]);v.scheduleRender()}getProjectionStyles(v){var l,A;if(!this.instance||this.isSVG)return;if(!this.isVisible)return t$;const R={visibility:""},L=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,R.opacity="",R.pointerEvents=w0(v?.pointerEvents)||"",R.transform=L?L(this.latestValues,""):"none",R;const B=this.getLead();if(!this.projectionDelta||!this.layout||!B.target){const Q={};return this.options.layoutId&&(Q.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,Q.pointerEvents=w0(v?.pointerEvents)||""),this.hasProjected&&!Lf(this.latestValues)&&(Q.transform=L?L({},""):"none",this.hasProjected=!1),Q}const W=B.animationValues||B.latestValues;this.applyTransformsToTarget(),R.transform=XU(this.projectionDeltaWithTransform,this.treeScale,W),L&&(R.transform=L(W,R.transform));const{x:re,y:ce}=this.projectionDelta;R.transformOrigin=`${re.origin*100}% ${ce.origin*100}% 0`,B.animationValues?R.opacity=B===this?(A=(l=W.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&A!==void 0?A:1:this.preserveOpacity?this.latestValues.opacity:W.opacityExit:R.opacity=B===this?W.opacity!==void 0?W.opacity:"":W.opacityExit!==void 0?W.opacityExit:0;for(const Q in J0){if(W[Q]===void 0)continue;const{correct:X,applyTo:le}=J0[Q],he=R.transform==="none"?W[Q]:X(W[Q],B);if(le){const _e=le.length;for(let Ie=0;Ie<_e;Ie++)R[le[Ie]]=he}else R[Q]=he}return this.options.layoutId&&(R.pointerEvents=B===this?w0(v?.pointerEvents)||"":"none"),R}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(v=>{var l;return(l=v.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(K7),this.root.sharedNodes.clear()}}}function n$(r){r.updateLayout()}function i$(r){var n;const s=((n=r.resumeFrom)===null||n===void 0?void 0:n.snapshot)||r.snapshot;if(r.isLead()&&r.layout&&s&&r.hasListeners("didUpdate")){const{layoutBox:u,measuredBox:m}=r.layout,{animationType:x}=r.options,v=s.source!==r.layout.source;x==="size"?sl(B=>{const W=v?s.measuredBox[B]:s.layoutBox[B],re=Ia(W);W.min=u[B].min,W.max=W.min+re}):rP(x,s.layoutBox,u)&&sl(B=>{const W=v?s.measuredBox[B]:s.layoutBox[B],re=Ia(u[B]);W.max=W.min+re,r.relativeTarget&&!r.currentAnimation&&(r.isProjectionDirty=!0,r.relativeTarget[B].max=r.relativeTarget[B].min+re)});const l=tm();Pg(l,u,s.layoutBox);const A=tm();v?Pg(A,r.applyTransform(m,!0),s.measuredBox):Pg(A,u,s.layoutBox);const R=!QS(l);let L=!1;if(!r.resumeFrom){const B=r.getClosestProjectingParent();if(B&&!B.resumeFrom){const{snapshot:W,layout:re}=B;if(W&&re){const ce=Ni();Cg(ce,s.layoutBox,W.layoutBox);const Q=Ni();Cg(Q,u,re.layoutBox),JS(ce,Q)||(L=!0),B.options.layoutRoot&&(r.relativeTarget=Q,r.relativeTargetOrigin=ce,r.relativeParent=B)}}}r.notifyListeners("didUpdate",{layout:u,snapshot:s,delta:A,layoutDelta:l,hasLayoutChanged:R,hasRelativeTargetChanged:L})}else if(r.isLead()){const{onExitComplete:u}=r.options;u&&u()}r.options.transition=void 0}function s$(r){xg&&zf.totalNodes++,r.parent&&(r.isProjecting()||(r.isProjectionDirty=r.parent.isProjectionDirty),r.isSharedProjectionDirty||(r.isSharedProjectionDirty=!!(r.isProjectionDirty||r.parent.isProjectionDirty||r.parent.isSharedProjectionDirty)),r.isTransformDirty||(r.isTransformDirty=r.parent.isTransformDirty))}function o$(r){r.isProjectionDirty=r.isSharedProjectionDirty=r.isTransformDirty=!1}function a$(r){r.clearSnapshot()}function K7(r){r.clearMeasurements()}function l$(r){r.isLayoutDirty=!1}function c$(r){const{visualElement:n}=r.options;n&&n.getProps().onBeforeLayoutMeasure&&n.notify("BeforeLayoutMeasure"),r.resetTransform()}function Y7(r){r.finishAnimation(),r.targetDelta=r.relativeTarget=r.target=void 0,r.isProjectionDirty=!0}function u$(r){r.resolveTargetDelta()}function h$(r){r.calcProjection()}function d$(r){r.resetSkewAndRotation()}function f$(r){r.removeLeadSnapshot()}function Q7(r,n,s){r.translate=_i(n.translate,0,s),r.scale=_i(n.scale,1,s),r.origin=n.origin,r.originPoint=n.originPoint}function J7(r,n,s,u){r.min=_i(n.min,s.min,u),r.max=_i(n.max,s.max,u)}function p$(r,n,s,u){J7(r.x,n.x,s.x,u),J7(r.y,n.y,s.y,u)}function m$(r){return r.animationValues&&r.animationValues.opacityExit!==void 0}const g$={duration:.45,ease:[.4,0,.1,1]},e6=r=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(r),t6=e6("applewebkit/")&&!e6("chrome/")?Math.round:eo;function r6(r){r.min=t6(r.min),r.max=t6(r.max)}function y$(r){r6(r.x),r6(r.y)}function rP(r,n,s){return r==="position"||r==="preserve-aspect"&&!_U(W7(n),W7(s),.2)}function _$(r){var n;return r!==r.root&&((n=r.scroll)===null||n===void 0?void 0:n.wasRoot)}const v$=tP({attachResizeListener:(r,n)=>eh(r,"resize",n),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),l1={current:void 0},nP=tP({measureScroll:r=>({x:r.scrollLeft,y:r.scrollTop}),defaultParent:()=>{if(!l1.current){const r=new v$({});r.mount(window),r.setOptions({layoutScroll:!0}),l1.current=r}return l1.current},resetTransform:(r,n)=>{r.style.transform=n!==void 0?n:"none"},checkIsScrollRoot:r=>window.getComputedStyle(r).position==="fixed"}),x$={pan:{Feature:LU},drag:{Feature:RU,ProjectionNode:nP,MeasureLayout:XS}};function n6(r,n,s){const{props:u}=r;r.animationState&&u.whileHover&&r.animationState.setActive("whileHover",s);const m=u[s?"onHoverStart":"onHoverEnd"];m&&Bn.postRender(()=>m(n,hy(n)))}class b$ extends Od{mount(){const{current:n,props:s}=this.node;n&&(this.unmount=lU(n,u=>(n6(this.node,u,!0),m=>n6(this.node,m,!1)),{passive:!s.onHoverStart&&!s.onHoverEnd}))}unmount(){}}class w$ extends Od{constructor(){super(...arguments),this.isActive=!1}onFocus(){let n=!1;try{n=this.node.current.matches(":focus-visible")}catch{n=!0}!n||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Td(eh(this.node.current,"focus",()=>this.onFocus()),eh(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const iP=(r,n)=>n?r===n?!0:iP(r,n.parentElement):!1;function c1(r,n){if(!n)return;const s=new PointerEvent("pointer"+r);n(s,hy(s))}class T$ extends Od{constructor(){super(...arguments),this.removeStartListeners=eo,this.removeEndListeners=eo,this.removeAccessibleListeners=eo,this.startPointerPress=(n,s)=>{if(this.isPressing)return;this.removeEndListeners();const u=this.node.getProps(),x=Sd(window,"pointerup",(l,A)=>{if(!this.checkPressEnd())return;const{onTap:R,onTapCancel:L,globalTapTarget:B}=this.node.getProps(),W=!B&&!iP(this.node.current,l.target)?L:R;W&&Bn.update(()=>W(l,A))},{passive:!(u.onTap||u.onPointerUp)}),v=Sd(window,"pointercancel",(l,A)=>this.cancelPress(l,A),{passive:!(u.onTapCancel||u.onPointerCancel)});this.removeEndListeners=Td(x,v),this.startPress(n,s)},this.startAccessiblePress=()=>{const n=x=>{if(x.key!=="Enter"||this.isPressing)return;const v=l=>{l.key!=="Enter"||!this.checkPressEnd()||c1("up",(A,R)=>{const{onTap:L}=this.node.getProps();L&&Bn.postRender(()=>L(A,R))})};this.removeEndListeners(),this.removeEndListeners=eh(this.node.current,"keyup",v),c1("down",(l,A)=>{this.startPress(l,A)})},s=eh(this.node.current,"keydown",n),u=()=>{this.isPressing&&c1("cancel",(x,v)=>this.cancelPress(x,v))},m=eh(this.node.current,"blur",u);this.removeAccessibleListeners=Td(s,m)}}startPress(n,s){this.isPressing=!0;const{onTapStart:u,whileTap:m}=this.node.getProps();m&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),u&&Bn.postRender(()=>u(n,s))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!OS()}cancelPress(n,s){if(!this.checkPressEnd())return;const{onTapCancel:u}=this.node.getProps();u&&Bn.postRender(()=>u(n,s))}mount(){const n=this.node.getProps(),s=Sd(n.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(n.onTapStart||n.onPointerStart)}),u=eh(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Td(s,u)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const ox=new WeakMap,u1=new WeakMap,S$=r=>{const n=ox.get(r.target);n&&n(r)},P$=r=>{r.forEach(S$)};function C$({root:r,...n}){const s=r||document;u1.has(s)||u1.set(s,{});const u=u1.get(s),m=JSON.stringify(n);return u[m]||(u[m]=new IntersectionObserver(P$,{root:r,...n})),u[m]}function E$(r,n,s){const u=C$(n);return ox.set(r,s),u.observe(r),()=>{ox.delete(r),u.unobserve(r)}}const M$={some:0,all:1};class I$ extends Od{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:n={}}=this.node.getProps(),{root:s,margin:u,amount:m="some",once:x}=n,v={root:s?s.current:void 0,rootMargin:u,threshold:typeof m=="number"?m:M$[m]},l=A=>{const{isIntersecting:R}=A;if(this.isInView===R||(this.isInView=R,x&&!R&&this.hasEnteredView))return;R&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",R);const{onViewportEnter:L,onViewportLeave:B}=this.node.getProps(),W=R?L:B;W&&W(A)};return E$(this.node.current,v,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:n,prevProps:s}=this.node;["amount","margin","root"].some(A$(n,s))&&this.startObserver()}unmount(){}}function A$({viewport:r={}},{viewport:n={}}={}){return s=>r[s]!==n[s]}const k$={inView:{Feature:I$},tap:{Feature:T$},focus:{Feature:w$},hover:{Feature:b$}},D$={layout:{ProjectionNode:nP,MeasureLayout:XS}},$2=j.createContext({transformPagePoint:r=>r,isStatic:!1,reducedMotion:"never"}),A_=j.createContext({}),G2=typeof window<"u",sP=G2?j.useLayoutEffect:j.useEffect,oP=j.createContext({strict:!1});function R$(r,n,s,u,m){var x,v;const{visualElement:l}=j.useContext(A_),A=j.useContext(oP),R=j.useContext(I_),L=j.useContext($2).reducedMotion,B=j.useRef();u=u||A.renderer,!B.current&&u&&(B.current=u(r,{visualState:n,parent:l,props:s,presenceContext:R,blockInitialAnimation:R?R.initial===!1:!1,reducedMotionConfig:L}));const W=B.current,re=j.useContext(HS);W&&!W.projection&&m&&(W.type==="html"||W.type==="svg")&&L$(B.current,s,m,re);const ce=j.useRef(!1);j.useInsertionEffect(()=>{W&&ce.current&&W.update(s,R)});const Q=s[RS],X=j.useRef(!!Q&&!(!((x=window.MotionHandoffIsComplete)===null||x===void 0)&&x.call(window,Q))&&((v=window.MotionHasOptimisedAnimation)===null||v===void 0?void 0:v.call(window,Q)));return sP(()=>{W&&(ce.current=!0,window.MotionIsMounted=!0,W.updateFeatures(),U2.render(W.render),X.current&&W.animationState&&W.animationState.animateChanges())}),j.useEffect(()=>{W&&(!X.current&&W.animationState&&W.animationState.animateChanges(),X.current&&(queueMicrotask(()=>{var le;(le=window.MotionHandoffMarkAsComplete)===null||le===void 0||le.call(window,Q)}),X.current=!1))}),W}function L$(r,n,s,u){const{layoutId:m,layout:x,drag:v,dragConstraints:l,layoutScroll:A,layoutRoot:R}=n;r.projection=new s(r.latestValues,n["data-framer-portal-id"]?void 0:aP(r.parent)),r.projection.setOptions({layoutId:m,layout:x,alwaysMeasureLayout:!!v||l&&em(l),visualElement:r,animationType:typeof x=="string"?x:"both",initialPromotionConfig:u,layoutScroll:A,layoutRoot:R})}function aP(r){if(r)return r.options.allowProjection!==!1?r.projection:aP(r.parent)}function z$(r,n,s){return j.useCallback(u=>{u&&r.mount&&r.mount(u),n&&(u?n.mount(u):n.unmount()),s&&(typeof s=="function"?s(u):em(s)&&(s.current=u))},[n])}function k_(r){return C_(r.animate)||b2.some(n=>Hg(r[n]))}function lP(r){return!!(k_(r)||r.variants)}function F$(r,n){if(k_(r)){const{initial:s,animate:u}=r;return{initial:s===!1||Hg(s)?s:void 0,animate:Hg(u)?u:void 0}}return r.inherit!==!1?n:{}}function O$(r){const{initial:n,animate:s}=F$(r,j.useContext(A_));return j.useMemo(()=>({initial:n,animate:s}),[i6(n),i6(s)])}function i6(r){return Array.isArray(r)?r.join(" "):r}const s6={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},bm={};for(const r in s6)bm[r]={isEnabled:n=>s6[r].some(s=>!!n[s])};function N$(r){for(const n in r)bm[n]={...bm[n],...r[n]}}const j$=Symbol.for("motionComponentSymbol");function B$({preloadedFeatures:r,createVisualElement:n,useRender:s,useVisualState:u,Component:m}){r&&N$(r);function x(l,A){let R;const L={...j.useContext($2),...l,layoutId:V$(l)},{isStatic:B}=L,W=O$(l),re=u(l,B);if(!B&&G2){U$();const ce=$$(L);R=ce.MeasureLayout,W.visualElement=R$(m,re,L,n,ce.ProjectionNode)}return V.jsxs(A_.Provider,{value:W,children:[R&&W.visualElement?V.jsx(R,{visualElement:W.visualElement,...L}):null,s(m,l,z$(re,W.visualElement,A),re,B,W.visualElement)]})}const v=j.forwardRef(x);return v[j$]=m,v}function V$({layoutId:r}){const n=j.useContext(V2).id;return n&&r!==void 0?n+"-"+r:r}function U$(r,n){j.useContext(oP).strict}function $$(r){const{drag:n,layout:s}=bm;if(!n&&!s)return{};const u={...n,...s};return{MeasureLayout:n?.isEnabled(r)||s?.isEnabled(r)?u.MeasureLayout:void 0,ProjectionNode:u.ProjectionNode}}const G$=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function q2(r){return typeof r!="string"||r.includes("-")?!1:!!(G$.indexOf(r)>-1||/[A-Z]/u.test(r))}function cP(r,{style:n,vars:s},u,m){Object.assign(r.style,n,m&&m.getProjectionStyles(u));for(const x in s)r.style.setProperty(x,s[x])}const uP=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function hP(r,n,s,u){cP(r,n,void 0,u);for(const m in n.attrs)r.setAttribute(uP.has(m)?m:B2(m),n.attrs[m])}function dP(r,{layout:n,layoutId:s}){return ep.has(r)||r.startsWith("origin")||(n||s!==void 0)&&(!!J0[r]||r==="opacity")}function Z2(r,n,s){var u;const{style:m}=r,x={};for(const v in m)(Js(m[v])||n.style&&Js(n.style[v])||dP(v,r)||((u=s?.getValue(v))===null||u===void 0?void 0:u.liveStyle)!==void 0)&&(x[v]=m[v]);return x}function fP(r,n,s){const u=Z2(r,n,s);for(const m in r)if(Js(r[m])||Js(n[m])){const x=ly.indexOf(m)!==-1?"attr"+m.charAt(0).toUpperCase()+m.substring(1):m;u[x]=r[m]}return u}function W2(r){const n=j.useRef(null);return n.current===null&&(n.current=r()),n.current}function q$({scrapeMotionValuesFromProps:r,createRenderState:n,onMount:s},u,m,x){const v={latestValues:Z$(u,m,x,r),renderState:n()};return s&&(v.mount=l=>s(u,l,v)),v}const pP=r=>(n,s)=>{const u=j.useContext(A_),m=j.useContext(I_),x=()=>q$(r,n,u,m);return s?x():W2(x)};function Z$(r,n,s,u){const m={},x=u(r,{});for(const W in x)m[W]=w0(x[W]);let{initial:v,animate:l}=r;const A=k_(r),R=lP(r);n&&R&&!A&&r.inherit!==!1&&(v===void 0&&(v=n.initial),l===void 0&&(l=n.animate));let L=s?s.initial===!1:!1;L=L||v===!1;const B=L?l:v;if(B&&typeof B!="boolean"&&!C_(B)){const W=Array.isArray(B)?B:[B];for(let re=0;re<W.length;re++){const ce=v2(r,W[re]);if(ce){const{transitionEnd:Q,transition:X,...le}=ce;for(const he in le){let _e=le[he];if(Array.isArray(_e)){const Ie=L?_e.length-1:0;_e=_e[Ie]}_e!==null&&(m[he]=_e)}for(const he in Q)m[he]=Q[he]}}}return m}const H2=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),mP=()=>({...H2(),attrs:{}}),gP=(r,n)=>n&&typeof r=="number"?n.transform(r):r,W$={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},H$=ly.length;function X$(r,n,s){let u="",m=!0;for(let x=0;x<H$;x++){const v=ly[x],l=r[v];if(l===void 0)continue;let A=!0;if(typeof l=="number"?A=l===(v.startsWith("scale")?1:0):A=parseFloat(l)===0,!A||s){const R=gP(l,I2[v]);if(!A){m=!1;const L=W$[v]||v;u+=`${L}(${R}) `}s&&(n[v]=R)}}return u=u.trim(),s?u=s(n,m?"":u):m&&(u="none"),u}function X2(r,n,s){const{style:u,vars:m,transformOrigin:x}=r;let v=!1,l=!1;for(const A in n){const R=n[A];if(ep.has(A)){v=!0;continue}else if(lS(A)){m[A]=R;continue}else{const L=gP(R,I2[A]);A.startsWith("origin")?(l=!0,x[A]=L):u[A]=L}}if(n.transform||(v||s?u.transform=X$(n,r.transform,s):u.transform&&(u.transform="none")),l){const{originX:A="50%",originY:R="50%",originZ:L=0}=x;u.transformOrigin=`${A} ${R} ${L}`}}function o6(r,n,s){return typeof r=="string"?r:wr.transform(n+s*r)}function K$(r,n,s){const u=o6(n,r.x,r.width),m=o6(s,r.y,r.height);return`${u} ${m}`}const Y$={offset:"stroke-dashoffset",array:"stroke-dasharray"},Q$={offset:"strokeDashoffset",array:"strokeDasharray"};function J$(r,n,s=1,u=0,m=!0){r.pathLength=1;const x=m?Y$:Q$;r[x.offset]=wr.transform(-u);const v=wr.transform(n),l=wr.transform(s);r[x.array]=`${v} ${l}`}function K2(r,{attrX:n,attrY:s,attrScale:u,originX:m,originY:x,pathLength:v,pathSpacing:l=1,pathOffset:A=0,...R},L,B){if(X2(r,R,B),L){r.style.viewBox&&(r.attrs.viewBox=r.style.viewBox);return}r.attrs=r.style,r.style={};const{attrs:W,style:re,dimensions:ce}=r;W.transform&&(ce&&(re.transform=W.transform),delete W.transform),ce&&(m!==void 0||x!==void 0||re.transform)&&(re.transformOrigin=K$(ce,m!==void 0?m:.5,x!==void 0?x:.5)),n!==void 0&&(W.x=n),s!==void 0&&(W.y=s),u!==void 0&&(W.scale=u),v!==void 0&&J$(W,v,l,A,!1)}const Y2=r=>typeof r=="string"&&r.toLowerCase()==="svg",eG={useVisualState:pP({scrapeMotionValuesFromProps:fP,createRenderState:mP,onMount:(r,n,{renderState:s,latestValues:u})=>{Bn.read(()=>{try{s.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{s.dimensions={x:0,y:0,width:0,height:0}}}),Bn.render(()=>{K2(s,u,Y2(n.tagName),r.transformTemplate),hP(n,s)})}})},tG={useVisualState:pP({scrapeMotionValuesFromProps:Z2,createRenderState:H2})};function yP(r,n,s){for(const u in n)!Js(n[u])&&!dP(u,s)&&(r[u]=n[u])}function rG({transformTemplate:r},n){return j.useMemo(()=>{const s=H2();return X2(s,n,r),Object.assign({},s.vars,s.style)},[n])}function nG(r,n){const s=r.style||{},u={};return yP(u,s,r),Object.assign(u,rG(r,n)),u}function iG(r,n){const s={},u=nG(r,n);return r.drag&&r.dragListener!==!1&&(s.draggable=!1,u.userSelect=u.WebkitUserSelect=u.WebkitTouchCallout="none",u.touchAction=r.drag===!0?"none":`pan-${r.drag==="x"?"y":"x"}`),r.tabIndex===void 0&&(r.onTap||r.onTapStart||r.whileTap)&&(s.tabIndex=0),s.style=u,s}const sG=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function e_(r){return r.startsWith("while")||r.startsWith("drag")&&r!=="draggable"||r.startsWith("layout")||r.startsWith("onTap")||r.startsWith("onPan")||r.startsWith("onLayout")||sG.has(r)}let _P=r=>!e_(r);function oG(r){r&&(_P=n=>n.startsWith("on")?!e_(n):r(n))}try{oG(require("@emotion/is-prop-valid").default)}catch{}function aG(r,n,s){const u={};for(const m in r)m==="values"&&typeof r.values=="object"||(_P(m)||s===!0&&e_(m)||!n&&!e_(m)||r.draggable&&m.startsWith("onDrag"))&&(u[m]=r[m]);return u}function lG(r,n,s,u){const m=j.useMemo(()=>{const x=mP();return K2(x,n,Y2(u),r.transformTemplate),{...x.attrs,style:{...x.style}}},[n]);if(r.style){const x={};yP(x,r.style,r),m.style={...x,...m.style}}return m}function cG(r=!1){return(s,u,m,{latestValues:x},v)=>{const A=(q2(s)?lG:iG)(u,x,v,s),R=aG(u,typeof s=="string",r),L=s!==j.Fragment?{...R,...A,ref:m}:{},{children:B}=u,W=j.useMemo(()=>Js(B)?B.get():B,[B]);return j.createElement(s,{...L,children:W})}}function uG(r,n){return function(u,{forwardMotionProps:m}={forwardMotionProps:!1}){const v={...q2(u)?eG:tG,preloadedFeatures:r,useRender:cG(m),createVisualElement:n,Component:u};return B$(v)}}const ax={current:null},vP={current:!1};function hG(){if(vP.current=!0,!!G2)if(window.matchMedia){const r=window.matchMedia("(prefers-reduced-motion)"),n=()=>ax.current=r.matches;r.addListener(n),n()}else ax.current=!1}function dG(r,n,s){for(const u in n){const m=n[u],x=s[u];if(Js(m))r.addValue(u,m);else if(Js(x))r.addValue(u,Yg(m,{owner:r}));else if(x!==m)if(r.hasValue(u)){const v=r.getValue(u);v.liveStyle===!0?v.jump(m):v.hasAnimated||v.set(m)}else{const v=r.getStaticValue(u);r.addValue(u,Yg(v!==void 0?v:m,{owner:r}))}}for(const u in s)n[u]===void 0&&r.removeValue(u);return n}const a6=new WeakMap,fG=[...hS,Ys,Rd],pG=r=>fG.find(uS(r)),l6=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class mG{scrapeMotionValuesFromProps(n,s,u){return{}}constructor({parent:n,props:s,presenceContext:u,reducedMotionConfig:m,blockInitialAnimation:x,visualState:v},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=C2,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const W=Jc.now();this.renderScheduledAt<W&&(this.renderScheduledAt=W,Bn.render(this.render,!1,!0))};const{latestValues:A,renderState:R}=v;this.latestValues=A,this.baseTarget={...A},this.initialValues=s.initial?{...A}:{},this.renderState=R,this.parent=n,this.props=s,this.presenceContext=u,this.depth=n?n.depth+1:0,this.reducedMotionConfig=m,this.options=l,this.blockInitialAnimation=!!x,this.isControllingVariants=k_(s),this.isVariantNode=lP(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(n&&n.current);const{willChange:L,...B}=this.scrapeMotionValuesFromProps(s,{},this);for(const W in B){const re=B[W];A[W]!==void 0&&Js(re)&&re.set(A[W],!1)}}mount(n){this.current=n,a6.set(n,this),this.projection&&!this.projection.instance&&this.projection.mount(n),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,u)=>this.bindToMotionValue(u,s)),vP.current||hG(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:ax.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){a6.delete(this.current),this.projection&&this.projection.unmount(),Dd(this.notifyUpdate),Dd(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const s=this.features[n];s&&(s.unmount(),s.isMounted=!1)}this.current=null}bindToMotionValue(n,s){this.valueSubscriptions.has(n)&&this.valueSubscriptions.get(n)();const u=ep.has(n),m=s.on("change",l=>{this.latestValues[n]=l,this.props.onUpdate&&Bn.preRender(this.notifyUpdate),u&&this.projection&&(this.projection.isTransformDirty=!0)}),x=s.on("renderRequest",this.scheduleRender);let v;window.MotionCheckAppearSync&&(v=window.MotionCheckAppearSync(this,n,s)),this.valueSubscriptions.set(n,()=>{m(),x(),v&&v(),s.owner&&s.stop()})}sortNodePosition(n){return!this.current||!this.sortInstanceNodePosition||this.type!==n.type?0:this.sortInstanceNodePosition(this.current,n.current)}updateFeatures(){let n="animation";for(n in bm){const s=bm[n];if(!s)continue;const{isEnabled:u,Feature:m}=s;if(!this.features[n]&&m&&u(this.props)&&(this.features[n]=new m(this)),this.features[n]){const x=this.features[n];x.isMounted?x.update():(x.mount(),x.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ni()}getStaticValue(n){return this.latestValues[n]}setStaticValue(n,s){this.latestValues[n]=s}update(n,s){(n.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=n,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let u=0;u<l6.length;u++){const m=l6[u];this.propEventSubscriptions[m]&&(this.propEventSubscriptions[m](),delete this.propEventSubscriptions[m]);const x="on"+m,v=n[x];v&&(this.propEventSubscriptions[m]=this.on(m,v))}this.prevMotionValues=dG(this,this.scrapeMotionValuesFromProps(n,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(n){return this.props.variants?this.props.variants[n]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(n){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(n),()=>s.variantChildren.delete(n)}addValue(n,s){const u=this.values.get(n);s!==u&&(u&&this.removeValue(n),this.bindToMotionValue(n,s),this.values.set(n,s),this.latestValues[n]=s.get())}removeValue(n){this.values.delete(n);const s=this.valueSubscriptions.get(n);s&&(s(),this.valueSubscriptions.delete(n)),delete this.latestValues[n],this.removeValueFromRenderState(n,this.renderState)}hasValue(n){return this.values.has(n)}getValue(n,s){if(this.props.values&&this.props.values[n])return this.props.values[n];let u=this.values.get(n);return u===void 0&&s!==void 0&&(u=Yg(s===null?void 0:s,{owner:this}),this.addValue(n,u)),u}readValue(n,s){var u;let m=this.latestValues[n]!==void 0||!this.current?this.latestValues[n]:(u=this.getBaseTargetFromProps(this.props,n))!==null&&u!==void 0?u:this.readValueFromInstance(this.current,n,this.options);return m!=null&&(typeof m=="string"&&(oS(m)||sS(m))?m=parseFloat(m):!pG(m)&&Rd.test(s)&&(m=vS(n,s)),this.setBaseTarget(n,Js(m)?m.get():m)),Js(m)?m.get():m}setBaseTarget(n,s){this.baseTarget[n]=s}getBaseTarget(n){var s;const{initial:u}=this.props;let m;if(typeof u=="string"||typeof u=="object"){const v=v2(this.props,u,(s=this.presenceContext)===null||s===void 0?void 0:s.custom);v&&(m=v[n])}if(u&&m!==void 0)return m;const x=this.getBaseTargetFromProps(this.props,n);return x!==void 0&&!Js(x)?x:this.initialValues[n]!==void 0&&m===void 0?void 0:this.baseTarget[n]}on(n,s){return this.events[n]||(this.events[n]=new j2),this.events[n].add(s)}notify(n,...s){this.events[n]&&this.events[n].notify(...s)}}class xP extends mG{constructor(){super(...arguments),this.KeyframeResolver=xS}sortInstanceNodePosition(n,s){return n.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(n,s){return n.style?n.style[s]:void 0}removeValueFromRenderState(n,{vars:s,style:u}){delete s[n],delete u[n]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:n}=this.props;Js(n)&&(this.childSubscription=n.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}}function gG(r){return window.getComputedStyle(r)}class yG extends xP{constructor(){super(...arguments),this.type="html",this.renderInstance=cP}readValueFromInstance(n,s){if(ep.has(s)){const u=A2(s);return u&&u.default||0}else{const u=gG(n),m=(lS(s)?u.getPropertyValue(s):u[s])||0;return typeof m=="string"?m.trim():m}}measureInstanceViewportBox(n,{transformPagePoint:s}){return ZS(n,s)}build(n,s,u){X2(n,s,u.transformTemplate)}scrapeMotionValuesFromProps(n,s,u){return Z2(n,s,u)}}class _G extends xP{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ni}getBaseTargetFromProps(n,s){return n[s]}readValueFromInstance(n,s){if(ep.has(s)){const u=A2(s);return u&&u.default||0}return s=uP.has(s)?s:B2(s),n.getAttribute(s)}scrapeMotionValuesFromProps(n,s,u){return fP(n,s,u)}build(n,s,u){K2(n,s,this.isSVGTag,u.transformTemplate)}renderInstance(n,s,u,m){hP(n,s,u,m)}mount(n){this.isSVGTag=Y2(n.tagName),super.mount(n)}}const vG=(r,n)=>q2(r)?new _G(n):new yG(n,{allowProjection:r!==j.Fragment}),xG=uG({...oU,...k$,...x$,...D$},vG),wa=nB(xG);class bG extends j.Component{getSnapshotBeforeUpdate(n){const s=this.props.childRef.current;if(s&&n.isPresent&&!this.props.isPresent){const u=this.props.sizeRef.current;u.height=s.offsetHeight||0,u.width=s.offsetWidth||0,u.top=s.offsetTop,u.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function wG({children:r,isPresent:n}){const s=j.useId(),u=j.useRef(null),m=j.useRef({width:0,height:0,top:0,left:0}),{nonce:x}=j.useContext($2);return j.useInsertionEffect(()=>{const{width:v,height:l,top:A,left:R}=m.current;if(n||!u.current||!v||!l)return;u.current.dataset.motionPopId=s;const L=document.createElement("style");return x&&(L.nonce=x),document.head.appendChild(L),L.sheet&&L.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${v}px !important;
            height: ${l}px !important;
            top: ${A}px !important;
            left: ${R}px !important;
          }
        `),()=>{document.head.removeChild(L)}},[n]),V.jsx(bG,{isPresent:n,childRef:u,sizeRef:m,children:j.cloneElement(r,{ref:u})})}const TG=({children:r,initial:n,isPresent:s,onExitComplete:u,custom:m,presenceAffectsLayout:x,mode:v})=>{const l=W2(SG),A=j.useId(),R=j.useCallback(B=>{l.set(B,!0);for(const W of l.values())if(!W)return;u&&u()},[l,u]),L=j.useMemo(()=>({id:A,initial:n,isPresent:s,custom:m,onExitComplete:R,register:B=>(l.set(B,!1),()=>l.delete(B))}),x?[Math.random(),R]:[s,R]);return j.useMemo(()=>{l.forEach((B,W)=>l.set(W,!1))},[s]),j.useEffect(()=>{!s&&!l.size&&u&&u()},[s]),v==="popLayout"&&(r=V.jsx(wG,{isPresent:s,children:r})),V.jsx(I_.Provider,{value:L,children:r})};function SG(){return new Map}const d0=r=>r.key||"";function c6(r){const n=[];return j.Children.forEach(r,s=>{j.isValidElement(s)&&n.push(s)}),n}const PG=({children:r,exitBeforeEnter:n,custom:s,initial:u=!0,onExitComplete:m,presenceAffectsLayout:x=!0,mode:v="sync"})=>{const l=j.useMemo(()=>c6(r),[r]),A=l.map(d0),R=j.useRef(!0),L=j.useRef(l),B=W2(()=>new Map),[W,re]=j.useState(l),[ce,Q]=j.useState(l);sP(()=>{R.current=!1,L.current=l;for(let he=0;he<ce.length;he++){const _e=d0(ce[he]);A.includes(_e)?B.delete(_e):B.get(_e)!==!0&&B.set(_e,!1)}},[ce,A.length,A.join("-")]);const X=[];if(l!==W){let he=[...l];for(let _e=0;_e<ce.length;_e++){const Ie=ce[_e],ke=d0(Ie);A.includes(ke)||(he.splice(_e,0,Ie),X.push(Ie))}v==="wait"&&X.length&&(he=X),Q(c6(he)),re(l);return}const{forceRender:le}=j.useContext(V2);return V.jsx(V.Fragment,{children:ce.map(he=>{const _e=d0(he),Ie=l===ce||A.includes(_e),ke=()=>{if(B.has(_e))B.set(_e,!0);else return;let Je=!0;B.forEach(He=>{He||(Je=!1)}),Je&&(le?.(),Q(L.current),m&&m())};return V.jsx(TG,{isPresent:Ie,initial:!R.current||u?void 0:!1,custom:Ie?void 0:s,presenceAffectsLayout:x,mode:v,onExitComplete:Ie?void 0:ke,children:he},_e)})})};function CG(){const[,r]=x6(),{toast:n}=mx(),[s,u]=j.useState(""),[m,x]=j.useState(""),[v,l]=j.useState(!1),[A,R]=j.useState(!1),[L,B]=j.useState(!1),W=async re=>{re.preventDefault(),l(!0);const ce=s.trim(),Q=m.trim();try{const X=await fetch("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:ce,password:Q}),credentials:"include"}),le=await X.json();X.ok?(F6.invalidateQueries({queryKey:["/api/admin/session"]}),B(!0),setTimeout(()=>{r("/admin")},5e3)):(n({title:"",description:le.message||"   ",variant:"destructive"}),l(!1))}catch{n({title:"",description:"    ",variant:"destructive"}),l(!1)}};return V.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-gray-100 via-gray-200 to-gray-300 p-4 overflow-hidden",children:V.jsx(PG,{mode:"wait",children:L?V.jsxs(wa.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"relative flex flex-col items-center justify-center",children:[V.jsxs("div",{className:"relative flex items-center justify-center mb-8",children:[V.jsx(wa.div,{initial:{scale:.5,opacity:.8},animate:{scale:2.5,opacity:0},transition:{delay:0,duration:2,repeat:1/0,repeatDelay:.5},className:"absolute rounded-full border-2 border-gray-400/50",style:{width:120,height:120}}),V.jsx(wa.div,{initial:{scale:.5,opacity:.8},animate:{scale:2.5,opacity:0},transition:{delay:.5,duration:2,repeat:1/0,repeatDelay:.5},className:"absolute rounded-full border-2 border-gray-400/50",style:{width:120,height:120}}),V.jsx(wa.div,{initial:{scale:.5,opacity:.8},animate:{scale:2.5,opacity:0},transition:{delay:1,duration:2,repeat:1/0,repeatDelay:.5},className:"absolute rounded-full border-2 border-gray-400/50",style:{width:120,height:120}}),V.jsx(wa.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:200,damping:15,delay:.2},className:"relative z-10 flex items-center justify-center w-28 h-28 rounded-full bg-gradient-to-br from-gray-300 to-gray-400 shadow-2xl shadow-gray-300/50",children:V.jsx(wa.div,{animate:{rotate:[0,10,-10,10,0]},transition:{duration:2,repeat:1/0,repeatDelay:.5},children:V.jsx(f4,{className:"h-14 w-14 text-white drop-shadow-lg"})})})]}),V.jsxs(wa.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5,duration:.8,type:"spring"},className:"text-center relative z-10",children:[V.jsx(wa.h1,{className:"text-4xl md:text-6xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-gray-800 via-gray-600 to-gray-800 mb-2",animate:{backgroundPosition:["0% 50%","100% 50%","0% 50%"]},transition:{duration:3,repeat:1/0},style:{backgroundSize:"200% 200%"},children:" "}),V.jsx(wa.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.8,duration:.6,type:"spring"},className:"flex items-center justify-center gap-3 mt-2",children:V.jsx("span",{className:"text-3xl md:text-4xl font-bold text-black",children:" !"})})]}),V.jsx(wa.div,{initial:{scaleX:0},animate:{scaleX:1},transition:{delay:1.2,duration:1,ease:"easeOut"},className:"w-80 h-1.5 bg-gradient-to-r from-transparent via-gray-500 to-transparent rounded-full mt-8"}),V.jsxs(wa.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.8,duration:.6},className:"mt-8 flex flex-col items-center gap-3",children:[V.jsx("p",{className:"text-gray-600 text-lg",children:"   "}),V.jsx("div",{className:"flex gap-2",children:[0,1,2].map(re=>V.jsx(wa.div,{animate:{scale:[1,1.5,1],opacity:[.5,1,.5]},transition:{duration:.8,repeat:1/0,delay:re*.2},className:"w-3 h-3 rounded-full bg-gray-500"},re))})]})]},"welcome"):V.jsx(wa.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9,y:-50},transition:{duration:.4},className:"w-full max-w-md",children:V.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl shadow-gray-300/50 overflow-hidden",children:[V.jsxs("div",{className:"bg-gradient-to-r from-gray-500 to-gray-600 p-6 text-center",children:[V.jsx("h1",{className:"text-2xl font-bold text-white",children:" "}),V.jsx("p",{className:"text-white/80 text-sm mt-1",children:"   "})]}),V.jsxs("div",{className:"p-8",children:[V.jsxs("form",{onSubmit:W,className:"space-y-5",children:[V.jsxs("div",{className:"space-y-2",children:[V.jsx(Z0,{htmlFor:"username",className:"text-black font-medium",children:""}),V.jsx(Bf,{id:"username",type:"text",value:s,onChange:re=>u(re.target.value),placeholder:" ",autoComplete:"username",required:!0,className:"h-12 bg-gray-50 border-gray-200 text-black placeholder:text-gray-400 focus:border-gray-500 focus:ring-gray-500","data-testid":"input-username"})]}),V.jsxs("div",{className:"space-y-2",children:[V.jsx(Z0,{htmlFor:"password",className:"text-black font-medium",children:""}),V.jsxs("div",{className:"relative",children:[V.jsx(Bf,{id:"password",type:A?"text":"password",value:m,onChange:re=>x(re.target.value),placeholder:" ",autoComplete:"current-password",required:!0,className:"h-12 bg-gray-50 border-gray-200 text-black placeholder:text-gray-400 focus:border-gray-500 focus:ring-gray-500 pr-12","data-testid":"input-password"}),V.jsx("button",{type:"button",onClick:()=>R(!A),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:A?V.jsx(LM,{className:"h-5 w-5"}):V.jsx(zM,{className:"h-5 w-5"})})]})]}),V.jsx(Qo,{type:"submit",className:"w-full h-12 bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white font-semibold text-base shadow-lg shadow-gray-400/50",disabled:v,"data-testid":"button-login",children:v?"...":""})]}),V.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-100",children:[V.jsxs("p",{className:"text-center text-sm text-gray-500",children:[": ",V.jsx("span",{className:"font-mono text-black bg-gray-100 px-2 py-0.5 rounded",children:"admin"})]}),V.jsxs("p",{className:"text-center text-sm text-gray-500 mt-1",children:[": ",V.jsx("span",{className:"font-mono text-black bg-gray-100 px-2 py-0.5 rounded",children:"admin123"})]})]})]})]})},"login")})})}function EG(){return V.jsxs(JC,{children:[V.jsx(e0,{path:"/",component:PN}),V.jsx(e0,{path:"/admin",component:rB}),V.jsx(e0,{path:"/admin/login",component:CG}),V.jsx(e0,{component:fk})]})}function MG(){return V.jsx(vE,{client:F6,children:V.jsx(sk,{children:V.jsxs(lk,{children:[V.jsx(RI,{}),V.jsx(EG,{})]})})})}AC.createRoot(document.getElementById("root")).render(V.jsx(MG,{}));
